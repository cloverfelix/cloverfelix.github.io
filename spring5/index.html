<!DOCTYPE html>
<html lang="zh-cn">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Spring5 - clover</title><meta name="Description" content="Spring5"><meta property="og:title" content="Spring5" />
<meta property="og:description" content="Spring5" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cloverfelix.github.io/spring5/" /><meta property="og:image" content="https://cloverfelix.github.io/RW.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-10-29T17:25:51&#43;08:00" />
<meta property="article:modified_time" content="2021-10-29T17:25:51&#43;08:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://cloverfelix.github.io/RW.png"/>

<meta name="twitter:title" content="Spring5"/>
<meta name="twitter:description" content="Spring5"/>
<meta name="application-name" content="Clover">
<meta name="apple-mobile-web-app-title" content="Clover"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://cloverfelix.github.io/spring5/" /><link rel="prev" href="https://cloverfelix.github.io/springcloud/" /><link rel="next" href="https://cloverfelix.github.io/springboot2/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Spring5",
        "inLanguage": "zh-cn",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/cloverfelix.github.io\/spring5\/"
        },"image": ["https:\/\/cloverfelix.github.io\/images\/Apple-Devices-Preview.png"],"genre": "posts","keywords": "Spring","wordcount":  16289 ,
        "url": "https:\/\/cloverfelix.github.io\/spring5\/","datePublished": "2021-10-29T17:25:51+08:00","dateModified": "2021-10-29T17:25:51+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "clover","logo": "https:\/\/cloverfelix.github.io\/images\/RW.png"},"author": {
                "@type": "Person",
                "name": "Clover"
            },"description": "Spring5"
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="clover"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span>Clover</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 所有文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><a class="menu-item" href="/about/"> 关于 </a><a class="menu-item" href="https://github.com/cloverfelix" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="clover"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span>Clover</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">所有文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a class="menu-item" href="/about/" title="">关于</a><a class="menu-item" href="https://github.com/cloverfelix" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Spring5</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Clover</a></span>&nbsp;<span class="post-category">收录于 <a href="/categories/spring/"><i class="far fa-folder fa-fw"></i>Spring</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2021-10-29">2021-10-29</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 16289 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 33 分钟&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#1spring框架概述">1、Spring框架概述</a></li>
    <li><a href="#2入门案例">2、入门案例</a></li>
    <li><a href="#3ioc概念和原理">3、IOC(概念和原理)</a>
      <ul>
        <li><a href="#31什么是ioc">3.1、什么是IOC</a></li>
        <li><a href="#32ioc底层原理">3.2、IOC底层原理</a></li>
      </ul>
    </li>
    <li><a href="#4iocbeanfactory-接口">4、IOC(BeanFactory 接口)</a></li>
    <li><a href="#5ioc的操作">5、IOC的操作</a>
      <ul>
        <li><a href="#51bean管理">5.1、Bean管理</a></li>
        <li><a href="#52bean管理操作实现">5.2、Bean管理操作实现</a></li>
        <li><a href="#53ioc-操作-bean-管理xml-注入其他类型属性">5.3、IOC 操作 Bean 管理(xml 注入其他类型属性)</a>
          <ul>
            <li><a href="#531字面量">5.3.1、字面量</a></li>
            <li><a href="#532注入属性-外部bean">5.3.2、注入属性-外部Bean</a></li>
            <li><a href="#533注入属性-内部bean">5.3.3、注入属性-内部Bean</a></li>
            <li><a href="#534注入属性-级联赋值">5.3.4、注入属性-级联赋值</a>
              <ul>
                <li><a href="#5341第一种写法">5.3.4.1、第一种写法</a></li>
                <li><a href="#5342第二种写法">5.3.4.2、第二种写法</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#54ioc-操作-bean-管理xml-注入集合属性">5.4、IOC 操作 Bean 管理(xml 注入集合属性)</a>
          <ul>
            <li><a href="#541xml注入集合属性两个小细节">5.4.1、xml注入集合属性两个小细节</a></li>
          </ul>
        </li>
        <li><a href="#55ioc-操作-bean-管理factorybean">5.5、IOC 操作 Bean 管理(FactoryBean)</a></li>
        <li><a href="#56ioc-操作-bean-管理bean-作用域">5.6、IOC 操作 Bean 管理(bean 作用域)</a></li>
        <li><a href="#57ioc-操作-bean-管理bean-生命周期">5.7、IOC 操作 Bean 管理(bean 生命周期)</a></li>
        <li><a href="#58ioc-操作-bean-管理xml-自动装配">5.8、IOC 操作 Bean 管理(xml 自动装配)</a></li>
        <li><a href="#59ioc-操作-bean-管理外部属性文件">5.9、IOC 操作 Bean 管理(外部属性文件)</a></li>
        <li><a href="#510ioc-操作-bean-管理基于注解方式">5.10、IOC 操作 Bean 管理(基于注解方式)</a></li>
        <li><a href="#511完全注解开发">5.11、完全注解开发</a></li>
      </ul>
    </li>
    <li><a href="#6aop概念">6、AOP（概念）</a>
      <ul>
        <li><a href="#61什么是aop">6.1、什么是AOP</a></li>
        <li><a href="#62aop底层原理">6.2、AOP(底层原理)</a></li>
        <li><a href="#63aopjdk-动态代理">6.3、AOP(JDK 动态代理)</a></li>
        <li><a href="#64aop术语">6.4、AOP术语</a></li>
        <li><a href="#65aop操作准备工作">6.5、AOP操作(准备工作)</a></li>
        <li><a href="#66aop-操作aspectj-注解">6.6、AOP 操作(AspectJ 注解)</a></li>
        <li><a href="#67aop-操作aspectj-配置文件">6.7、AOP 操作（AspectJ 配置文件）</a></li>
      </ul>
    </li>
    <li><a href="#7jdbctemplate概念和准备">7、JdbcTemplate(概念和准备)</a>
      <ul>
        <li><a href="#71jdbctemplate-操作数据库添加">7.1、JdbcTemplate 操作数据库（添加）</a></li>
        <li><a href="#72jdbctemplate-操作数据库修改和删除">7.2、JdbcTemplate 操作数据库（修改和删除）</a></li>
        <li><a href="#73jdbctemplate-操作数据库查询返回某个值">7.3、JdbcTemplate 操作数据库（查询返回某个值）</a></li>
        <li><a href="#74jdbctemplate-操作数据库查询返回对象">7.4、JdbcTemplate 操作数据库（查询返回对象）</a></li>
        <li><a href="#75jdbctemplate-操作数据库查询返回集合">7.5、JdbcTemplate 操作数据库（查询返回集合）</a></li>
        <li><a href="#76jdbctemplate-操作数据库批量操作">7.6、JdbcTemplate 操作数据库（批量操作）</a></li>
      </ul>
    </li>
    <li><a href="#8事务概念">8、事务概念</a>
      <ul>
        <li><a href="#81事务操作搭建事务操作环境">8.1、事务操作（搭建事务操作环境）</a></li>
        <li><a href="#82事务操作spring-事务管理介绍">8.2、事务操作（Spring 事务管理介绍）</a></li>
        <li><a href="#83事务操作注解声明式事务管理">8.3、事务操作（注解声明式事务管理）</a></li>
        <li><a href="#84事务操作声明式事务管理参数配置">8.4、事务操作（声明式事务管理参数配置）</a></li>
        <li><a href="#85事务操作xml声明式事务管理">8.5、事务操作（XML声明式事务管理）</a></li>
        <li><a href="#86事务操作完全注解声明式事务管理">8.6、事务操作（完全注解声明式事务管理）</a></li>
      </ul>
    </li>
    <li><a href="#9spring5-框架新功能">9、Spring5 框架新功能</a></li>
    <li><a href="#10spring5-框架新功能webflux">10、Spring5 框架新功能（Webflux）</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="1spring框架概述">1、Spring框架概述</h2>
<ol>
<li>Spring 是<strong>轻量级</strong>的<strong>开源</strong>的 JavaEE<strong>框架</strong></li>
<li>Spring 可以解决企业应用开发的复杂性</li>
<li>Spring 有两个核心部分：<strong>IOC</strong>和 <strong>Aop</strong>
<ul>
<li>IOC：控制反转，把创建对象过程交给 Spring 进行管理</li>
<li>AOP：面向切面，不修改源代码进行功能增强</li>
</ul>
</li>
<li>Spring 特点
<ul>
<li>方便解耦，简化开发</li>
<li>AOP编程支持</li>
<li>方便程序测试</li>
<li>方便和其它框架进行整合</li>
<li>方便进行事务操作</li>
<li>降低API开发难度</li>
</ul>
</li>
</ol>
<h2 id="2入门案例">2、入门案例</h2>
<p>1、创建一个Java工程</p>
<p>2、导入相关的依赖包</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029201059.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029201059.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029201059.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029201059.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029201059.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029201059.png" /></p>
<p>3、创建普通类</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.clover.spring5</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Add.............&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>4、创建Spring配置文件，在配置文件中配置创建的对象</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">&#34;http://www.springframework.org/schema/beans&#34;</span>
       <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&#34;</span><span class="nt">&gt;</span>

    <span class="c">&lt;!--配置User对象创建--&gt;</span>
    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;user&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.User&#34;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/beans&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>5、进行测试代码编写</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.clover.spring5.Test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.clover.spring5.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.support.ClassPathXmlApplicationContext</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">demo</span> <span class="o">{</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testAdd</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="c1">//1.加载配置文件
</span><span class="c1"></span>        <span class="n">ClassPathXmlApplicationContext</span> <span class="n">context</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ClassPathXmlApplicationContext</span><span class="o">(</span><span class="s">&#34;bean1.xml&#34;</span><span class="o">);</span>

        <span class="c1">//2.获取配置创建的对象
</span><span class="c1"></span>        <span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">&#34;user&#34;</span><span class="o">,</span> <span class="n">User</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
        <span class="n">user</span><span class="o">.</span><span class="na">add</span><span class="o">();</span>

    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029201350.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029201350.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029201350.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029201350.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029201350.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029201350.png" /></p>
<h2 id="3ioc概念和原理">3、IOC(概念和原理)</h2>
<h3 id="31什么是ioc">3.1、什么是IOC</h3>
<ol>
<li>控制反转，把对象的创建和对象之间的调用过程，交给Spring进行管理</li>
<li>使用IOC的目的：为了耦合度降低</li>
</ol>
<h3 id="32ioc底层原理">3.2、IOC底层原理</h3>
<ul>
<li>
<p>xml解析、工厂模式、反射</p>
</li>
<li>
<p>反射：通道得到该类的字节码文件，然后可以操作该类中的所有内容</p>
</li>
<li>
<p>原始方式</p>
</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029203925.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029203925.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029203925.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029203925.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029203925.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029203925.png" /></p>
<ul>
<li>工厂模式</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029204220.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029204220.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029204220.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029204220.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029204220.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029204220.png" /></p>
<ul>
<li>IOC模式</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029203548.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029203548.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029203548.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029203548.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029203548.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029203548.png" /></p>
<h2 id="4iocbeanfactory-接口">4、IOC(BeanFactory 接口)</h2>
<ol>
<li>
<p><strong>IOC思想基于IOC容器完成，IOC容器底层就是对象工厂</strong></p>
</li>
<li>
<p>Spring提供IOC容器实现的<strong>两种方法</strong>：（两个接口）</p>
<ul>
<li>
<p><code>BeanFactory</code>：IOC容器的基本实现，是Spring内部的使用接口，不提供给开发人员进行使用</p>
<ul>
<li><strong>与ApplicationContext的区别</strong>：它在加载配置文件的时候不会去创建对象，在获取(使用)对象的时候才去创建对象</li>
</ul>
</li>
<li>
<p><code>ApplicationContext</code>：BeanFactory接口的子接口，提供更多更强大的功能，一般由开发人员进行使用</p>
<ul>
<li><strong>与BeanFacotory的区别</strong>：它在加载配置文件的时候就会把在配置文件中配置的对象进行创建</li>
</ul>
</li>
<li>
<p>上述两种方式那种更好呢？</p>
</li>
<li>
<p>有人说：第一种方式好，因为只有在用的时候才去使用，节约内存空间</p>
</li>
<li>
<p>有人说：第二种方式好，因为不需要在使用的时候=去创建，因为那会耗费很多时间和资源</p>
</li>
<li>
<p>综上所述：第二种方式更好，我们将这些耗费时间和资源的事情全部交给服务器去做，在启动的时候就全部做完，我们直接使用即可</p>
</li>
</ul>
</li>
<li>
<p>ApplicationContext接口有实现类</p>
</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029210834.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029210834.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029210834.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029210834.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029210834.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211029210834.png" /></p>
<h2 id="5ioc的操作">5、IOC的操作</h2>
<h3 id="51bean管理">5.1、Bean管理</h3>
<p><strong>IOC的操作实质上就是对Bean进行操作，因为IOC容器就是管理着一个个Bean，而Bean有两个操作：1、创建对象，2、注入属性</strong></p>
<ol>
<li>
<p>什么是Bean管理</p>
<ul>
<li>Bean管理指的是两个操作
<ul>
<li>Spring创建对象</li>
<li>Spring注入属性</li>
</ul>
</li>
</ul>
</li>
<li>
<p>怎样实现Bean管理操作</p>
<ol>
<li>基于xml配置文件方式实现
<ul>
<li>基于该方法实现属性注入时有<strong>两种方法</strong>
<ul>
<li><code>set方法注入</code></li>
<li><code>有参构造函数注入</code></li>
</ul>
</li>
</ul>
</li>
<li>基于注解方式实现</li>
</ol>
</li>
</ol>
<h3 id="52bean管理操作实现">5.2、Bean管理操作实现</h3>
<p>1、基于xml 方式创建对象</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--配置User对象创建--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;user&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.User&#34;</span> <span class="nt">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>在spring配置文件中，使用bean标签，标签里面添加对应的属性，就可以实现对象创建</li>
<li>在bean标签里面有很多属性，介绍常用属性
<ul>
<li><code>id属性</code>：类似于对象的一个别名或者标识，并不是代表对象，是通过该别名去获取真实的对象，要有唯一性</li>
<li><code>class属性</code>：类的全路径，即该对象所对应的类路径</li>
</ul>
</li>
</ul>
<p>2、基于xml方式注入属性</p>
<ul>
<li>DI：依赖注入，就是属性注入</li>
<li><strong><code>面试时问</code>：IOC与DI的区别</strong>
<ul>
<li>DI是IOC中的一种具体实现，它表示属性注入，属性注入是在<code>对象创建好的基础之上</code>去执行的</li>
</ul>
</li>
</ul>
<p>３、第一种注入方式：<strong>使用set方法进行注入</strong></p>
<ul>
<li>创建类，定义属性和set方法</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.clover.spring5</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * 演示使用set方法进行注入属性
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Book</span> <span class="o">{</span>
    <span class="c1">// 创建属性
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">author</span><span class="o">;</span>

    <span class="c1">// 创建属性对应的set方法
</span><span class="c1"></span>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setName</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setAuthor</span><span class="o">(</span><span class="n">String</span> <span class="n">author</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">author</span> <span class="o">=</span> <span class="n">author</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">(){</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">name</span><span class="o">+</span><span class="s">&#34;::::::&#34;</span><span class="o">+</span><span class="n">author</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>在spring配置文件中配置对象创建，配置属性注入</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--set方法注入属性--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;book&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.Book&#34;</span><span class="nt">&gt;</span>
	<span class="c">&lt;!--
</span><span class="c">		使用 property 完成属性注入 
</span><span class="c">		name：类里面属性名称 
</span><span class="c">		value：向属性注入的值 
</span><span class="c">	--&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;name&#34;</span> <span class="na">value=</span><span class="s">&#34;易筋经&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;author&#34;</span> <span class="na">value=</span><span class="s">&#34;达摩老祖&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>4、第二种注入方式：<strong>使用有参构造函数进行注入</strong></p>
<ul>
<li>创建类，定义属性，创建属性对应有参数构造方法</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="c1">//有参构造函数
</span><span class="c1"></span><span class="kd">public</span> <span class="nf">Book</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="n">String</span> <span class="n">author</span><span class="o">)</span> <span class="o">{</span>
	<span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
	<span class="k">this</span><span class="o">.</span><span class="na">author</span> <span class="o">=</span> <span class="n">author</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>在 spring 配置文件中进行配置</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--使用有参构造函数进行注入--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;book&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.Book&#34;</span><span class="nt">&gt;</span>
	<span class="c">&lt;!--
</span><span class="c">		使用 constructor-arg 完成属性注入
</span><span class="c">		name：类里面属性名称
</span><span class="c">		value：向属性注入的值
</span><span class="c">	--&gt;</span>
	<span class="nt">&lt;constructor-arg</span> <span class="na">name=</span><span class="s">&#34;name&#34;</span> <span class="na">value=</span><span class="s">&#34;易筋经&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;constructor-arg</span> <span class="na">name=</span><span class="s">&#34;author&#34;</span> <span class="na">value=</span><span class="s">&#34;达摩老祖&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>5、p名称空间注入（了解）</p>
<ul>
<li><strong>p名称空间注入底层还是使用了Set方法注入</strong></li>
<li>使用p名称空间注入，可以简化基于xml配置方式</li>
<li>第一步 添加p名称空间在配置文件中</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">&#34;http://www.springframework.org/schema/beans&#34;</span>
       <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
       <span class="na">xmlns:p=</span><span class="s">&#34;http://www.springframework.org/schema/p&#34;</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&#34;</span><span class="nt">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>第二步 进行属性注入，在bean标签里面进行操作</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--p命名空间注入属性--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;book&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.Book&#34;</span> <span class="na">p:name=</span><span class="s">&#34;九阳神功&#34;</span> <span class="na">p:author=</span><span class="s">&#34;无名氏&#34;</span><span class="nt">/&gt;</span>	
</code></pre></td></tr></table>
</div>
</div><h3 id="53ioc-操作-bean-管理xml-注入其他类型属性">5.3、IOC 操作 Bean 管理(xml 注入其他类型属性)</h3>
<h4 id="531字面量">5.3.1、字面量</h4>
<p>1、空值(NULL值)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--给属性设null值--&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;address&#34;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;null/&gt;</span>
<span class="nt">&lt;/property&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>2、属性值包含特殊符号</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--属性值包含特殊符号
</span><span class="c">	  1、把&lt;&gt;进行转义  &amp;lt;&amp;gt; 代表大于号、小于号
</span><span class="c">	  2、把带特殊符号内容写道CDATA中
</span><span class="c">--&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;address&#34;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;value&gt;</span><span class="cp">&lt;![CDATA[&lt;&lt;赤壁&gt;&gt;]]&gt;</span><span class="nt">&lt;/value&gt;</span>
<span class="nt">&lt;/property&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="532注入属性-外部bean">5.3.2、注入属性-外部Bean</h4>
<p>1、创建两个类service类和dao类</p>
<p>2、在 service 调用 dao 里面的方法</p>
<p>3、在 spring配置文件中进行配置</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--1 service和dao对象创建--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;userService&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.service.UserService&#34;</span><span class="nt">&gt;</span>
	<span class="c">&lt;!--注入UserDao对象，外部Bean
</span><span class="c">		name属性：类里面属性名称
</span><span class="c">		ref属性：创建UserDao对象bean标签ID值
</span><span class="c">	--&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;userDao&#34;</span> <span class="na">ref=</span><span class="s">&#34;userDao&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="c">&lt;!--因为接口不能创建对象，所以class路径指向接口实现类--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;userDao&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.dao.UserDaoImpl&#34;</span><span class="nt">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.clover.spring5.service</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.clover.spring5.dao.UserDao</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserService</span> <span class="o">{</span>
    <span class="c1">// 创建UserDao类型属性，生成set方法进行属性注入
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">UserDao</span> <span class="n">userDao</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUserDao</span><span class="o">(</span><span class="n">UserDao</span> <span class="n">userDao</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">userDao</span> <span class="o">=</span> <span class="n">userDao</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;UserService add .............&#34;</span><span class="o">);</span>
        <span class="n">userDao</span><span class="o">.</span><span class="na">update</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="533注入属性-内部bean">5.3.3、注入属性-内部Bean</h4>
<p>1、一对多关系：部门和员工
一个部门有多个员工，一个员工属于一个部门
部门是一，员工是多</p>
<p>2、在实体类之间表示一对多关系，员工表示所属部门，使用对象类型进行表示</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.clover.spring5.bean</span><span class="o">;</span>

<span class="c1">//部门类
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Dept</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">dname</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setDname</span><span class="o">(</span><span class="n">String</span> <span class="n">dname</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">dname</span> <span class="o">=</span> <span class="n">dname</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">&#34;Dept{&#34;</span> <span class="o">+</span>
                <span class="s">&#34;dname=&#39;&#34;</span> <span class="o">+</span> <span class="n">dname</span> <span class="o">+</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="o">+</span>
                <span class="sc">&#39;}&#39;</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.clover.spring5.bean</span><span class="o">;</span>

<span class="c1">// 员工类
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Emp</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">ename</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">gender</span><span class="o">;</span>

    <span class="c1">//员工属于某一个部门，使用对象形式表示
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">Dept</span> <span class="n">dept</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setDept</span><span class="o">(</span><span class="n">Dept</span> <span class="n">dept</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">dept</span> <span class="o">=</span> <span class="n">dept</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setEname</span><span class="o">(</span><span class="n">String</span> <span class="n">ename</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">ename</span> <span class="o">=</span> <span class="n">ename</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setGender</span><span class="o">(</span><span class="n">String</span> <span class="n">gender</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">gender</span> <span class="o">=</span> <span class="n">gender</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">ename</span><span class="o">+</span><span class="s">&#34;:::&#34;</span><span class="o">+</span><span class="n">gender</span><span class="o">+</span><span class="s">&#34;:::&#34;</span><span class="o">+</span><span class="n">dept</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>3、在spring配置文件中进行配置</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--内部bean--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;emp&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.bean.Emp&#34;</span><span class="nt">&gt;</span>
	<span class="c">&lt;!--设置两个普通属性--&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;ename&#34;</span> <span class="na">value=</span><span class="s">&#34;clover&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;gender&#34;</span> <span class="na">value=</span><span class="s">&#34;男&#34;</span><span class="nt">/&gt;</span>
	<span class="c">&lt;!--设置对象类型属性--&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;dept&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;dept&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.bean.Dept&#34;</span><span class="nt">&gt;</span>
			<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;dname&#34;</span> <span class="na">value=</span><span class="s">&#34;技术部&#34;</span><span class="nt">/&gt;</span>
		<span class="nt">&lt;/bean&gt;</span>
	<span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="534注入属性-级联赋值">5.3.4、注入属性-级联赋值</h4>
<h5 id="5341第一种写法">5.3.4.1、第一种写法</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--级联赋值--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;emp&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.bean.Emp&#34;</span><span class="nt">&gt;</span>
	<span class="c">&lt;!--设置两个普通属性--&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;ename&#34;</span> <span class="na">value=</span><span class="s">&#34;clover&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;gender&#34;</span> <span class="na">value=</span><span class="s">&#34;男&#34;</span><span class="nt">/&gt;</span>
	<span class="c">&lt;!--级联赋值--&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;dept&#34;</span> <span class="na">ref=</span><span class="s">&#34;dept&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;dept&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.bean.Dept&#34;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;dname&#34;</span> <span class="na">value=</span><span class="s">&#34;安保部&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h5 id="5342第二种写法">5.3.4.2、第二种写法</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"> <span class="c">&lt;!--级联赋值--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;emp&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.bean.Emp&#34;</span><span class="nt">&gt;</span>
	<span class="c">&lt;!--设置两个普通属性--&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;ename&#34;</span> <span class="na">value=</span><span class="s">&#34;clover&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;gender&#34;</span> <span class="na">value=</span><span class="s">&#34;男&#34;</span><span class="nt">/&gt;</span>
	<span class="c">&lt;!--级联赋值--&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;dept&#34;</span> <span class="na">ref=</span><span class="s">&#34;dept&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;dept.dname&#34;</span> <span class="na">value=</span><span class="s">&#34;财务部&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;dept&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.bean.Dept&#34;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;dname&#34;</span> <span class="na">value=</span><span class="s">&#34;安保部&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211030172853.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211030172853.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211030172853.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211030172853.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211030172853.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211030172853.png" /></p>
<pre><code>注意：使用级联赋值时，如果你property中的name=对象.属性名，那么你需要在该property对应Bean的实体类中加入get
方法，因为你不先拿到该对象时无法对该对象进行操作的
同时，你在使用第二种方式的同时，第一种方法的写法也得保存下来，要不然会报错，说你对应的属性值为null
</code></pre>
<p><strong>自己小总结：</strong></p>
<ol>
<li>IOC的底层就是基于xml、工厂模式和反射</li>
<li>先配置好xml，然后工厂模式对xml进行解析，最后通过反射创建对象</li>
<li>IOC基于容器实现，容器的底层又是工厂模式</li>
<li>工厂模式有两种实现方式：
<ol>
<li>Application</li>
<li>BeanFactory</li>
</ol>
</li>
<li>使用set方法进行注入时，是因为工厂模式在解析xml的时候，xml中的property设置的值就会去调用set方法设置对应属性的值，否则会报null错误 <strong>(这点为自我总结，还未查阅资料，不知正确与否)</strong></li>
<li>使用构造器进行注入时，与使用set方法注入是一样的作用</li>
</ol>
<h3 id="54ioc-操作-bean-管理xml-注入集合属性">5.4、IOC 操作 Bean 管理(xml 注入集合属性)</h3>
<p>1、注入数组类型属性</p>
<p>2、注入 List 集合类型属性</p>
<p>3、注入Map集合类型属性</p>
<ul>
<li>创建类，定义数组、list、map、set类型属性，生成对应 set方法</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.clover.spring5.collectiontype</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Set</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Stu</span> <span class="o">{</span>
    <span class="c1">//1 数组类型属性
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">String</span><span class="o">[]</span> <span class="n">courses</span><span class="o">;</span>

    <span class="c1">//2 list集合类型属性
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">lists</span><span class="o">;</span>

    <span class="c1">//3 map集合类型属性
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">maps</span><span class="o">;</span>

    <span class="c1">//4 set集合类型属性
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">sets</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setCourses</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">courses</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">courses</span> <span class="o">=</span> <span class="n">courses</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setLists</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">lists</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">lists</span> <span class="o">=</span> <span class="n">lists</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setMaps</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">maps</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">maps</span> <span class="o">=</span> <span class="n">maps</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setSets</span><span class="o">(</span><span class="n">Set</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">sets</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">sets</span> <span class="o">=</span> <span class="n">sets</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">courses</span><span class="o">));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">lists</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">maps</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">sets</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>在 spring配置文件进行配置</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--集合类型属性注入--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;stu&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.collectiontype.Stu&#34;</span><span class="nt">&gt;</span>
	<span class="c">&lt;!--数组类型属性注入--&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;courses&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;array&gt;</span>
			<span class="nt">&lt;value&gt;</span>Java 课程<span class="nt">&lt;/value&gt;</span>
			<span class="nt">&lt;value&gt;</span>数据库课程<span class="nt">&lt;/value&gt;</span>
		<span class="nt">&lt;/array&gt;</span>
	<span class="nt">&lt;/property&gt;</span>

	<span class="c">&lt;!--list类型属性注入--&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;lists&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;list&gt;</span>
			<span class="nt">&lt;value&gt;</span>李四<span class="nt">&lt;/value&gt;</span>
			<span class="nt">&lt;value&gt;</span>小李子<span class="nt">&lt;/value&gt;</span>
		<span class="nt">&lt;/list&gt;</span>
	<span class="nt">&lt;/property&gt;</span>

	<span class="c">&lt;!--map类型属性注入--&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;maps&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;map&gt;</span>
			<span class="nt">&lt;entry</span> <span class="na">key=</span><span class="s">&#34;JAVA&#34;</span> <span class="na">value=</span><span class="s">&#34;java&#34;</span><span class="nt">/&gt;</span>
			<span class="nt">&lt;entry</span> <span class="na">key=</span><span class="s">&#34;PHP&#34;</span> <span class="na">value=</span><span class="s">&#34;php&#34;</span><span class="nt">/&gt;</span>
		<span class="nt">&lt;/map&gt;</span>
	<span class="nt">&lt;/property&gt;</span>

	<span class="c">&lt;!--set类型属性注入--&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;sets&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;set&gt;</span>
			<span class="nt">&lt;value&gt;</span>Mysql<span class="nt">&lt;/value&gt;</span>
			<span class="nt">&lt;value&gt;</span>Redis<span class="nt">&lt;/value&gt;</span>
		<span class="nt">&lt;/set&gt;</span>
	<span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="541xml注入集合属性两个小细节">5.4.1、xml注入集合属性两个小细节</h4>
<p>1、在集合里面设置对象类型值</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--注入list集合类型，值是对象--&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;courseList&#34;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;list&gt;</span>
		<span class="nt">&lt;ref</span> <span class="na">bean=</span><span class="s">&#34;course1&#34;</span><span class="nt">/&gt;</span>
		<span class="nt">&lt;ref</span> <span class="na">bean=</span><span class="s">&#34;course2&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/list&gt;</span>
<span class="nt">&lt;/property&gt;</span>
<span class="c">&lt;!--创建多个course对象--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;course1&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.collectiontype.Courses&#34;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;cname&#34;</span> <span class="na">value=</span><span class="s">&#34;spring&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;course2&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.collectiontype.Courses&#34;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;cname&#34;</span> <span class="na">value=</span><span class="s">&#34;mybatis&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>2、把集合注入部分提取出来</p>
<ul>
<li>在 spring 配置文件中引入名称空间 util</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">&#34;http://www.springframework.org/schema/beans&#34;</span>
       <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
       <span class="na">xmlns:p=</span><span class="s">&#34;http://www.springframework.org/schema/p&#34;</span>
       <span class="na">xmlns:util=</span><span class="s">&#34;http://www.springframework.org/schema/util&#34;</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
</span><span class="s">                           http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd&#34;</span><span class="nt">&gt;</span>


<span class="nt">&lt;/beans&gt;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>使用 util 标签完成 list 集合注入提取</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--1 提取list集合类型属性注入--&gt;</span>
<span class="nt">&lt;util:list</span> <span class="na">id=</span><span class="s">&#34;bookList&#34;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;value&gt;</span>易筋经<span class="nt">&lt;/value&gt;</span>
	<span class="nt">&lt;value&gt;</span>九阴真经<span class="nt">&lt;/value&gt;</span>
	<span class="nt">&lt;value&gt;</span>九阳神功<span class="nt">&lt;/value&gt;</span>
<span class="nt">&lt;/util:list&gt;</span>

<span class="c">&lt;!--2 提取list集合类型属性注入使用--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;book&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.collectiontype.Book&#34;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;list&#34;</span> <span class="na">ref=</span><span class="s">&#34;bookList&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="55ioc-操作-bean-管理factorybean">5.5、IOC 操作 Bean 管理(FactoryBean)</h3>
<p>1、<strong>Spring有两种类型bean，一种普通bean，另外一种叫工厂bean(FactoryBean)</strong></p>
<p>2、<code>普通 bean</code>：在配置文件中定义的 bean类型就是返回类型</p>
<p>3、<code>工厂bean</code>：在配置文件定义的 bean类型可以和返回类型不一样</p>
<ul>
<li>第一步 创建类，让这个类作为工厂 bean，实现接口 FactoryBean</li>
<li>第二步 实现接口里面的方法，在实现的方法中定义返回的bean类型</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.clover.spring5.factorybean</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.clover.spring5.collectiontype.Courses</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.FactoryBean</span><span class="o">;</span>

<span class="c1">// 工厂Bean，可以让返回对象类型和class中定义的不一样
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyBean</span> <span class="kd">implements</span> <span class="n">FactoryBean</span><span class="o">&lt;</span><span class="n">Courses</span><span class="o">&gt;</span> <span class="o">{</span>
    
    <span class="c1">//定义返回bean的类型
</span><span class="c1"></span>    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Courses</span> <span class="nf">getObject</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">Courses</span> <span class="n">courses</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Courses</span><span class="o">();</span>
        <span class="n">courses</span><span class="o">.</span><span class="na">setCname</span><span class="o">(</span><span class="s">&#34;clover&#34;</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">courses</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">getObjectType</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isSingleton</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;myBean&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.factorybean.MyBean&#34;</span><span class="nt">&gt;&lt;/bean&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test3</span><span class="o">()</span>
<span class="o">{</span>
	<span class="c1">// 1.加载配置文件
</span><span class="c1"></span>	<span class="n">ApplicationContext</span> <span class="n">context</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ClassPathXmlApplicationContext</span><span class="o">(</span><span class="s">&#34;bean3.xml&#34;</span><span class="o">);</span>

	<span class="c1">// 2.获取配置文件创建的对象
</span><span class="c1"></span>	<span class="n">Courses</span> <span class="n">courses</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">&#34;myBean&#34;</span><span class="o">,</span> <span class="n">Courses</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

	<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">courses</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="56ioc-操作-bean-管理bean-作用域">5.6、IOC 操作 Bean 管理(bean 作用域)</h3>
<ol>
<li>在 Spring里面，设置创建 bean实例是单实例还是多实例</li>
<li>在 Spring里面，默认情况下，<strong>bean 是单实例对象</strong></li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031101923.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031101923.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031101923.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031101923.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031101923.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031101923.png" /></p>
<ol start="3">
<li>如何设置单实例还是多实例
<ol>
<li>
<p>在 spring配置文件 bean标签里面有属性（scope）用于设置单实例还是多实例</p>
</li>
<li>
<p>scope 属性值</p>
<ul>
<li>第一个值  默认值，singleton，表示是单实例对象</li>
<li>第二个值  prototype，表示是多实例对象</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031101947.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031101947.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031101947.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031101947.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031101947.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031101947.png" /></p>
<ul>
<li>**singleton 和 prototype 区别 **
<ol>
<li>第一  singleton 单实例，prototype 多实例</li>
<li>第二 设置 scope 值是 singleton时候，加载 spring 配置文件时候就会创建单实例对象</li>
<li>设置 scope 值是 prototype 时候，不是在加载 spring 配置文件时候创建 对象，在调用 getBean方法时候创建多实例对象</li>
</ol>
</li>
</ul>
</li>
</ol>
</li>
</ol>
<h3 id="57ioc-操作-bean-管理bean-生命周期">5.7、IOC 操作 Bean 管理(bean 生命周期)</h3>
<ol>
<li>生命周期
<ol>
<li>从对象创建到对象销毁的过程</li>
</ol>
</li>
<li><strong>bean 生命周期</strong>
<ol>
<li>通过构造器创建bean实例  (调用无参构造函数)</li>
<li>未bean的属性设置值和对其它bean引用  (调用set方法)</li>
<li>调用bean的初始化方法  (需要进行配置初始化的方法)</li>
<li>bean可以使用了  (对象获取到了)</li>
<li>当容器关闭的时候，调用bean的销毁方法  (需要进行配置销毁的方法)</li>
</ol>
</li>
<li>演示 bean 生命周期</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.clover.spring5.bean</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Orders</span> <span class="o">{</span>
    <span class="c1">//无参数构造
</span><span class="c1"></span>    <span class="kd">public</span> <span class="nf">Orders</span><span class="o">(){</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;第一步 执行无参数构造创建 bean 实例&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">oname</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setOname</span><span class="o">(</span><span class="n">String</span> <span class="n">oname</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">oname</span> <span class="o">=</span> <span class="n">oname</span><span class="o">;</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;第二步 调用 set 方法设置属性值&#34;</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="c1">//创建执行的初始化的方法
</span><span class="c1"></span>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initMethod</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;第三步 执行初始化的方法&#34;</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="c1">//创建执行的销毁的方法
</span><span class="c1"></span>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">destroyMethod</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;第五步 执行销毁的方法&#34;</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;orders&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.bean.Orders&#34;</span> <span class="na">init-method=</span><span class="s">&#34;initMethod&#34;</span> <span class="na">destroy-method=</span><span class="s">&#34;destroyMethod&#34;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;oname&#34;</span> <span class="na">value=</span><span class="s">&#34;adas&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test4</span><span class="o">()</span>
<span class="o">{</span>
	<span class="c1">// 1.加载配置文件
</span><span class="c1"></span>	<span class="n">ClassPathXmlApplicationContext</span> <span class="n">context</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ClassPathXmlApplicationContext</span><span class="o">(</span><span class="s">&#34;bean4.xml&#34;</span><span class="o">);</span>

	<span class="c1">// 2.获取配置文件创建的对象
</span><span class="c1"></span>	<span class="n">Orders</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">&#34;orders&#34;</span><span class="o">,</span> <span class="n">Orders</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

	<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;第四步 获取创建 bean 实例对象&#34;</span><span class="o">);</span>
	<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">orders</span><span class="o">);</span>

	<span class="c1">//手动让bean实例销毁
</span><span class="c1"></span>	<span class="n">context</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031104706.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031104706.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031104706.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031104706.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031104706.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031104706.png" /></p>
<ol start="4">
<li>**bean的后置处理器，bean生命周期有七步 **
<ol>
<li>通过构造器创建bean实例  (调用无参构造函数)</li>
<li>未bean的属性设置值和对其它bean引用  (调用set方法)</li>
<li>把 bean 实例传递 bean 后置处理器的方法 postProcessBeforeInitialization</li>
<li>调用bean的初始化方法  (需要进行配置初始化的方法)</li>
<li>把 bean 实例传递 bean 后置处理器的方法 postProcessAfterInitialization</li>
<li>bean可以使用了  (对象获取到了)</li>
<li>当容器关闭的时候，调用bean的销毁方法  (需要进行配置销毁的方法)</li>
</ol>
</li>
<li>演示添加后置处理器效果
<ol>
<li>创建类，实现接口 BeanPostProcessor，创建后置处理器</li>
</ol>
</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.clover.spring5.bean</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.beans.BeansException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.config.BeanPostProcessor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.lang.Nullable</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyBeanPost</span> <span class="kd">implements</span> <span class="n">BeanPostProcessor</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">postProcessBeforeInitialization</span><span class="o">(</span><span class="n">Object</span> <span class="n">bean</span><span class="o">,</span> <span class="n">String</span> <span class="n">beanName</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">BeansException</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;在初始化之前执行的方法&#34;</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">bean</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">postProcessAfterInitialization</span><span class="o">(</span><span class="n">Object</span> <span class="n">bean</span><span class="o">,</span> <span class="n">String</span> <span class="n">beanName</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">BeansException</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;在初始化之后执行的方法&#34;</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">bean</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--配置后置处理器--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;myPostBean&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.bean.MyBeanPost&#34;</span><span class="nt">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031105108.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031105108.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031105108.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031105108.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031105108.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031105108.png" /></p>
<p><strong>问题、疑惑：</strong></p>
<pre><code>自己的一个问题，但还没有查找资料解决
创建bean实例通过调用无参构造函数来指向，但是当你使用了有参构造函数进行属性注入时，无参构造函数没有了，bean
实例如何创建的
</code></pre>
<h3 id="58ioc-操作-bean-管理xml-自动装配">5.8、IOC 操作 Bean 管理(xml 自动装配)</h3>
<ol>
<li>什么是自动装配
<ul>
<li>根据指定装配规则（属性名称或者属性类型），Spring自动将匹配的属性值进行注入</li>
</ul>
</li>
<li>演示自动装配过程
<ul>
<li>根据属性名称自动注入
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--实现自动装配
</span><span class="c">        bean标签属性autowire，配置自动装配
</span><span class="c">        autowire属性常用两个值：
</span><span class="c">            byName根据属性名称注入 ，注入值bean的id值和类属性名称一样
</span><span class="c">            byType根据属性类型注入 ，但是只能每次同一个对象只能有一个，多个就不知道该调用哪一个了
</span><span class="c">    --&gt;</span>
    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;emp&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.autowire.Emp&#34;</span> <span class="na">autowire=</span><span class="s">&#34;byName&#34;</span><span class="nt">&gt;</span>
<span class="c">&lt;!--        &lt;property name=&#34;dept&#34; ref=&#34;dept&#34;/&gt;--&gt;</span>
    <span class="nt">&lt;/bean&gt;</span>

    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;dept&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.autowire.Dept&#34;</span><span class="nt">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div></li>
<li>根据属性类型自动注入
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--实现自动装配
</span><span class="c">        bean标签属性autowire，配置自动装配
</span><span class="c">        autowire属性常用两个值：
</span><span class="c">            byName根据属性名称注入 ，注入值bean的id值和类属性名称一样
</span><span class="c">            byType根据属性类型注入 ，但是只能每次同一个对象只能有一个，多个就不知道该调用哪一个了
</span><span class="c">    --&gt;</span>
    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;emp&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.autowire.Emp&#34;</span> <span class="na">autowire=</span><span class="s">&#34;byType&#34;</span><span class="nt">&gt;</span>
<span class="c">&lt;!--        &lt;property name=&#34;dept&#34; ref=&#34;dept&#34;/&gt;--&gt;</span>
    <span class="nt">&lt;/bean&gt;</span>

    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;dept&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.autowire.Dept&#34;</span><span class="nt">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">       
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ol>
<h3 id="59ioc-操作-bean-管理外部属性文件">5.9、IOC 操作 Bean 管理(外部属性文件)</h3>
<ol>
<li>直接配置数据库信息
<ol>
<li>配置Druid连接池</li>
<li>引入Druid连接池依赖 jar包</li>
</ol>
</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--直接配置连接池--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;dataSource&#34;</span> <span class="na">class=</span><span class="s">&#34;com.alibaba.druid.pool.DruidDataSource&#34;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driverClassName&#34;</span> <span class="na">value=</span><span class="s">&#34;com.mysql.jdbc.Driver&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;jdbc:mysql://localhost:3306/userDb&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;root&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;root&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>引入外部属性文件配置数据库连接池
<ul>
<li>
<p>创建外部属性文件，properties格式文件，写数据库信息</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml">prop.driverClass= com.mysql.jdbc.Driver
prop.url= jdbc:mysql://localhost:3306/userDb
prop.userName=root
prop.password=root|
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>把外部 properties 属性文件引入到 spring 配置文件中：<strong>引入 context 名称空间</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">&#34;http://www.springframework.org/schema/beans&#34;</span>
       <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
       <span class="na">xmlns:p=</span><span class="s">&#34;http://www.springframework.org/schema/p&#34;</span>
       <span class="na">xmlns:util=</span><span class="s">&#34;http://www.springframework.org/schema/util&#34;</span>
       <span class="na">xmlns:context=</span><span class="s">&#34;http://www.springframework.org/schema/context&#34;</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
</span><span class="s">                           http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd
</span><span class="s">                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&#34;</span><span class="nt">&gt;</span>

<span class="nt">&lt;/beans&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>在spring 配置文件使用标签引入外部属性文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--引入外部属性文件--&gt;</span>
<span class="nt">&lt;context:property-placeholder</span> <span class="na">location=</span><span class="s">&#34;classpath:jdbc.properties&#34;</span><span class="nt">/&gt;</span>
<span class="c">&lt;!--配置连接池--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;dataSource&#34;</span> <span class="na">class=</span><span class="s">&#34;com.alibaba.druid.pool.DruidDataSource&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driverClassName&#34;</span> <span class="na">value=</span><span class="s">&#34;${prop.driverClass}&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;${prop.url}&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;${prop.userName}&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;${prop.password}&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">       
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ol>
<h3 id="510ioc-操作-bean-管理基于注解方式">5.10、IOC 操作 Bean 管理(基于注解方式)</h3>
<ol>
<li>什么是注解
<ul>
<li>注解是代码特殊标记，格式：@注解名称(属性名称=属性值, 属性名称=属性值..)</li>
<li>使用注解，注解作用在类上面，方法上面，属性上面</li>
<li>使用注解目的：简化 xml配置</li>
</ul>
</li>
<li>Spring 针对 Bean 管理中创建对象提供注解
<ul>
<li>@Component</li>
<li>@Service</li>
<li>@Controller</li>
<li>@Repository</li>
<li><strong>上面四个注解功能是一样的，都可以用来创建bean实例</strong></li>
</ul>
</li>
<li>基于注解方式实现对象创建
<ul>
<li>
<p>第一步 引入AOP依赖</p>
</li>
<li>
<p>第二步 开启组件扫描</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--开启组件扫描
</span><span class="c">        1 如果扫描多个包，多个包使用逗号隔开
</span><span class="c">        2 扫描包上层目录
</span><span class="c">--&gt;</span>
<span class="nt">&lt;context:component-scan</span> <span class="na">base-package=</span><span class="s">&#34;com.clover&#34;</span><span class="nt">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>第三步 创建类，在类上面添加创建对象注解</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.clover.spring5.bean</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="o">;</span>

<span class="c1">//在注解里面value属性值可以省略不写，
</span><span class="c1">//默认值是类名称，首字母小写
</span><span class="c1"></span><span class="nd">@Service</span>  <span class="c1">// 该注解就等价于&lt;bean id=&#34;userService&#34; class=&#34;...&#34;/&gt;
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserService</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;service add.......&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>开启组件扫描细节配置</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--示例1
</span><span class="c">	use-default-filters=&#34;false&#34; 表示现在不使用默认filter，自己配置filter 
</span><span class="c">	context:include-filter ，设置扫描哪些内容
</span><span class="c">--&gt;</span>
<span class="nt">&lt;context:component-scan</span> <span class="na">base-package=</span><span class="s">&#34;com.clover&#34;</span> <span class="na">use-default-filters=</span><span class="s">&#34;false&#34;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;context:include-filter</span> <span class="na">type=</span><span class="s">&#34;annotation&#34;</span> <span class="na">expression=</span><span class="s">&#34;org.springframework.stereotype.Controller&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/context:component-scan&gt;</span>

<span class="c">&lt;!--示例2
</span><span class="c">	下面配置扫描包所有内容
</span><span class="c">	context:exclude-filter： 设置哪些内容不进行扫描
</span><span class="c">--&gt;</span>
<span class="nt">&lt;context:component-scan</span> <span class="na">base-package=</span><span class="s">&#34;com.clover&#34;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;context:exclude-filter</span> <span class="na">type=</span><span class="s">&#34;annotation&#34;</span> <span class="na">expression=</span><span class="s">&#34;org.springframework.stereotype.Controller&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/context:component-scan&gt;</span>
</code></pre></td></tr></table>
</div>
</div><ol start="5">
<li>基于注解方式实现属性注入
<ol>
<li>
<p><code>@Autowired</code>：根据属性类型进行自动装配</p>
<ul>
<li>第一步 把 service 和 dao 对象创建，在 service 和 dao 类添加创建对象注解</li>
<li>第二步 在 service 注入 dao 对象，在 service 类添加 dao类型属性，在属性上面使用注解
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="c1">//在注解里面value属性值可以省略不写，
</span><span class="c1">//默认值是类名称，首字母小写
</span><span class="c1"></span><span class="nd">@Service</span>  <span class="c1">// 该注解就等价于&lt;bean id=&#34;userService&#34; class=&#34;...&#34;/&gt;
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserService</span> <span class="o">{</span>
    <span class="c1">//定义dao类型属性
</span><span class="c1"></span>    <span class="c1">//不需要添加set方法
</span><span class="c1"></span>    <span class="c1">//添加注入属性注解
</span><span class="c1"></span>    <span class="nd">@Autowired</span>      <span class="c1">//根据类型进行注入
</span><span class="c1"></span>    <span class="nd">@Qualifier</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&#34;userDaoImpl1&#34;</span><span class="o">)</span> <span class="c1">//根据名称进行注入
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">UserDao</span> <span class="n">userDao</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;service add.......&#34;</span><span class="o">);</span>
        <span class="n">userDao</span><span class="o">.</span><span class="na">add</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>
<p><code>@Qualifier</code>：根据名称进行注入;<strong>这个@Qualifier 注解的使用，和上面@Autowired 一起使用</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="c1">//定义dao类型属性
</span><span class="c1">//不需要添加set方法
</span><span class="c1">//添加注入属性注解
</span><span class="c1"></span><span class="nd">@Autowired</span>      <span class="c1">//根据类型进行注入
</span><span class="c1"></span><span class="nd">@Qualifier</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&#34;userDaoImpl1&#34;</span><span class="o">)</span> <span class="c1">//根据名称进行注入
</span><span class="c1"></span><span class="kd">private</span> <span class="n">UserDao</span> <span class="n">userDao</span><span class="o">;</span>
</code></pre></td></tr></table>
</div>
</div><p>~~</p>
</li>
<li>
<p><code>@Resource</code>：可以根据类型注入，也可以根据名称注入</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java">    <span class="nd">@Resource</span>  <span class="c1">//根据类型进行注入
</span><span class="c1">//    @Resource(name = &#34;userDaoImpl1&#34;)  //根据名称进行注入
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">UserDao</span> <span class="n">userDao</span><span class="o">;</span>
</code></pre></td></tr></table>
</div>
</div><p>~~</p>
</li>
<li>
<p><code>@Value</code>：注入普通类型属性</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@Value</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&#34;abc&#34;</span><span class="o">)</span> 
<span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
</code></pre></td></tr></table>
</div>
</div><p>~~</p>
<pre><code> 注意：前面三个注解是针对对象类型注入，而不是普通属性注入
             使用了注解不用写set方法，因为注解里面帮我们封装好了
</code></pre>
</li>
</ol>
</li>
</ol>
<h3 id="511完全注解开发">5.11、完全注解开发</h3>
<p>1、创建配置类，替代xml配置文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.clover.spring5.config</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.ComponentScan</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Configuration</span><span class="o">;</span>

<span class="nd">@Configuration</span>
<span class="nd">@ComponentScan</span><span class="o">(</span><span class="n">basePackages</span> <span class="o">=</span> <span class="o">{</span><span class="s">&#34;com.clover&#34;</span><span class="o">})</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SpringConfig</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>2、编写测试类</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test2</span><span class="o">()</span>
<span class="o">{</span>
	<span class="c1">//加载配置类
</span><span class="c1"></span>	<span class="n">ApplicationContext</span> <span class="n">context</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AnnotationConfigApplicationContext</span><span class="o">(</span><span class="n">SpringConfig</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

	<span class="n">UserService</span> <span class="n">userService</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">&#34;userService&#34;</span><span class="o">,</span> <span class="n">UserService</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

	<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">userService</span><span class="o">);</span>
	<span class="n">userService</span><span class="o">.</span><span class="na">add</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="6aop概念">6、AOP（概念）</h2>
<h3 id="61什么是aop">6.1、什么是AOP</h3>
<ol>
<li>面向切面（方面）编程，<strong>利用 AOP 可以对业务逻辑的各个部分进行隔离，从而使得业务逻辑各部分之间的耦合度降低</strong>，提高程序的可重用性，同时提高了开发的效率</li>
<li>通俗描述：不通过修改源代码方式，在主干功能里面添加新功能</li>
<li>使用登录例子说明AOP</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031160654.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031160654.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031160654.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031160654.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031160654.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031160654.png" /></p>
<h3 id="62aop底层原理">6.2、AOP(底层原理)</h3>
<p>动态代理</p>
<ol>
<li>
<p>传入的目标对象</p>
</li>
<li>
<p>利用反射机制返回一个代理对象</p>
</li>
<li>
<p>通过代理对象调用目标对象方法触发<code>事情处理器方法</code></p>
</li>
<li>
<p>AOP底层使用动态代理</p>
<ol>
<li>
<p>有两种情况动态代理</p>
<ol>
<li>第一种 有接口情况，使用JDK动态代理
<ul>
<li>创建接口实现类代理对象，增强类的方法</li>
</ul>
</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031162049.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031162049.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031162049.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031162049.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031162049.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031162049.png" /></p>
<ol start="2">
<li>第二种 没有接口情况，使用CGLIB动态代理</li>
</ol>
<ul>
<li>创建子类的代理对象，增强类的方法</li>
</ul>
</li>
</ol>
</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031162347.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031162347.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031162347.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031162347.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031162347.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211031162347.png" /></p>
<h3 id="63aopjdk-动态代理">6.3、AOP(JDK 动态代理)</h3>
<ul>
<li><strong>想对哪个类方法进行加强，就传入哪个类对象，创建目标对象可以用接口变量形式接收</strong>
<ul>
<li><strong>利用反射机制返回一个代理对象</strong>
<ul>
<li><code>需要准备3个参数</code></li>
</ul>
<ol>
<li><code>当前目标对象使用的类加载器</code></li>
<li><code>目标对象实现的接口类型</code></li>
<li><code>创建代理对象</code></li>
</ol>
</li>
<li><strong>通过代理对象调用方法后，就会实现功能增强；调用目标对象方法后，会触发事情处理器方法，会把当前执行的目标对象方法作为参数传入</strong></li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.clover.spring5</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.lang.reflect.InvocationHandler</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.reflect.Method</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.reflect.Proxy</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JDKProxy</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//创建目标对象实现的接口类型
</span><span class="c1"></span>        <span class="n">Class</span><span class="o">[]</span> <span class="n">interfaces</span> <span class="o">=</span> <span class="o">{</span><span class="n">UserDao</span><span class="o">.</span><span class="na">class</span><span class="o">};</span>
        <span class="c1">//创建目标对象
</span><span class="c1"></span>        <span class="n">UserDao</span> <span class="n">target</span> <span class="o">=</span> <span class="k">new</span> <span class="n">UserDaoImpl</span><span class="o">();</span>
        <span class="c1">//给目标对象创建代理对象
</span><span class="c1"></span>        <span class="c1">//返回指定接口的代理类的实例，该接口将方法调用分派给指定的调用处理程序
</span><span class="c1"></span>        <span class="cm">/**
</span><span class="cm">         * ClassLoader loader: 指定当前目标对象使用的类加载器，获取加载器的方法固定
</span><span class="cm">         * Class&lt;?&gt;[] interfaces: 目标对象实现的接口类型，使用泛型方式确认
</span><span class="cm">         * InvocationHandler h: 事情处理，执行目标对象的方法，会触发事情处理器方法，会把当前执行的目标对象方法作为参数传入
</span><span class="cm">         */</span>
        <span class="n">UserDao</span> <span class="n">dao</span> <span class="o">=</span> <span class="o">(</span><span class="n">UserDao</span><span class="o">)</span> <span class="n">Proxy</span><span class="o">.</span><span class="na">newProxyInstance</span><span class="o">(</span><span class="n">JDKProxy</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getClassLoader</span><span class="o">(),</span> <span class="n">interfaces</span><span class="o">,</span> <span class="k">new</span> <span class="n">UserDaoProxy</span><span class="o">(</span><span class="n">target</span><span class="o">));</span>
        <span class="c1">//System.out.println((Proxy.newProxyInstance(JDKProxy.class.getClassLoader(), interfaces, new UserDaoProxy(userDao))) instanceof UserDao);
</span><span class="c1"></span>        <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">dao</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">1</span><span class="o">,</span> <span class="n">2</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;result:&#34;</span><span class="o">+</span><span class="n">result</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// 创建代理对象
</span><span class="c1"></span><span class="kd">class</span> <span class="nc">UserDaoProxy</span> <span class="kd">implements</span> <span class="n">InvocationHandler</span><span class="o">{</span>
    <span class="c1">//1 把创建的是谁的代理对象，就把谁传递过来
</span><span class="c1"></span>    <span class="c1">//有参数构造传递
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">Object</span> <span class="n">obj</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">UserDaoProxy</span><span class="o">(</span><span class="n">Object</span> <span class="n">obj</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">//增强功能的逻辑
</span><span class="c1"></span>    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">invoke</span><span class="o">(</span><span class="n">Object</span> <span class="n">proxy</span><span class="o">,</span> <span class="n">Method</span> <span class="n">method</span><span class="o">,</span> <span class="n">Object</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Throwable</span> <span class="o">{</span>
        <span class="c1">//方法之前
</span><span class="c1"></span>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;方法之前执行....&#34;</span><span class="o">+</span><span class="n">method</span><span class="o">.</span><span class="na">getName</span><span class="o">()+</span><span class="s">&#34; :传递的参数...&#34;</span><span class="o">+</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">args</span><span class="o">));</span>
        <span class="c1">//被增强的方法执行
</span><span class="c1"></span>        <span class="c1">//通过反射机制调用目标对象的方法
</span><span class="c1"></span>        <span class="n">Object</span> <span class="n">res</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">obj</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
        <span class="c1">//System.out.println(res);
</span><span class="c1"></span>        <span class="c1">//方法之后
</span><span class="c1"></span>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;方法之后执行....&#34;</span><span class="o">+</span><span class="n">obj</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">res</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.clover.spring5</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserDaoImpl</span> <span class="kd">implements</span> <span class="n">UserDao</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">add</span><span class="o">(</span><span class="kt">int</span> <span class="n">a</span><span class="o">,</span> <span class="kt">int</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;1111&#34;</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">update</span><span class="o">(</span><span class="n">String</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">com</span><span class="p">.</span><span class="nx">clover</span><span class="p">.</span><span class="nx">spring5</span><span class="p">;</span>

<span class="nx">public</span> <span class="kd">interface</span> <span class="nx">UserDao</span> <span class="p">{</span>
    <span class="nx">public</span> <span class="kt">int</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="nx">a</span><span class="p">,</span><span class="kt">int</span> <span class="nx">b</span><span class="p">);</span>
    <span class="nx">public</span> <span class="nx">String</span> <span class="nf">update</span><span class="p">(</span><span class="nx">String</span> <span class="nx">id</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="64aop术语">6.4、AOP术语</h3>
<p><strong>1、连接点</strong></p>
<ul>
<li>类里面哪些方法可以被增强</li>
</ul>
<p><strong>2、切入点</strong></p>
<ul>
<li>实际被真正增强的方法，称为切入点</li>
</ul>
<p><strong>3、通知(增强)</strong></p>
<ul>
<li>实际增强的逻辑部分称为通知(增加)</li>
<li>通知有多种类型
<ul>
<li><code>前置通知</code>：在某一个方法之前执行</li>
<li><code>后置通知</code>：在某一方法之后执行</li>
<li><code>环绕通知</code>：在某一方法之前之后都执行</li>
<li><code>异常通知</code>：在某一方法出现异常时执行</li>
<li><code>最终通知</code>：类似于finally，不管怎么样最后都会执行</li>
</ul>
</li>
</ul>
<p><strong>4、切面</strong></p>
<ul>
<li>是动作，把通知应用到切入点的过程</li>
</ul>
<h3 id="65aop操作准备工作">6.5、AOP操作(准备工作)</h3>
<ol>
<li>Spring 框架一般都是基于 AspectJ 实现 AOP 操作
<ul>
<li>AspectJ 不是 Spring 组成部分，是独立 AOP 框架，一般把 AspectJ 和 Spirng 框架一起使用，进行AOP操作</li>
</ul>
</li>
<li>基于 AspectJ 实现 AOP 操作
<ul>
<li><strong>基于xml配置文件实现</strong></li>
<li><strong>基于注解方式实现（使用）</strong></li>
</ul>
</li>
<li>在项目工程里面引入AOP相关依赖</li>
<li>切入点表达式
<ul>
<li>切入点表达式作用：<code>知道对哪个类里面的哪个方法进行增强</code></li>
<li>语法结构： execution([权限修饰符] [返回类型] [类全路径] <a href="[%e5%8f%82%e6%95%b0%e5%88%97%e8%a1%a8]" rel="">方法名称</a>)</li>
<li><strong>使用两个<code>..</code>代表参数列表</strong></li>
<li>举例 1：对 com.atguigu.dao.BookDao 类里面的 add 进行增强</li>
<li><code>execution(*  com.atguigu.dao.BookDao.add(..))</code></li>
<li>举例 2：对 com.atguigu.dao.BookDao 类里面的所有的方法进行增强</li>
<li><code>execution(*  com.atguigu.dao.BookDao.* (..))</code></li>
<li>举例 3：对 com.atguigu.dao包里面所有类，类里面所有方法进行增强</li>
<li><code>execution(*  com.atguigu.dao.*.* (..))</code></li>
</ul>
</li>
</ol>
<h3 id="66aop-操作aspectj-注解">6.6、AOP 操作(AspectJ 注解)</h3>
<p>1、创建类，在类里面定义方法</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;add.................&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>2、创建增强类（编写增强逻辑）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="c1">//增强的类
</span><span class="c1"></span><span class="nd">@Component</span>
<span class="nd">@Aspect</span><span class="c1">//生成代理对象 
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserProxy</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">before</span><span class="o">()</span> <span class="o">{</span><span class="c1">//前置通知
</span><span class="c1"></span>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;before......&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>3、进行通知的配置</p>
<ul>
<li>在 spring配置文件中，开启注解扫描</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">&#34;http://www.springframework.org/schema/beans&#34;</span>
       <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
       <span class="na">xmlns:context=</span><span class="s">&#34;http://www.springframework.org/schema/context&#34;</span> 
       <span class="na">xmlns:aop=</span><span class="s">&#34;http://www.springframework.org/schema/aop&#34;</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
</span><span class="s">                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
</span><span class="s">                           http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd&#34;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- 开启注解扫描 --&gt;</span>
    <span class="nt">&lt;context:component-scan</span> <span class="na">base-package=</span><span class="s">&#34;com.clover.spring5.aopannotation&#34;</span><span class="nt">/&gt;</span>

	<span class="c">&lt;!-- 开启Aspect生成代理对象--&gt;</span>
	<span class="nt">&lt;aop:aspectj-autoproxy/&gt;</span>
    
<span class="nt">&lt;/beans&gt;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>使用注解创建 User 和 UserProxy 对象</li>
<li><strong>在增强类上面添加注解 @Aspect</strong></li>
<li><strong>在 spring配置文件中开启生成代理对象</strong></li>
</ul>
<p>4、配置不同类型的通知</p>
<ul>
<li>在增强类的里面，在作为通知方法上面添加通知类型注解，使用切入点表达式配置</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="c1">//增强的类
</span><span class="c1"></span><span class="nd">@Component</span>
<span class="nd">@Aspect</span><span class="c1">//生成代理对象
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserProxy</span> <span class="o">{</span>

    <span class="nd">@Before</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&#34;execution(* com.clover.spring5.aopannotation.User.add(..))&#34;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">before</span><span class="o">()</span> <span class="o">{</span><span class="c1">//前置通知
</span><span class="c1"></span>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;before......&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">//后置通知（返回通知）(方法有异常时不会执行)
</span><span class="c1"></span>    <span class="nd">@AfterReturning</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&#34;execution(* com.clover.spring5.aopannotation.User.add(..))&#34;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">afterReturning</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;afterReturning.........&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">//最终通知(方法有异常时也会执行)
</span><span class="c1"></span>    <span class="nd">@After</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&#34;execution(* com.clover.spring5.aopannotation.User.add(..))&#34;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">after</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;after.........&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">//异常通知
</span><span class="c1"></span>    <span class="nd">@AfterThrowing</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&#34;execution(* com.clover.spring5.aopannotation.User.add(..))&#34;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">afterThrowing</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;afterThrowing.........&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">//环绕通知
</span><span class="c1"></span>    <span class="nd">@Around</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&#34;execution(* com.clover.spring5.aopannotation.User.add(..))&#34;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">around</span><span class="o">(</span><span class="n">ProceedingJoinPoint</span> <span class="n">proceedingJoinPoint</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Throwable</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;环绕之前.........&#34;</span><span class="o">);</span>
        <span class="c1">//被增强的方法执行
</span><span class="c1"></span>        <span class="n">proceedingJoinPoint</span><span class="o">.</span><span class="na">proceed</span><span class="o">();</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;环绕之后.........&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>5、相同的切入点抽取</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//相同切入点抽取
</span><span class="c1"></span><span class="nd">@Pointcut</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&#34;execution(* com.clover.spring5.aopannotation.User.add(..))&#34;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">pointcut</span><span class="o">()</span>
<span class="o">{</span>

<span class="o">}</span>

<span class="nd">@Before</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&#34;pointcut()&#34;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">before</span><span class="o">()</span> <span class="o">{</span><span class="c1">//前置通知
</span><span class="c1"></span>	<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;before......&#34;</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>6、有多个增强类多同一个方法进行增强，设置增强类优先级</p>
<ul>
<li>在增强类上面添加注解 @Order(数字类型值)，数字类型值越小优先级越高</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@Component</span>
<span class="nd">@Aspect</span>
<span class="nd">@Order</span><span class="o">(</span><span class="n">1</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PersonProxy</span> 
</code></pre></td></tr></table>
</div>
</div><p>7、完全使用注解开发</p>
<ul>
<li>创建配置类，不需要创建xml配置文件</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@Configuration</span>
<span class="nd">@ComponentScan</span><span class="o">(</span><span class="n">basePackages</span> <span class="o">=</span> <span class="o">{</span><span class="s">&#34;com.clover&#34;</span><span class="o">})</span><span class="c1">// 开启注解扫描
</span><span class="c1"></span><span class="nd">@EnableAspectJAutoProxy</span><span class="o">(</span><span class="n">proxyTargetClass</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span><span class="c1">// 开启Aspect生成代理对象
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">configAop</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="67aop-操作aspectj-配置文件">6.7、AOP 操作（AspectJ 配置文件）</h3>
<p>1、创建两个类，增强类和被增强类，创建方法</p>
<p>2、在 spring配置文件中创建两个类对象</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--创建对象--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;book&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.aopxml.Book&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;bookProxy&#34;</span> <span class="na">class=</span><span class="s">&#34;com.clover.spring5.aopxml.BookProxy&#34;</span><span class="nt">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>3、在 spring 配置文件中配置切入点</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--配置aop增强--&gt;</span>
<span class="nt">&lt;aop:config&gt;</span>
	<span class="c">&lt;!--配置切入点--&gt;</span>
	<span class="nt">&lt;aop:pointcut</span> <span class="na">id=</span><span class="s">&#34;p&#34;</span> <span class="na">expression=</span><span class="s">&#34;execution(* com.clover.spring5.aopxml.Book.buy(..))&#34;</span><span class="nt">/&gt;</span>

	<span class="c">&lt;!--配置切面--&gt;</span>
	<span class="nt">&lt;aop:aspect</span> <span class="na">ref=</span><span class="s">&#34;bookProxy&#34;</span><span class="nt">&gt;</span>
		<span class="c">&lt;!--增强作用在具体的方法上--&gt;</span>
		<span class="nt">&lt;aop:before</span> <span class="na">method=</span><span class="s">&#34;before&#34;</span> <span class="na">pointcut-ref=</span><span class="s">&#34;p&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/aop:aspect&gt;</span>
<span class="nt">&lt;/aop:config&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="7jdbctemplate概念和准备">7、JdbcTemplate(概念和准备)</h2>
<p>1、什么是 JdbcTemplate</p>
<ul>
<li>Spring 框架对 JDBC 进行封装，使用 JdbcTemplate 方便实现对数据库操作</li>
</ul>
<p>2、准备工作</p>
<ul>
<li>引入相关 jar包</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211101214655.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211101214655.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211101214655.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211101214655.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211101214655.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211101214655.png" /></p>
<ul>
<li>
<p>在 spring配置文件配置数据库连接池</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!-- 数据库连接池 --&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;dataSource&#34;</span> <span class="na">class=</span><span class="s">&#34;com.alibaba.druid.pool.DruidDataSource&#34;</span> <span class="na">destroy-method=</span><span class="s">&#34;close&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;jdbc:mysql:///user_db&#34;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;root&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;xn123456&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driverClassName&#34;</span> <span class="na">value=</span><span class="s">&#34;com.mysql.jdbc.Driver&#34;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>配置 JdbcTemplate 对象，注入 DataSource</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!-- JdbcTemplate对象 --&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;jdbcTemplate&#34;</span> <span class="na">class=</span><span class="s">&#34;org.springframework.jdbc.core.JdbcTemplate&#34;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!--注入dataSource--&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;dataSource&#34;</span> <span class="na">ref=</span><span class="s">&#34;dataSource&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="c">&lt;!-- 组件扫描 --&gt;</span>
<span class="nt">&lt;context:component-scan</span> <span class="na">base-package=</span><span class="s">&#34;com.clover&#34;</span><span class="nt">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>创建 service 类，创建 dao 类，在 dao 注入 jdbcTemplate 对象</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">BookService</span> <span class="o">{</span>

    <span class="c1">//注入dao
</span><span class="c1"></span>    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">BookDao</span> <span class="n">bookDao</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">   
 ~~~Java
 @Repository
 public class BookDaoImpl implements BookDao {
     //注入JdbcTemplate
     @Autowired
     private JdbcTemplate jdbcTemplate;
 }
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">   
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="71jdbctemplate-操作数据库添加">7.1、JdbcTemplate 操作数据库（添加）</h3>
<p>1、对应数据库创建实体类</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Book</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">userId</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">username</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">userStatus</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getUserId</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">userId</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUserId</span><span class="o">(</span><span class="kt">int</span> <span class="n">userId</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">userId</span> <span class="o">=</span> <span class="n">userId</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getUsername</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">username</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUsername</span><span class="o">(</span><span class="n">String</span> <span class="n">username</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">username</span> <span class="o">=</span> <span class="n">username</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getUserStatus</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">userStatus</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUserStatus</span><span class="o">(</span><span class="n">String</span> <span class="n">userStatus</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">userStatus</span> <span class="o">=</span> <span class="n">userStatus</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>2、编写 service 和 dao</p>
<ul>
<li>在dao进行数据库添加操作</li>
<li>调用 JdbcTemplate 对象里面 update 方法实现添加操作</li>
<li>有两个参数
<ul>
<li>
<p>第一个参数：sql 语句</p>
</li>
<li>
<p>第二个参数：可变参数，设置sql语句值</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@Repository</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">BookDaoImpl</span> <span class="kd">implements</span> <span class="n">BookDao</span> <span class="o">{</span>
    <span class="c1">//注入JdbcTemplate
</span><span class="c1"></span>    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">JdbcTemplate</span> <span class="n">jdbcTemplate</span><span class="o">;</span>
    <span class="c1">//添加的方法
</span><span class="c1"></span>    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">Book</span> <span class="n">book</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//1 创建sql语句
</span><span class="c1"></span>        <span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;insert into t_book values(?,?,?)&#34;</span><span class="o">;</span>
        <span class="c1">//2 调用方法实现
</span><span class="c1"></span>        <span class="n">Object</span><span class="o">[]</span> <span class="n">args</span> <span class="o">=</span> <span class="o">{</span><span class="n">book</span><span class="o">.</span><span class="na">getUserId</span><span class="o">(),</span> <span class="n">book</span><span class="o">.</span><span class="na">getUsername</span><span class="o">(),</span> <span class="n">book</span><span class="o">.</span><span class="na">getUserStatus</span><span class="o">()};</span>
        <span class="kt">int</span> <span class="n">update</span> <span class="o">=</span> <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">sql</span><span class="o">,</span><span class="n">args</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">update</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ul>
<p>3、测试类</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testJdbcTemplate</span><span class="o">()</span> <span class="o">{</span>
	<span class="n">ApplicationContext</span> <span class="n">context</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ClassPathXmlApplicationContext</span><span class="o">(</span><span class="s">&#34;bean1.xml&#34;</span><span class="o">);</span>
	<span class="n">BookService</span> <span class="n">bookService</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">&#34;bookService&#34;</span><span class="o">,</span> <span class="n">BookService</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
	<span class="n">Book</span> <span class="n">book</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Book</span><span class="o">();</span>
	<span class="n">book</span><span class="o">.</span><span class="na">setUserId</span><span class="o">(</span><span class="s">&#34;1&#34;</span><span class="o">);</span>
	<span class="n">book</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="s">&#34;java&#34;</span><span class="o">);</span>
	<span class="n">book</span><span class="o">.</span><span class="na">setUstatus</span><span class="o">(</span><span class="s">&#34;a&#34;</span><span class="o">);</span>
	<span class="n">bookService</span><span class="o">.</span><span class="na">addBook</span><span class="o">(</span><span class="n">book</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="72jdbctemplate-操作数据库修改和删除">7.2、JdbcTemplate 操作数据库（修改和删除）</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="c1">//修改
</span><span class="c1"></span><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">update</span><span class="o">(</span><span class="n">Book</span> <span class="n">book</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;update t_book set username=?,ustatus=? where user_id=?&#34;</span><span class="o">;</span>
	<span class="n">Object</span><span class="o">[]</span> <span class="n">args</span> <span class="o">=</span> <span class="o">{</span><span class="n">book</span><span class="o">.</span><span class="na">getUsername</span><span class="o">(),</span> <span class="n">book</span><span class="o">.</span><span class="na">getUserStatus</span><span class="o">(),</span><span class="n">book</span><span class="o">.</span><span class="na">getUserId</span><span class="o">()};</span>
	<span class="kt">int</span> <span class="n">update</span> <span class="o">=</span> <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">sql</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
	<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">update</span><span class="o">);</span>
<span class="o">}</span>

<span class="c1">//删除
</span><span class="c1"></span><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteBook</span><span class="o">(</span><span class="n">String</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;delete from t_book where user_id=?&#34;</span><span class="o">;</span>
	<span class="kt">int</span> <span class="n">update</span> <span class="o">=</span> <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">sql</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span>
	<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">update</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="73jdbctemplate-操作数据库查询返回某个值">7.3、JdbcTemplate 操作数据库（查询返回某个值）</h3>
<p>1、查询表里面有多少条记录，返回是某个值</p>
<p>2、使用 JdbcTemplate 实现查询返回某个值代码</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211101222134.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211101222134.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211101222134.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211101222134.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211101222134.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211101222134.png" /></p>
<ul>
<li>有两个参数
<ul>
<li>第一个参数：sql 语句</li>
<li>第二个参数：返回类型 Class</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="c1">//查询表记录数
</span><span class="c1"></span><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">int</span> <span class="nf">selectCount</span><span class="o">()</span> <span class="o">{</span>
	<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;select count(*) from t_book&#34;</span><span class="o">;</span>
	<span class="n">Integer</span> <span class="n">count</span> <span class="o">=</span> <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">queryForObject</span><span class="o">(</span><span class="n">sql</span><span class="o">,</span> <span class="n">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
	<span class="k">return</span> <span class="n">count</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="74jdbctemplate-操作数据库查询返回对象">7.4、JdbcTemplate 操作数据库（查询返回对象）</h3>
<p>1、场景：查询图书详情</p>
<p>2、JdbcTemplate 实现查询返回对象</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102131616.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102131616.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102131616.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102131616.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102131616.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102131616.png" /></p>
<ul>
<li>有三个参数
<ul>
<li>第一个参数：sql 语句</li>
<li>第二个参数：RowMapper 是接口，针对返回不同类型数据，使用这个接口里面实现类完成数据封装</li>
<li>第三个参数：sql 语句值</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="c1">//查询返回对象
</span><span class="c1"></span><span class="nd">@Override</span>
<span class="kd">public</span> <span class="n">Book</span> <span class="nf">findBookInfo</span><span class="o">(</span><span class="n">String</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;select * from t_book where user_id=?&#34;</span><span class="o">;</span>
	<span class="c1">//调用方法
</span><span class="c1"></span>	<span class="n">Book</span> <span class="n">book</span> <span class="o">=</span> <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">queryForObject</span><span class="o">(</span><span class="n">sql</span><span class="o">,</span> <span class="k">new</span> <span class="n">BeanPropertyRowMapper</span><span class="o">&lt;</span><span class="n">Book</span><span class="o">&gt;(</span><span class="n">Book</span><span class="o">.</span><span class="na">class</span><span class="o">),</span> <span class="n">id</span><span class="o">);</span>
	<span class="k">return</span> <span class="n">book</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="75jdbctemplate-操作数据库查询返回集合">7.5、JdbcTemplate 操作数据库（查询返回集合）</h3>
<p>1、场景：查询图书详情</p>
<p>2、JdbcTemplate 实现查询返回对象</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102132940.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102132940.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102132940.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102132940.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102132940.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102132940.png" /></p>
<ul>
<li>有三个参数
<ul>
<li>第一个参数：sql 语句</li>
<li>第二个参数：RowMapper 是接口，针对返回不同类型数据，使用这个接口里面实现类完成 数据封装</li>
<li>第三个参数：sql 语句值</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="c1">//查询返回集合
</span><span class="c1"></span><span class="nd">@Override</span>
<span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Book</span><span class="o">&gt;</span> <span class="nf">findAllBook</span><span class="o">()</span> <span class="o">{</span>
	<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;select * from t_book&#34;</span><span class="o">;</span>
	<span class="c1">//调用方法
</span><span class="c1"></span>	<span class="n">List</span><span class="o">&lt;</span><span class="n">Book</span><span class="o">&gt;</span> <span class="n">bookList</span> <span class="o">=</span> <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="n">sql</span><span class="o">,</span> <span class="k">new</span> <span class="n">BeanPropertyRowMapper</span><span class="o">&lt;</span><span class="n">Book</span><span class="o">&gt;(</span><span class="n">Book</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>
	<span class="k">return</span> <span class="n">bookList</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="76jdbctemplate-操作数据库批量操作">7.6、JdbcTemplate 操作数据库（批量操作）</h3>
<p>1、批量操作：操作表里面多条记录</p>
<p>2、JdbcTemplate 实现批量添加操作</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102133529.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102133529.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102133529.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102133529.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102133529.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102133529.png" /></p>
<ul>
<li>有两个参数
<ul>
<li>第一个参数：sql 语句</li>
<li>第二个参数：List集合，添加多条记录数据</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="c1">//批量添加
</span><span class="c1"></span><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">batchAddBook</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">[]&gt;</span> <span class="n">batchArgs</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;insert into t_book values(?,?,?)&#34;</span><span class="o">;</span>
	<span class="kt">int</span><span class="o">[]</span> <span class="n">ints</span> <span class="o">=</span> <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">batchUpdate</span><span class="o">(</span><span class="n">sql</span><span class="o">,</span> <span class="n">batchArgs</span><span class="o">);</span>
	<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">ints</span><span class="o">));</span> 
<span class="o">}</span>

<span class="c1">//批量添加测试
</span><span class="c1"></span><span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">[]&gt;</span> <span class="n">batchArgs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span> 
<span class="n">Object</span><span class="o">[]</span> <span class="n">o1</span> <span class="o">=</span> <span class="o">{</span><span class="s">&#34;3&#34;</span><span class="o">,</span><span class="s">&#34;java&#34;</span><span class="o">,</span><span class="s">&#34;a&#34;</span><span class="o">};</span> 
<span class="n">Object</span><span class="o">[]</span> <span class="n">o2</span> <span class="o">=</span> <span class="o">{</span><span class="s">&#34;4&#34;</span><span class="o">,</span><span class="s">&#34;c++&#34;</span><span class="o">,</span><span class="s">&#34;b&#34;</span><span class="o">};</span> 
<span class="n">Object</span><span class="o">[]</span> <span class="n">o3</span> <span class="o">=</span> <span class="o">{</span><span class="s">&#34;5&#34;</span><span class="o">,</span><span class="s">&#34;MySQL&#34;</span><span class="o">,</span><span class="s">&#34;c&#34;</span><span class="o">};</span> 
<span class="n">batchArgs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">o1</span><span class="o">);</span> <span class="n">batchArgs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">o2</span><span class="o">);</span> <span class="n">batchArgs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">o3</span><span class="o">);</span>
<span class="c1">//调用批量添加
</span><span class="c1"></span><span class="n">bookService</span><span class="o">.</span><span class="na">batchAdd</span><span class="o">(</span><span class="n">batchArgs</span><span class="o">);</span>
</code></pre></td></tr></table>
</div>
</div><p>3、JdbcTemplate 实现批量修改操作</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="c1">//批量修改
</span><span class="c1"></span><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">batchUpdateBook</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">[]&gt;</span> <span class="n">batchArgs</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;update t_book set username=?,ustatus=? where user_id=?&#34;</span><span class="o">;</span>
	<span class="kt">int</span><span class="o">[]</span> <span class="n">ints</span> <span class="o">=</span> <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">batchUpdate</span><span class="o">(</span><span class="n">sql</span><span class="o">,</span> <span class="n">batchArgs</span><span class="o">);</span>
	<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">ints</span><span class="o">));</span> 
<span class="o">}</span>
<span class="c1">//批量修改
</span><span class="c1"></span><span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">[]&gt;</span> <span class="n">batchArgs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span> 
<span class="n">Object</span><span class="o">[]</span> <span class="n">o1</span> <span class="o">=</span> <span class="o">{</span><span class="s">&#34;java0909&#34;</span><span class="o">,</span><span class="s">&#34;a3&#34;</span><span class="o">,</span><span class="s">&#34;3&#34;</span><span class="o">};</span> 
<span class="n">Object</span><span class="o">[]</span> <span class="n">o2</span> <span class="o">=</span> <span class="o">{</span><span class="s">&#34;c++1010&#34;</span><span class="o">,</span><span class="s">&#34;b4&#34;</span><span class="o">,</span><span class="s">&#34;4&#34;</span><span class="o">};</span> 
<span class="n">Object</span><span class="o">[]</span> <span class="n">o3</span> <span class="o">=</span> <span class="o">{</span><span class="s">&#34;MySQL1111&#34;</span><span class="o">,</span><span class="s">&#34;c5&#34;</span><span class="o">,</span><span class="s">&#34;5&#34;</span><span class="o">};</span> 
<span class="n">batchArgs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">o1</span><span class="o">);</span> <span class="n">batchArgs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">o2</span><span class="o">);</span> <span class="n">batchArgs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">o3</span><span class="o">);</span>
<span class="c1">//调用方法实现批量修改
</span><span class="c1"></span><span class="n">bookService</span><span class="o">.</span><span class="na">batchUpdate</span><span class="o">(</span><span class="n">batchArgs</span><span class="o">);</span>
</code></pre></td></tr></table>
</div>
</div><p>4、JdbcTemplate 实现批量删除操作</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="c1">//批量删除
</span><span class="c1"></span><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">batchDeleteBook</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">[]&gt;</span> <span class="n">batchArgs</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;delete from t_book where user_id=?&#34;</span><span class="o">;</span>
	<span class="kt">int</span><span class="o">[]</span> <span class="n">ints</span> <span class="o">=</span> <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">batchUpdate</span><span class="o">(</span><span class="n">sql</span><span class="o">,</span> <span class="n">batchArgs</span><span class="o">);</span>
	<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">ints</span><span class="o">));</span> 
<span class="o">}</span>
<span class="c1">//批量删除
</span><span class="c1"></span><span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">[]&gt;</span> <span class="n">batchArgs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="n">Object</span><span class="o">[]</span> <span class="n">o1</span> <span class="o">=</span> <span class="o">{</span><span class="s">&#34;3&#34;</span><span class="o">};</span> 
<span class="n">Object</span><span class="o">[]</span> <span class="n">o2</span> <span class="o">=</span> <span class="o">{</span><span class="s">&#34;4&#34;</span><span class="o">};</span> 
<span class="n">batchArgs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">o1</span><span class="o">);</span> <span class="n">batchArgs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">o2</span><span class="o">);</span>
<span class="c1">//调用方法实现批量删除
</span><span class="c1"></span><span class="n">bookService</span><span class="o">.</span><span class="na">batchDelete</span><span class="o">(</span><span class="n">batchArgs</span><span class="o">);</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="8事务概念">8、事务概念</h2>
<p>1、什么事务</p>
<ul>
<li>事务是数据库操作最基本单元，逻辑上一组操作，要么都成功，如果有一个失败所有操作都失败</li>
<li>典型场景：银行转账</li>
<li>lucy 转账 100 元 给 mary</li>
<li>lucy 少 100，mary 多 100</li>
</ul>
<p><strong>2、事务四个特性（ACID）</strong></p>
<ul>
<li><code>原子性</code>：要么都成功，要么都失败</li>
<li><code>一致性</code>：操作前后总量是一致的</li>
<li><code>隔离性</code>：多事务之间的操作无影响，比如两个人操作同一记录，过程间是不会产生影响的</li>
<li><code>持久性</code>：数据操作完成后表中数据是真正改变了</li>
</ul>
<h3 id="81事务操作搭建事务操作环境">8.1、事务操作（搭建事务操作环境）</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102154956.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102154956.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102154956.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102154956.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102154956.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102154956.png" /></p>
<p>1、创建数据库表，添加记录</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102155023.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102155023.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102155023.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102155023.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102155023.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102155023.png" /></p>
<p>2、创建 service，搭建 dao，完成对象创建和注入关系</p>
<ul>
<li>service 注入 dao，在 dao 注入 JdbcTemplate，在 JdbcTemplate 注入 DataSource</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserService</span> <span class="o">{</span>
	<span class="c1">//注入dao
</span><span class="c1"></span>	<span class="nd">@Autowired</span>
	<span class="kd">private</span> <span class="n">UserDao</span> <span class="n">userDao</span><span class="o">;</span>
<span class="o">}</span>
<span class="nd">@Repository</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserDaoImpl</span> <span class="kd">implements</span> <span class="n">UserDao</span> <span class="o">{</span>
	<span class="nd">@Autowired</span>
	<span class="kd">private</span> <span class="n">JdbcTemplate</span> <span class="n">jdbcTemplate</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>3、在 dao创建两个方法：多钱和少钱的方法，在 service创建方法（转账的方法）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.clover.spring5.dao</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.jdbc.core.JdbcTemplate</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Repository</span><span class="o">;</span>

<span class="nd">@Repository</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserDaoImpl</span> <span class="kd">implements</span> <span class="n">UserDao</span><span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">JdbcTemplate</span> <span class="n">jdbcTemplate</span><span class="o">;</span>

    <span class="c1">//lucy转账100给mary
</span><span class="c1"></span>    <span class="c1">// 少钱
</span><span class="c1"></span>    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">reduceMoney</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;update t_money set money=money-? where username=?&#34;</span><span class="o">;</span>
        <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">sql</span><span class="o">,</span><span class="n">100</span><span class="o">,</span><span class="s">&#34;lucy&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">//多钱
</span><span class="c1"></span>    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addMoney</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;update t_money set money=money+? where username=?&#34;</span><span class="o">;</span>
        <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">sql</span><span class="o">,</span><span class="n">100</span><span class="o">,</span><span class="s">&#34;mary&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserService</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">UserDao</span> <span class="n">userDao</span><span class="o">;</span>

    <span class="c1">//转账的方法
</span><span class="c1"></span>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">accountMoney</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">//lucy少100
</span><span class="c1"></span>        <span class="n">userDao</span><span class="o">.</span><span class="na">reduceMoney</span><span class="o">();</span>
        <span class="c1">//mary多100
</span><span class="c1"></span>        <span class="n">userDao</span><span class="o">.</span><span class="na">addMoney</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>4、上面代码，如果正常执行没有问题的，但是如果代码执行过程中出现异常，有问题</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102160253.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102160253.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102160253.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102160253.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102160253.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102160253.png" /></p>
<ul>
<li>上面问题如何解决呢？
<ul>
<li><strong>使用事务进行解决</strong></li>
</ul>
</li>
<li>事务操作过程</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102160533.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102160533.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102160533.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102160533.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102160533.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102160533.png" /></p>
<h3 id="82事务操作spring-事务管理介绍">8.2、事务操作（Spring 事务管理介绍）</h3>
<p>1、事务添加到 JavaEE 三层结构里面 Service 层（业务逻辑层）</p>
<p>2、在 Spring 进行事务管理操作</p>
<ul>
<li>有两种方式
<ul>
<li><strong>编程式事务管理</strong></li>
<li><strong>声明式事务管理（常用）</strong></li>
</ul>
</li>
</ul>
<p>3、声明式事务管理</p>
<ul>
<li><strong>基于注解方式（常用）</strong></li>
<li>基于xml配置文件方式</li>
</ul>
<p>4、在 Spring进行声明式事务管理，<strong>底层使用 AOP原理</strong></p>
<p>5、Spring 事务管理 API</p>
<ul>
<li>提供一个接口，代表事务管理器，这个接口针对不同的框架提供不同的实现类</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102161040.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102161040.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102161040.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102161040.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102161040.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102161040.png" /></p>
<h3 id="83事务操作注解声明式事务管理">8.3、事务操作（注解声明式事务管理）</h3>
<p>1、在 spring配置文件配置事务管理器</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--创建事务管理器--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;transactionManager&#34;</span> <span class="na">class=</span><span class="s">&#34;org.springframework.jdbc.datasource.DataSourceTransactionManager&#34;</span><span class="nt">&gt;</span>
	<span class="c">&lt;!--注入数据源--&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;dataSource&#34;</span> <span class="na">ref=</span><span class="s">&#34;dataSource&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>2、在 spring 配置文件，开启事务注解</p>
<ul>
<li>在 spring配置文件引入名称空间 tx</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">&#34;http://www.springframework.org/schema/beans&#34;</span>
       <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
       <span class="na">xmlns:context=</span><span class="s">&#34;http://www.springframework.org/schema/context&#34;</span>
       <span class="na">xmlns:tx=</span><span class="s">&#34;http://www.springframework.org/schema/tx&#34;</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
</span><span class="s">                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
</span><span class="s">                           http://www.springframework.org/schema/tx http://www.springframework.org/schema/aop/spring-tx.xsd&#34;</span><span class="nt">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>开启事务注解</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--开启事务注解--&gt;</span>
<span class="nt">&lt;tx:annotation-driven</span> <span class="na">transaction-manager=</span><span class="s">&#34;transactionManager&#34;</span><span class="nt">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>3、在 service 类上面（或者 service 类里面方法上面）添加事务注解</p>
<ul>
<li><code>@Transactional</code>，这个注解添加到类上面，也可以添加方法上面</li>
<li>如果把这个注解添加类上面，这个类里面所有的方法都添加事务</li>
<li>如果把这个注解添加方法上面，为这个方法添加事务</li>
</ul>
<h3 id="84事务操作声明式事务管理参数配置">8.4、事务操作（声明式事务管理参数配置）</h3>
<p>1、在 service 类上面添加注解@Transactional，在这个注解里面可以配置事务相关参数</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102163629.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102163629.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102163629.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102163629.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102163629.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102163629.png" /></p>
<p><strong>2、propagation：事务传播行为</strong></p>
<ul>
<li>多事务方法之间进行调用，这个过程中事务是如何进行管理的</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102163350.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102163350.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102163350.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102163350.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102163350.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102163350.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102163417.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102163417.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102163417.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102163417.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102163417.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102163417.png" /></p>
<p><strong>3、ioslation：事务隔离级别</strong></p>
<ul>
<li>事务有特性成为隔离性，多事务操作之间不会产生影响。不考虑隔离性产生很多问题</li>
<li>有三个读问题：<strong>脏读、不可重复读、虚（幻）读</strong></li>
<li><code>脏读</code>：一个未提交事务读取到另一个未提交事务的数据
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102164658.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102164658.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102164658.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102164658.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102164658.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102164658.png" /></li>
<li><code>不可重复读</code>：一个未提交事务读取到另一提交事务<code>修改</code>数据</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102165350.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102165350.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102165350.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102165350.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102165350.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102165350.png" /></p>
<ul>
<li><code>虚读</code>：一个未提交事务读取到另一提交事务<code>添加</code>数据</li>
<li>解决：<strong>通过设置事务隔离级别</strong>，解决读问题</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102165444.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102165444.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102165444.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102165444.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102165444.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102165444.png" /></p>
<p><strong>4、timeout：超时时间</strong></p>
<ul>
<li>事务需要在一定时间内进行提交，如果不提交进行回滚</li>
<li>默认值是 -1 ，设置时间以<code>秒单位</code>进行计算</li>
</ul>
<p><strong>5、readOnly：是否只读</strong></p>
<ul>
<li>读：查询操作，写：添加修改删除操作</li>
<li>readOnly 默认值 false，表示可以查询，也可以添加修改删除操作</li>
<li>设置 readOnly 值是 true，设置成 true 之后，只能查询</li>
</ul>
<p><strong>6、rollbackFor：回滚</strong></p>
<ul>
<li>设置出现哪些异常进行事务回滚</li>
</ul>
<p><strong>7、noRollbackFor：不回滚</strong></p>
<ul>
<li>设置出现哪些异常不进行事务回滚</li>
</ul>
<h3 id="85事务操作xml声明式事务管理">8.5、事务操作（XML声明式事务管理）</h3>
<p>1、在 spring 配置文件中进行配置</p>
<ul>
<li>第一步 配置事务管理器</li>
<li>第二步 配置通知</li>
<li>第三步 配置切入点和切面</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--1 创建事务管理器--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;transactionManager&#34;</span> <span class="na">class=</span><span class="s">&#34;org.springframework.jdbc.datasource.DataSourceTransactionManager&#34;</span><span class="nt">&gt;</span>
	<span class="c">&lt;!--注入数据源--&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;dataSource&#34;</span> <span class="na">ref=</span><span class="s">&#34;dataSource&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="c">&lt;!--2 配置通知--&gt;</span>
<span class="nt">&lt;tx:advice</span> <span class="na">id=</span><span class="s">&#34;txadvice&#34;</span><span class="nt">&gt;</span>
	<span class="c">&lt;!--配置事务参数--&gt;</span>
	<span class="nt">&lt;tx:attributes&gt;</span>
		<span class="c">&lt;!--指定哪种规则在方法上面添加事务--&gt;</span>
		<span class="nt">&lt;tx:method</span> <span class="na">name=</span><span class="s">&#34;accountMoney&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/tx:attributes&gt;</span>
<span class="nt">&lt;/tx:advice&gt;</span>

<span class="c">&lt;!--3 配置切入点和切面--&gt;</span>
<span class="nt">&lt;aop:config&gt;</span>
	<span class="c">&lt;!--配置切入点--&gt;</span>
	<span class="nt">&lt;aop:pointcut</span> <span class="na">id=</span><span class="s">&#34;pt&#34;</span> <span class="na">expression=</span><span class="s">&#34;execution(* com.clover.spring5.service.UserService.*(..))&#34;</span><span class="nt">/&gt;</span>

	<span class="c">&lt;!--配置切面--&gt;</span>
	<span class="nt">&lt;aop:advisor</span> <span class="na">advice-ref=</span><span class="s">&#34;txadvice&#34;</span> <span class="na">pointcut-ref=</span><span class="s">&#34;pt&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/aop:config&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="86事务操作完全注解声明式事务管理">8.6、事务操作（完全注解声明式事务管理）</h3>
<p>1、创建配置类，使用配置类替代xml配置文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@Configuration</span><span class="c1">//配置类
</span><span class="c1"></span><span class="nd">@ComponentScan</span><span class="o">(</span><span class="n">basePackages</span> <span class="o">=</span> <span class="s">&#34;com.clover&#34;</span><span class="o">)</span><span class="c1">//组件扫描
</span><span class="c1"></span><span class="nd">@EnableTransactionManagement</span> <span class="c1">//开启事务
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TxConfig</span> <span class="o">{</span>

    <span class="c1">//创建数据库连接池
</span><span class="c1"></span>    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">DruidDataSource</span> <span class="nf">getDruidDataSource</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="n">DruidDataSource</span> <span class="n">dataSource</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DruidDataSource</span><span class="o">();</span>
        <span class="n">dataSource</span><span class="o">.</span><span class="na">setUrl</span><span class="o">(</span><span class="s">&#34;jdbc:mysql:///user_db&#34;</span><span class="o">);</span>
        <span class="n">dataSource</span><span class="o">.</span><span class="na">setDriverClassName</span><span class="o">(</span><span class="s">&#34;com.mysql.jdbc.Driver&#34;</span><span class="o">);</span>
        <span class="n">dataSource</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="s">&#34;root&#34;</span><span class="o">);</span>
        <span class="n">dataSource</span><span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="s">&#34;xn123456&#34;</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">dataSource</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">//创建JdbcTemplate对象
</span><span class="c1"></span>    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">JdbcTemplate</span> <span class="nf">getJdbcTemplate</span><span class="o">(</span><span class="n">DataSource</span> <span class="n">dataSource</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="c1">//到ioc容器中根据类型找到dataSource
</span><span class="c1"></span>        <span class="n">JdbcTemplate</span> <span class="n">jdbcTemplate</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JdbcTemplate</span><span class="o">();</span>
        <span class="c1">//注入dataSource
</span><span class="c1"></span>        <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">setDataSource</span><span class="o">(</span><span class="n">dataSource</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">jdbcTemplate</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">//创建事务管理器
</span><span class="c1"></span>    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">DataSourceTransactionManager</span> <span class="nf">getDataSourceTransactionManager</span><span class="o">(</span><span class="n">DataSource</span> <span class="n">dataSource</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="n">DataSourceTransactionManager</span> <span class="n">transactionManager</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DataSourceTransactionManager</span><span class="o">();</span>
        <span class="n">transactionManager</span><span class="o">.</span><span class="na">setDataSource</span><span class="o">(</span><span class="n">dataSource</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">transactionManager</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="9spring5-框架新功能">9、Spring5 框架新功能</h2>
<p>1、整个 Spring5 框架的代码基于 Java8，运行时兼容 JDK9，许多不建议使用的类和方 法在代码库中删除</p>
<p>2、Spring 5.0 框架自带了通用的日志封装</p>
<ul>
<li>Spring5 已经移除 Log4jConfigListener，官方建议使用 Log4j2</li>
<li>Spring5 框架整合 Log4j2
<ul>
<li>第一步 引入jar包</li>
<li>第二步 创建 log4j2.xml 配置文件</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="c">&lt;!--日志级别以及优先级排序: OFF &gt; FATAL &gt; ERROR &gt; WARN &gt; INFO &gt; DEBUG &gt; TRACE &gt; ALL --&gt;</span>
<span class="c">&lt;!--Configuration后面的status用于设置log4j2自身内部的信息输出，可以不设置，当设置成trace时，可以看到log4j2内部各种详细输出--&gt;</span>
<span class="nt">&lt;configuration</span> <span class="na">status=</span><span class="s">&#34;INFO&#34;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!--先定义所有的appender--&gt;</span>
    <span class="nt">&lt;appenders&gt;</span>
        <span class="c">&lt;!--输出日志信息到控制台--&gt;</span>
        <span class="nt">&lt;console</span> <span class="na">name=</span><span class="s">&#34;Console&#34;</span> <span class="na">target=</span><span class="s">&#34;SYSTEM_OUT&#34;</span><span class="nt">&gt;</span>
            <span class="c">&lt;!--控制日志输出的格式--&gt;</span>
            <span class="nt">&lt;PatternLayout</span> <span class="na">pattern=</span><span class="s">&#34;%d{yyyy-MM-dd HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/console&gt;</span>
    <span class="nt">&lt;/appenders&gt;</span>
    <span class="c">&lt;!--然后定义logger，只有定义了logger并引入的appender，appender才会生效--&gt;</span>
    <span class="c">&lt;!--root：用于指定项目的根日志，如果没有单独指定Logger，则会使用root作为默认的日志输出--&gt;</span>
    <span class="nt">&lt;loggers&gt;</span>
        <span class="nt">&lt;root</span> <span class="na">level=</span><span class="s">&#34;info&#34;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">&#34;Console&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/root&gt;</span>
    <span class="nt">&lt;/loggers&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>3、Spring5 框架核心容器支持@Nullable 注解</p>
<ul>
<li><code>@Nullable 注解</code>可以使用在方法上面，属性上面，参数上面，表示方法返回可以为空，属性值可以为空，参数值可以为空</li>
<li>注解用在方法上面，方法返回值可以为空</li>
<li>注解使用在方法参数里面，方法参数可以为空</li>
<li>注解使用在属性上面，属性值可以为空</li>
</ul>
<p>4、Spring5 核心容器支持函数式风格 GenericApplicationContext</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="c1">//函数式风格创建对象，交给spring进行管理
</span><span class="c1"></span><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testGenericApplicationContext</span><span class="o">()</span> <span class="o">{</span>
	<span class="c1">//1 创建GenericApplicationContext对象
</span><span class="c1"></span>	<span class="n">GenericApplicationContext</span> <span class="n">context</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GenericApplicationContext</span><span class="o">();</span>
	<span class="c1">//2 调用context的方法对象注册
</span><span class="c1"></span>	<span class="n">context</span><span class="o">.</span><span class="na">refresh</span><span class="o">();</span> <span class="n">context</span><span class="o">.</span><span class="na">registerBean</span><span class="o">(</span><span class="s">&#34;user1&#34;</span><span class="o">,</span><span class="n">User</span><span class="o">.</span><span class="na">class</span><span class="o">,()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="n">User</span><span class="o">());</span>
	<span class="c1">//3 获取在spring注册的对象
</span><span class="c1">//        User user = (User)context.getBean(&#34;com.clover.spring5.Test.User&#34;);
</span><span class="c1"></span>	<span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="o">(</span><span class="n">User</span><span class="o">)</span><span class="n">context</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">&#34;user1&#34;</span><span class="o">);</span>
	<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>5、Spring5 支持整合 JUnit5</p>
<ul>
<li>
<p>整合 JUnit4</p>
<ul>
<li>第一步 引入 Spring相关针对测试依赖
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102183207.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102183207.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102183207.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102183207.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102183207.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102183207.png" />
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102183224.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102183224.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102183224.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102183224.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102183224.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102183224.png" /></li>
<li>第二步 创建测试类，使用注解方式完成
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@RunWith</span><span class="o">(</span><span class="n">SpringJUnit4ClassRunner</span><span class="o">.</span><span class="na">class</span><span class="o">)</span><span class="c1">//指定单元测试框架
</span><span class="c1"></span><span class="nd">@ContextConfiguration</span><span class="o">(</span><span class="s">&#34;classpath:bean1.xml&#34;</span><span class="o">)</span> <span class="c1">//加载配置文件
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JTest4</span> <span class="o">{</span>

   <span class="nd">@Autowired</span>
   <span class="kd">private</span> <span class="n">UserService</span> <span class="n">userService</span><span class="o">;</span>

   <span class="nd">@Test</span>
   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test1</span><span class="o">()</span> <span class="o">{</span>
       <span class="n">userService</span><span class="o">.</span><span class="na">accountMoney</span><span class="o">();</span>
   <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>
<p>Spring5 整合 JUnit5</p>
<ul>
<li>
<p>第一步 引入 JUnit5 的 jar 包</p>
</li>
<li>
<p>第二步 创建测试类，使用注解完成</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">import</span> <span class="nn">com.clover.spring5.service.UserService</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.extension.ExtendWith</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.test.context.ContextConfiguration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.test.context.junit.jupiter.SpringExtension</span><span class="o">;</span>

<span class="nd">@ExtendWith</span><span class="o">(</span><span class="n">SpringExtension</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="nd">@ContextConfiguration</span><span class="o">(</span><span class="s">&#34;classpath:bean1.xml&#34;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JTest5</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">UserService</span> <span class="n">userService</span><span class="o">;</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test1</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">userService</span><span class="o">.</span><span class="na">accountMoney</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">       
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>
<p>使用一个复合注解替代上面两个注解完成整合</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="nd">@SpringJUnitConfig</span><span class="o">(</span><span class="n">locations</span> <span class="o">=</span> <span class="s">&#34;classpath:bean1.xml&#34;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JTest5</span> <span class="o">{</span>
	<span class="nd">@Autowired</span>
	<span class="kd">private</span> <span class="n">UserService</span> <span class="n">userService</span><span class="o">;</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test1</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">userService</span><span class="o">.</span><span class="na">accountMoney</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="10spring5-框架新功能webflux">10、Spring5 框架新功能（Webflux）</h2>
<p>1、SpringWebflux 介绍</p>
<ul>
<li>是 Spring5 添加新的模块，用于 web 开发的，功能和 SpringMVC 类似的，Webflux 使用当前一种比较流行<strong>响应式编程</strong>出现的框架</li>
<li>使用传统 web 框架，比如 SpringMVC，这些基于 Servlet 容器，Webflux 是一种<strong>异步非阻塞</strong>的框架，异步非阻塞的框架在 Servlet3.1 以后才支持，<strong>核心是基于 Reactor 的相关 API 实现的</strong></li>
<li>解释什么是异步非阻塞
<ul>
<li>异步和同步；非阻塞和阻塞</li>
<li>上面都是针对对象不一样</li>
<li><strong>异步和同步针对<code>调用者</code></strong>，调用者发送请求，如果等着对方回应之后才去做其他事情就是同步，如果发送请求之后不等着对方回应就去做其他事情就是异步</li>
<li><strong>阻塞和非阻塞针对<code>被调用者</code></strong>，被调用者收到请求之后，做完请求任务之后才给出反馈就是阻塞，受到请求之后马上给出反馈然后再去做事情就是非阻塞</li>
</ul>
</li>
<li>Webflux 特点
<ul>
<li>第一 异步非阻塞式：在有限资源下，提高系统吞吐量和伸缩性，以Reactor为基础实现响应式编程</li>
<li>第二 函数式编程：Spring5 框架基于 java8，Webflux 使用 Java8函数式编程方式实现路由请求</li>
</ul>
</li>
<li>比较 SpringMVC</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102200845.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102200845.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102200845.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102200845.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102200845.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211102200845.png" /></p>
<ul>
<li>第一 两个框架都可以使用注解方式，都运行在Tomcat等容器中</li>
<li>第二 SpringMVC采用命令式编程，Webflux采用异步响应式编程</li>
</ul>
<p>2、响应式编程（Java 实现）</p>
<ul>
<li>什么是响应式编程
<ul>
<li>响应式编程是一种面向数据流和变化传播的编程范式。这意味着可以在编程语言中很方便地表达静态或动态的数据流，而相关的计算模型会自动将变化的值通过数据流进行传播</li>
<li>电子表格程序就是响应式编程的一个例子。单元格可以包含字面值或类似&quot;=B1+C1&quot;的公式，而包含公式的单元格的值会依据其他单元格的值的变化而变化</li>
</ul>
</li>
<li>Java8及其之前版本
<ul>
<li>提供的<strong>观察者模式</strong>两个类 <code>Observer</code> 和 <code>Observable</code></li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ObserverDemo</span> <span class="kd">extends</span> <span class="n">Observable</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>

        <span class="n">ObserverDemo</span> <span class="n">observerDemo</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObserverDemo</span><span class="o">();</span>
        <span class="c1">//添加观察者
</span><span class="c1"></span>        <span class="n">observerDemo</span><span class="o">.</span><span class="na">addObserver</span><span class="o">((</span><span class="n">o</span><span class="o">,</span><span class="n">arg</span><span class="o">)-&gt;{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;发生变化&#34;</span><span class="o">);</span>
        <span class="o">});</span>
        <span class="n">observerDemo</span><span class="o">.</span><span class="na">addObserver</span><span class="o">((</span><span class="n">o</span><span class="o">,</span><span class="n">arg</span><span class="o">)-&gt;{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;手动被观察者通知，准备改变&#34;</span><span class="o">);</span>
        <span class="o">});</span>
        <span class="n">observerDemo</span><span class="o">.</span><span class="na">setChanged</span><span class="o">();</span> <span class="c1">//监控数据变化
</span><span class="c1"></span>        <span class="n">observerDemo</span><span class="o">.</span><span class="na">notifyObservers</span><span class="o">();</span> <span class="c1">//通知
</span><span class="c1"></span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>3、响应式编程（Reactor 实现）</p>
<ul>
<li>响应式编程操作中，Reactor 是满足 Reactive 规范框架</li>
<li>Reactor 有两个核心类，Mono 和 Flux，这两个类实现接口 Publisher，提供丰富操作符。Flux对象实现发布者，返回 N个元素；Mono实现发布者，返回 0或者1个元素</li>
<li>Flux和 Mono都是数据流的发布者，使用 Flux和 Mono 都可以发出三种数据信号： <strong>元素值，错误信号，完成信号</strong>，错误信号和完成信号都代表终止信号，终止信号用于告诉订阅者数据流结束了，错误信号终止数据流同时把错误信息传递给订阅者</li>
<li>代码演示 Flux 和 Mono</li>
</ul>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2021-10-29</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="https://cloverfelix.github.io/spring5/" data-title="Spring5" data-hashtags="Spring"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="https://cloverfelix.github.io/spring5/" data-hashtag="Spring"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Hacker News" data-sharer="hackernews" data-url="https://cloverfelix.github.io/spring5/" data-title="Spring5"><i class="fab fa-hacker-news fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Line" data-sharer="line" data-url="https://cloverfelix.github.io/spring5/" data-title="Spring5"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@2.14.0/icons/line.svg"></i></a><a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="https://cloverfelix.github.io/spring5/" data-title="Spring5"><i class="fab fa-weibo fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/spring/">Spring</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/springcloud/" class="prev" rel="prev" title="Springcloud"><i class="fas fa-angle-left fa-fw"></i>Springcloud</a>
            <a href="/springboot2/" class="next" rel="next" title="Springboot2">Springboot2<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Clover</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/css/lightgallery.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/algoliasearch@4.2.0/dist/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/js/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.2.0/dist/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":10},"comment":{},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"search":{"algoliaAppID":"QEH6MSAUGD","algoliaIndex":"blog","algoliaSearchKey":"83e0e9a01bb86efaff215298300450e1","highlightTag":"em","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"algolia"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
