<!DOCTYPE html>
<html lang="zh-cn">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>React - clover</title><meta name="Description" content="React"><meta property="og:title" content="React" />
<meta property="og:description" content="React" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cloverfelix.github.io/react/" /><meta property="og:image" content="https://cloverfelix.github.io/RW.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-10-02T09:48:23&#43;08:00" />
<meta property="article:modified_time" content="2021-10-02T09:48:23&#43;08:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://cloverfelix.github.io/RW.png"/>

<meta name="twitter:title" content="React"/>
<meta name="twitter:description" content="React"/>
<meta name="application-name" content="Clover">
<meta name="apple-mobile-web-app-title" content="Clover"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://cloverfelix.github.io/react/" /><link rel="prev" href="https://cloverfelix.github.io/dockerdeploy/" /><link rel="next" href="https://cloverfelix.github.io/reactexpand/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "React",
        "inLanguage": "zh-cn",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/cloverfelix.github.io\/react\/"
        },"image": ["https:\/\/cloverfelix.github.io\/images\/Apple-Devices-Preview.png"],"genre": "posts","keywords": "React","wordcount":  94889 ,
        "url": "https:\/\/cloverfelix.github.io\/react\/","datePublished": "2021-10-02T09:48:23+08:00","dateModified": "2021-10-02T09:48:23+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "clover","logo": "https:\/\/cloverfelix.github.io\/images\/RW.png"},"author": {
                "@type": "Person",
                "name": "Clover"
            },"description": "React"
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="clover"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span>Clover</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 所有文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><a class="menu-item" href="/about/"> 关于 </a><a class="menu-item" href="https://github.com/cloverfelix" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="clover"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span>Clover</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">所有文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a class="menu-item" href="/about/" title="">关于</a><a class="menu-item" href="https://github.com/cloverfelix" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">React</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Clover</a></span>&nbsp;<span class="post-category">收录于 <a href="/categories/react/"><i class="far fa-folder fa-fw"></i>React</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2021-10-02">2021-10-02</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 94889 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 190 分钟&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#注意事项">注意事项:</a></li>
    <li><a href="#1定义">1.定义</a></li>
    <li><a href="#2特点">2.特点</a></li>
    <li><a href="#3上手">3.上手</a>
      <ul>
        <li><a href="#31-依赖包">3.1 依赖包</a></li>
        <li><a href="#32-第一个项目">3.2 第一个项目</a></li>
        <li><a href="#33-创建虚拟dom的两种方式">3.3 创建虚拟dom的两种方式</a></li>
        <li><a href="#34-什么是虚拟dom">3.4 什么是虚拟dom</a></li>
        <li><a href="#35-jsx">3.5 jsx</a></li>
        <li><a href="#36-jsx语法规则">3.6 jsx语法规则</a></li>
        <li><a href="#37-jsx小练习遍历">3.7 jsx小练习（遍历）</a></li>
        <li><a href="#38-复习">3.8 复习</a>
          <ul>
            <li><a href="#1类的基本知识">1.类的基本知识</a></li>
            <li><a href="#2原生js的事件绑定">2.原生js的事件绑定</a></li>
            <li><a href="#3类中的方法this">3.类中的方法this</a></li>
            <li><a href="#4函数的bind方法">4.函数的bind方法</a></li>
            <li><a href="#５展开运算符">５.展开运算符</a></li>
            <li><a href="#6scrollheight">6.scrollHeight</a></li>
            <li><a href="#7修改对象属性返回新对象">7.修改对象属性，返回新对象</a></li>
            <li><a href="#8reduce数组条件计数">8.reduce数组条件计数</a></li>
            <li><a href="#9多选框checked和defaultchecked">9.多选框checked和defaultChecked</a></li>
            <li><a href="#10结构赋值">10.结构赋值</a></li>
            <li><a href="#11单引号和反引号的区别">11.单引号和反引号的区别</a></li>
            <li><a href="#12-qs键值对与urlencoded之间的转换">12 qs：键值对与urlencoded之间的转换</a></li>
          </ul>
        </li>
        <li><a href="#38-模块与组件">3.8 模块与组件</a>
          <ul>
            <li><a href="#1函数式组件">1.函数式组件</a></li>
            <li><a href="#2类式组件">2.类式组件</a></li>
          </ul>
        </li>
        <li><a href="#39--组件实例的三大核心属性">3.9  <strong>组件实例</strong>的三大核心属性</a>
          <ul>
            <li><a href="#391-state">3.9.1 state</a>
              <ul>
                <li><a href="#1初始化state">1.初始化state</a></li>
                <li><a href="#2react事件绑定">2.react事件绑定</a></li>
                <li><a href="#3类组件中方法中的this">3.类组件中方法中的this</a></li>
                <li><a href="#4用bind解决类组件中方法中的this指向问题">4.用bind解决类组件中方法中的this指向问题</a></li>
                <li><a href="#5setstate的使用">5.setState的使用</a></li>
                <li><a href="#6优化代码箭头函数">6.优化代码（箭头函数）</a></li>
                <li><a href="#7state总结">7.state总结</a></li>
              </ul>
            </li>
            <li><a href="#392-props">3.9.2 props</a>
              <ul>
                <li><a href="#1props基本使用">1.props基本使用</a></li>
                <li><a href="#2批量传递props">2.批量传递props</a></li>
                <li><a href="#3对props属性进行限制">3.对props属性进行限制</a></li>
                <li><a href="#4props简写">4.props简写</a></li>
                <li><a href="#5构造函数与props">5，构造函数与props</a></li>
                <li><a href="#6_函数式组件使用props">6_函数式组件使用props</a></li>
                <li><a href="#7_props总结">7_props总结</a></li>
              </ul>
            </li>
            <li><a href="#393-refs">3.9.3 refs</a>
              <ul>
                <li><a href="#1字符串形式的ref">1.字符串形式的ref</a></li>
                <li><a href="#2回调函数形式的ref"><strong>2.回调函数形式的ref</strong></a></li>
                <li><a href="#3_回调ref中回调函数调用次数的问题">3_回调ref中回调函数调用次数的问题</a></li>
                <li><a href="#4createref">4.createRef</a></li>
                <li><a href="#5eventtarget--省略ref">5.event.target  省略ref</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#310-react中的事件绑定">3.10 react中的事件绑定</a></li>
        <li><a href="#311-react中收集表单数据">3.11 react中收集表单数据</a>
          <ul>
            <li><a href="#1非受控组件">1.非受控组件</a></li>
            <li><a href="#2受控组件">2.受控组件</a></li>
          </ul>
        </li>
        <li><a href="#312-高阶函数_函数柯里化">3.12 高阶函数_函数柯里化</a>
          <ul>
            <li><a href="#1用函数柯里化">1.用函数柯里化</a></li>
            <li><a href="#2不用函数柯里化">2.不用函数柯里化</a></li>
          </ul>
        </li>
        <li><a href="#313-组件的生命周期旧">3.13 组件的生命周期（旧）</a>
          <ul>
            <li><a href="#1引出生命周期错误示范">1.引出生命周期(错误示范)</a></li>
            <li><a href="#2引出生命周期">2.引出生命周期</a></li>
            <li><a href="#3组件挂载流程">3.组件挂载流程</a></li>
            <li><a href="#4组件正常更新流程">4.组件正常更新流程</a></li>
            <li><a href="#5组件强制更新流程">5.组件强制更新流程</a></li>
            <li><a href="#6父组件render流程">6.父组件render流程</a></li>
            <li><a href="#7总结">7.总结</a></li>
          </ul>
        </li>
        <li><a href="#314-组件的生命周期新">3.14 组件的生命周期（新）</a>
          <ul>
            <li><a href="#1getderivedstatefromprops">1.getDerivedStateFromProps</a></li>
            <li><a href="#2getsnapshotbeforeupdate">2.getSnapshotBeforeUpdate</a></li>
            <li><a href="#3getsnapshotbeforeupdate场景">3.getSnapshotBeforeUpdate场景</a></li>
          </ul>
        </li>
        <li><a href="#4总结">4.总结</a></li>
        <li><a href="#315-dom的ditting算法">3.15 Dom的ditting算法</a>
          <ul>
            <li><a href="#1引出ditting">1.引出ditting</a></li>
            <li><a href="#2key的作用1">2.key的作用(1)</a></li>
            <li><a href="#3key的作用2">3.key的作用(2)</a></li>
            <li><a href="#4总结-1">4.总结</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#4初始化react脚手架">4.初始化react脚手架</a>
      <ul>
        <li><a href="#1什么叫脚手架">1.什么叫脚手架</a></li>
        <li><a href="#2初始化脚手架">2.初始化脚手架</a></li>
      </ul>
    </li>
    <li><a href="#5react脚手架项目结构">5.react脚手架项目结构</a></li>
    <li><a href="#6分别暴露和默认暴露">6.分别暴露和默认暴露</a></li>
    <li><a href="#7一个简单的hello组件">7.一个简单的hello组件</a></li>
    <li><a href="#8样式模块化">8.样式模块化</a></li>
    <li><a href="#9-react插件及快捷键">9. react插件及快捷键</a></li>
    <li><a href="#9功能界面的组件化编码流程">9.功能界面的组件化编码流程</a></li>
    <li><a href="#10todolist案例">10.TodoList案例</a>
      <ul>
        <li><a href="#1静态组件">1.静态组件</a></li>
        <li><a href="#2动态添加列表">2.动态添加列表</a></li>
        <li><a href="#3添加todo">3.添加todo</a></li>
        <li><a href="#4鼠标移入效果">4.鼠标移入效果</a></li>
        <li><a href="#5勾选时改变状态中的对象属性值">5.勾选时改变状态中的对象属性值</a></li>
        <li><a href="#6对props限制">6.对props限制</a></li>
        <li><a href="#7删除一个todo">7.删除一个todo</a></li>
        <li><a href="#8实现底部功能">8.实现底部功能</a></li>
        <li><a href="#9todolist总结">9.todolist总结</a></li>
      </ul>
    </li>
    <li><a href="#11脚手架配置代理">11.脚手架配置代理</a>
      <ul>
        <li><a href="#1理解">1.理解</a></li>
        <li><a href="#2例子">2.例子</a></li>
        <li><a href="#3配置代理">3.配置代理</a></li>
      </ul>
    </li>
    <li><a href="#12github搜索案例">12.github搜索案例</a>
      <ul>
        <li><a href="#1静态组件-1">1.静态组件</a></li>
        <li><a href="#2axios发送请求">2.axios发送请求</a></li>
        <li><a href="#3展示数据">3.展示数据</a></li>
        <li><a href="#4完善案例">4.完善案例</a></li>
      </ul>
    </li>
    <li><a href="#13消息订阅与发布">13.消息订阅与发布</a>
      <ul>
        <li><a href="#1优化github搜索案例">1.优化github搜索案例</a></li>
      </ul>
    </li>
    <li><a href="#14fetch发送请求">14.fetch发送请求</a></li>
    <li><a href="#15路由">15.路由</a>
      <ul>
        <li><a href="#151-spa">15.1 SPA</a></li>
        <li><a href="#152-对路由的理解">15.2 对路由的理解</a></li>
        <li><a href="#153-路由原理history">15.3 路由原理history</a></li>
        <li><a href="#154-react-router-dom理解">15.4 react-router-dom理解</a></li>
        <li><a href="#155-路由的基本使用">15.5 路由的基本使用</a></li>
        <li><a href="#156-路由组件与一般组件">15.6 路由组件与一般组件</a></li>
        <li><a href="#157-navlink的使用高亮">15.7 NavLink的使用（高亮）</a></li>
        <li><a href="#158-二次封装navlink">15.8 二次封装NavLink</a></li>
        <li><a href="#159-switch">15.9 Switch</a></li>
        <li><a href="#1510-解决样式丢失问题">15.10 解决样式丢失问题</a></li>
        <li><a href="#1511-路由的模糊匹配和严格匹配">15.11 路由的模糊匹配和严格匹配</a></li>
        <li><a href="#1512-redirect重定向">15.12 Redirect重定向</a></li>
        <li><a href="#1513-嵌套路由">15.13 嵌套路由</a></li>
        <li><a href="#1514-向路由组件传递参数params数据">15.14 向路由组件传递参数params数据</a></li>
        <li><a href="#1515-向路由器传递参数search数据">15.15 向路由器传递参数search数据</a></li>
        <li><a href="#1516-向路由组件传递state参数">15.16 向路由组件传递state参数</a></li>
        <li><a href="#1517push与replace">15.17push与replace</a></li>
        <li><a href="#1518-编程式路由导航">15.18 编程式路由导航</a></li>
        <li><a href="#1519-withrouter使用">15.19 withRouter使用</a></li>
        <li><a href="#1520-browserrouter和hashrouter的区别">15.20 BrowserRouter和HashRouter的区别</a></li>
      </ul>
    </li>
    <li><a href="#16-antd">16. antd</a>
      <ul>
        <li><a href="#161-antd的基本使用">16.1 antd的基本使用</a></li>
        <li><a href="#162-antd样式的按需引入">16.2 antd样式的按需引入</a></li>
        <li><a href="#163-antd自定义主题">16.3 antd自定义主题</a></li>
      </ul>
    </li>
    <li><a href="#17-redux">17. redux</a>
      <ul>
        <li><a href="#171-redux简介">17.1 redux简介</a></li>
        <li><a href="#172-redux工作流程">17.2 redux工作流程</a></li>
        <li><a href="#173-求和案例">17.3 求和案例</a>
          <ul>
            <li><a href="#1-纯react版">1. 纯react版</a></li>
            <li><a href="#2-精简版的redux">2. 精简版的redux</a></li>
            <li><a href="#3-完整版的redux">3. 完整版的redux</a></li>
            <li><a href="#4异步action">4.异步action</a></li>
          </ul>
        </li>
        <li><a href="#174-react-redux理解">17.4 react-redux理解</a>
          <ul>
            <li><a href="#1-连接容器组件与ui组件">1. 连接容器组件与UI组件</a></li>
            <li><a href="#2react-redux的基本使用">2.react-redux的基本使用</a></li>
            <li><a href="#3总结">3.总结</a></li>
            <li><a href="#4mapdispatchtoprops精简版">4.mapDispatchToProps精简版</a></li>
            <li><a href="#5provider组件的使用">5.Provider组件的使用</a></li>
            <li><a href="#6整合ui组件和容器组件">6.整合UI组件和容器组件</a></li>
            <li><a href="#7优化react-redux总结">7.优化react-redux总结</a></li>
          </ul>
        </li>
        <li><a href="#175-数据共享">17.5 数据共享</a></li>
        <li><a href="#176-纯函数">17.6 纯函数</a></li>
        <li><a href="#177-redux开发者工具">17.7 redux开发者工具</a></li>
        <li><a href="#178-最终版">17.8 最终版</a></li>
        <li><a href="#179-项目打包运行">17.9 项目打包运行</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>React</p>
<h2 id="注意事项">注意事项:</h2>
<ol>
<li>使用脚手架创建react项目后，运行项目只认名为src目录，如果修改了src的目录文件名，那么运行时就找不到src目录。</li>
<li>react中内联样式的写法：style={{xxx:xxx}}，注意不是变量的要加引号</li>
<li>react中标签上的class用的是className</li>
<li>react中不能直接渲染一个对象到页面，可以展示对象的某个属性</li>
<li>github搜索案例中的index.html引入了第三方样式bootstrap.css，所以如果运行其他例子的时候，需要讲那一行代码注释掉，否则会出现样式问题</li>
<li>修改react脚手架项目的src文件名前，记得先终止项目运行</li>
</ol>
<h2 id="1定义">1.定义</h2>
<p>是将<strong>数据</strong>渲染为<strong>html视图</strong>的开源js库</p>
<h2 id="2特点">2.特点</h2>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100556.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100556.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100556.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100556.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100556.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100556.png" /></p>
<p>解释react的虚拟dom应用：</p>
<ul>
<li>原来的纯js，每次更新数据，之前所有的数据全部报废，然后又重新加载一遍全部数据。比如原来往真实dom中存放100个人，后来又新加了一个人，相当于原来100个人全作废，又重新加载一遍这101个人，存入真实dom</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100611.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100611.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100611.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100611.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100611.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100611.png" /></p>
<ul>
<li>react，虚拟dom会进行<strong>新旧虚拟dom比较</strong>（比较的最小力度是节点），如果是相同的，那么在真实dom中直接采用，而不会重新加载一遍，不用所有数据都重来，解决js重排重绘问题</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100625.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100625.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100625.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100625.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100625.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100625.png" /></p>
<h2 id="3上手">3.上手</h2>
<h3 id="31-依赖包">3.1 依赖包</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100659.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100659.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100659.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100659.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100659.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100659.png" /></p>
<ul>
<li>
<p>babel：</p>
<ol>
<li>将ES6转为ES5</li>
<li>将jsx转为js（react写的是jsx）</li>
</ol>
</li>
<li>
<p>react.development：</p>
<p>核心库，一旦引入就有一个对象React</p>
</li>
<li>
<p>react.dom.development</p>
<p>扩展库：支持react操作dom，一旦引入就有一个ReactDOM对象</p>
</li>
</ul>
<h3 id="32-第一个项目">3.2 第一个项目</h3>
<ol>
<li>
<p>准备好一个容器</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>引入库</p>
<p>顺序要求：核心库要比扩展库先引入</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>创建虚拟dom</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html">// 步骤三：创建虚拟dom 
// 此处一定不要写引号，因为不是字符串，jsx中标签和js可以混写
const VDOM=<span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>hello,react<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>渲染虚拟dom到页面</p>
<p>render：是替换，不是追加，所以如果再渲染一个虚拟DOM，那么之前的会被替换</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html">// 步骤四：渲染虚拟dom到页面中，第一个参数是虚拟dom，第二个参数是容器。由于react不支持选择器的写法，所以需要操作手动获取结点
   
ReactDOM.render(VDOM,document.getElementById(&#39;test&#39;))
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100821.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100821.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100821.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100821.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100821.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100821.png" /></p>
<h3 id="33-创建虚拟dom的两种方式">3.3 创建虚拟dom的两种方式</h3>
<ol>
<li>
<p>js创建</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 步骤一：创建一个容器 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 步骤二：引入库，不需要babel库了，因为写的是js不是jsx，不需要转换 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 表示写的是js --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span><span class="p">&gt;</span>
        <span class="c1">// 步骤三：创建虚拟dom 
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">VDOM</span><span class="o">=</span><span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">,{</span><span class="nx">id</span><span class="o">:</span><span class="s1">&#39;title&#39;</span><span class="p">},</span><span class="s1">&#39;hello,react,02&#39;</span><span class="p">)</span>
        <span class="c1">// 步骤四：渲染虚拟dom到页面中,第一个参数是虚拟dom，第二个参数是容器
</span><span class="c1"></span>        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="nx">VDOM</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">))</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100857.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100857.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100857.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100857.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100857.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100857.png" /></p>
<ol start="2">
<li>
<p>jsx创建</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 步骤一：创建一个容器 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 步骤二：引入库 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 表示写的是jsx，用babel转换 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="c1">// 步骤三：创建虚拟dom 
</span><span class="c1"></span>        <span class="c1">// 此处一定不要写引号，因为不是字符串，如果要将html代码以格式化的方式写，就加一个()
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">VDOM</span><span class="o">=</span><span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">span</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&#34;test&#34;</span><span class="o">&gt;</span><span class="nx">hello</span><span class="p">,</span><span class="nx">react</span><span class="p">,</span><span class="mi">02</span><span class="o">&lt;</span><span class="err">/span&gt;</span>
            <span class="o">&lt;</span><span class="err">/h1&gt;</span>
            <span class="p">)</span>
        <span class="c1">// 步骤四：渲染虚拟dom到页面中,第一个参数是虚拟dom，第二个参数是容器
</span><span class="c1"></span>        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="nx">VDOM</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">))</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100916.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100916.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100916.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100916.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100916.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100916.png" /></p>
<p>jsx是解决用原生js创建虚拟dom太繁琐的问题，jsx是js的语法糖，babel就是将jsx翻译成浏览器认识的js</p>
<h3 id="34-什么是虚拟dom">3.4 什么是虚拟dom</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"> <span class="c">&lt;!-- 步骤一：创建一个容器 --&gt;</span>
     <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;demo&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
     <span class="c">&lt;!-- 步骤二：引入库 --&gt;</span>
     <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
     <span class="c">&lt;!-- 表示写的是jsx，用babel转换 --&gt;</span>
     <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
         <span class="c1">// 步骤三：创建虚拟dom 
</span><span class="c1"></span>         <span class="c1">// 此处一定不要写引号，因为不是字符串
</span><span class="c1"></span>         <span class="kr">const</span> <span class="nx">VDOM</span><span class="o">=&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">hello</span><span class="p">,</span><span class="nx">react</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
         <span class="c1">// 步骤四：渲染虚拟dom到页面中,第一个参数是虚拟dom，第二个参数是容器
</span><span class="c1"></span>         <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="nx">VDOM</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">))</span>



         <span class="c1">//什么是vdom和tdom
</span><span class="c1"></span>         <span class="kr">const</span> <span class="nx">TDOM</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;demo&#39;</span><span class="p">)</span>
         <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;VDOM&#39;</span><span class="p">,</span><span class="nx">VDOM</span><span class="p">)</span>
         <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;TDOM&#34;</span><span class="p">,</span><span class="nx">TDOM</span><span class="p">)</span>
     <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100949.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100949.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100949.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100949.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100949.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002100949.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101030.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101030.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101030.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101030.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101030.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101030.png" /></p>
<h3 id="35-jsx">3.5 jsx</h3>
<p>xml和json写法</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101044.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101044.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101044.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101044.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101044.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101044.png" /></p>
<p>jsx</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101101.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101101.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101101.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101101.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101101.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101101.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101115.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101115.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101115.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101115.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101115.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101115.png" /></p>
<h3 id="36-jsx语法规则">3.6 jsx语法规则</h3>
<ol>
<li>
<p>定义虚拟dom时不要加引号，直接写html标签</p>
</li>
<li>
<p>如果标签中嵌套<strong>js表达式</strong>（不是js语句、代码），需要用{}引起来</p>
<ul>
<li>
<p>js语句（代码）：if(){}、for(){}、switch(){case:}</p>
</li>
<li>
<p>js表达式：一个表达式会产生一个值，可以放在任何一个需要值的地方，如：a、a+b、fun(1)、arr.map()。包括function test (){}也算表达式，因为用const a=function test (){}返回的就是一个函数，也有返回值。即表达式的结果一定是一个值</p>
</li>
</ul>
</li>
<li>
<p>样式的类名不要用class，而用className。因为ES6中：class是关键字（外部样式中）</p>
</li>
<li>
<p>内联样式：需要用style={{key:value,key:value}}的形式去写</p>
<ul>
<li>
<p>外面的大括号表示里面写的是js，里面的大括号表示写的是一个对象</p>
</li>
<li>
<p>key需要遵守驼峰原则，比如js中的font-size，在jsx中就是fontSize。</p>
</li>
<li>
<p>value要用‘ ’引起来，因为不是一个变量</p>
</li>
</ul>
</li>
<li>
<p>虚拟DOM必须只有一个根标签</p>
</li>
<li>
<p>标签必须闭合</p>
</li>
<li>
<p>标签首字母：</p>
<ul>
<li>若小写字母开头，则将改标签转为html中同名元素，若html中无同名元素，就报错</li>
<li>若是大写字母开头，react则去渲染对应的组件，若组件没有定义，则报错</li>
</ul>
</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>jsx语法规则<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 步骤一：创建一个容器 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
        <span class="p">.</span><span class="nc">hhh</span><span class="p">{</span><span class="k">background</span><span class="p">:</span><span class="kc">peru</span><span class="p">;}</span>
    <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>

    <span class="c">&lt;!-- 步骤二：引入库 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="c">&lt;!-- 表示写的是jsx，用babel转换 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
    
        <span class="kr">const</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&#34;tESt&#34;</span>
        <span class="kr">const</span> <span class="nx">child</span><span class="o">=</span><span class="s2">&#34;HeLlo,rEacT,02&#34;</span>

        <span class="c1">// 步骤三：创建虚拟dom 
</span><span class="c1"></span>        <span class="c1">// 此处一定不要写引号，因为不是字符串，如果要将html代码格式化，就加一个()
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">VDOM</span><span class="o">=</span><span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">span</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;hhh&#34;</span> <span class="nx">style</span><span class="o">=</span><span class="p">{{</span><span class="nx">fontSize</span><span class="o">:</span><span class="s1">&#39;30px&#39;</span><span class="p">,</span><span class="nx">color</span><span class="o">:</span><span class="s1">&#39;white&#39;</span><span class="p">}}</span> <span class="nx">id</span><span class="o">=</span><span class="p">{</span><span class="nx">id</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">child</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()}</span><span class="o">&lt;</span><span class="err">/span&gt;</span>
                <span class="o">&lt;</span><span class="err">/h1&gt;</span>
                <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
            <span class="p">)</span>

        <span class="c1">// 步骤四：渲染虚拟dom到页面中,第一个参数是虚拟dom，第二个参数是容器
</span><span class="c1"></span>        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="nx">VDOM</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">))</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101135.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101135.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101135.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101135.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101135.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101135.png" /></p>
<h3 id="37-jsx小练习遍历">3.7 jsx小练习（遍历）</h3>
<p>注意：</p>
<ol>
<li>
<p>{}中只能写js表达式，即有返回值的。不能写for这种js语句</p>
</li>
<li>
<p>页面中遍历出来的每一个child结点都必须要有一个唯一key属性，如：如果单个单个写出的li，浏览器会自动给加上。但是如果是遍历出来的li，就必须显示为每个结点添加唯一key属性</p>
</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>example<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 步骤一：创建一个容器 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
        <span class="p">.</span><span class="nc">dd</span><span class="p">{</span>
            <span class="k">font-size</span><span class="p">:</span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 步骤二：引入库 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 表示写的是jsx，用babel转换 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">const</span> <span class="nx">dt</span><span class="o">=</span><span class="s2">&#34;前端js框架列表&#34;</span>
        <span class="kr">const</span> <span class="nx">dd</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;vue&#34;</span><span class="p">,</span><span class="s2">&#34;react&#34;</span><span class="p">,</span><span class="s2">&#34;angular&#34;</span><span class="p">]</span>
        <span class="kr">const</span> <span class="nx">VDOM</span><span class="o">=</span><span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">dt</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
                <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
                    <span class="p">{</span>
                        <span class="c1">// 由于{}中只能是js表达式，所以这里用处理数组的方式遍历dd数组
</span><span class="c1"></span>                        <span class="nx">dd</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">item</span><span class="p">,</span><span class="nx">index</span><span class="p">)=&gt;{</span>
                            <span class="c1">// 给li设置key的值为每一个item的index，注意取值时加{}
</span><span class="c1"></span>                            <span class="k">return</span> <span class="o">&lt;</span><span class="nx">li</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">index</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">item</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;;</span>
                        <span class="p">})</span>
                    <span class="p">}</span>
                <span class="o">&lt;</span><span class="err">/ul&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="nx">VDOM</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">))</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101148.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101148.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101148.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101148.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101148.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101148.png" /></p>
<h3 id="38-复习">3.8 复习</h3>
<h4 id="1类的基本知识">1.类的基本知识</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101204.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101204.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101204.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101204.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101204.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101204.png" /></p>
<ul>
<li>类中定义的方法都是放在了类的原型对象上，所有类实例共用的。但是类中构造器中的属性或方法，是实例自身的，不是公用的</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>类的基本知识<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
        <span class="c">&lt;!-- 步骤二：引入库 --&gt;</span>
        <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span><span class="p">&gt;</span>
            <span class="kr">class</span> <span class="nx">Person</span> <span class="p">{</span>

                <span class="c1">// 构造器方法
</span><span class="c1"></span>                <span class="nx">constructor</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="nx">age</span><span class="p">){</span>
                    <span class="c1">// this指的是类的实例对象
</span><span class="c1"></span>                    <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="o">=</span><span class="nx">name</span><span class="p">;</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">age</span><span class="o">=</span><span class="nx">age</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="c1">// 一般方法
</span><span class="c1"></span>                <span class="nx">speak</span><span class="p">(){</span>
                    <span class="c1">//通过Person实例调用的，那么this就指向Person实例
</span><span class="c1"></span>                    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;我叫：&#39;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="o">+</span><span class="s1">&#39; 我的年龄是：&#39;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">age</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="kr">class</span> <span class="nx">Student</span> <span class="kr">extends</span> <span class="nx">Person</span><span class="p">{</span>
                <span class="c1">//要么不写构造器，那么会自动继承父类的构造器
</span><span class="c1"></span>                <span class="nx">constructor</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="nx">age</span><span class="p">,</span><span class="nx">grade</span><span class="p">){</span>
                    <span class="c1">//如果写了构造器，必须要用super()继承父类的构造器，并且super顺序一定要排在第一
</span><span class="c1"></span>                    <span class="kr">super</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="nx">age</span><span class="p">);</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">grade</span><span class="o">=</span><span class="nx">grade</span><span class="p">;</span>
                    <span class="c1">// 这表示每一个实例对象中都有一个属性school，不需要传参，默认有
</span><span class="c1"></span>                    <span class="k">this</span><span class="p">.</span><span class="nx">school</span><span class="o">=</span><span class="s1">&#39;尚硅谷&#39;</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="c1">// 重写父类中的speak方法
</span><span class="c1"></span>                <span class="nx">speak</span><span class="p">(){</span>
                    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;我叫：&#39;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="o">+</span><span class="s1">&#39; 我的年龄是：&#39;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">age</span><span class="o">+</span><span class="s1">&#39; 我读的年级是：&#39;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">grade</span><span class="p">);</span>
                <span class="p">}</span>

                <span class="c1">//子类自己的方法
</span><span class="c1"></span>                <span class="nx">study</span><span class="p">(){</span>
                    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;我很爱学习&#39;</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="c1">// 创建一个Person的实例对象
</span><span class="c1"></span>            <span class="kr">const</span> <span class="nx">p1</span><span class="o">=</span><span class="k">new</span> <span class="nx">Person</span><span class="p">(</span><span class="s1">&#39;憨憨&#39;</span><span class="p">,</span><span class="mi">12</span><span class="p">);</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">p1</span><span class="p">);</span> <span class="c1">//输出的格式是：类名{属性：属性值，属性：属性值}
</span><span class="c1"></span>            <span class="nx">p1</span><span class="p">.</span><span class="nx">speak</span><span class="p">();</span> <span class="c1">//p1对象调用类中的speak()方法，那么方法中的this指向的是p1对象
</span><span class="c1"></span>
            <span class="c1">//创建一个Student的实例对象
</span><span class="c1"></span>            <span class="kr">const</span> <span class="nx">s1</span><span class="o">=</span><span class="k">new</span> <span class="nx">Student</span><span class="p">(</span><span class="s1">&#39;小学生&#39;</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="s1">&#39;一年级&#39;</span><span class="p">);</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">s1</span><span class="p">);</span>
            <span class="nx">s1</span><span class="p">.</span><span class="nx">speak</span><span class="p">();</span>
            <span class="nx">s1</span><span class="p">.</span><span class="nx">study</span><span class="p">();</span>
            
            
             <span class="c1">// -------------------直接在类中写赋值语句-----------------------------------
</span><span class="c1"></span>            <span class="kr">class</span> <span class="nx">Car</span><span class="p">{</span>
                <span class="nx">constructor</span><span class="p">(){</span>
                    <span class="c1">// 表示往每一个对象中添加一个固定的属性wheel，且固定为4
</span><span class="c1"></span>                    <span class="k">this</span><span class="p">.</span><span class="nx">wheel</span><span class="o">=</span><span class="mi">4</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="c1">// 也表示往每一个对象中添加一个固定的属性a，且值为1。应用场景：当要往每一个对象中添加一个固定值的属性时，可以直接用这种赋值语句，不需要写构造函数
</span><span class="c1"></span>                <span class="nx">a</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">}</span>

            <span class="kr">const</span> <span class="nx">c1</span><span class="o">=</span><span class="k">new</span> <span class="nx">Car</span><span class="p">();</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">c1</span><span class="p">);</span>
        <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101221.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101221.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101221.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101221.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101221.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101221.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101233.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101233.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101233.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101233.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101233.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101233.png" /></p>
<h4 id="2原生js的事件绑定">2.原生js的事件绑定</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>原生js的事件绑定<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">button</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&#34;fun()&#34;</span><span class="p">&gt;</span>按钮1<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span><span class="p">&gt;</span>
        <span class="kd">function</span> <span class="nx">fun</span><span class="p">(){</span>
            <span class="nx">alert</span><span class="p">(</span><span class="s2">&#34;按钮被点击了&#34;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101249.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101249.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101249.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101249.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101249.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101249.png" /></p>
<h4 id="3类中的方法this">3.类中的方法this</h4>
<p>类中的方法，在js中默认开启了局部严格模式。所以类中的方法:</p>
<ul>
<li>
<p>如果以对象实例调用的，那么this就指向对象实例。</p>
</li>
<li>
<p>如果是以函数形式调用的，那么this原本应该指向window，但是由于类中的方法默认开启了严格模式，严格模式不允许函数形式调用的方法中的this指向window，所以如果类中的方法是以函数形式调用的，this就是undefined</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-HTML" data-lang="HTML"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>类中的方法this指向<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">People</span><span class="p">{</span>
            <span class="nx">constructor</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="nx">age</span><span class="p">){</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="o">=</span><span class="nx">name</span><span class="p">;</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">age</span><span class="o">=</span><span class="nx">age</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">speak</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="kr">const</span> <span class="nx">p1</span><span class="o">=</span><span class="k">new</span> <span class="nx">People</span><span class="p">(</span><span class="s1">&#39;哈哈&#39;</span><span class="p">,</span><span class="mi">12</span><span class="p">);</span>
        <span class="c1">// 由对象实例调用的speak()方法，那么speak()方法中的this指向类实例对象
</span><span class="c1"></span>        <span class="nx">p1</span><span class="p">.</span><span class="nx">speak</span><span class="p">();</span>

        <span class="c1">// 将p1对象的speak方法赋值给x，那么x()就表示以函数的方式调用的，那么this就指向window
</span><span class="c1"></span>        <span class="c1">// 但是js默认在类中的方法中开启局部严格模式，严格模式是不允许函数形式调用的方法中的this指向window，所以这里的this是undefined
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">x</span><span class="o">=</span><span class="nx">p1</span><span class="p">.</span><span class="nx">speak</span><span class="p">;</span>
        <span class="nx">x</span><span class="p">();</span>

        <span class="kd">function</span> <span class="nx">test1</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="c1">// js中的函数没有开启严格模式，所以这里的this指向的是window
</span><span class="c1"></span>        <span class="nx">test1</span><span class="p">();</span>

        <span class="kd">function</span> <span class="nx">test2</span><span class="p">()</span> <span class="p">{</span>
            <span class="c1">// 手动开启严格模式
</span><span class="c1"></span>            <span class="s1">&#39;use strict&#39;</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="c1">// 由于严格模式中不允许函数形式调用的方法中的this指向window，所以这里的this是undefined
</span><span class="c1"></span>        <span class="nx">test2</span><span class="p">();</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101308.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101308.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101308.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101308.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101308.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101308.png" /></p>
<h4 id="4函数的bind方法">4.函数的bind方法</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>函数的bind方法<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span><span class="p">&gt;</span>
        <span class="kd">function</span> <span class="nx">demo</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// 非严格模式下，函数调用的方法中的this指向window
</span><span class="c1"></span>        <span class="nx">demo</span><span class="p">();</span>

        <span class="c1">// 意思是：调用demo函数的bind方法，返回一个新函数，并且指定这个新函数的this指向的是{a:1,b:2}这个对象（函数体还是跟demo一样，但是this 指向不一样了）
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">a</span><span class="o">=</span><span class="nx">demo</span><span class="p">.</span><span class="nx">bind</span><span class="p">({</span><span class="nx">a</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">b</span><span class="o">:</span><span class="mi">2</span><span class="p">});</span>
        <span class="c1">// 调用这个新函数
</span><span class="c1"></span>        <span class="nx">a</span><span class="p">();</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101323.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101323.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101323.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101323.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101323.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101323.png" /></p>
<h4 id="５展开运算符">５.展开运算符</h4>
<ol>
<li>展开数组：&hellip;数组</li>
<li>连接数组：[&hellip;数组1,&hellip;数组2]</li>
<li>函数传参，批量接收参数，将所有参数封装在一个数组中：function(&hellip;参数){}</li>
<li>以字面量形式复制对象：{&hellip;对象}</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>展开运算符<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span><span class="p">&gt;</span>
        <span class="c1">// 1.展开运算符展开数组
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">arr1</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">];</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(...</span><span class="nx">arr1</span><span class="p">);</span>

        <span class="c1">// 2.展开运算符可用于连接两个数组
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">arr2</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">];</span>
        <span class="kr">const</span> <span class="nx">arr3</span><span class="o">=</span><span class="p">[...</span><span class="nx">arr1</span><span class="p">,...</span><span class="nx">arr2</span><span class="p">];</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr3</span><span class="p">);</span>

        <span class="c1">// 3.作为函数传参，批量接收参数，将所有参数封装在一个数组中
</span><span class="c1"></span>        <span class="kd">function</span> <span class="nx">sum</span><span class="p">(...</span><span class="nx">arr</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// 数组中的求和方法：reduce
</span><span class="c1"></span>            <span class="k">return</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">preValue</span><span class="p">,</span><span class="nx">currentValue</span><span class="p">)=&gt;{</span>
                <span class="k">return</span> <span class="nx">preValue</span><span class="o">+</span><span class="nx">currentValue</span>
            <span class="p">})</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">));</span>

        <span class="c1">// 4.展开运算符不能展开对象，但是能以字面量的方式复制一个对象，能达到深度复制的效果。局限是：只能深度复制一层，如果对象中还嵌套了对象，那么复制不到第二层
</span><span class="c1"></span>        <span class="c1">// 注意一定要在外面加{}，这是ES6的语法规范。如果不加，那么 ...对象 表示的是展开一个对象，而展开运算符是不能展开对象的。
</span><span class="c1"></span>        <span class="kr">class</span> <span class="nx">People</span><span class="p">{</span>
            <span class="nx">constructor</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="nx">age</span><span class="p">){</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="o">=</span><span class="nx">name</span><span class="p">;</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">age</span><span class="o">=</span><span class="nx">age</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="kr">const</span> <span class="nx">p1</span><span class="o">=</span><span class="k">new</span> <span class="nx">People</span><span class="p">(</span><span class="s2">&#34;憨憨&#34;</span><span class="p">,</span><span class="s2">&#34;18&#34;</span><span class="p">);</span>

        <span class="c1">// 4.1 深度复制对象方法一：以字面量的形式复制对象。局限是：只能深度复制一层，如果对象中还嵌套了对象，那么复制不到第二层
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">p2</span><span class="o">=</span><span class="p">{...</span><span class="nx">p1</span><span class="p">};</span>
        <span class="c1">// 深度复制对象方法二：先将对象转为字符串，再转为对象
</span><span class="c1"></span>        <span class="c1">// const p2=JSON.parse(JSON.stringify(p1));
</span><span class="c1"></span>        <span class="nx">p1</span><span class="p">.</span><span class="nx">name</span><span class="o">=</span><span class="s2">&#34;修改&#34;</span><span class="p">;</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">p1</span><span class="p">);</span> <span class="c1">// p1被修改
</span><span class="c1"></span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">p2</span><span class="p">);</span> <span class="c1">// p2没有被同步修改
</span><span class="c1"></span>
        <span class="c1">// 4.2 复制的同时修改属性(同名覆盖，不同名就添加)
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">p3</span><span class="o">=</span><span class="p">{...</span><span class="nx">p1</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s2">&#34;对象3&#34;</span><span class="p">,</span><span class="nx">address</span><span class="o">:</span><span class="s2">&#34;大道&#34;</span><span class="p">};</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">p3</span><span class="p">);</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101339.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101339.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101339.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101339.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101339.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101339.png" /></p>
<h4 id="6scrollheight">6.scrollHeight</h4>
<p>只有子元素比父元素高，讨论滚动条才有意义</p>
<p>scrollHeight：代表包括当前不可见部分的元素的高度</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101352.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101352.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101352.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101352.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101352.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101352.png" /></p>
<p>clientHeight：当前可见的高度</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101404.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101404.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101404.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101404.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101404.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101404.png" /></p>
<p>scrollTop：<strong>代表在有滚动条时</strong>，滚动条向下滚动的距离也就是<strong>元素顶部被遮住部分的高度</strong>。在没有滚动条时<code>scrollTop==0</code>恒成立。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101415.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101415.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101415.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101415.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101415.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101415.png" /></p>
<p>offsetTop：与有无滚动条无关。 当前元素顶部距离最近父元素顶部的距离,和有没有滚动条没有关系。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101427.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101427.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101427.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101427.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101427.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101427.png" /></p>
<h4 id="7修改对象属性返回新对象">7.修改对象属性，返回新对象</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>7_修改对象属性，返回新对象<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span>  <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span><span class="p">&gt;</span>
    <span class="c1">// 修改b的值为3
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">p1</span><span class="o">=</span><span class="p">{</span><span class="nx">a</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">b</span><span class="o">:</span><span class="mi">2</span><span class="p">};</span>
        <span class="kr">const</span> <span class="nx">p2</span><span class="o">=</span><span class="p">{...</span><span class="nx">p1</span><span class="p">,</span><span class="nx">b</span><span class="o">:</span><span class="mi">3</span><span class="p">};</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">p1</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">p2</span><span class="p">);</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101445.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101445.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101445.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101445.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101445.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101445.png" /></p>
<h4 id="8reduce数组条件计数">8.reduce数组条件计数</h4>
<p>（10.8用到）</p>
<p>reduce的第一个参数：函数</p>
<ul>
<li>该函数的第一个参数pre：上一次调用函数的返回值</li>
<li>该函数的第二个参数current：当前遍历到的数组项</li>
<li>该函数的返回值：自动赋值给下一次调用函数时的pre，即下一次调用函数的参数pre的值为上一次调用函数的返回值</li>
</ul>
<p>reduce的第二个参数：pre的初始值,，如果不指定则默认为数组中的第一个值，而current就从第二个值开始</p>
<p>reduce返回值：最终累积的pre值</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>8_reduce数组条件计数<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span>  <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span><span class="p">&gt;</span>
        <span class="c1">// 求数组项中对象属性a的值为2的对象个数
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">arr</span><span class="o">=</span><span class="p">[{</span><span class="nx">a</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">b</span><span class="o">:</span><span class="mi">2</span><span class="p">},{</span><span class="nx">a</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span><span class="nx">b</span><span class="o">:</span><span class="mi">2</span><span class="p">},{</span><span class="nx">a</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span><span class="nx">b</span><span class="o">:</span><span class="mi">2</span><span class="p">},{</span><span class="nx">a</span><span class="o">:</span><span class="mi">3</span><span class="p">,</span><span class="nx">b</span><span class="o">:</span><span class="mi">2</span><span class="p">}];</span>
        <span class="kr">const</span> <span class="nx">count</span><span class="o">=</span><span class="nx">arr</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">pre</span><span class="p">,</span><span class="nx">current</span><span class="p">)=&gt;{</span>
            <span class="c1">// 切记：二目运算符中使用三目运算符，是需要加括号的。赋值语句中使用三目运算符，不需要加括号
</span><span class="c1"></span>            <span class="k">return</span> <span class="nx">pre</span> <span class="o">+</span> <span class="p">(</span><span class="nx">current</span><span class="p">.</span><span class="nx">a</span><span class="o">===</span><span class="mi">2</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">},</span><span class="mi">0</span><span class="p">)</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="err">‘</span><span class="nx">数量为</span><span class="err">’</span><span class="p">,</span><span class="nx">count</span><span class="p">);</span>
        
        <span class="c1">// 如果不指定pre初始值，则默认为数组中的第一个值，而current就从第二个值开始
</span><span class="c1"></span>        <span class="kd">function</span> <span class="nx">sum</span><span class="p">(...</span><span class="nx">arr</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// 数组中的求和方法：reduce
</span><span class="c1"></span>            <span class="k">return</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">preValue</span><span class="p">,</span><span class="nx">currentValue</span><span class="p">)=&gt;{</span>
                <span class="k">return</span> <span class="nx">preValue</span><span class="o">+</span><span class="nx">currentValue</span>
            <span class="p">})</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">));</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101458.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101458.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101458.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101458.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101458.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101458.png" /></p>
<h4 id="9多选框checked和defaultchecked">9.多选框checked和defaultChecked</h4>
<p>当多选框没有添加onChange事件时，并且此时的checked值取决于一个变量，那么就没有途径去修改这个变量从而达到修改checked值。所以当没有添加onChange事件时，也不能在标签上设置checked属性</p>
<p>但是可以设置标签的defaultChecked属性：但是该属性的值为它取决的那个变量的初始值，后面无论怎么修改那个变量的值，都不会改变defaultChecked的值。</p>
<h4 id="10结构赋值">10.结构赋值</h4>
<p>(12.2用到)</p>
<p>结构赋值和连续结构赋值</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>9_结构赋值<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span>  <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span><span class="p">&gt;</span>
        <span class="kr">const</span> <span class="nx">p1</span><span class="o">=</span><span class="p">{</span><span class="nx">a</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">b</span><span class="o">:</span><span class="mi">2</span><span class="p">};</span>
        <span class="c1">// 一般获取p对象中的a属性
</span><span class="c1"></span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">p1</span><span class="p">.</span><span class="nx">a</span><span class="p">);</span>
        <span class="c1">// 结构赋值
</span><span class="c1"></span>        <span class="kr">const</span> <span class="p">{</span><span class="nx">a</span><span class="p">}</span><span class="o">=</span><span class="nx">p1</span><span class="p">;</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>

        <span class="c1">// 连续结构赋值
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">p2</span><span class="o">=</span><span class="p">{</span><span class="nx">a</span><span class="o">:</span><span class="p">{</span><span class="nx">b</span><span class="o">:</span><span class="p">{</span><span class="nx">c</span><span class="o">:</span><span class="mi">1</span><span class="p">}}};</span>
        <span class="c1">// 一般拿到p2对象中的c属性
</span><span class="c1"></span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">p2</span><span class="p">.</span><span class="nx">a</span><span class="p">.</span><span class="nx">b</span><span class="p">.</span><span class="nx">c</span><span class="p">);</span>
        <span class="c1">// 连续结构赋值拿到p2对象中的c属性
</span><span class="c1"></span>        <span class="kr">const</span> <span class="p">{</span><span class="nx">a</span><span class="o">:</span><span class="p">{</span><span class="nx">b</span><span class="o">:</span><span class="p">{</span><span class="nx">c</span><span class="p">}}}</span><span class="o">=</span><span class="nx">p2</span><span class="p">;</span>
        <span class="c1">// 但是注意这样写只能拿到c，不能拿到a和b，所以要输出a和b，还是需要p.a  p.a.b
</span><span class="c1"></span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">c</span><span class="p">);</span>

        <span class="c1">// 连续结构赋值并给拿到的属性取别名
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">p3</span><span class="o">=</span><span class="p">{</span><span class="nx">a</span><span class="o">:</span><span class="p">{</span><span class="nx">b</span><span class="o">:</span><span class="mi">1</span><span class="p">}};</span>
        <span class="c1">// 表示拿到了p2中的a对象的b属性，并给b属性取了给别名
</span><span class="c1"></span>        <span class="kr">const</span> <span class="p">{</span><span class="nx">a</span><span class="o">:</span><span class="p">{</span><span class="nx">b</span><span class="o">:</span><span class="nx">hahaha</span><span class="p">}}</span><span class="o">=</span><span class="nx">p3</span><span class="p">;</span>
        <span class="c1">// 取了个别名
</span><span class="c1"></span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">hahaha</span><span class="p">);</span>
        <span class="c1">// 原属性还在
</span><span class="c1"></span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">p3</span><span class="p">.</span><span class="nx">a</span><span class="p">.</span><span class="nx">b</span><span class="p">);</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101515.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101515.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101515.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101515.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101515.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101515.png" /></p>
<h4 id="11单引号和反引号的区别">11.单引号和反引号的区别</h4>
<p>相当于$ ()–命令替换</p>
<p>反引号中可以解析变量：</p>
<p>如：表示在反引号内取变量keywords</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="sb">`https://api.github.com/search/users?q=</span><span class="si">${</span><span class="nx">keywords</span><span class="si">}</span><span class="sb">`</span>
</code></pre></td></tr></table>
</div>
</div><p>而单引号里面只能是字面量字符串</p>
<h4 id="12-qs键值对与urlencoded之间的转换">12 qs：键值对与urlencoded之间的转换</h4>
<p>要先安装querystring包，如果是react脚手架项目，react脚手架已经自动帮你安装好这个包了，只需要导入即可</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">p1</span><span class="o">=</span><span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="s2">&#34;tom&#34;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">11</span><span class="p">}</span>
        <span class="kr">const</span> <span class="nx">str1</span><span class="o">=</span><span class="nx">qs</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">p1</span><span class="p">)</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">str1</span><span class="p">)</span>

        <span class="kr">const</span> <span class="nx">str2</span><span class="o">=</span><span class="s2">&#34;name=haha&amp;age=23&#34;</span>
        <span class="kr">const</span> <span class="nx">p2</span><span class="o">=</span><span class="nx">qs</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">str2</span><span class="p">)</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">p2</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101528.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101528.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101528.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101528.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101528.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101528.png" /></p>
<h3 id="38-模块与组件">3.8 模块与组件</h3>
<p>模块：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101541.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101541.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101541.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101541.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101541.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101541.png" /></p>
<p>组件：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101553.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101553.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101553.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101553.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101553.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101553.png" /></p>
<p>模块化：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101604.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101604.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101604.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101604.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101604.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101604.png" /></p>
<p>组件化：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101618.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101618.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101618.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101618.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101618.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101618.png" /></p>
<h4 id="1函数式组件">1.函数式组件</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>函数式组件<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
     <span class="c">&lt;!-- 步骤一：创建一个容器 --&gt;</span>
     <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

     <span class="c">&lt;!-- 步骤二：引入库 --&gt;</span>
     <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

     <span class="c">&lt;!-- 表示写的是jsx，用babel转换 --&gt;</span>
     <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="c1">// 创建函数式组件
</span><span class="c1"></span>        <span class="c1">// 注意这里的函数名首字母必须大写，因为组件名必须是首字母大写的，如果是小写的就会被当成标签，去html库中查找。
</span><span class="c1"></span>        <span class="kd">function</span> <span class="nx">Demo</span><span class="p">(){</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">//这里的this为undefined，不是指向window，因为babel解析代码会转换为严格模式，严格模式是不允许自定义函数中的this指向window的
</span><span class="c1"></span>            <span class="k">return</span> <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">我是函数定义的组件</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
        <span class="p">}</span>
        
        <span class="c1">// 渲染组件到页面ReactDOM.render(组件标签，容器)，注意：这里的标签记得闭合
</span><span class="c1"></span><span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Demo</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test&#34;</span><span class="p">))</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101637.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101637.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101637.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101637.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101637.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101637.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101649.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101649.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101649.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101649.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101649.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101649.png" /></p>
<h4 id="2类式组件">2.类式组件</h4>
<p>要求：</p>
<ul>
<li>必须继承React.Component类</li>
<li>类中必须写render(){return xxx}</li>
<li>不要求写构造函数</li>
</ul>
<p>知识点：</p>
<ul>
<li>用类定义组件中的render(){}方法是放在改类的原型对象中的，供实例使用。</li>
<li>类中的this指的是组件实例对象，即用类定义的组件中，类的实例对象</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"> <span class="cp">&lt;!DOCTYPE html&gt;</span>
 <span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>类式组件<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
 <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
     
     <span class="c">&lt;!-- 步骤一：创建一个容器 --&gt;</span>
     <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

     <span class="c">&lt;!-- 步骤二：引入库 --&gt;</span>
     <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

     <span class="c">&lt;!-- 表示写的是jsx，用babel转换 --&gt;</span>
     <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="c1">// 类定义组件必须继承React.Component,而且要写render(){return xxx}
</span><span class="c1"></span>        <span class="kr">class</span> <span class="nx">MyComponent</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
            <span class="c1">// render是放在MyComponent的原型对象上，供实例使用
</span><span class="c1"></span>            <span class="nx">render</span><span class="p">(){</span>
                <span class="c1">// 这里的this指的是组件实例对象，即用类定义的组件中，类的实例对象
</span><span class="c1"></span>                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
                
                <span class="k">return</span> <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">我是类定义的组件</span><span class="err">（</span><span class="nx">一般用于复杂组件</span><span class="err">）</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// 将组件渲染到容器中
</span><span class="c1"></span>        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">));</span>
     <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
 <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
 <span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101841.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101841.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101841.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101841.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101841.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101841.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101853.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101853.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101853.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101853.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101853.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101853.png" /></p>
<h3 id="39--组件实例的三大核心属性">3.9  <strong>组件实例</strong>的三大核心属性</h3>
<h4 id="391-state">3.9.1 state</h4>
<ul>
<li><strong>组件的数据存放在状态里，状态的改变驱动着页面的改变</strong>。是由组件实例对象生成的，因为state存放在类中的this对象里，而this表示的是组件实例对象</li>
<li>组件就是一个“状态机”，通过更新组件的state来更新对应的页面显示（重新渲染组件）</li>
</ul>
<h5 id="1初始化state">1.初始化state</h5>
<p>初始化state要求：</p>
<ul>
<li>
<p>实例中要用到state属性，所以必须要写构造函数初始化state属性</p>
</li>
<li>
<p>state值必须是一个对象或者为null</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>state状态<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 步骤一：创建一个容器 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  
    <span class="c">&lt;!-- 步骤二：引入库 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  
    <span class="c">&lt;!-- 表示写的是jsx，用babel转换 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">Weather</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
            <span class="c1">// 实例中要用到state属性，所以必须要写构造函数初始化state属性
</span><span class="c1"></span>            <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
                    <span class="c1">// 只要继承了某个类，并且写了构造函数，就必须要写super()
</span><span class="c1"></span>                    <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
                    <span class="c1">// state必须是一个对象，或者为null
</span><span class="c1"></span>                    <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;isHot&#39;</span><span class="o">:</span><span class="kc">true</span><span class="p">};</span>
                <span class="p">}</span>
  
            <span class="nx">render</span><span class="p">(){</span>
                <span class="k">return</span> <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">今天天气真</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">isHot</span><span class="o">?</span><span class="s1">&#39;炎热&#39;</span><span class="o">:</span><span class="s1">&#39;寒冷&#39;</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;;</span>
            <span class="p">}</span>
        <span class="p">}</span>
  
        <span class="c1">// 将组件渲染到页面中
</span><span class="c1"></span>        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Weather</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">));</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h5 id="2react事件绑定">2.react事件绑定</h5>
<p>事件绑定要求：</p>
<ul>
<li>
<p>react中的onxxx事件，都必须用驼峰命名。如原生的js中的onclick，在react中就得用onClick</p>
</li>
<li>
<p>事件值只需要函数名，且必须为函数，而不是一个字符串，所以要用{}取</p>
</li>
<li>
<p>事件值中不要加()，函数名()：表示调用函数后的返回值</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>state状态<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 步骤一：创建一个容器 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  
    <span class="c">&lt;!-- 步骤二：引入库 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  
    <span class="c">&lt;!-- 表示写的是jsx，用babel转换 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">Weather</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
            <span class="c1">// 实例中要用到state属性，所以必须要写构造函数初始化state属性
</span><span class="c1"></span>            <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
                    <span class="c1">// 只要继承了某个类，并且写了构造函数，就必须要写super()
</span><span class="c1"></span>                    <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
                    <span class="c1">// state必须是一个对象，或者为null
</span><span class="c1"></span>                    <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;isHot&#39;</span><span class="o">:</span><span class="kc">true</span><span class="p">};</span>
                <span class="p">}</span>
                  
            <span class="nx">render</span><span class="p">(){</span>
                <span class="c1">// 1.注意这里的事件名要改为驼峰。2.事件值只需要函数名，且必须为函数，而不是一个字符串，所以要用{}取。3.事件值中不要加()，函数名()：表示调用函数后的返回值
</span><span class="c1"></span>                <span class="k">return</span> <span class="o">&lt;</span><span class="nx">h2</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">demo</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">今天天气真</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">isHot</span><span class="o">?</span><span class="s1">&#39;炎热&#39;</span><span class="o">:</span><span class="s1">&#39;寒冷&#39;</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;;</span>
            <span class="p">}</span>
        <span class="p">}</span>
  
        <span class="kd">function</span> <span class="nx">demo</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;按钮被点击&#34;</span><span class="p">);</span>
        <span class="p">}</span>
  
        <span class="c1">// 将组件渲染到页面中
</span><span class="c1"></span>        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Weather</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">));</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101913.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101913.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101913.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101913.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101913.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101913.png" /></p>
<h5 id="3类组件中方法中的this">3.类组件中方法中的this</h5>
<ul>
<li>babel解析，也会开启严格模式，所以由函数形式调用的方法中的this都不允许指向window，都为undefined</li>
<li>js中类中自定义方法中也会默认开启局部严格模式，所以由函数形式调用的方法中的this，就指向undefined。但是如果由实例对象调用的方法中的this，就指向对象实例</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>类方法中的this<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 步骤一：创建一个容器 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="c">&lt;!-- 步骤二：引入库 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="c">&lt;!-- 表示写的是jsx，用babel转换 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">Weather</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
            <span class="c1">// constructor中的this一定是指向实例对象的
</span><span class="c1"></span>            <span class="c1">// 实例中要用到state属性，所以必须要写构造函数初始化state属性
</span><span class="c1"></span>            <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
                    <span class="c1">// 只要继承了某个类，并且写了构造函数，就必须要写super()
</span><span class="c1"></span>                    <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
                    <span class="c1">// state必须是一个对象，或者为null
</span><span class="c1"></span>                    <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;isHot&#39;</span><span class="o">:</span><span class="kc">true</span><span class="p">};</span>
                <span class="p">}</span>

            <span class="c1">// render方法中的this指的是类实例对象，因为组件在渲染的时候，自动创建了类实例，并且用类实例调用了render方法
</span><span class="c1"></span>            <span class="nx">render</span><span class="p">(){</span>
                <span class="c1">// 注意：3.如果这里写this.demo，意思是：将实例对象中的demo方法，作为onClick的回调函数去调用，不是由实例对象调用，而是点击这个结点后由react自动调用，属于函数调用，所以demo方法中的this为undefined
</span><span class="c1"></span>                <span class="k">return</span> <span class="o">&lt;</span><span class="nx">h2</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">demo</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">今天天气真</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">isHot</span><span class="o">?</span><span class="s1">&#39;炎热&#39;</span><span class="o">:</span><span class="s1">&#39;寒冷&#39;</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;;</span>
            <span class="p">}</span>

            <span class="c1">// 将方法写在类里面
</span><span class="c1"></span>            <span class="nx">demo</span><span class="p">()</span> <span class="p">{</span>
                <span class="c1">// 1.babel解析，也会开启严格模式，所以由函数形式调用的方法中的this都不允许指向window，都为undefined
</span><span class="c1"></span>                <span class="c1">// 2.类中自定义方法中也会默认开启局部严格模式，所以由函数形式调用的方法中的this，就指向undefined。但是如果由实例对象调用的方法中的this，就指向对象实例
</span><span class="c1"></span>                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// 将组件渲染到页面中
</span><span class="c1"></span>        <span class="c1">// Weather类的实例对象是由react内部创建的
</span><span class="c1"></span>        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Weather</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">));</span>

        <span class="c1">// 测试由对象实例调用类组件中的方法(这样写是不规范的，因为类组件的实例对象是由react创建的，不是由我们手动创建)
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">w1</span><span class="o">=</span><span class="k">new</span> <span class="nx">Weather</span><span class="p">();</span>
        <span class="nx">w1</span><span class="p">.</span><span class="nx">demo</span><span class="p">();</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101930.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101930.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101930.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101930.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101930.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101930.png" /></p>
<h5 id="4用bind解决类组件中方法中的this指向问题">4.用bind解决类组件中方法中的this指向问题</h5>
<p>用函数的bind，强制修改函数中this的指向，不管该函数是以什么方式调用，this都是指向你指定的东西</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>解决类方法中的this指向<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 步骤一：创建一个容器 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="c">&lt;!-- 步骤二：引入库 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="c">&lt;!-- 表示写的是jsx，用babel转换 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">Weather</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
            <span class="c1">// constructor中的this一定是指向实例对象的
</span><span class="c1"></span>            <span class="c1">// 实例中要用到state属性，所以必须要写构造函数初始化state属性
</span><span class="c1"></span>            <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
                    <span class="c1">// 只要继承了某个类，并且写了构造函数，就必须要写super()
</span><span class="c1"></span>                    <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
                    <span class="c1">// state必须是一个对象，或者为null
</span><span class="c1"></span>                    <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;isHot&#39;</span><span class="o">:</span><span class="kc">true</span><span class="p">};</span>

                    <span class="c1">//构造函数中的this一定是指向实例对象的
</span><span class="c1"></span>					<span class="c1">// 调用实例对象中 demo 函数的bind方法，将类中 demo 函数中的this修改为指向实例对象
</span><span class="c1"></span>					 <span class="c1">// 再返回新函数，将它添加到每一个实例对象中。这样每个实例对象中都有一个 demo 函数，Weather 实例对象中有一个 demo 函数
</span><span class="c1"></span>                    <span class="k">this</span><span class="p">.</span><span class="nx">demo1</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">demo</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
                <span class="p">}</span>

            <span class="c1">// render方法中的this指的是类实例对象，因为组件在渲染的时候，自动创建了类实例，并且用类实例调用了render方法
</span><span class="c1"></span>            <span class="nx">render</span><span class="p">(){</span>
                <span class="c1">// 3.注意：那么这里的this.demo1表示的将对象实例中的demo1方法作为onClick方法的回调，尽管还是以函数方式调用的，但是用bind强制修改了demo方法的this为实例对象并作为一个新的方法：demo1，所以demo1中的this指向实例对象
</span><span class="c1"></span>                <span class="k">return</span> <span class="o">&lt;</span><span class="nx">h2</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">demo1</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">今天天气真</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">isHot</span><span class="o">?</span><span class="s1">&#39;炎热&#39;</span><span class="o">:</span><span class="s1">&#39;寒冷&#39;</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;;</span>
            <span class="p">}</span>

            <span class="c1">// 将方法写在类里面
</span><span class="c1"></span>            <span class="nx">demo</span><span class="p">()</span> <span class="p">{</span>
                <span class="c1">// 1.babel解析，也会开启严格模式，所以由函数形式调用的方法中的this都不允许指向window，都为undefined
</span><span class="c1"></span>                <span class="c1">// 2.类中自定义方法中也会默认开启局部严格模式，所以由函数形式调用的方法中的this，就指向undefined。但是如果由实例对象调用的方法中的this，就指向对象实例
</span><span class="c1"></span>                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> 
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// 将组件渲染到页面中
</span><span class="c1"></span>        <span class="c1">// Weather类的实例对象是由react内部创建的
</span><span class="c1"></span>        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Weather</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">));</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101946.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101946.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101946.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101946.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101946.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002101946.png" /></p>
<h5 id="5setstate的使用">5.setState的使用</h5>
<ul>
<li>
<p>状态里的数据不能直接更改，即直接取到state属性，直接改变它的state属性值。要借助一个内置的API去更改。</p>
</li>
<li>
<p>setState更新state数据，不是替换，而是合并，重名的属性就替换，不重名的属性依然保留</p>
</li>
<li>
<p>渲染时，标签用到几次，那么react就创建了几个类组件对象，构造器就相应的调用了几次，下面这个例子constructor就调用了一次</p>
</li>
<li>
<p>render调用了1+n次，1表示初始化的那次，最开始渲染页面的那次。n表示状态state切换的次数，状态的改变驱动着页面的改变。所以每次改变state，render都会重新被调用一次</p>
</li>
<li>
<p>下面例子中的demo调用的次数：就是点击的次数。因为demo中修改了state的值，每次调用完demo后，react会自动调用render重新渲染页面。</p>
</li>
<li>
<p>render做的最多的事情就是从状态里面读东西，然后根据状态里面的数据的不同，重新改变页面</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>setState的使用<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 步骤一：创建一个容器 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="c">&lt;!-- 步骤二：引入库 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="c">&lt;!-- 表示写的是jsx，用babel转换 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">Weather</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
            <span class="c1">// constructor中的this一定是指向实例对象的
</span><span class="c1"></span>            <span class="c1">// 实例中要用到state属性，所以必须要写构造函数初始化state属性
</span><span class="c1"></span>            <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
                    <span class="c1">// 只要继承了某个类，并且写了构造函数，就必须要写super()
</span><span class="c1"></span>                    <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
                    <span class="c1">// state必须是一个对象，或者为null
</span><span class="c1"></span>                    <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="nx">isHot</span><span class="o">:</span><span class="kc">true</span><span class="p">};</span>

                    <span class="c1">//构造函数中的this一定是指向实例对象的
</span><span class="c1"></span>                    <span class="c1">//调用实例对象中的demo函数的bind方法，将类中的demo函数中的this修改为指向实例对象，再将返回新函数，将它添加到每一个实例对象中。这样每个实例对象中都有一个demo1函数，Weather原型对象中有一个demo函数
</span><span class="c1"></span>                    <span class="k">this</span><span class="p">.</span><span class="nx">demo1</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">demo</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
                <span class="p">}</span>

            <span class="c1">// render方法中的this指的是类实例对象，因为组件在渲染的时候，自动创建了类实例，并且用类实例调用了render方法
</span><span class="c1"></span>            <span class="nx">render</span><span class="p">(){</span>
                <span class="c1">// 表示取this.state这个对象中的isHot属性，那么isHot就代表this.state.isHot
</span><span class="c1"></span>                <span class="kr">const</span> <span class="p">{</span><span class="nx">isHot</span><span class="p">}</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>
                <span class="c1">// 3.注意：那么这里的this.demo1表示的将对象实例中的demo1方法作为onClick方法的回调，尽管还是以函数方式调用的，但是用bind强制修改了此方法的this为实例对象，所以demo1中的this指向实例对象
</span><span class="c1"></span>                <span class="k">return</span> <span class="o">&lt;</span><span class="nx">h2</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">demo1</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">今天天气真</span><span class="p">{</span><span class="nx">isHot</span><span class="o">?</span><span class="s1">&#39;炎热&#39;</span><span class="o">:</span><span class="s1">&#39;寒冷&#39;</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;;</span>
            <span class="p">}</span>

            <span class="c1">// 将方法写在类里面
</span><span class="c1"></span>            <span class="nx">demo</span><span class="p">()</span> <span class="p">{</span>
                <span class="c1">// 1.babel解析，也会开启严格模式，所以由函数形式调用的方法中的this都不允许指向window，都为undefined
</span><span class="c1"></span>                <span class="c1">// 2.类中自定义方法中也会默认开启局部严格模式，所以由函数形式调用的方法中的this，就指向undefined。但是如果由实例对象调用的方法中的this，就指向对象实例
</span><span class="c1"></span>                <span class="c1">// this.state.isHot=!this.state.isHot; 这样的写法是错误的，因为状态里的数据不能直接更改，要借助内置的api去改：类原型对象的上一级对象中的setState方法，通过this就能拿到
</span><span class="c1"></span>                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">isHot</span><span class="o">:!</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">isHot</span><span class="p">});</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// 将组件渲染到页面中
</span><span class="c1"></span>        <span class="c1">// Weather类的实例对象是由react内部创建的
</span><span class="c1"></span>        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Weather</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">));</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102001.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102001.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102001.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102001.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102001.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102001.png" /></p>
<h5 id="6优化代码箭头函数">6.优化代码（箭头函数）</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>setState的使用<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 步骤一：创建一个容器 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="c">&lt;!-- 步骤二：引入库 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="c">&lt;!-- 表示写的是jsx，用babel转换 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">Weather</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
            <span class="c1">// 直接用赋值语句，往每一个实例对象中添加属性或者函数，如果属性和函数原本就存在，那么就是修改，不需要再写构造器
</span><span class="c1"></span>            <span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="nx">isHot</span><span class="o">:</span><span class="kc">true</span><span class="p">};</span>

            <span class="nx">render</span><span class="p">(){</span>
                <span class="kr">const</span> <span class="p">{</span><span class="nx">isHot</span><span class="p">}</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>
                <span class="k">return</span> <span class="o">&lt;</span><span class="nx">h2</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">demo</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">今天天气真</span><span class="p">{</span><span class="nx">isHot</span><span class="o">?</span><span class="s1">&#39;炎热&#39;</span><span class="o">:</span><span class="s1">&#39;寒冷&#39;</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;;</span>
            <span class="p">}</span>

			<span class="c1">// 直接赋值，表示往所有实例对象中添加一个箭头函数demo
</span><span class="c1"></span>            <span class="c1">// 箭头函数本身没有this，如果在箭头函数中，用到了this，那么箭头函数就会去它的外面找this，将外面的this作为自己的this。
</span><span class="c1"></span>            <span class="c1">// 由于没办法在类中直接console出this，这里我们就不纠结箭头函数外面：也就是类中的this是什么，只用知道用了箭头函数后，类中自定义方法中的this就指向了实例对象
</span><span class="c1"></span>            <span class="c1">// 所以不管以什么方法调用的demo，demo中的this永远指向实例对象
</span><span class="c1"></span>            <span class="nx">demo</span> <span class="o">=</span> <span class="p">()=&gt;{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">isHot</span><span class="o">:!</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">isHot</span><span class="p">});</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Weather</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">));</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102015.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102015.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102015.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102015.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102015.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102015.png" /></p>
<h5 id="7state总结">7.state总结</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102031.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102031.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102031.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102031.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102031.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102031.png" /></p>
<h4 id="392-props">3.9.2 props</h4>
<p>props属性存在于每一个类组件的实例对象中，可以<strong>在类外部定义属性及属性值，通过标签属性传参，供类内部调用</strong></p>
<h5 id="1props基本使用">1.props基本使用</h5>
<ul>
<li>每一个类组件的实例对象中都有一个props属性</li>
<li>组件标签中的所有属性都保存在props中</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>props基本使用<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test2&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test3&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">MyComponent</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
            <span class="nx">render</span><span class="p">(){</span>
                <span class="kr">const</span> <span class="p">{</span><span class="nx">name</span><span class="p">,</span><span class="nx">age</span><span class="p">,</span><span class="nx">sex</span><span class="p">}</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">姓名</span><span class="err">：</span><span class="p">{</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">年龄</span><span class="err">：</span><span class="p">{</span><span class="nx">age</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">性别</span><span class="err">：</span><span class="p">{</span><span class="nx">sex</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                    <span class="o">&lt;</span><span class="err">/ul&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// 可以用过标签往组件中的props对象中添加属性和属性值，属性名作为props中的键，属性值作为props的值
</span><span class="c1"></span>        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;小红&#34;</span> <span class="nx">age</span><span class="o">=</span><span class="s2">&#34;18&#34;</span> <span class="nx">sex</span><span class="o">=</span><span class="s2">&#34;男&#34;</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test1&#34;</span><span class="p">));</span>
        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;小蓝&#34;</span> <span class="nx">age</span><span class="o">=</span><span class="s2">&#34;18&#34;</span> <span class="nx">sex</span><span class="o">=</span><span class="s2">&#34;女&#34;</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test2&#34;</span><span class="p">));</span>
        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;小绿&#34;</span> <span class="nx">age</span><span class="o">=</span><span class="s2">&#34;18&#34;</span> <span class="nx">sex</span><span class="o">=</span><span class="s2">&#34;男&#34;</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test3&#34;</span><span class="p">));</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102046.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102046.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102046.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102046.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102046.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102046.png" /></p>
<h5 id="2批量传递props">2.批量传递props</h5>
<ul>
<li>在babel和引入的React前提下，支持展开运算符&hellip;展开一个对象，但仅限于在标签中使用</li>
<li>语法：{&hellip;对象}，外面的{}仅表示分隔符，而不是表示深度复制</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>props基本使用<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test2&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test3&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">MyComponent</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
            <span class="nx">render</span><span class="p">(){</span>
                <span class="kr">const</span> <span class="p">{</span><span class="nx">name</span><span class="p">,</span><span class="nx">age</span><span class="p">,</span><span class="nx">sex</span><span class="p">}</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">姓名</span><span class="err">：</span><span class="p">{</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">年龄</span><span class="err">：</span><span class="p">{</span><span class="nx">age</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">性别</span><span class="err">：</span><span class="p">{</span><span class="nx">sex</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                    <span class="o">&lt;</span><span class="err">/ul&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// 可以用过标签往组件中的props对象中添加属性和属性值，属性名作为props中的键，属性值作为props的值
</span><span class="c1"></span>        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;小红&#34;</span> <span class="nx">age</span><span class="o">=</span><span class="s2">&#34;18&#34;</span> <span class="nx">sex</span><span class="o">=</span><span class="s2">&#34;男&#34;</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test1&#34;</span><span class="p">));</span>

        <span class="c1">// 简写的方法：构造字面量对象时展开语法
</span><span class="c1"></span>        <span class="c1">// 用{...对象}，这里的{}只表示分隔符的作用，...对象表示展开一个对象。在js中是不允许...展开一个对象的。但是babel+引入的react允许在react中展开一个对象，但是仅限于标签中展开一个对象，其他地方不能使用...展开一个对象
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">p</span><span class="o">=</span><span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="s2">&#34;小蓝&#34;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="s2">&#34;18&#34;</span><span class="p">,</span><span class="nx">sex</span><span class="o">:</span><span class="s2">&#34;女&#34;</span><span class="p">};</span>
        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span> <span class="p">{...</span><span class="nx">p</span><span class="p">}</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test2&#34;</span><span class="p">));</span>
        
        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;小绿&#34;</span> <span class="nx">age</span><span class="o">=</span><span class="s2">&#34;18&#34;</span> <span class="nx">sex</span><span class="o">=</span><span class="s2">&#34;男&#34;</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test3&#34;</span><span class="p">));</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h5 id="3对props属性进行限制">3.对props属性进行限制</h5>
<ul>
<li>
<p>只要给<strong>组件自身</strong>加了特定属性，就可以对props属性值进行限制，这里的组件是类式组件，所以需要给类加一些特定的属性</p>
</li>
<li>
<p>要导入专门限制props属性的包</p>
</li>
<li>
<p>要注意区分大小写</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>对props属性进行限制<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test2&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test3&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test4&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test5&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 导入专门限制props属性的包，因为如果props放在React对象中，那么React对象就会变得很繁重，所以单独对限制props属性创建一个包 --&gt;</span>
    <span class="c">&lt;!-- 引入此包后，全局中就有一个PropTypes对象 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/prop-types.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">MyComponent</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
            <span class="nx">render</span><span class="p">(){</span>
                <span class="c1">// 获得props对象中的三个属性
</span><span class="c1"></span>                <span class="kr">const</span> <span class="p">{</span><span class="nx">name</span><span class="p">,</span><span class="nx">age</span><span class="p">,</span><span class="nx">sex</span><span class="p">,</span><span class="nx">speak</span><span class="p">}</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">姓名</span><span class="err">：</span><span class="p">{</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">年龄</span><span class="err">：</span><span class="p">{</span><span class="nx">age</span><span class="o">+</span><span class="mi">1</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">性别</span><span class="err">：</span><span class="p">{</span><span class="nx">sex</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                    <span class="o">&lt;</span><span class="err">/ul&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// 给类中添加propTypes对props属性进行类型、必要性的限制
</span><span class="c1"></span>        <span class="nx">MyComponent</span><span class="p">.</span><span class="nx">propTypes</span><span class="o">=</span><span class="p">{</span>
            <span class="c1">// 这里的PropTypes首字母要大写，string的首字母要小写，为了避免和关键字String冲突
</span><span class="c1"></span>            <span class="nx">name</span><span class="o">:</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">string</span><span class="p">.</span><span class="nx">isRequired</span><span class="p">,</span> <span class="c1">// 限制为字符串，且必填
</span><span class="c1"></span>            <span class="nx">age</span><span class="o">:</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">number</span><span class="p">,</span> <span class="c1">// 限制为数字
</span><span class="c1"></span>            <span class="nx">sex</span><span class="o">:</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">string</span><span class="p">,</span> <span class="c1">// 限制为字符串
</span><span class="c1"></span>            <span class="nx">speak</span><span class="o">:</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">func</span>  <span class="c1">// 由于不能跟function关键字冲突，所以这里的语法规范是func
</span><span class="c1"></span>        <span class="p">}</span>

        <span class="c1">// 给类中添加defaultProps对props属性进行默认值的限制
</span><span class="c1"></span>        <span class="nx">MyComponent</span><span class="p">.</span><span class="nx">defaultProps</span><span class="o">=</span><span class="p">{</span>
            <span class="nx">age</span><span class="o">:</span><span class="mi">18</span><span class="p">,</span>  <span class="c1">// 默认为18
</span><span class="c1"></span>            <span class="nx">sex</span><span class="o">:</span><span class="s1">&#39;男&#39;</span>  <span class="c1">// 默认为男
</span><span class="c1"></span>        <span class="p">}</span>

        <span class="c1">// 测试正常数据
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">p1</span><span class="o">=</span><span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;憨憨1&#39;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">19</span><span class="p">,</span><span class="nx">sex</span><span class="o">:</span><span class="s1">&#39;女&#39;</span><span class="p">};</span>
        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span> <span class="p">{...</span><span class="nx">p1</span><span class="p">}</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test1&#34;</span><span class="p">));</span>

        <span class="c1">// 测试不填写年龄、性别
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">p2</span><span class="o">=</span><span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="s2">&#34;憨憨2&#34;</span><span class="p">};</span>
        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span> <span class="p">{...</span><span class="nx">p2</span><span class="p">}</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test2&#34;</span><span class="p">));</span>

        <span class="c1">// 测试不填写姓名
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">p3</span><span class="o">=</span><span class="p">{</span><span class="nx">age</span><span class="o">:</span><span class="mi">19</span><span class="p">,</span><span class="nx">sex</span><span class="o">:</span><span class="s1">&#39;女&#39;</span><span class="p">};</span>
        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span> <span class="p">{...</span><span class="nx">p3</span><span class="p">}</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test3&#34;</span><span class="p">));</span>

        <span class="c1">// 测试将姓名填写成一个数字
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">p4</span><span class="o">=</span><span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="mi">10</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">19</span><span class="p">,</span><span class="nx">sex</span><span class="o">:</span><span class="s1">&#39;女&#39;</span><span class="p">};</span>
        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span> <span class="p">{...</span><span class="nx">p4</span><span class="p">}</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test4&#34;</span><span class="p">));</span>

        <span class="c1">// 测试限制一个属性值必须为函数
</span><span class="c1"></span>        <span class="kd">function</span> <span class="nx">speakfun</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;我在说话&#34;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="kr">const</span> <span class="nx">p5</span><span class="o">=</span><span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="s2">&#34;憨憨5&#34;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">80</span><span class="p">,</span><span class="nx">sex</span><span class="o">:</span><span class="s1">&#39;男&#39;</span><span class="p">,</span><span class="nx">speak</span><span class="o">:</span><span class="nx">speakfun</span><span class="p">};</span>
        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span> <span class="p">{...</span><span class="nx">p5</span><span class="p">}</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test5&#34;</span><span class="p">));</span>

    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102105.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102105.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102105.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102105.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102105.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102105.png" /></p>
<h5 id="4props简写">4.props简写</h5>
<p>将对类组件中的状态初始化、对象属性的限制都放在类里面去写。而对象属性的值可以在类外面灵活定义</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>props简写<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test2&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test3&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test4&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test5&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 导入专门限制props属性的包，因为如果props放在React对象中，那么React对象就会变得很繁大，所以单独对限制props属性创建一个包 --&gt;</span>
    <span class="c">&lt;!-- 引入此包后，全局中就有一个PropTypes对象 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/prop-types.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">MyComponent</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
            <span class="nx">render</span><span class="p">(){</span>
                <span class="c1">// 获得props对象中的三个属性
</span><span class="c1"></span>                <span class="kr">const</span> <span class="p">{</span><span class="nx">name</span><span class="p">,</span><span class="nx">age</span><span class="p">,</span><span class="nx">sex</span><span class="p">,</span><span class="nx">speak</span><span class="p">}</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">姓名</span><span class="err">：</span><span class="p">{</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">年龄</span><span class="err">：</span><span class="p">{</span><span class="nx">age</span><span class="o">+</span><span class="mi">1</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">性别</span><span class="err">：</span><span class="p">{</span><span class="nx">sex</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                    <span class="o">&lt;</span><span class="err">/ul&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>

            <span class="c1">// 给类中添加propTypes对props属性进行类型、必要性的限制
</span><span class="c1"></span>            <span class="kr">static</span> <span class="nx">propTypes</span><span class="o">=</span><span class="p">{</span>
                <span class="c1">// 这里的PropTypes首字母要大写，string的首字母要小写，为了避免和关键字String冲突
</span><span class="c1"></span>                <span class="nx">name</span><span class="o">:</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">string</span><span class="p">.</span><span class="nx">isRequired</span><span class="p">,</span> <span class="c1">// 限制为字符串，且必填
</span><span class="c1"></span>                <span class="nx">age</span><span class="o">:</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">number</span><span class="p">,</span> <span class="c1">// 限制为数字
</span><span class="c1"></span>                <span class="nx">sex</span><span class="o">:</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">string</span><span class="p">,</span> <span class="c1">// 限制为字符串
</span><span class="c1"></span>                <span class="nx">speak</span><span class="o">:</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">func</span>  <span class="c1">// 由于不能跟function关键字冲突，所以这里的语法规范是func
</span><span class="c1"></span>            <span class="p">}</span>

            <span class="c1">// 给类中添加defaultProps对props属性进行默认值的限制
</span><span class="c1"></span>            <span class="kr">static</span> <span class="nx">defaultProps</span><span class="o">=</span><span class="p">{</span>
                <span class="nx">age</span><span class="o">:</span><span class="mi">18</span><span class="p">,</span>  <span class="c1">// 默认为18
</span><span class="c1"></span>                <span class="nx">sex</span><span class="o">:</span><span class="s1">&#39;男&#39;</span>  <span class="c1">// 默认为男
</span><span class="c1"></span>            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// 测试正常数据
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">p1</span><span class="o">=</span><span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;憨憨1&#39;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">19</span><span class="p">,</span><span class="nx">sex</span><span class="o">:</span><span class="s1">&#39;女&#39;</span><span class="p">};</span>
        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span> <span class="p">{...</span><span class="nx">p1</span><span class="p">}</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test1&#34;</span><span class="p">));</span>

        <span class="c1">// 测试不填写年龄、性别
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">p2</span><span class="o">=</span><span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="s2">&#34;憨憨2&#34;</span><span class="p">};</span>
        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span> <span class="p">{...</span><span class="nx">p2</span><span class="p">}</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test2&#34;</span><span class="p">));</span>

        <span class="c1">// 测试不填写姓名
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">p3</span><span class="o">=</span><span class="p">{</span><span class="nx">age</span><span class="o">:</span><span class="mi">19</span><span class="p">,</span><span class="nx">sex</span><span class="o">:</span><span class="s1">&#39;女&#39;</span><span class="p">};</span>
        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span> <span class="p">{...</span><span class="nx">p3</span><span class="p">}</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test3&#34;</span><span class="p">));</span>

        <span class="c1">// 测试将姓名填写成一个数字
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">p4</span><span class="o">=</span><span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="mi">10</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">19</span><span class="p">,</span><span class="nx">sex</span><span class="o">:</span><span class="s1">&#39;女&#39;</span><span class="p">};</span>
        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span> <span class="p">{...</span><span class="nx">p4</span><span class="p">}</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test4&#34;</span><span class="p">));</span>

        <span class="c1">// 测试限制一个属性值必须为函数
</span><span class="c1"></span>        <span class="kd">function</span> <span class="nx">speakfun</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;我在说话&#34;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="kr">const</span> <span class="nx">p5</span><span class="o">=</span><span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="s2">&#34;憨憨5&#34;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">80</span><span class="p">,</span><span class="nx">sex</span><span class="o">:</span><span class="s1">&#39;男&#39;</span><span class="p">,</span><span class="nx">speak</span><span class="o">:</span><span class="nx">speakfun</span><span class="p">};</span>
        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span> <span class="p">{...</span><span class="nx">p5</span><span class="p">}</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test5&#34;</span><span class="p">));</span>

    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102120.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102120.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102120.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102120.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102120.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102120.png" /></p>
<h5 id="5构造函数与props">5，构造函数与props</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102130.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102130.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102130.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102130.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102130.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102130.png" /></p>
<p>如果需要在构造函数中使用this.props，那么一定要在构造函数中接收props并且super(props)，不然this.props很可能会出现undefined</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>构造函数与props<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 导入专门限制props属性的包，因为如果props放在React对象中，那么React对象就会变得很繁大，所以单独对限制props属性创建一个包 --&gt;</span>
    <span class="c">&lt;!-- 引入此包后，全局中就有一个PropTypes对象 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/prop-types.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">MyComponent</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
            <span class="nx">constructor</span><span class="p">(){</span>
                <span class="kr">super</span><span class="p">();</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="nx">render</span><span class="p">(){</span>
                <span class="c1">// 获得props对象中的三个属性
</span><span class="c1"></span>                <span class="kr">const</span> <span class="p">{</span><span class="nx">name</span><span class="p">,</span><span class="nx">age</span><span class="p">,</span><span class="nx">sex</span><span class="p">,</span><span class="nx">speak</span><span class="p">}</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">姓名</span><span class="err">：</span><span class="p">{</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">年龄</span><span class="err">：</span><span class="p">{</span><span class="nx">age</span><span class="o">+</span><span class="mi">1</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">性别</span><span class="err">：</span><span class="p">{</span><span class="nx">sex</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                    <span class="o">&lt;</span><span class="err">/ul&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>

            <span class="c1">// 给类中添加propTypes对props属性进行类型、必要性的限制
</span><span class="c1"></span>            <span class="kr">static</span> <span class="nx">propTypes</span><span class="o">=</span><span class="p">{</span>
                <span class="nx">name</span><span class="o">:</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">string</span><span class="p">.</span><span class="nx">isRequired</span><span class="p">,</span> <span class="c1">// 限制为字符串，且必填
</span><span class="c1"></span>                <span class="nx">age</span><span class="o">:</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">number</span><span class="p">,</span> <span class="c1">// 限制为数字
</span><span class="c1"></span>                <span class="nx">sex</span><span class="o">:</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">string</span><span class="p">,</span> <span class="c1">// 限制为字符串
</span><span class="c1"></span>                <span class="nx">speak</span><span class="o">:</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">func</span>  <span class="c1">// 由于不能跟function关键字冲突，所以这里的语法规范是func
</span><span class="c1"></span>            <span class="p">}</span>

            <span class="c1">// 给类中添加defaultProps对props属性进行默认值的限制
</span><span class="c1"></span>            <span class="kr">static</span> <span class="nx">defaultProps</span><span class="o">=</span><span class="p">{</span>
                <span class="nx">age</span><span class="o">:</span><span class="mi">18</span><span class="p">,</span>  <span class="c1">// 默认为18
</span><span class="c1"></span>                <span class="nx">sex</span><span class="o">:</span><span class="s1">&#39;男&#39;</span>  <span class="c1">// 默认为男
</span><span class="c1"></span>            <span class="p">}</span>
        <span class="p">}</span>

        <span class="kr">const</span> <span class="nx">p1</span><span class="o">=</span><span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;憨憨1&#39;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">19</span><span class="p">,</span><span class="nx">sex</span><span class="o">:</span><span class="s1">&#39;女&#39;</span><span class="p">};</span>
        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span> <span class="p">{...</span><span class="nx">p1</span><span class="p">}</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test1&#34;</span><span class="p">));</span>

    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102145.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102145.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102145.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102145.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102145.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102145.png" /></p>
<h5 id="6_函数式组件使用props">6_函数式组件使用props</h5>
<ul>
<li>
<p>函数式组件只能使用props，因为函数可以接收参数。不能用state、ref属性</p>
</li>
<li>
<p>将props作为参数传入函数，那么在函数中就可以拿到props的所有属性值</p>
</li>
<li>
<p>如果在函数式组件要对props属性值进行限制，那么直接往组件中添加特定属性就可以</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>函数式组件使用props<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 导入专门限制props属性的包，因为如果props放在React对象中，那么React对象就会变得很繁大，所以单独对限制props属性创建一个包 --&gt;</span>
    <span class="c">&lt;!-- 引入此包后，全局中就有一个PropTypes对象 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/prop-types.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kd">function</span> <span class="nx">MyComponent</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
            <span class="kr">const</span> <span class="p">{</span><span class="nx">name</span><span class="p">,</span><span class="nx">age</span><span class="p">,</span><span class="nx">sex</span><span class="p">}</span> <span class="o">=</span> <span class="nx">props</span><span class="p">;</span>
            <span class="k">return</span> <span class="p">(</span>
                    <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">姓名</span><span class="err">：</span><span class="p">{</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">年龄</span><span class="err">：</span><span class="p">{</span><span class="nx">age</span><span class="o">+</span><span class="mi">1</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">性别</span><span class="err">：</span><span class="p">{</span><span class="nx">sex</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                    <span class="o">&lt;</span><span class="err">/ul&gt;</span>
                <span class="p">)</span>
        <span class="p">}</span>
        
		<span class="c1">// 函数式组件对props限制，只能写在函数外侧
</span><span class="c1"></span>        <span class="c1">// 给函数组件中添加propTypes对props属性进行类型、必要性的限制
</span><span class="c1"></span>        <span class="nx">MyComponent</span><span class="p">.</span><span class="nx">propTypes</span><span class="o">=</span><span class="p">{</span>
            <span class="nx">name</span><span class="o">:</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">string</span><span class="p">.</span><span class="nx">isRequired</span><span class="p">,</span> <span class="c1">// 限制为字符串，且必填
</span><span class="c1"></span>            <span class="nx">age</span><span class="o">:</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">number</span><span class="p">,</span> <span class="c1">// 限制为数字
</span><span class="c1"></span>            <span class="nx">sex</span><span class="o">:</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">string</span><span class="p">,</span> <span class="c1">// 限制为字符串
</span><span class="c1"></span>        <span class="p">}</span>

        <span class="c1">// 给类中添加defaultProps对props属性进行默认值的限制
</span><span class="c1"></span>        <span class="nx">MyComponent</span><span class="p">.</span><span class="nx">defaultProps</span><span class="o">=</span><span class="p">{</span>
            <span class="nx">age</span><span class="o">:</span><span class="mi">18</span><span class="p">,</span>  <span class="c1">// 默认为18
</span><span class="c1"></span>            <span class="nx">sex</span><span class="o">:</span><span class="s1">&#39;男&#39;</span>  <span class="c1">// 默认为男
</span><span class="c1"></span>        <span class="p">}</span>
        
        <span class="kr">const</span> <span class="nx">p1</span><span class="o">=</span><span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;憨憨1&#39;</span><span class="p">};</span>
        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span> <span class="p">{...</span><span class="nx">p1</span><span class="p">}</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test1&#34;</span><span class="p">));</span>

    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102200.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102200.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102200.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102200.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102200.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102200.png" /></p>
<h5 id="7_props总结">7_props总结</h5>
<ul>
<li>在组件内部不能修改props属性，因为props是只读的。可以对props的某个属性值进行运算，但是不能修改，比如在组件内部：this.props.age=this.props.age+1； 这样就表示修改。<li>年龄：{age+1}</li>  这样就表示运算。</li>
</ul>
<h4 id="393-refs">3.9.3 refs</h4>
<p>作用：获取任意标签结点</p>
<h5 id="1字符串形式的ref">1.字符串形式的ref</h5>
<ul>
<li>ref属性值为字符串</li>
<li>ref相当于标签的标识，每一个标签上的ref都以键值对形式被封装在实例对象中的refs对象，key为ref的属性值，value为当前标签结点</li>
<li>不建议使用，因为写多了字符串形式的ref，存在效率问题，而且未来版本可能会删掉字符串形式的ref</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>1_字符串形式的ref<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">MyComponent</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
            
            <span class="c1">// 直接从实例对象中的refs属性中拿到相应标签所在的结点，直接获取输入框结点的value值
</span><span class="c1"></span>            <span class="c1">// 这里取的是类组件创建的虚拟DOM变为真实DOM后的结点，不是直接取的虚拟DOM的结点
</span><span class="c1"></span>            <span class="nx">textAlert1</span><span class="o">=</span><span class="p">()=&gt;{</span>
                <span class="nx">alert</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">refs</span><span class="p">.</span><span class="nx">text1</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">loseBlurAlert</span><span class="o">=</span><span class="p">()=&gt;{</span>
                <span class="nx">alert</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">refs</span><span class="p">.</span><span class="nx">text2</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">render</span><span class="p">(){</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="c1">// ref相当于标签的标识，每一个标签上的ref都以键值对形式被封装在实例对象中的refs对象，key为ref的属性值，value为当前标签结点
</span><span class="c1"></span>                    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="s2">&#34;text1&#34;</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">&#34;点击按钮提示数据&#34;</span><span class="o">/&gt;</span>
                        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">textAlert1</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">点我提示左侧的数据</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                        <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="s2">&#34;text2&#34;</span> <span class="nx">onBlur</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">loseBlurAlert</span><span class="p">}</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">&#34;失去焦点提示数据&#34;</span><span class="o">/&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test1&#34;</span><span class="p">));</span>

    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102215.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102215.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102215.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102215.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102215.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102215.png" /></p>
<h5 id="2回调函数形式的ref"><strong>2.回调函数形式的ref</strong></h5>
<p>只要render中的标签上用到了回调函数形式的ref那么react会自动帮你调用这个回调函数</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>2_回调函数形式的ref<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">MyComponent</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
            
            <span class="c1">// 直接从实例对象中的refs属性中拿到相应标签所在的结点，直接获取输入框结点的value值
</span><span class="c1"></span>            <span class="nx">textAlert1</span><span class="o">=</span><span class="p">()=&gt;{</span>
                <span class="nx">alert</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">text1</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">loseBlurAlert</span><span class="o">=</span><span class="p">()=&gt;{</span>
                <span class="nx">alert</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">text2</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">render</span><span class="p">(){</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="c1">// 这里用回调函数ref，会自动将当前标签所在结点作为参数传入回调函数中，这时，我们在实例对象中定义一个属性去接收它，这样直接获取实例对象中的那个属性就相当于获取当前标签所在结点
</span><span class="c1"></span>                    <span class="c1">// currentNode名字可以任意取
</span><span class="c1"></span>                    <span class="c1">// 箭头函数没有this，去外面找，也就是render中，render中的this是实例对象，所以this.text1=currentNode表示将结点赋值给实例对象中的text1属性
</span><span class="c1"></span>                    <span class="c1">// 箭头函数的参数只有一个时，可以省略()，函数体只有一句话时，可以省略{}
</span><span class="c1"></span>                    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{(</span><span class="nx">currentNode</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">text1</span><span class="o">=</span><span class="nx">currentNode</span><span class="p">}}</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">&#34;点击按钮提示数据&#34;</span><span class="o">/&gt;</span>
                        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">textAlert1</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">点我提示左侧的数据</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                        <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">currentNode</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">text2</span><span class="o">=</span><span class="nx">currentNode</span><span class="p">}</span> <span class="nx">onBlur</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">loseBlurAlert</span><span class="p">}</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">&#34;失去焦点提示数据&#34;</span><span class="o">/&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test1&#34;</span><span class="p">));</span>

    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102230.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102230.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102230.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102230.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102230.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102230.png" /></p>
<h5 id="3_回调ref中回调函数调用次数的问题">3_回调ref中回调函数调用次数的问题</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102243.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102243.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102243.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102243.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102243.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102243.png" /></p>
<ul>
<li>刚进页面会调一次，因为使用类组件对页面进行渲染，会自动调用实例对象的render方法，render放法中的ref是回调形式的，所以react自动调用一次这个回调函数。</li>
<li>state状态每改变一次，就会驱动页面改变，就会重新渲染页面。但是回调函数被调用两次，且第一次被调用时，当前结点为null。因为state状态改变，重新调用render，那么内联函数将被当作一个新函数，既然是新函数，就要清空上一次旧函数的值，所以传递一个null参数，然后再将当前结点作为参数传递给函数。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>3_回调ref中回调函数调用次数<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">MyComponent</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
            
            <span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="nx">isHot</span><span class="o">:</span><span class="kc">true</span><span class="p">};</span>

            <span class="nx">textAlert1</span><span class="o">=</span><span class="p">()=&gt;{</span>
                <span class="nx">alert</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">text1</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">changeWeather</span><span class="o">=</span><span class="p">()=&gt;{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">isHot</span><span class="o">:!</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">isHot</span><span class="p">})</span>
            <span class="p">}</span>

            <span class="nx">render</span><span class="p">(){</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{(</span><span class="nx">currentNode</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">text1</span><span class="o">=</span><span class="nx">currentNode</span><span class="p">;</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">,</span><span class="nx">currentNode</span><span class="p">);}}</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">&#34;点击按钮提示数据&#34;</span><span class="o">/&gt;</span>
                        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">textAlert1</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">点我提示左侧数据</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                        <span class="o">&lt;</span><span class="nx">h2</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">changeWeather</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">今天天气很</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">isHot</span><span class="o">?</span><span class="s1">&#39;炎热&#39;</span><span class="o">:</span><span class="s1">&#39;凉爽&#39;</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test1&#34;</span><span class="p">));</span>

    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102256.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102256.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102256.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102256.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102256.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102256.png" /></p>
<p>解决：将回调函数不直接写在标签上，而是作为一个箭头函数放进实例对象中</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>4_解决回调ref调用次数问题<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">MyComponent</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
            
            <span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="nx">isHot</span><span class="o">:</span><span class="kc">true</span><span class="p">};</span>

            <span class="nx">textAlert1</span><span class="o">=</span><span class="p">()=&gt;{</span>
                <span class="nx">alert</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cNode</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">changeWeather</span><span class="o">=</span><span class="p">()=&gt;{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">isHot</span><span class="o">:!</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">isHot</span><span class="p">})</span>
            <span class="p">}</span>

            <span class="nx">getNode</span><span class="o">=</span><span class="p">(</span><span class="nx">currentNode</span><span class="p">)=&gt;{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">cNode</span><span class="o">=</span><span class="nx">currentNode</span><span class="p">;</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cNode</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">render</span><span class="p">(){</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">getNode</span><span class="p">}</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">&#34;点击按钮提示数据&#34;</span><span class="o">/&gt;</span>
                        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">textAlert1</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">点我提示左侧数据</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                        <span class="o">&lt;</span><span class="nx">h2</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">changeWeather</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">今天天气很</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">isHot</span><span class="o">?</span><span class="s1">&#39;炎热&#39;</span><span class="o">:</span><span class="s1">&#39;凉爽&#39;</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test1&#34;</span><span class="p">));</span>

    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>现在不管怎么改变状态，都不会调用回调函数了，<strong>因为它不是内联函数，每次渲染时，不再是一个新函数需要被清空了</strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102311.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102311.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102311.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102311.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102311.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102311.png" /></p>
<h5 id="4createref">4.createRef</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>5_createRef<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">MyComponent</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
            

            <span class="c1">// 调用React.createRef表示生成一个空间，可以用来存储一个标签结点，key为current（固定的），value为结点
</span><span class="c1"></span>            <span class="c1">// 局限：只能存储一个结点，要是还想存储，那么就要再调用一次
</span><span class="c1"></span>            <span class="nx">myRef</span><span class="o">=</span><span class="nx">React</span><span class="p">.</span><span class="nx">createRef</span><span class="p">();</span>
            <span class="nx">myRef2</span><span class="o">=</span><span class="nx">React</span><span class="p">.</span><span class="nx">createRef</span><span class="p">();</span>
            
            <span class="c1">// 直接从实例对象中的refs属性中拿到相应标签所在的结点，直接获取输入框结点的value值
</span><span class="c1"></span>            <span class="nx">textAlert1</span><span class="o">=</span><span class="p">()=&gt;{</span>
                <span class="c1">// current是myRef中的结点的key值
</span><span class="c1"></span>                <span class="nx">alert</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">myRef</span><span class="p">.</span><span class="nx">current</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">loseBlurAlert</span><span class="o">=</span><span class="p">()=&gt;{</span>
                <span class="nx">alert</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">myRef2</span><span class="p">.</span><span class="nx">current</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">render</span><span class="p">(){</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="c1">// 表示将结点存储在对象属性的myRef中
</span><span class="c1"></span>                    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">myRef</span><span class="p">}</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">&#34;点击按钮提示数据&#34;</span><span class="o">/&gt;</span>
                        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">textAlert1</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">点我提示左侧的数据</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                        <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">myRef2</span><span class="p">}</span> <span class="nx">onBlur</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">loseBlurAlert</span><span class="p">}</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">&#34;失去焦点提示数据&#34;</span><span class="o">/&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test1&#34;</span><span class="p">));</span>

    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102329.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102329.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102329.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102329.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102329.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102329.png" /></p>
<h5 id="5eventtarget--省略ref">5.event.target  省略ref</h5>
<p>当为一个结点绑定事件时，该结点事件触发的回调函数的参数，默认就是event</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>6_省略ref<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">MyComponent</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
            
            <span class="nx">myRef</span><span class="o">=</span><span class="nx">React</span><span class="p">.</span><span class="nx">createRef</span><span class="p">();</span>
    
            <span class="nx">textAlert1</span><span class="o">=</span><span class="p">()=&gt;{</span>
                <span class="nx">alert</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">myRef</span><span class="p">.</span><span class="nx">current</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">loseBlurAlert</span><span class="o">=</span><span class="p">(</span><span class="nx">event</span><span class="p">)=&gt;{</span>
                <span class="c1">// 事件中的event.target表示的是事件源对象，即触发事件的结点对象，此例中就是第二个输入框对象
</span><span class="c1"></span>                <span class="nx">alert</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">render</span><span class="p">(){</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="c1">// 第二个输入框，触发事件的结点和要获取结点的标签是同一个，这时可以用event.target对象获取结点，从而拿到结点上的数据
</span><span class="c1"></span>                    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">myRef</span><span class="p">}</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">&#34;点击按钮提示数据&#34;</span><span class="o">/&gt;</span>
                        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">textAlert1</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">点我提示左侧的数据</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                        <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">myRef2</span><span class="p">}</span> <span class="nx">onBlur</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">loseBlurAlert</span><span class="p">}</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">&#34;失去焦点提示数据&#34;</span><span class="o">/&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test1&#34;</span><span class="p">));</span>

    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="310-react中的事件绑定">3.10 react中的事件绑定</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102345.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102345.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102345.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102345.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102345.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102345.png" /></p>
<h3 id="311-react中收集表单数据">3.11 react中收集表单数据</h3>
<h4 id="1非受控组件">1.非受控组件</h4>
<ul>
<li>表单中的数据现用现取。填完之后，从表单中取出来直接用的，为非受控组件</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>1_非受控组件<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">MyComponent</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>

            <span class="nx">handleSubmit</span><span class="o">=</span><span class="p">(</span><span class="nx">event</span><span class="p">)=&gt;{</span>
                <span class="c1">// 阻止表单提交,即提交表单后，不进行页面刷新和跳转，做到让用户在本页面中就能处理表单提交的感觉
</span><span class="c1"></span>                <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>

                <span class="c1">// 获得并使用两个表单项结点的数据
</span><span class="c1"></span>                <span class="nx">alert</span><span class="p">(</span><span class="s2">&#34;你的用户名为：&#34;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">usernameNode</span><span class="p">.</span><span class="nx">value</span><span class="o">+</span><span class="s2">&#34;；你的密码为：&#34;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">passwordNode</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">render</span><span class="p">(){</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="c1">// onSubmit：表单提交时触发
</span><span class="c1"></span>                    <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">action</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="nx">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleSubmit</span><span class="p">}</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">c</span><span class="p">=&gt;</span><span class="k">this</span><span class="p">.</span><span class="nx">usernameNode</span><span class="o">=</span><span class="nx">c</span><span class="p">}</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;username&#34;</span><span class="o">/&gt;</span>
                        <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">c</span><span class="p">=&gt;</span><span class="k">this</span><span class="p">.</span><span class="nx">passwordNode</span><span class="o">=</span><span class="nx">c</span><span class="p">}</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;password&#34;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;password&#34;</span><span class="o">/&gt;</span>
                        <span class="o">&lt;</span><span class="nx">button</span><span class="o">&gt;</span><span class="nx">确定</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                    <span class="o">&lt;</span><span class="err">/form&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test1&#34;</span><span class="p">));</span>

    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102403.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102403.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102403.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102403.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102403.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102403.png" /></p>
<h4 id="2受控组件">2.受控组件</h4>
<ul>
<li>
<p>将表单中的数据存到state中，要用的时候，从state中取出来，叫做受控组件（变相的双向绑定）</p>
</li>
<li>
<p>使用react中的onChange事件（改变时触发）实时拿到表单中的数据，并将表单中的数据存到state中，用的时候直接从state中取即可（state建议最好先初始化，再setState）</p>
</li>
<li>
<p>建议使用受控组件，因为react官网建议少用ref</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>2_受控组件<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">MyComponent</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>

            <span class="c1">// 初始化state
</span><span class="c1"></span>            <span class="nx">state</span><span class="o">=</span><span class="p">{</span>
                <span class="nx">username</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="nx">password</span><span class="o">:</span><span class="s1">&#39;&#39;</span>
            <span class="p">}</span>

            <span class="c1">// 用户名输入框值发生改变时触发，event.target表示事件源对象
</span><span class="c1"></span>            <span class="nx">saveName</span><span class="o">=</span><span class="p">(</span><span class="nx">event</span><span class="p">)=&gt;{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">username</span><span class="o">:</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">});</span>
            <span class="p">}</span>

            <span class="c1">// 用户名输入框值发生改变时触发，event.target表示事件源对象
</span><span class="c1"></span>            <span class="nx">savePass</span><span class="o">=</span><span class="p">(</span><span class="nx">event</span><span class="p">)=&gt;{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">password</span><span class="o">:</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">});</span>
            <span class="p">}</span>

            <span class="c1">// 表单提交的回调
</span><span class="c1"></span>            <span class="nx">handleSubmit</span><span class="o">=</span><span class="p">(</span><span class="nx">event</span><span class="p">)=&gt;{</span>
                <span class="c1">// 阻止表单提交,即提交表单后，不进行页面刷新和跳转，做到让用户在本页面中就能处理表单提交的感觉
</span><span class="c1"></span>                <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>

                <span class="nx">alert</span><span class="p">(</span><span class="s2">&#34;你的用户名为：&#34;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">username</span><span class="o">+</span><span class="s2">&#34;;你的密码为：&#34;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">password</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">render</span><span class="p">(){</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="c1">// onSubmit：表单提交时触发
</span><span class="c1"></span>                    <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">action</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="nx">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleSubmit</span><span class="p">}</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">saveName</span><span class="p">}</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;username&#34;</span><span class="o">/&gt;</span>
                        <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">savePass</span><span class="p">}</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;password&#34;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;password&#34;</span><span class="o">/&gt;</span>
                        <span class="o">&lt;</span><span class="nx">button</span><span class="o">&gt;</span><span class="nx">确定</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                    <span class="o">&lt;</span><span class="err">/form&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test1&#34;</span><span class="p">));</span>

    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102425.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102425.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102425.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102425.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102425.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102425.png" /></p>
<h3 id="312-高阶函数_函数柯里化">3.12 高阶函数_函数柯里化</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102436.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102436.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102436.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102436.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102436.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102436.png" /></p>
<h4 id="1用函数柯里化">1.用函数柯里化</h4>
<ul>
<li>
<p>如果将一个<strong>函数调用后的返回值（函数的执行结果）<strong>作为某个</strong>事件触发的回调函数</strong>。那么在一进页面，这个函数就被执行一遍，得到一个返回值，将返回值作为事件触发的回调，那么后面无论怎么触发事件，这个函数都不会再被调用，因为<strong>事件的回调</strong>是这个<strong>函数的返回值</strong></p>
</li>
<li>
<p>如果不仅将一个函数调用后的返回值作为事件回调，还给这函数传了参，那么这个函数的默认参数就不再是event事件源，而是你自己传的参数</p>
</li>
<li>
<p>函数调用后的返回值如果是一个回调函数，那么表示：一进页面，react就调用这个函数，得到返回值，将返回值作为事件触发的回调，这个返回值又恰好是一个回调函数，所以事件的回调还是一个回调函数。那么每次触发事件时，react都会调用那个返回值回调函数（但是不会再调用之前那个函数了）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>2_受控组件<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">MyComponent</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
  
            <span class="c1">// 初始化state
</span><span class="c1"></span>            <span class="nx">state</span><span class="o">=</span><span class="p">{</span>
                <span class="nx">username</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="nx">password</span><span class="o">:</span><span class="s1">&#39;&#39;</span>
            <span class="p">}</span>
  
            <span class="c1">// 绑定了事件的表单项的值发生改变时触发，参数为你自己传的参数（在一进页面，react就发现onChange事件的回调是一个函数的调用，那么react就直接先调用了这个函数，并且后面再触发onChange事件后，这个函数都不会再被调用。）
</span><span class="c1"></span>            <span class="nx">saveForm</span><span class="o">=</span><span class="p">(</span><span class="nx">formType</span><span class="p">)=&gt;{</span>
                <span class="c1">// 该事件函数的返回值为一个回调函数，将这个回调函数作为onChange的触发事件，那么在每次触发事件时，react都会调用这个回调函数。这个回调函数被传参数，所以参数默认为event
</span><span class="c1"></span>                <span class="k">return</span> <span class="p">(</span><span class="nx">event</span><span class="p">)=&gt;{</span>
                    <span class="c1">// 在对象中读取一个变量，需要将变量用[]括起来
</span><span class="c1"></span>                    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({[</span><span class="nx">formType</span><span class="p">]</span><span class="o">:</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">});</span>
                <span class="p">};</span>
            <span class="p">}</span>
  
            <span class="c1">// 表单提交的回调
</span><span class="c1"></span>            <span class="nx">handleSubmit</span><span class="o">=</span><span class="p">(</span><span class="nx">event</span><span class="p">)=&gt;{</span>
                  
                <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
  
                <span class="nx">alert</span><span class="p">(</span><span class="s2">&#34;你的用户名为：&#34;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">username</span><span class="o">+</span><span class="s2">&#34;;你的密码为：&#34;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">password</span><span class="p">);</span>
            <span class="p">}</span>
  
            <span class="nx">render</span><span class="p">(){</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="c1">// 事件的回调应该传的是一个函数，每触发一次事件，函数就被react调用一次。但是这里是将一个函数的执行结果的返回值作为onChange的回调，那么结果是：在一进页面，react就发现onChange事件的回调是一个函数的调用，那么react就直接先调用了这个函数，并且后面再触发onChange事件后，这个函数都不会再被调用。这函数还传了实参，那么箭头函数默认的参数不再是事件源event，而是你自己传的那个参数
</span><span class="c1"></span>                    <span class="c1">// 将这个函数调用的返回值设置为一个回调函数，在返回值回调函数中，写在触发onChange后你真正想做的事，返回值回调函数没有传参，所以参数默认就是event了，即事件源对象。每次触发事件，都会调用这个回调函数
</span><span class="c1"></span>                    <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">action</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="nx">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleSubmit</span><span class="p">}</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">saveForm</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)}</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;username&#34;</span><span class="o">/&gt;</span>
                        <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">saveForm</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">)}</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;password&#34;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;password&#34;</span><span class="o">/&gt;</span>
                        <span class="o">&lt;</span><span class="nx">button</span><span class="o">&gt;</span><span class="nx">确定</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                    <span class="o">&lt;</span><span class="err">/form&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
  
        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test1&#34;</span><span class="p">));</span>
  
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102515.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102515.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102515.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102515.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102515.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102515.png" /></p>
<h4 id="2不用函数柯里化">2.不用函数柯里化</h4>
<p>统一传参：</p>
<p>将箭头函数直接以内联的方式作为事件触发的回调函数，将事件源作为箭头函数的参数直接传入箭头函数中。在箭头函数中调用另一个箭头函数，并将得到的事件源event作为参数传入。那么另一个箭头函数也能拿到事件源对象了</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>2_不用函数柯里化<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">MyComponent</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>

            <span class="c1">// 初始化state
</span><span class="c1"></span>            <span class="nx">state</span><span class="o">=</span><span class="p">{</span>
                <span class="nx">username</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="nx">password</span><span class="o">:</span><span class="s1">&#39;&#39;</span>
            <span class="p">}</span>

            <span class="c1">// 绑定了事件的表单项的值发生改变时触发，参数为你自己传的参数
</span><span class="c1"></span>            <span class="c1">// 此时的event，为事件触发回调时，拿到的事件源，再将event作为参数传到这里，所以这里的event也为事件源
</span><span class="c1"></span>            <span class="nx">saveForm</span><span class="o">=</span><span class="p">(</span><span class="nx">formType</span><span class="p">,</span><span class="nx">event</span><span class="p">)=&gt;{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({[</span><span class="nx">formType</span><span class="p">]</span><span class="o">:</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">});</span>
            <span class="p">}</span>

            <span class="c1">// 表单提交的回调
</span><span class="c1"></span>            <span class="nx">handleSubmit</span><span class="o">=</span><span class="p">(</span><span class="nx">event</span><span class="p">)=&gt;{</span>
                
                <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>

                <span class="nx">alert</span><span class="p">(</span><span class="s2">&#34;你的用户名为：&#34;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">username</span><span class="o">+</span><span class="s2">&#34;;你的密码为：&#34;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">password</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">render</span><span class="p">(){</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="c1">// 直接将一个回调函数以内联的方式作为事件触发的回调，那么在每次触发事件时，都会执行这个回调函数，此回调函数的参数默认为当前事件源。
</span><span class="c1"></span>                    <span class="c1">// 在这个回调函数体里是一另一个回调函数。那么事件每次触发时，react先会调用外侧的回调函数，外侧的回调函数被调用的时候，就执行函数体里面的回调函数，达到表单值一改变时，就将当前表单值存入state状态中
</span><span class="c1"></span>                    <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">action</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="nx">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleSubmit</span><span class="p">}</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="nx">event</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">saveForm</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span><span class="nx">event</span><span class="p">)}</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;username&#34;</span><span class="o">/&gt;</span>
                        <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="nx">event</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">saveForm</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">,</span><span class="nx">event</span><span class="p">)</span> <span class="p">}</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;password&#34;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;password&#34;</span><span class="o">/&gt;</span>
                        <span class="o">&lt;</span><span class="nx">button</span><span class="o">&gt;</span><span class="nx">确定</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                    <span class="o">&lt;</span><span class="err">/form&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test1&#34;</span><span class="p">));</span>

    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102541.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102541.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102541.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102541.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102541.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102541.png" /></p>
<h3 id="313-组件的生命周期旧">3.13 组件的生命周期（旧）</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102601.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102601.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102601.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102601.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102601.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102601.png" /></p>
<h4 id="1引出生命周期错误示范">1.引出生命周期(错误示范)</h4>
<p>做一个效果：1.点击按钮，页面中的组件就消失 2.一进页面（即组件刚挂载完后）：页面中的第一行文字，不透明度逐渐减小，等到透明时，自动变为1，再继续减小</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>1_引出生命周期<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">MyComponent</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>

            <span class="c1">// 初始化state
</span><span class="c1"></span>            <span class="nx">state</span><span class="o">=</span><span class="p">{</span>
                <span class="c1">// 最开始不透明度为1，后来慢慢减少
</span><span class="c1"></span>                <span class="nx">opacity</span><span class="o">:</span> <span class="mi">1</span>
            <span class="p">}</span>

            <span class="c1">// ReactDOM中的unmountComponentAtNode方法表示卸载，将一个组件从页面中卸载
</span><span class="c1"></span>            <span class="nx">dead</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
                <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">unmountComponentAtNode</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test1&#39;</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="nx">render</span><span class="p">(){</span>
                <span class="c1">// 由于类中不能写函数，所以将函数放在render函数里面
</span><span class="c1"></span>                <span class="c1">// 这样带来的问题是：第一次页面渲染时，react创建类的实例对象并调用render方法时，调用了这个setInterval定时器，但是在定时器中，修改了state状态，只要状态改变，render就会被重新调用，那么随着render的重新调用，又开了一个定时器。以此类推，无限循环，开启了无数个定时器
</span><span class="c1"></span>                <span class="nx">setInterval</span><span class="p">(()=&gt;{</span>
                    <span class="c1">// 获得当前不透明度。这里要用let定义op变量，因为const定义的话，是不能修改变量值的
</span><span class="c1"></span>                    <span class="kd">let</span> <span class="nx">op</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">opacity</span><span class="p">;</span>
                    <span class="nx">op</span> <span class="o">-=</span> <span class="mf">0.1</span><span class="p">;</span>

                    <span class="c1">// 将当前状态中的不透明度减去0.1
</span><span class="c1"></span>                    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">opacity</span><span class="o">:</span><span class="nx">op</span><span class="p">});</span>

                    <span class="c1">// 如果不透明度小于或等于0了（完全透明了），就将他重新设置为1
</span><span class="c1"></span>                    <span class="k">if</span><span class="p">(</span><span class="nx">op</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">){</span>
                        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">opacity</span><span class="o">:</span><span class="mi">1</span><span class="p">});</span>
                    <span class="p">}</span>
                <span class="p">},</span><span class="mi">200</span><span class="p">);</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="c1">// 注意内联样式的写法：以key，value的形式写属性
</span><span class="c1"></span>                    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">h2</span> <span class="nx">style</span><span class="o">=</span><span class="p">{{</span><span class="nx">opacity</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">opacity</span><span class="p">}}</span><span class="o">&gt;</span><span class="nx">开始变得透明</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">dead</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">点我全部消失</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test1&#34;</span><span class="p">));</span>

    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>结果是：因为开了很多个定时器，导致越来越快。一直在新开定时器</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102619.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102619.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102619.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102619.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102619.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102619.png" /></p>
<h4 id="2引出生命周期">2.引出生命周期</h4>
<ul>
<li>componentDidMount做到在组件挂载完毕后：页面中的那行文字就开始变透明，一直循环变。</li>
<li>一点击按钮，页面内的组件就消失</li>
<li>componentWillUnmount在组件消失之前，关闭定时器。因为如果在组件卸载后，定时器还开着话，定时器内又一直在改变state，就会报错。Can&rsquo;t perform a React state update on an unmounted component.（在一个卸载的组件中改变状态）</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>2_引出生命周期<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">MyComponent</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>

            <span class="c1">// 初始化state
</span><span class="c1"></span>            <span class="nx">state</span><span class="o">=</span><span class="p">{</span>
                <span class="c1">// 最开始不透明度为1，后来慢慢减少
</span><span class="c1"></span>                <span class="nx">opacity</span><span class="o">:</span> <span class="mi">1</span>
            <span class="p">}</span>

            <span class="c1">// ReactDOM中的unmountComponentAtNode方法表示卸载，将一个组件从页面中卸载
</span><span class="c1"></span>            <span class="nx">dead</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
                <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">unmountComponentAtNode</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test1&#39;</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="c1">// 调用时机：组件卸载之前
</span><span class="c1"></span>            <span class="nx">componentWillUnmount</span><span class="p">(){</span>
                <span class="c1">// 在卸载组件前，清除定时器，this.timer为定时器的id
</span><span class="c1"></span>                <span class="nx">clearInterval</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">timer</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="c1">// 调用时机：组件挂载完毕后，即第一次渲染页面完毕后执行，且只执行这一次
</span><span class="c1"></span>            <span class="nx">componentDidMount</span><span class="p">(){</span>
                <span class="c1">// 将定时器放在componentDidMount方法中，页面挂载完毕后，调用一次。那么做到了只开启一个定时器
</span><span class="c1"></span>                <span class="k">this</span><span class="p">.</span><span class="nx">timer</span> <span class="o">=</span> <span class="nx">setInterval</span><span class="p">(()=&gt;{</span>
                    <span class="c1">// 获得当前不透明度。这里要用let定义op变量，因为const定义的话，是不能修改变量值的
</span><span class="c1"></span>                    <span class="kd">let</span> <span class="nx">op</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">opacity</span><span class="p">;</span>
                    <span class="nx">op</span> <span class="o">-=</span> <span class="mf">0.1</span><span class="p">;</span>

                    <span class="c1">// 将当前状态中的不透明度减去0.1
</span><span class="c1"></span>                    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">opacity</span><span class="o">:</span><span class="nx">op</span><span class="p">});</span>

                    <span class="c1">// 如果不透明度小于或等于0了（完全透明了），就将他重新设置为1
</span><span class="c1"></span>                    <span class="k">if</span><span class="p">(</span><span class="nx">op</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">){</span>
                        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">opacity</span><span class="o">:</span><span class="mi">1</span><span class="p">});</span>
                    <span class="p">}</span>
                <span class="p">},</span><span class="mi">200</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="c1">// 调用时机：1.页面第一次渲染 2.状态改变
</span><span class="c1"></span>            <span class="nx">render</span><span class="p">(){</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="c1">// 注意内联样式的写法：以key，value的形式写属性
</span><span class="c1"></span>                    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">h2</span> <span class="nx">style</span><span class="o">=</span><span class="p">{{</span><span class="nx">opacity</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">opacity</span><span class="p">}}</span><span class="o">&gt;</span><span class="nx">开始变得透明</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">dead</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">点我全部消失</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyComponent</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;test1&#34;</span><span class="p">));</span>

    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102634.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102634.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102634.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102634.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102634.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102634.png" /></p>
<h4 id="3组件挂载流程">3.组件挂载流程</h4>
<p>挂载时：</p>
<ol>
<li>
<p>construstor：构造器</p>
</li>
<li>
<p>componentWillMount：组件将要挂载</p>
</li>
<li>
<p>render：组件挂载</p>
</li>
<li>
<p>componentDidMount：组件挂载完毕</p>
<hr>
</li>
<li>
<p>componentWillUnmount：组件卸载前（unmountComponentByNode(组件) 卸载组件的方法）</p>
</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>3_组件挂载流程<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">Count</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>

            <span class="c1">// 由于要展示生命周期各个时间段，所以这里写构造器
</span><span class="c1"></span>            <span class="c1">// 第一阶段：Count----构造器
</span><span class="c1"></span>            <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;构造器&#34;</span><span class="p">);</span>
                <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="nx">count</span><span class="o">:</span><span class="mi">0</span><span class="p">};</span>
            <span class="p">}</span>

            <span class="c1">// 卸载组件按钮的回调
</span><span class="c1"></span>            <span class="nx">dead</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
                <span class="c1">// 卸载组件
</span><span class="c1"></span>                <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">unmountComponentAtNode</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test1&#39;</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="c1">// 第二阶段：Count----组件将要挂载
</span><span class="c1"></span>            <span class="nx">componentWillMount</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;组件将要挂载&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="c1">// 第四阶段：Count----组件刚挂载完毕
</span><span class="c1"></span>            <span class="nx">componentDidMount</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;组件刚挂载完毕&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="c1">// 第五阶段：Count----组件卸载之前
</span><span class="c1"></span>            <span class="nx">componentWillUnmount</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;组件卸载之前&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="c1">// 第三阶段：Count----组件挂载
</span><span class="c1"></span>            <span class="nx">render</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;组件挂载&#34;</span><span class="p">);</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">dead</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">卸载组件</span><span class="o">&lt;</span><span class="err">/button&gt;  </span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// 渲染组件
</span><span class="c1"></span>        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Count</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test1&#39;</span><span class="p">));</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102647.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102647.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102647.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102647.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102647.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102647.png" /></p>
<h4 id="4组件正常更新流程">4.组件正常更新流程</h4>
<p>更新时：</p>
<ol>
<li>
<p>更改状态时（setState）：</p>
<ul>
<li>
<p>shouldComponentUpdate：组件是否能被更新。</p>
<p>返回值必须是bool值</p>
<p>如果直接不写这个函数，那么底层也会默认写出来，且默认为true。</p>
<p>为true才能往下走下去。相当于控制组件是否能更新的阀门</p>
</li>
<li>
<p>componentWillUpdate：组件更新前</p>
</li>
<li>
<p>render：组件更新</p>
</li>
<li>
<p>componentDidUpdate：组件更新完毕</p>
<hr>
</li>
<li>
<p>componentWillUnmount：组件卸载前</p>
</li>
</ul>
</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>4_组件正常更新流程<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">Count</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>

            <span class="c1">// 由于要展示生命周期各个时间段，所以这里写构造器
</span><span class="c1"></span>            <span class="c1">// 第一阶段：Count----构造器
</span><span class="c1"></span>            <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;构造器&#34;</span><span class="p">);</span>
                <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="nx">count</span><span class="o">:</span><span class="mi">0</span><span class="p">};</span>
            <span class="p">}</span>

            <span class="c1">// 卸载组件按钮的回调
</span><span class="c1"></span>            <span class="nx">dead</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
                <span class="c1">// 卸载组件
</span><span class="c1"></span>                <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">unmountComponentAtNode</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test1&#39;</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="c1">// +1按钮的回调
</span><span class="c1"></span>            <span class="c1">// 更改state
</span><span class="c1"></span>            <span class="nx">add</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">count</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span><span class="o">+</span><span class="mi">1</span><span class="p">});</span>
            <span class="p">}</span>

            <span class="c1">// 第一阶段：组件是否能更新的阀门
</span><span class="c1"></span>            <span class="nx">shouldComponentUpdate</span><span class="p">(){</span>
                <span class="c1">// 返回true才能更新组件
</span><span class="c1"></span>                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;组件是否能更新？&#34;</span><span class="p">);</span>
                <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="c1">// 第二阶段：组件更新前
</span><span class="c1"></span>            <span class="nx">componentWillUpdate</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;组件更新前&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="c1">// 第四阶段：组件更新完毕
</span><span class="c1"></span>            <span class="nx">componentDidUpdate</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;组件更新完毕&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="c1">// 第五阶段：Count----组件卸载之前
</span><span class="c1"></span>            <span class="nx">componentWillUnmount</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;组件卸载之前&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="c1">// 第三阶段：Count----组件挂载/组件更新
</span><span class="c1"></span>            <span class="nx">render</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;组件挂载/更新&#34;</span><span class="p">);</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">当前数字为</span><span class="err">：</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">add</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">点我</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">dead</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">卸载组件</span><span class="o">&lt;</span><span class="err">/button&gt;  </span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// 渲染组件
</span><span class="c1"></span>        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Count</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test1&#39;</span><span class="p">));</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102659.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102659.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102659.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102659.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102659.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102659.png" /></p>
<h4 id="5组件强制更新流程">5.组件强制更新流程</h4>
<ol>
<li>
<p>强制更新（ this.forceUpdate() ）：</p>
<p>没有更改状态，组件也能更新。</p>
<p>强制更新不受shouldComponentUpdate阀门的限制，直接往下走</p>
<ul>
<li>componentWillUpdate：组件更新前</li>
<li>render：组件更新</li>
<li>componentDidUpdate：组件更新完毕</li>
</ul>
</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>5_组件强制更新流程<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">Count</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>

            <span class="nx">force</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
                <span class="c1">// this.forceUpdate()方法：不修改状态，也能更新组件
</span><span class="c1"></span>                <span class="k">this</span><span class="p">.</span><span class="nx">forceUpdate</span><span class="p">();</span>
            <span class="p">}</span>

            <span class="c1">// 第一阶段：组件是否能更新的阀门
</span><span class="c1"></span>            <span class="nx">shouldComponentUpdate</span><span class="p">(){</span>
                <span class="c1">// 返回true才能更新组件
</span><span class="c1"></span>                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;组件是否能更新？&#34;</span><span class="p">);</span>
                <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="c1">// 第二阶段：组件更新前
</span><span class="c1"></span>            <span class="nx">componentWillUpdate</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;组件更新前&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="c1">// 第四阶段：组件更新完毕
</span><span class="c1"></span>            <span class="nx">componentDidUpdate</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;组件更新完毕&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="c1">// 第三阶段：Count----组件挂载/组件更新
</span><span class="c1"></span>            <span class="nx">render</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;组件挂载/更新&#34;</span><span class="p">);</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">force</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">不修改状态</span><span class="err">，</span><span class="nx">强制更新组件</span><span class="o">&lt;</span><span class="err">/button&gt;  </span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// 渲染组件
</span><span class="c1"></span>        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Count</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test1&#39;</span><span class="p">));</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102746.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102746.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102746.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102746.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102746.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102746.png" /></p>
<h4 id="6父组件render流程">6.父组件render流程</h4>
<p>一般是将父组件state对象中的属性，传给子组件的props</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>6_父组件render<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">Father</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>

            <span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="nx">car</span><span class="o">:</span><span class="s1">&#39;奥迪&#39;</span><span class="p">}</span>

            <span class="nx">changeCar</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">car</span><span class="o">:</span><span class="s1">&#39;奔驰&#39;</span><span class="p">})</span>
            <span class="p">}</span>

            <span class="nx">render</span><span class="p">(){</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="c1">// 将state对象中的属性，传给子组件的props
</span><span class="c1"></span>                    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">我是Father组件</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">changeCar</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">点我换车</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                        <span class="o">&lt;</span><span class="nx">Son</span> <span class="nx">car</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">car</span><span class="p">}</span><span class="o">/&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="kr">class</span> <span class="nx">Son</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>

            <span class="c1">// 第一阶段：组件将要接收到新的props参数钩子，此钩子可以接收参数props。但是此钩子有一个坑：第一次接收的不算，即第一次接收props参数，此函数不调用，必须得接收新的props参数才开始调用。
</span><span class="c1"></span>            <span class="nx">componentWillReceiveProps</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;组件将要接收到props参数&#34;</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="c1">// 第二阶段：组件是否能更新的阀门
</span><span class="c1"></span>            <span class="nx">shouldComponentUpdate</span><span class="p">(){</span>
                <span class="c1">// 返回true才能更新组件
</span><span class="c1"></span>                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;组件是否能更新？&#34;</span><span class="p">);</span>
                <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="c1">// 第三阶段：组件更新前
</span><span class="c1"></span>            <span class="nx">componentWillUpdate</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;组件更新前&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="c1">// 第五阶段：组件更新完毕
</span><span class="c1"></span>            <span class="nx">componentDidUpdate</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;组件更新完毕&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="c1">// 第四阶段：渲染组件/更新组件
</span><span class="c1"></span>            <span class="nx">render</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;渲染/更新&#34;</span><span class="p">);</span>
                <span class="c1">// 接收到的car参数封装到了this.props对象中，直接拿取
</span><span class="c1"></span>                <span class="k">return</span> <span class="p">(</span>
                    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">我是Son组件</span><span class="p">,</span><span class="nx">我接收到的车是</span><span class="err">：</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">car</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// 渲染组件
</span><span class="c1"></span>        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Father</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test1&#39;</span><span class="p">));</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102801.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102801.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102801.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102801.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102801.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102801.png" /></p>
<h4 id="7总结">7.总结</h4>
<p>常用：</p>
<p>render(){}</p>
<p>componentDIdMount(){}</p>
<ul>
<li>初始化的事情</li>
<li>开启定时器</li>
<li>发送网络请求</li>
<li>订阅消息</li>
</ul>
<p>componentWillUnmount(){}</p>
<ul>
<li>收尾的事情</li>
<li>关闭定时器</li>
<li>取消订阅</li>
</ul>
<h3 id="314-组件的生命周期新">3.14 组件的生命周期（新）</h3>
<p>新的生命周期中：componentWillMount、componentWillReceiveProps、componentWillUpdate使用时都需要加上前缀UNSAFE_。</p>
<p>因为这三个钩子函数被人乱用，可能在React的未来版本造成不安全的隐患。所以要使用，必须加上前缀才能使用，目前的版本中如果不加前缀，会有警告，未来的React版本，可能会直接报废弃的错，不能不加前缀使用</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102813.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102813.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102813.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102813.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102813.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102813.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102836.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102836.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102836.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102836.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102836.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102836.png" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>1_新旧区别<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/新版本/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/新版本/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/新版本/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">Count</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>

            <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;构造器&#34;</span><span class="p">);</span>
                <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="nx">count</span><span class="o">:</span><span class="mi">0</span><span class="p">};</span>
            <span class="p">}</span>

            <span class="nx">dead</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
                <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">unmountComponentAtNode</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test1&#39;</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="nx">add</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">count</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span><span class="o">+</span><span class="mi">1</span><span class="p">});</span>
            <span class="p">}</span>

            <span class="nx">force</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">forceUpdate</span><span class="p">();</span>
            <span class="p">}</span>

            <span class="nx">UNSAFE_componentWillMount</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;Count————组件将要挂载&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">componentDidMount</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;Count————组件刚挂载完毕&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">componentWillUnmount</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;Count————组件卸载之前&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="c1">// 第一阶段：组件是否能更新的阀门
</span><span class="c1"></span>            <span class="nx">shouldComponentUpdate</span><span class="p">(){</span>
                <span class="c1">// 返回true才能更新组件
</span><span class="c1"></span>                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;Count————组件是否能更新？&#34;</span><span class="p">);</span>
                <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="c1">// 第二阶段：组件更新前
</span><span class="c1"></span>            <span class="nx">UNSAFE_componentWillUpdate</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;Count————组件更新前&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="c1">// 第四阶段：组件更新完毕
</span><span class="c1"></span>            <span class="nx">componentDidUpdate</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;Count————组件更新完毕&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">render</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;Count————组件挂载/更新&#34;</span><span class="p">);</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">dead</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">卸载组件</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">add</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">点我</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">force</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">不修改状态</span><span class="err">，</span><span class="nx">强制更新组件</span><span class="o">&lt;</span><span class="err">/button&gt;  </span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="kr">class</span> <span class="nx">Father</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>

            <span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="nx">car</span><span class="o">:</span><span class="s1">&#39;奥迪&#39;</span><span class="p">}</span>

            <span class="nx">changeCar</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">car</span><span class="o">:</span><span class="s1">&#39;奔驰&#39;</span><span class="p">})</span>
            <span class="p">}</span>

            <span class="nx">render</span><span class="p">(){</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">我是Father组件</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">changeCar</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">点我换车</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                        <span class="o">&lt;</span><span class="nx">Son</span> <span class="nx">car</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">car</span><span class="p">}</span><span class="o">/&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="kr">class</span> <span class="nx">Son</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>

            <span class="c1">// 第一阶段：组件将要接收到props参数钩子，此钩子可以接收参数props。但是此钩子有一个坑：第一次接收的不算，即第一次接收props参数，此函数不调用，必须得接收新的props参数才开始调用。
</span><span class="c1"></span>            <span class="nx">UNSAFE_componentWillReceiveProps</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;组件将要接收到props参数&#34;</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="c1">// 第二阶段：组件是否能更新的阀门
</span><span class="c1"></span>            <span class="nx">shouldComponentUpdate</span><span class="p">(){</span>
                <span class="c1">// 返回true才能更新组件
</span><span class="c1"></span>                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;组件是否能更新？&#34;</span><span class="p">);</span>
                <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="c1">// 第三阶段：组件更新前
</span><span class="c1"></span>            <span class="nx">UNSAFE_componentWillUpdate</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;组件更新前&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="c1">// 第五阶段：组件更新完毕
</span><span class="c1"></span>            <span class="nx">componentDidUpdate</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;组件更新完毕&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="c1">// 第四阶段：渲染组件/更新组件
</span><span class="c1"></span>            <span class="nx">render</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;渲染/更新&#34;</span><span class="p">);</span>
                <span class="c1">// 接收到的car参数封装到了this.props对象中，直接拿取
</span><span class="c1"></span>                <span class="k">return</span> <span class="p">(</span>
                    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">我是Son组件</span><span class="p">,</span><span class="nx">我接收到的车是</span><span class="err">：</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">car</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Count</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test1&#39;</span><span class="p">));</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>就不会报错</p>
<h4 id="1getderivedstatefromprops">1.getDerivedStateFromProps</h4>
<p>从props中得到衍生状态。意思是：</p>
<ul>
<li>
<p>首先该函数可以接收props参数，也能接收state参数，但是这个state参数是指当前state</p>
</li>
<li>
<p>返回值只能是null和状态对象</p>
<ul>
<li>如果该函数的返回参数是null，那么不影响state</li>
<li>如果函数返回值是一个状态对象，即跟状态中的属性有关的对象，比如{name:&lsquo;憨憨&rsquo;}，或者直接返回props对象，那么相当于将返回的这个对象作为state的初始值，并且不能通过setState修改状态了，**因为setState和forceState也会触发getDerivedStateFromProps方法，所以用过setState修改state后，又触发getDerivedStateFromProps，那么就又将state值更新为props了，所以本质上用setState修改相当于没改。**此后的state改变完全取决于返回的这个对象。</li>
</ul>
</li>
<li>
<p>getDerivedStateFromProps必须为一个静态函数</p>
</li>
<li>
<p>应用场景：state的值完全取决于props时，即接收props参数，并且返回值也为props时</p>
</li>
</ul>
<p>比如：之前的点击按钮+1，是通过setState实现的，但是如果调用了这个函数，且返回值不为null</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>2_getDerivedStateFromProps<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/新版本/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/新版本/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/新版本/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">Count</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>

            <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;constructor————构造器&#34;</span><span class="p">);</span>
                <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="nx">count</span><span class="o">:</span><span class="mi">0</span><span class="p">};</span>
            <span class="p">}</span>

            <span class="nx">add</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">count</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span><span class="o">+</span><span class="mi">1</span><span class="p">});</span>
            <span class="p">}</span>

            <span class="c1">// 记得getDerivedStateFromProps必须为一个静态函数
</span><span class="c1"></span>            <span class="kr">static</span> <span class="nx">getDerivedStateFromProps</span><span class="p">(</span><span class="nx">props</span><span class="p">,</span><span class="nx">state</span><span class="p">){</span>
                <span class="c1">// 接收props
</span><span class="c1"></span>                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
                <span class="c1">// 这里是当前state
</span><span class="c1"></span>                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">state</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;getDerivedStateFromProps————从props中得到衍生状态&#34;</span><span class="p">);</span>
                <span class="c1">// 将返回值作为一个衍生的state，替换掉在这之前的state。并且后面再用setState不能修改state了，因为setState和forceState也会触发getDerivedStateFromProps方法，所以用过setState修改state后，又触发getDerivedStateFromProps，那么就又将state值更新为props了，所以本质上用setState修改相当于没改。state的改变完全跟props绑定在一起了。
</span><span class="c1"></span>                <span class="c1">// 当然这里也可以不返回props，可以返回一个与状态有关的对象即可{count:100}。
</span><span class="c1"></span>                <span class="k">return</span> <span class="nx">props</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nx">componentDidMount</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;componentDidMount————组件刚挂载完毕&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">componentWillUnmount</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;Count————组件卸载之前&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">shouldComponentUpdate</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;Count————组件是否能更新？&#34;</span><span class="p">);</span>
                <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nx">componentDidUpdate</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;Count————组件更新完毕&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">render</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;Count————组件挂载/更新&#34;</span><span class="p">);</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">当前数字为</span><span class="err">：</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">add</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">点我</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// 向props中传递count:100
</span><span class="c1"></span>        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Count</span> <span class="nx">count</span><span class="o">=</span><span class="p">{</span><span class="mi">100</span><span class="p">}</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test1&#39;</span><span class="p">));</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="2getsnapshotbeforeupdate">2.getSnapshotBeforeUpdate</h4>
<p>组件更新（render）到组件更新完毕（componentDidUpdate）之间，能获取一些<strong>组件更改前的信息</strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102858.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102858.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102858.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102858.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102858.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102858.png" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>3_getSnapshotBeforeUpdate<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/新版本/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/新版本/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/新版本/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">Count</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>

            <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;constructor————构造器&#34;</span><span class="p">);</span>
                <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="nx">count</span><span class="o">:</span><span class="mi">0</span><span class="p">};</span>
            <span class="p">}</span>

            <span class="nx">add</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">count</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span><span class="o">+</span><span class="mi">1</span><span class="p">});</span>
            <span class="p">}</span>

            <span class="kr">static</span> <span class="nx">getDerivedStateFromProps</span><span class="p">(</span><span class="nx">props</span><span class="p">,</span><span class="nx">state</span><span class="p">){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
                <span class="c1">// 这里是当前state
</span><span class="c1"></span>                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">state</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;getDerivedStateFromProps————从props中得到衍生状态&#34;</span><span class="p">);</span>
                <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nx">componentDidMount</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;componentDidMount————组件刚挂载完毕&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">shouldComponentUpdate</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;shouldComponentUpdate————组件是否能更新？&#34;</span><span class="p">);</span>
                <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="c1">// 组件更新render到组件更新完毕componentDidUpdate之间。作用：在更新之前，获取快照，返回值可以传给componentDidUpdate
</span><span class="c1"></span>            <span class="nx">getSnapshotBeforeUpdate</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;getSnapshotBeforeUpdate————组件更新到渲染组件到页面之间&#34;</span><span class="p">);</span>
                <span class="k">return</span> <span class="s1">&#39;快照值&#39;</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="c1">// 能接收两个参数，在这一次组件更新（调用setState或者使用getDerivedStateFromProps更新状态）前的props，这一次组件更新前的state
</span><span class="c1"></span>            <span class="nx">componentDidUpdate</span><span class="p">(</span><span class="nx">preProps</span><span class="p">,</span><span class="nx">preState</span><span class="p">,</span><span class="nx">snapshot</span><span class="p">){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">preProps</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">preState</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">snapshot</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;componentDidUpdate————组件更新完毕&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">componentWillUnmount</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;componentWillUnmount————组件卸载之前&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">render</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;render————组件挂载/更新&#34;</span><span class="p">);</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">当前数字为</span><span class="err">：</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">add</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">点我</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// 向props中传递count:100
</span><span class="c1"></span>        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Count</span> <span class="nx">count</span><span class="o">=</span><span class="p">{</span><span class="mi">100</span><span class="p">}</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test1&#39;</span><span class="p">));</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102912.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102912.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102912.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102912.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102912.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102912.png" /></p>
<h4 id="3getsnapshotbeforeupdate场景">3.getSnapshotBeforeUpdate场景</h4>
<p>实时新增新闻，并保持滚动条位置不随新闻数的增加而改变</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>4_getSnapshotBeforeUpdate使用场景<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/新版本/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/新版本/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/新版本/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">Count</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>

            
            <span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="nx">newsArr</span><span class="o">:</span><span class="p">[]};</span>

            <span class="kr">static</span> <span class="nx">getDerivedStateFromProps</span><span class="p">(</span><span class="nx">props</span><span class="p">,</span><span class="nx">state</span><span class="p">){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;getDerivedStateFromProps————从props中得到衍生状态&#34;</span><span class="p">);</span>
                <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nx">componentDidMount</span><span class="p">(){</span>
                <span class="nx">setInterval</span><span class="p">(()=&gt;{</span>
                    <span class="c1">// 每200毫秒创建一个新闻，并且不丢弃之前的新闻，将新创建的和之前的封装成一个数组设置为newsArr的值
</span><span class="c1"></span>                    <span class="kr">const</span> <span class="nx">news</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;新闻&#39;</span><span class="o">+</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">newsArr</span><span class="p">.</span><span class="nx">length</span><span class="o">+</span><span class="mi">1</span><span class="p">),...</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">newsArr</span><span class="p">];</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">newsArr</span><span class="o">:</span><span class="nx">news</span><span class="p">});</span>
                <span class="p">},</span><span class="mi">200</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;componentDidMount————组件刚挂载完毕&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">shouldComponentUpdate</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;shouldComponentUpdate————组件是否能更新？&#34;</span><span class="p">);</span>
                <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="c1">// 组件更新render到组件更新完毕componentDidUpdate之间。作用：在更新之前，获取快照，返回值可以传给componentDidUpdate
</span><span class="c1"></span>            <span class="nx">getSnapshotBeforeUpdate</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;getSnapshotBeforeUpdate————组件更新到渲染组件到页面之间&#34;</span><span class="p">);</span>
                <span class="c1">// 在这一次组件更新渲染之前，能获取到渲染完毕前的scrollHeight，将之传给componentDidUpdate
</span><span class="c1"></span>                <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">refs</span><span class="p">.</span><span class="nx">list</span><span class="p">.</span><span class="nx">scrollHeight</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="c1">// 能接收两个参数，在这一次组件更新（调用setState或者使用getDerivedStateFromProps更新状态）前的props，这一次组件更新前的state
</span><span class="c1"></span>            <span class="nx">componentDidUpdate</span><span class="p">(</span><span class="nx">preProps</span><span class="p">,</span><span class="nx">preState</span><span class="p">,</span><span class="nx">scrollHeight</span><span class="p">){</span>
                <span class="c1">// this.refs.list.scrollHeight-scrollHeight表示每次更新后，子元素增加的height
</span><span class="c1"></span>                <span class="c1">// 想让滚动条一直保持在某个地方，就必须将scrollTop设置为当前scrollTop+新增的height，就可以保持滚动条位置不变
</span><span class="c1"></span>                <span class="k">this</span><span class="p">.</span><span class="nx">refs</span><span class="p">.</span><span class="nx">list</span><span class="p">.</span><span class="nx">scrollTop</span><span class="o">+=</span><span class="k">this</span><span class="p">.</span><span class="nx">refs</span><span class="p">.</span><span class="nx">list</span><span class="p">.</span><span class="nx">scrollHeight</span><span class="o">-</span><span class="nx">scrollHeight</span><span class="p">;</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;componentDidUpdate————组件更新完毕&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">render</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;render————组件挂载/更新&#34;</span><span class="p">);</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s1">&#39;list&#39;</span> <span class="nx">ref</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="o">&gt;</span>
                        <span class="p">{</span>
                            <span class="c1">// 遍历渲染出来的节点，都需要指定key值
</span><span class="c1"></span>                            <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">newsArr</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">item</span><span class="p">,</span><span class="nx">index</span><span class="p">)=&gt;{</span>
                                <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s1">&#39;news&#39;</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">index</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">item</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/div&gt;</span>
                            <span class="p">})</span>
                        <span class="p">}</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Count</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test1&#39;</span><span class="p">));</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
        <span class="p">.</span><span class="nc">list</span><span class="p">{</span><span class="k">height</span><span class="p">:</span><span class="mi">150</span><span class="kt">px</span><span class="p">;</span> <span class="k">width</span><span class="p">:</span><span class="mi">100</span><span class="kt">px</span><span class="p">;</span> <span class="k">background</span><span class="p">:</span><span class="nb">rgb</span><span class="p">(</span><span class="mi">226</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="mi">123</span><span class="p">);</span> <span class="k">overflow</span><span class="p">:</span> <span class="kc">auto</span><span class="p">;}</span><span class="o">;</span>
        <span class="p">.</span><span class="nc">list</span> <span class="p">.</span><span class="nc">news</span><span class="p">{</span>
            <span class="k">height</span><span class="p">:</span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102926.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102926.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102926.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102926.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102926.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102926.png" /></p>
<h3 id="4总结">4.总结</h3>
<p>常用：跟旧版本的一样</p>
<p>render(){}</p>
<p>componentDIdMount(){}</p>
<ul>
<li>初始化的事情</li>
<li>开启定时器</li>
<li>发送网络请求</li>
<li>订阅消息</li>
</ul>
<p>componentWillUnmount(){}</p>
<ul>
<li>收尾的事情</li>
<li>关闭定时器</li>
<li>取消订阅</li>
</ul>
<h3 id="315-dom的ditting算法">3.15 Dom的ditting算法</h3>
<h4 id="1引出ditting">1.引出ditting</h4>
<p>页面开始：</p>
<pre><code>    1.生成虚拟DOM
    2.赋给真实DOM，渲染到页面
    3.更新状态
    4.生成新的虚拟DOM
    5.将新的虚拟DOM中节点的key与旧的虚拟DOM中节点的key比较：
        1.key不同：将新虚拟DOM中的节点添加到真实DOM中
        2.key相同：
            (1)如果新虚拟DOM中的内容为文本，则直接进行替换
            (2)如果相同的key对应的节点内容也相同，那么就直接采用真实DOM中的这个节点
            (3)如果相同的key对应的节点的内容不同，那么就将新的虚拟DOM中的这个节点覆盖真实DOM中的这个节点
            (4)如果相同的key中存在子节点，那么子节点则继续进行如上规则的判断
</code></pre>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>1_引出ditting<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/新版本/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/新版本/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/新版本/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="c">&lt;!-- 
</span><span class="c">        页面开始：
</span><span class="c">        1.生成虚拟DOM
</span><span class="c">        2.赋给真实DOM，渲染到页面
</span><span class="c">        3.更新状态
</span><span class="c">        4.生成新的虚拟DOM
</span><span class="c">        5.将新的虚拟DOM中节点的key与旧的虚拟DOM中节点的key比较：
</span><span class="c">            1.key不同：将新虚拟DOM中的节点添加到真实DOM中
</span><span class="c">            2.key相同：
</span><span class="c">                (1)如果新虚拟DOM中的内容为文本，则直接进行替换
</span><span class="c">                (2)如果相同的key对应的节点内容也相同，那么就直接采用真实DOM中的这个节点
</span><span class="c">                (3)如果相同的key对应的节点的内容不同，那么就将新的虚拟DOM中的这个节点覆盖真实DOM中的这个节点
</span><span class="c">                (4)如果相同的key中存在子节点，那么子节点则继续进行如上规则的判断
</span><span class="c">     --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">Showdate</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
            <span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="nx">currentDate</span><span class="o">:</span><span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">toLocaleString</span><span class="p">()};</span>

            <span class="nx">componentDidMount</span><span class="p">(){</span>
                <span class="c1">// 每一秒钟，更新状态为当前时间
</span><span class="c1"></span>                <span class="nx">setInterval</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">currentDate</span><span class="o">:</span><span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">toLocaleString</span><span class="p">()});</span>
            <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">render</span><span class="p">(){</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="c1">// 状态的改变，会重新生成一个新的虚拟DOM，这时再将新的虚拟DOM中节点的key与旧的虚拟DOM中节点的key作比较。
</span><span class="c1"></span>                    <span class="c1">// 1.key相同：（1）如果相同的key对应的节点内容也相同，那么就直接采用真实DOM中的这个节点 (2)如果相同的key对应的节点的内容不用，那么就将新的虚拟DOM中的这个节点渲染到真实DOM中
</span><span class="c1"></span>                    <span class="c1">// 2.key不同：直接将新的虚拟DOM中的这个节点渲染到真实DOM中
</span><span class="c1"></span>
                    <span class="c1">// 下面外层中的input节点和h1节点，包括span中的input节点，都是直接采用的真实DOM中的，因为每一次状态更新都没影响到这两个节点的内容，所以新旧虚拟DOM中，这两个节点key值相同，且内容相同，不用重新渲染到真实DOM，直接采用真实DOM中的这两个节点
</span><span class="c1"></span>                    <span class="c1">// 而span节点中除了input子节点之外的文本节点部分，就直接用新虚拟DOM覆盖真实DOM，{this.state.currentDate}由于内容不一样，所以也是每次都更新真实DOM
</span><span class="c1"></span>                    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span><span class="o">/&gt;</span>
                        <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">哈哈哈</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
                        <span class="o">&lt;</span><span class="nx">span</span><span class="o">&gt;</span>
                            <span class="nx">当前时间为</span><span class="err">：</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">currentDate</span><span class="p">}</span>
                            <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span><span class="o">/&gt;</span>
                        <span class="o">&lt;</span><span class="err">/span&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Showdate</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test1&#39;</span><span class="p">));</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102939.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102939.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102939.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102939.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102939.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102939.png" /></p>
<h4 id="2key的作用1">2.key的作用(1)</h4>
<p>页面开始：</p>
<pre><code>    1.生成虚拟DOM
    2.赋给真实DOM，渲染到页面
    3.更新状态
    4.生成新的虚拟DOM
    5.将新的虚拟DOM中节点的key与旧的虚拟DOM中节点的key比较：
        1.key不同：先将新虚拟DOM中的节点添加到真实DOM中，再将旧虚拟DOM中存在，但新虚拟DOM中不存在的节点删除
        2.key相同：
            (1)如果新虚拟DOM中的内容为文本，则直接进行替换
            (2)如果相同的key对应的节点内容也相同，那么就直接采用真实DOM中的这个节点
            (3)如果相同的key对应的节点的内容不同，那么就将新的虚拟DOM中的这个节点覆盖真实DOM中的这个节点
            (4)如果相同的key中存在子节点，那么子节点则继续进行如上规则的判断
</code></pre>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>2_key的作用<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/新版本/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/新版本/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/新版本/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="c">&lt;!-- 
</span><span class="c">        页面开始：
</span><span class="c">        1.生成虚拟DOM
</span><span class="c">        2.赋给真实DOM，渲染到页面
</span><span class="c">        3.更新状态
</span><span class="c">        4.生成新的虚拟DOM
</span><span class="c">        5.将新的虚拟DOM中节点的key与旧的虚拟DOM中节点的key比较：
</span><span class="c">            1.key不同：先将新虚拟DOM中的节点添加到真实DOM中，再将旧虚拟DOM中存在，但新虚拟DOM中不存在的节点删除
</span><span class="c">            2.key相同：
</span><span class="c">                (1)如果新虚拟DOM中的内容为文本，则直接进行替换
</span><span class="c">                (2)如果相同的key对应的节点内容也相同，那么就直接采用真实DOM中的这个节点
</span><span class="c">                (3)如果相同的key对应的节点的内容不同，那么就将新的虚拟DOM中的这个节点覆盖真实DOM中的这个节点
</span><span class="c">                (4)如果相同的key中存在子节点，那么子节点则继续进行如上规则的判断
</span><span class="c">     --&gt;</span>

     <span class="c">&lt;!-- 
</span><span class="c">        页面开始：如果以index下标作为key的话
</span><span class="c">        1.生成虚拟DOM
</span><span class="c">            &lt;li key={0}&gt;张三---------18&lt;/li&gt;
</span><span class="c">            &lt;li key={1}&gt;李四---------19&lt;/li&gt;
</span><span class="c">        2.赋给真实DOM，渲染到页面
</span><span class="c">        3.点击按钮更新状态
</span><span class="c">        4.生成新的虚拟DOM
</span><span class="c">            &lt;li key={0}&gt;王五---------20&lt;/li&gt;
</span><span class="c">            &lt;li key={1}&gt;张三---------18&lt;/li&gt;
</span><span class="c">            &lt;li key={2}&gt;李四---------19&lt;/li&gt;
</span><span class="c">        5.比较新虚拟DOM和旧虚拟DOM
</span><span class="c">            key为0：旧虚拟DOM：张三---------18，新虚拟DOM：王五---------20。内容不一样，所以将新虚拟DOM的 王五---------20 添加进真实DOM并渲染到页面
</span><span class="c">            key为1：旧虚拟DOM：李四---------19，新虚拟DOM：张三---------18。内容不一样，所以将新虚拟DOM的 张三---------18 添加进真实DOM并渲染到页面
</span><span class="c">            key为2：旧虚拟DOM中无，所以直接将新虚拟DOM的 李四---------19 添加进真实DOM并渲染到页面
</span><span class="c">        
</span><span class="c">        发现问题：张三---------18、李四---------19 在之前已经添加进真实DOM了，却因为key的值为index下标，由于在数组中的顺序改变了，导致index下标也
</span><span class="c">                 发生大变化，所以影响到key发生变化，导致 张三---------18 、李四---------19 因为key值与之前不用，被当作内容不一样的节点，又重新再一次添加进真实DOM
</span><span class="c">      --&gt;</span>

      <span class="c">&lt;!-- 
</span><span class="c">        页面开始：如果以id(每条数据的唯一标识)作为key的话
</span><span class="c">        1.生成虚拟DOM
</span><span class="c">            &lt;li key={1}&gt;张三---------18&lt;/li&gt;
</span><span class="c">            &lt;li key={2}&gt;李四---------19&lt;/li&gt;
</span><span class="c">        2.赋给真实DOM，渲染到页面
</span><span class="c">        3.点击按钮更新状态
</span><span class="c">        4.生成新的虚拟DOM
</span><span class="c">            &lt;li key={3}&gt;王五---------20&lt;/li&gt;
</span><span class="c">            &lt;li key={1}&gt;张三---------18&lt;/li&gt;
</span><span class="c">            &lt;li key={2}&gt;李四---------19&lt;/li&gt;
</span><span class="c">        5.比较新虚拟DOM和旧虚拟DOM
</span><span class="c">            key为1：旧虚拟DOM：张三---------18，新虚拟DOM：张三---------18。内容一样，所以直接采用真实DOM中的这个节点
</span><span class="c">            key为2：旧虚拟DOM：李四---------19，新虚拟DOM：李四---------19。内容一样，所以直接采用真实DOM中的这个节点
</span><span class="c">            key为3：旧虚拟DOM中无，所以直接将新虚拟DOM的王五---------20添加进真实DOM并渲染到页面
</span><span class="c">        
</span><span class="c">        效率比原本用index作为key高的多，之前已经添加进真实DOM中的节点不用再重复添加
</span><span class="c">      --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">Showperson</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>

            <span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="nx">person</span><span class="o">:</span><span class="p">[{</span><span class="nx">id</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;张三&#39;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">18</span><span class="p">,</span><span class="nx">sex</span><span class="o">:</span><span class="s1">&#39;男&#39;</span><span class="p">},{</span><span class="nx">id</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;李四&#39;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">19</span><span class="p">,</span><span class="nx">sex</span><span class="o">:</span><span class="s1">&#39;女&#39;</span><span class="p">}]};</span>

            <span class="nx">addPerson</span><span class="o">=</span><span class="p">()=&gt;{</span>
                <span class="kr">const</span> <span class="nx">person3</span><span class="o">=</span><span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">person</span><span class="p">.</span><span class="nx">length</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;王五&#39;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">20</span><span class="p">,</span><span class="nx">sex</span><span class="o">:</span><span class="s1">&#39;男&#39;</span><span class="p">};</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">person</span><span class="o">:</span><span class="p">[</span><span class="nx">person3</span><span class="p">,...</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">person</span><span class="p">]});</span>
            <span class="p">}</span>

            <span class="nx">render</span><span class="p">(){</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">addPerson</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">点击新增人</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                        <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">使用index</span><span class="err">（</span><span class="nx">索引值</span><span class="err">）</span><span class="nx">作为key</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                        <span class="p">{</span>
                            <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">person</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">item</span><span class="p">,</span><span class="nx">index</span><span class="p">)=&gt;{</span>
                                <span class="k">return</span> <span class="o">&lt;</span><span class="nx">li</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">index</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">name</span><span class="o">+</span><span class="s1">&#39;---------&#39;</span><span class="o">+</span><span class="nx">item</span><span class="p">.</span><span class="nx">age</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                            <span class="p">})</span>
                        <span class="p">}</span>
                        <span class="o">&lt;</span><span class="nx">hr</span><span class="o">/&gt;</span>
                        <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">使用id</span><span class="err">（</span><span class="nx">每条数据的唯一标识</span><span class="err">）</span><span class="nx">作为key</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                        <span class="p">{</span>
                            <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">person</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">item</span><span class="p">)=&gt;{</span>
                                <span class="k">return</span> <span class="o">&lt;</span><span class="nx">li</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">name</span><span class="o">+</span><span class="s1">&#39;---------&#39;</span><span class="o">+</span><span class="nx">item</span><span class="p">.</span><span class="nx">age</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                            <span class="p">})</span>
                        <span class="p">}</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Showperson</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test1&#39;</span><span class="p">));</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102955.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102955.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102955.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102955.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102955.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002102955.png" /></p>
<h4 id="3key的作用2">3.key的作用(2)</h4>
<p>页面开始：</p>
<pre><code>    1.生成虚拟DOM
    2.赋给真实DOM，渲染到页面
    3.更新状态
    4.生成新的虚拟DOM
    5.将新的虚拟DOM中节点的key与旧的虚拟DOM中节点的key比较：
        1.key不同：先将新虚拟DOM中的节点添加到真实DOM中，再将旧虚拟DOM中存在，但新虚拟DOM中不存在的节点删除
        2.key相同：
            (1)如果新虚拟DOM中的内容为文本，则直接进行替换
            (2)如果相同的key对应的节点内容也相同，那么就直接采用真实DOM中的这个节点
            (3)如果相同的key对应的节点的内容不同，那么就将新的虚拟DOM中的这个节点覆盖真实DOM中的这个节点
            (4)如果相同的key中存在子节点，那么子节点则继续进行如上规则的判断
</code></pre>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>3_key的作用(2)<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;test1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/新版本/react.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/新版本/react-dom.development.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;../js/新版本/babel.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="c">&lt;!-- 
</span><span class="c">        页面开始：
</span><span class="c">        1.生成虚拟DOM
</span><span class="c">        2.赋给真实DOM，渲染到页面
</span><span class="c">        3.更新状态
</span><span class="c">        4.生成新的虚拟DOM
</span><span class="c">        5.将新的虚拟DOM中节点的key与旧的虚拟DOM中节点的key比较：
</span><span class="c">            1.key不同：先将新虚拟DOM中的节点添加到真实DOM中，再将旧虚拟DOM中存在，但新虚拟DOM中不存在的节点删除
</span><span class="c">            2.key相同：
</span><span class="c">                (1)如果新虚拟DOM中的内容为文本，则直接进行替换
</span><span class="c">                (2)如果相同的key对应的节点内容也相同，那么就直接采用真实DOM中的这个节点
</span><span class="c">                (3)如果相同的key对应的节点的内容不同，那么就将新的虚拟DOM中的这个节点覆盖真实DOM中的这个节点
</span><span class="c">                (4)如果相同的key中存在子节点，那么子节点则继续进行如上规则的判断
</span><span class="c">     --&gt;</span>

     <span class="c">&lt;!-- 
</span><span class="c">        页面开始：如果以index下标作为key的话（input输入框中的value值只在真实DOM中存在，虚拟DOM中不存在value，因为只有渲染到页面上，页面上输入了值，才有value）
</span><span class="c">        1.生成虚拟DOM
</span><span class="c">            &lt;li key={0}&gt;张三---------18 &lt;input type=&#34;text&#34;/&gt; &lt;/li&gt;
</span><span class="c">            &lt;li key={1}&gt;李四---------19 &lt;input type=&#34;text&#34;/&gt; &lt;/li&gt;
</span><span class="c">        2.赋给真实DOM，渲染到页面
</span><span class="c">        3.点击按钮更新状态
</span><span class="c">        4.生成新的虚拟DOM
</span><span class="c">            &lt;li key={0}&gt;王五---------20 &lt;input type=&#34;text&#34;/&gt; &lt;/li&gt;
</span><span class="c">            &lt;li key={1}&gt;张三---------18 &lt;input type=&#34;text&#34;/&gt; &lt;/li&gt;
</span><span class="c">            &lt;li key={2}&gt;李四---------19 &lt;input type=&#34;text&#34;/&gt; &lt;/li&gt;
</span><span class="c">        5.比较新虚拟DOM和旧虚拟DOM
</span><span class="c">            key为0：旧虚拟DOM：张三---------18，新虚拟DOM：王五---------20。内容不一样，所以将新虚拟DOM的 王五---------20 添加进真实DOM并渲染到页面。再比较子节点input输入框，发现子节点input输入框的标签名和属性值都是一样的，所以将旧的虚拟DOM中的input子节点直接给新的虚拟DOM用，那么造成之前输入的“张三“也被一并挪过来了
</span><span class="c">            key为1：旧虚拟DOM：李四---------19，新虚拟DOM：张三---------18。内容不一样，所以将新虚拟DOM的 张三---------18 添加进真实DOM并渲染到页面。再比较子节点input输入框，发现子节点input输入框的标签名和属性值都是一样的，所以将旧的虚拟DOM中的input子节点直接给新的虚拟DOM用，那么造成之前输入的“李四“也被一并挪过来了
</span><span class="c">            key为2：旧虚拟DOM中无，所以直接将新虚拟DOM的 李四---------19 以及子input节点，添加进真实DOM并渲染到页面。
</span><span class="c">        
</span><span class="c">        发现问题：张三---------18、李四---------19 在之前已经添加进真实DOM了，却因为key的值为index下标，由于在数组中的顺序改变了，导致index下标也
</span><span class="c">                 发生大变化，所以影响到key发生变化，导致 张三---------18 、李四---------19 因为key值与之前不用，被当作内容不一样的节点，又重新再一次添加进真实DOM。
</span><span class="c">                 且输入框错位问题。
</span><span class="c">      --&gt;</span>

      <span class="c">&lt;!-- 
</span><span class="c">        页面开始：如果以id(每条数据的唯一标识)作为key的话
</span><span class="c">        1.生成虚拟DOM
</span><span class="c">            &lt;li key={1}&gt;张三---------18 &lt;input type=&#34;text&#34;/&gt; &lt;/li&gt;
</span><span class="c">            &lt;li key={2}&gt;李四---------19 &lt;input type=&#34;text&#34;/&gt; &lt;/li&gt;
</span><span class="c">        2.赋给真实DOM，渲染到页面
</span><span class="c">        3.点击按钮更新状态
</span><span class="c">        4.生成新的虚拟DOM
</span><span class="c">            &lt;li key={3}&gt;王五---------20 &lt;input type=&#34;text&#34;/&gt; &lt;/li&gt;
</span><span class="c">            &lt;li key={1}&gt;张三---------18 &lt;input type=&#34;text&#34;/&gt; &lt;/li&gt;
</span><span class="c">            &lt;li key={2}&gt;李四---------19 &lt;input type=&#34;text&#34;/&gt; &lt;/li&gt;
</span><span class="c">        5.比较新虚拟DOM和旧虚拟DOM
</span><span class="c">            key为1：旧虚拟DOM：张三---------18，新虚拟DOM：张三---------18。内容一样，所以直接采用真实DOM中的这个节点。子节点input也一样，所以新虚拟DOM直接采用旧虚拟DOM的子节点。
</span><span class="c">            key为2：旧虚拟DOM：李四---------19，新虚拟DOM：李四---------19。内容一样，所以直接采用真实DOM中的这个节点。子节点input也一样，所以新虚拟DOM直接采用旧虚拟DOM的子节点。
</span><span class="c">            key为3：旧虚拟DOM中无，所以直接将新虚拟DOM的 王五---------20以及子input节点 添加进真实DOM并渲染到页面
</span><span class="c">        
</span><span class="c">        效率比原本用index作为key高的多，之前已经添加进真实DOM中的节点不用再重复添加，也不会发生子input节点错位的情况
</span><span class="c">      --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/babel&#34;</span><span class="p">&gt;</span>
        <span class="kr">class</span> <span class="nx">Showperson</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>

            <span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="nx">person</span><span class="o">:</span><span class="p">[{</span><span class="nx">id</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;张三&#39;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">18</span><span class="p">,</span><span class="nx">sex</span><span class="o">:</span><span class="s1">&#39;男&#39;</span><span class="p">},{</span><span class="nx">id</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;李四&#39;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">19</span><span class="p">,</span><span class="nx">sex</span><span class="o">:</span><span class="s1">&#39;女&#39;</span><span class="p">}]};</span>

            <span class="nx">addPerson</span><span class="o">=</span><span class="p">()=&gt;{</span>
                <span class="kr">const</span> <span class="nx">person3</span><span class="o">=</span><span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">person</span><span class="p">.</span><span class="nx">length</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;王五&#39;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">20</span><span class="p">,</span><span class="nx">sex</span><span class="o">:</span><span class="s1">&#39;男&#39;</span><span class="p">};</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">person</span><span class="o">:</span><span class="p">[</span><span class="nx">person3</span><span class="p">,...</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">person</span><span class="p">]});</span>
            <span class="p">}</span>

            <span class="nx">render</span><span class="p">(){</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">addPerson</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">点击新增人</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                        <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">使用index</span><span class="err">（</span><span class="nx">索引值</span><span class="err">）</span><span class="nx">作为key</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                        <span class="p">{</span>
                            <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">person</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">item</span><span class="p">,</span><span class="nx">index</span><span class="p">)=&gt;{</span>
                                <span class="k">return</span> <span class="o">&lt;</span><span class="nx">li</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">index</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">name</span><span class="o">+</span><span class="s1">&#39;---------&#39;</span><span class="o">+</span><span class="nx">item</span><span class="p">.</span><span class="nx">age</span><span class="p">}</span> <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span><span class="o">/&gt;</span> <span class="o">&lt;</span><span class="err">/li&gt;</span>
                            <span class="p">})</span>
                        <span class="p">}</span>
                        <span class="o">&lt;</span><span class="nx">hr</span><span class="o">/&gt;</span>
                        <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">使用id</span><span class="err">（</span><span class="nx">每条数据的唯一标识</span><span class="err">）</span><span class="nx">作为key</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                        <span class="p">{</span>
                            <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">person</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">item</span><span class="p">)=&gt;{</span>
                                <span class="k">return</span> <span class="o">&lt;</span><span class="nx">li</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">name</span><span class="o">+</span><span class="s1">&#39;---------&#39;</span><span class="o">+</span><span class="nx">item</span><span class="p">.</span><span class="nx">age</span><span class="p">}</span> <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span><span class="o">/&gt;</span> <span class="o">&lt;</span><span class="err">/li&gt;</span>
                            <span class="p">})</span>
                        <span class="p">}</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Showperson</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test1&#39;</span><span class="p">));</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103008.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103008.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103008.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103008.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103008.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103008.png" /></p>
<h4 id="4总结-1">4.总结</h4>
<p>用index作为key可能引发的问题：</p>
<p>注意：输入类的包括，单选框、多选框啥的</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103018.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103018.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103018.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103018.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103018.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103018.png" /></p>
<p>开发时如何选择key<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103029.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103029.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103029.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103029.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103029.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103029.png" /></p>
<h2 id="4初始化react脚手架">4.初始化react脚手架</h2>
<h3 id="1什么叫脚手架">1.什么叫脚手架</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103044.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103044.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103044.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103044.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103044.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103044.png" /></p>
<h3 id="2初始化脚手架">2.初始化脚手架</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103054.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103054.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103054.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103054.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103054.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103054.png" /></p>
<p>使用脚手架创建react项目成功后：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103107.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103107.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103107.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103107.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103107.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103107.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103118.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103118.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103118.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103118.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103118.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103118.png" /></p>
<p>再打开项目文件，启动项目</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103130.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103130.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103130.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103130.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103130.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103130.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103141.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103141.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103141.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103141.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103141.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103141.png" /></p>
<h2 id="5react脚手架项目结构">5.react脚手架项目结构</h2>
<ol>
<li>public：静态资源文件夹</li>
</ol>
<ul>
<li>
<p>react和vue都是spa单页面程序，只有一个主页面，所有的子页面都包含在这里面，整个项目只有一个html文件</p>
</li>
<li>
<p>应用加壳：如果你写了一个web应用，但是想让它在手机上也能运行。一般的做法是，让专门的移动端人员用移动端的语法重新写出这个应用。但是应用加壳的意思是：在这个web应用外层加一层安卓壳（或IOS壳）。让它在移动端看上去运行的是一个移动端的应用，但实际上内部的代码是一个web应用</p>
</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103151.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103151.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103151.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103151.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103151.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103151.png" /></p>
<p>index.html中</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103202.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103202.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103202.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103202.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103202.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103202.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103215.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103215.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103215.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103215.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103215.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103215.png" /></p>
<ol start="2">
<li>src：源码文件夹</li>
</ol>
<ul>
<li>
<p><strong>App.css</strong>：作用于App.js的外部样式</p>
</li>
<li>
<p><strong>App.js</strong>：实际上是定义了一个函数式组件，函数名叫做App，该组件被默认暴露，在index.js中被渲染到index.html中的div节点中。（注意：index.js只把这一个组件渲染到index.html中，其他的组件全部为App.js的子组件）</p>
</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103227.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103227.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103227.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103227.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103227.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103227.png" /></p>
<ul>
<li>
<p><strong>App.test.js</strong>：专门测试App.js的测试文件</p>
</li>
<li>
<p><strong>index.css</strong>：作用于index.js的样式，可以在index.js中引入，也可以在index.html中引入</p>
</li>
<li>
<p><strong>index.js</strong>：入口文件</p>
<ul>
<li>
<p>引入React</p>
</li>
<li>
<p>引入ReactDOM</p>
</li>
<li>
<p>引入样式</p>
</li>
<li>
<p>引入组件（.js和.jsx文件的后缀可以省略）</p>
</li>
<li>
<p>引入介绍页面性能的文件</p>
</li>
<li>
<p>渲染App.js组件到index.html的div节点中</p>
</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103244.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103244.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103244.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103244.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103244.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103244.png" /></p>
</li>
<li>
<p>reportWebVitals.js：用于介绍页面性能的，靠的是web-vitals这个库</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103256.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103256.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103256.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103256.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103256.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103256.png" /></p>
</li>
<li>
<p>setupTests.js：用于做应用的整体测试的，组件测试</p>
</li>
</ul>
<ol start="3">
<li>
<p>项目执行顺序：</p>
<p>一来就执行index.js，将App组件渲染到index.html页面</p>
</li>
</ol>
<h2 id="6分别暴露和默认暴露">6.分别暴露和默认暴露</h2>
<p>默认暴露：直接暴露一整个组件，你可以在另一个页面先引入这个组件  <strong>import 组件别名 from 路径</strong>  ，然后可以用  <strong>const {组件里的东西}=组件</strong>  的形式从组件中获取东西，这里的{}表示结构化赋值。</p>
<p>分别暴露：暴露组件内的某个东西，比如方法、属性等等，引入： <strong>import {名字} from 路径</strong>  ,但是这里的{}不是结构化赋值，这里表示如果是获得分别暴露的东西，那么取的时候就需要加上{}</p>
<p>如果一个出现<code>import 组件别名,{名字} from ‘路径’</code> 这种引入方式，则表示这个组件内有多种暴露方式</p>
<h2 id="7一个简单的hello组件">7.一个简单的hello组件</h2>
<p>react中区分组件js文件和普通js文件：</p>
<ol>
<li>组件js文件的文件名中首字母大写</li>
<li>组件js文件其实可以命名为xxx.jsx，那么.jsx文件就代表组件js，.js文件就代表普通js文件</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103308.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103308.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103308.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103308.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103308.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103308.png" /></p>
<ul>
<li>
<p>Hello.js子组件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 引入默认暴露的React组件 和 分别暴露的React组件中的Component类
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">React</span><span class="p">,{</span><span class="nx">Component</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="c1">// 引入样式
</span><span class="c1"></span><span class="kr">import</span> <span class="s1">&#39;./Hello.css&#39;</span><span class="p">;</span>
  
<span class="c1">// export default直接写在这里，简便
</span><span class="c1">// 这里直接写的Component，是因为已经引入了Component，可以不用加React前缀
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Hello</span> <span class="kr">extends</span> <span class="nx">Component</span><span class="p">{</span>
    <span class="nx">render</span><span class="p">(){</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;hello&#34;</span><span class="o">&gt;</span>
                <span class="nx">hello</span><span class="o">!!!</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Hello.css</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-css" data-lang="css"><span class="p">.</span><span class="nc">hello</span><span class="p">{</span>
    <span class="k">background-color</span><span class="p">:</span> <span class="kc">aquamarine</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Wellcom.js子组件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 引入默认暴露的React组件 和 分别暴露的React组件中的Component类
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">React</span><span class="p">,{</span><span class="nx">Component</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="c1">// 引入样式
</span><span class="c1"></span><span class="kr">import</span> <span class="s1">&#39;./Wellcom.css&#39;</span><span class="p">;</span>
  
<span class="c1">// export default直接写在这里，简便
</span><span class="c1">// 这里直接写的Component，是因为已经引入了Component，可以不用加React前缀
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Wellcom</span> <span class="kr">extends</span> <span class="nx">Component</span><span class="p">{</span>
    <span class="nx">render</span><span class="p">(){</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s1">&#39;wellcom&#39;</span><span class="o">&gt;</span>
                <span class="nx">Wellcom</span><span class="o">!!!</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Wellcom.css</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-css" data-lang="css"><span class="p">.</span><span class="nc">wellcom</span><span class="p">{</span>
    <span class="k">background-color</span><span class="p">:</span> <span class="kc">rebeccapurple</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>App.js主组件：包含所有子组件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 引入React组件
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="c1">// 引入Hello组件,react中引入时可以省略后缀.js或者是.jsx
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">Hello</span> <span class="nx">from</span> <span class="s1">&#39;./component/Hello/Hello&#39;</span>
<span class="c1">// 引入Wellcom组件
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">Wellcom</span> <span class="nx">from</span> <span class="s1">&#39;./component/Wellcom/Wellcom&#39;</span>
  
  
<span class="kr">const</span> <span class="p">{</span><span class="nx">Component</span><span class="p">}</span><span class="o">=</span><span class="nx">React</span>
<span class="c1">// 这里可以直接写Component是因为用结构赋值将Component从React中取出来了
</span><span class="c1"></span><span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span><span class="p">{</span>
    <span class="nx">render</span><span class="p">(){</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="c1">// App.js中一般是引入子组件,而不是自己去写虚拟DOM结构
</span><span class="c1"></span>            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">Hello</span><span class="o">/&gt;</span>
                <span class="o">&lt;</span><span class="nx">Wellcom</span><span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
  
<span class="c1">// 默认暴露App组件
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="nx">App</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>index.html：主页面</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>主页面<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;root&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>index.js入口：将App组件渲染到页面</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 引入React
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="c1">// 引入ReactDOM
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">ReactDOM</span> <span class="nx">from</span> <span class="s1">&#39;react-dom&#39;</span><span class="p">;</span>
<span class="c1">// 引入App组件，.js可以省略
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">App</span> <span class="nx">from</span> <span class="s1">&#39;./App&#39;</span><span class="p">;</span>
  
  
<span class="c1">// 渲染App组件到index.html页面
</span><span class="c1"></span><span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">App</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;root&#39;</span><span class="p">));</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103324.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103324.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103324.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103324.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103324.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103324.png" /></p>
<h2 id="8样式模块化">8.样式模块化</h2>
<p>真正项目开发中一般每个子组件对应的文件夹下的js和css都命名为index.js和index.css。</p>
<p>不管用不用index命名，如果每个组件内都没有与别的组件内的节点的className名发生重名的话，那就没有任何问题。但是如果存在某个组件内与另一个组件内的某个节点的className同名，那么会造成一个问题：</p>
<p>比如两个组件内都有一个className为hello的节点，并且两个组件对应的样式表都对这个节点进行了修改，都为.hello{}。那么最终子组件被引入到App主组件时，主组件采用的永远是后引入的子组件对应的重名样式</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103343.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103343.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103343.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103343.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103343.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103343.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103353.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103353.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103353.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103353.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103353.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103353.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103404.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103404.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103404.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103404.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103404.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103404.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103414.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103414.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103414.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103414.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103414.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103414.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103424.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103424.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103424.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103424.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103424.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103424.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103433.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103433.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103433.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103433.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103433.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103433.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103444.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103444.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103444.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103444.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103444.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103444.png" /></p>
<p>解决方法：</p>
<ol>
<li>
<p>用less样式时，样式前面都会加上父节点的 .class名 这样就即使节点同名了也没事，因为父节点不一样</p>
</li>
<li>
<p>实现样式模块化：</p>
<ul>
<li>给每个组件的css文件名从 文件名.css 修改为 文件名.module.css</li>
<li>引入的时候就可以把css当成一个模块来引入</li>
<li>那么组件中的节点的className名就为 xxx.title</li>
</ul>
</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103457.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103457.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103457.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103457.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103457.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103457.png" /></p>
<ul>
<li>
<p>Hello/index.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 引入默认暴露的React组件 和 分别暴露的React组件中的Component类
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">React</span><span class="p">,{</span><span class="nx">Component</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="c1">// 引入模块的方式引入样式,hello为自定义名字
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">hello</span> <span class="nx">from</span> <span class="s1">&#39;./index.module.css&#39;</span><span class="p">;</span>
  
<span class="c1">// export default直接写在这里，简便
</span><span class="c1">// 这里直接写的Component，是因为已经引入了Component，可以不用加React前缀
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Hello</span> <span class="kr">extends</span> <span class="nx">Component</span><span class="p">{</span>
    <span class="nx">render</span><span class="p">(){</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="c1">// 这里就可以将hello当成一个模块,直接拿取模块里面的值
</span><span class="c1"></span>            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="p">{</span><span class="nx">hello</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span><span class="o">&gt;</span>
                <span class="nx">hello</span><span class="o">!!!</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Wellcom/index.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 引入默认暴露的React组件 和 分别暴露的React组件中的Component类
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">React</span><span class="p">,{</span><span class="nx">Component</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="c1">// 引入模块的方式引入样式,hello为自定义名字
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">wellcom</span> <span class="nx">from</span> <span class="s1">&#39;./index.module.css&#39;</span><span class="p">;</span>
  
<span class="c1">// export default直接写在这里，简便
</span><span class="c1">// 这里直接写的Component，是因为已经引入了Component，可以不用加React前缀
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Wellcom</span> <span class="kr">extends</span> <span class="nx">Component</span><span class="p">{</span>
    <span class="nx">render</span><span class="p">(){</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="c1">// 这里就可以将hello当成一个模块,直接拿取模块里面的值
</span><span class="c1"></span>            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="p">{</span><span class="nx">wellcom</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span><span class="o">&gt;</span>
                <span class="nx">Wellcom</span><span class="o">!!!</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>App.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 引入React组件
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="c1">// 引入Hello组件,react中引入时可以省略后缀.js或者是.jsx
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">Hello</span> <span class="nx">from</span> <span class="s1">&#39;./component/Hello&#39;</span>
<span class="c1">// 引入Wellcom组件
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">Wellcom</span> <span class="nx">from</span> <span class="s1">&#39;./component/Wellcom&#39;</span>
  
  
<span class="kr">const</span> <span class="p">{</span><span class="nx">Component</span><span class="p">}</span><span class="o">=</span><span class="nx">React</span>
<span class="c1">// 这里可以直接写Component是因为用结构赋值将Component从React中取出来了
</span><span class="c1"></span><span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span><span class="p">{</span>
    <span class="nx">render</span><span class="p">(){</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="c1">// App.js中一般是引入子组件,而不是自己去写虚拟DOM结构
</span><span class="c1"></span>            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">Hello</span><span class="o">/&gt;</span>
                <span class="o">&lt;</span><span class="nx">Wellcom</span><span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
  
<span class="c1">// 默认暴露App组件
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="nx">App</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="9-react插件及快捷键">9. react插件及快捷键</h2>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103512.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103512.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103512.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103512.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103512.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103512.png" /></p>
<p>安装后，在.js文件中：</p>
<p>rcc+回车：快速生成类式组件模板</p>
<p>rfc+回车：快速生成函数式组件模板</p>
<h2 id="9功能界面的组件化编码流程">9.功能界面的组件化编码流程</h2>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103522.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103522.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103522.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103522.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103522.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103522.png" /></p>
<h2 id="10todolist案例">10.TodoList案例</h2>
<p>效果：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103532.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103532.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103532.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103532.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103532.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103532.png" /></p>
<ol>
<li>输入任务名称，点击回车，自动将此任务添加进下面列表</li>
<li>鼠标放在列表中的某项上，某项就显示高亮，并且该行右侧出现删除按钮</li>
<li>可以选中要清楚的任务，再点击清除已完成任务按钮，即可从列表中消失并且在左下角的有实时数字显示完成的条数</li>
</ol>
<h3 id="1静态组件">1.静态组件</h3>
<ul>
<li>拆分组件：</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103545.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103545.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103545.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103545.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103545.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103545.png" /></p>
<ul>
<li>实现静态页面（不包含事件）</li>
</ul>
<p>注意事项：</p>
<ol>
<li>如果组件中有使用子组件，那么记得导入</li>
<li>记得在主组件App.js中导入所有子组件</li>
<li>记得在每个子组件中导入css样式</li>
<li>记得将主组件渲染到主页面</li>
<li>记得className</li>
<li>记得style={{xxx:xxx}}</li>
</ol>
<h3 id="2动态添加列表">2.动态添加列表</h3>
<p>所有的东西应该都放在父组件App.js中，因为方便传递给不同的子组件，也能暂时避免兄弟组件之间的数据传递。</p>
<p>注意事项：</p>
<ol>
<li>遍历出来的组件和标签都要加上key</li>
<li>所有东西都放在父组件的state中，通过prop的方式传递给子组件。</li>
</ol>
<h3 id="3添加todo">3.添加todo</h3>
<p>注意事项：</p>
<ol>
<li><strong>父组件给子组件传数据</strong>：props</li>
<li><strong>子组件给父组件传数据</strong>：
<ul>
<li>父组件给子组件通过props传一个函数，子组件调用函数时用实参给父组件传数据</li>
</ul>
</li>
<li>生成全世界唯一的字符串的一个工具叫做：nanoid
<ul>
<li>先npm install nanoid</li>
<li>再在用到的页面导入import {nanoid} from &lsquo;nanoid&rsquo;，因为它里面用分别暴露的形式暴露了一个nanoid函数</li>
<li>使用时调用nanoid()，即可得到一个全球唯一的字符串</li>
</ul>
</li>
</ol>
<h3 id="4鼠标移入效果">4.鼠标移入效果</h3>
<p>注意事项：</p>
<ol>
<li>触发事件后执行的，必须是一个函数，如果在赋值的时候，函数带了参数的话，那么它就是一个函数调用，而不是一个函数。解决方法是：让此函数的返回值为一个回调函数</li>
<li>内联style中第一个花括号表示里面写的是js代码，第二个花括号表示这是一个对象</li>
</ol>
<h3 id="5勾选时改变状态中的对象属性值">5.勾选时改变状态中的对象属性值</h3>
<p>注意事项：</p>
<ol>
<li>如果是孙组件要给祖组件传数据，那么祖组件需要传一个函数给父组件，父组件再传一个函数给子组件，即要一级一级的传递</li>
<li>可以使用{&hellip;对象，属性：新属性值}的方式修改对象中某一属性的属性值，<strong>并直接返回一个新对象</strong></li>
<li>type为checkbox的input标签，得到它是否被勾选的属性是checked，checked为true，则被勾选，否则没被勾选</li>
</ol>
<h3 id="6对props限制">6.对props限制</h3>
<p>注意事项：</p>
<ol>
<li>先install i prop-types</li>
<li>记得导入包：import PropTypes from &lsquo;prop-types&rsquo; //引入能对props进行限制的包</li>
<li>记得是在接收props参数的类中进行限制</li>
</ol>
<h3 id="7删除一个todo">7.删除一个todo</h3>
<p>注意事项：</p>
<ol>
<li>将删除的id传给App组件，在App组件中用filter进行删除</li>
<li>删除前用confirm进行确认，注意：在react中confirm前要加window.，即window.confirm</li>
</ol>
<h3 id="8实现底部功能">8.实现底部功能</h3>
<p><strong>1.实现底部计数功能：</strong></p>
<p>注意事项：</p>
<ol>
<li>用reduce对数组进行条件计数，切记：二目运算符中使用三目运算符，是需要加括号的。赋值语句中使用三目运算符，不需要加括号</li>
</ol>
<p><strong>2.实现全选框选中时，所有选项全被选中。取消时：所有选择框全部被取消</strong></p>
<ol>
<li>通过map修改done的值，判断checked，当全选框的checked属性值为true时，修改所有选项的done为true，当全选框的checked属性值为false时，修改所有选项的done为false</li>
<li>状态在哪，修改状态的方法就在哪里，所以修改状态应该放在App组件</li>
</ol>
<p><strong>3.实现当所有选框都被选中时，全选框被选中，取消一个时，全选框被取消</strong></p>
<ol>
<li>通过设置标签上checked属性值，判断如果全部完成的数量===所有事项的数量，则将全选框的checked属性设置为true</li>
</ol>
<h3 id="9todolist总结">9.todolist总结</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103559.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103559.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103559.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103559.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103559.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103559.png" /></p>
<h2 id="11脚手架配置代理">11.脚手架配置代理</h2>
<h3 id="1理解">1.理解</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103613.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103613.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103613.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103613.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103613.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103613.png" /></p>
<h3 id="2例子">2.例子</h3>
<p><strong>先安装axios包，再导入包</strong></p>
<p>有一个小型的服务器，能返回固定学生数据，当服务器启动后，网址是：http://localhost:5000/students</p>
<p>现写一个页面：点击按钮，则请求到http://localhost:5000/students这个页面</p>
<p><strong>结果</strong>：报错，因为当前页面所在网址是http://localhost:3000，不能跨域到http://localhost:5000/students。请求发送成功了，但是不能返回数据，因为客户端有Ajax引擎，Ajax引擎拒绝接收跟客户端端口不一致的服务器数据</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103625.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103625.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103625.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103625.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103625.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103625.png" /></p>
<p><strong>解决</strong>：配置代理</p>
<p><strong>中间代理的端口号要和客户端一样</strong>，中间代理能接收不同端口号的服务器数据，因为它里面没有Ajax请求，它是由请求转发实现的</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103636.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103636.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103636.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103636.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103636.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103636.png" /></p>
<h3 id="3配置代理">3.配置代理</h3>
<p><strong>方法一：</strong></p>
<ul>
<li>在前端的package.json加一个&quot;proxy&quot;:&ldquo;代理服务器地址&rdquo;，表示：所有发给3000的请求，全部转发给了5000。<strong>注意：修改了配置文件后，必须重启一下项目</strong></li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103647.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103647.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103647.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103647.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103647.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103647.png" /></p>
<ul>
<li>设置一下请求的地址，改为3000，因为中间代理的端口号要和客户端的一致</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="nx">Axios</span> <span class="nx">from</span> <span class="s1">&#39;axios&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>

    <span class="nx">getStudent</span><span class="o">=</span><span class="p">()=&gt;{</span>
        <span class="c1">// 请求先发给中间代理，中间代理的端口号与客户端一致，由于在package.json中设置了proxy为5000，表示：所有发给3000的请求都会被转发到5000，所以这里发给中间代理3000的请求，又会被转发给5000
</span><span class="c1"></span>        <span class="nx">Axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;http://localhost:3000/students&#39;</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span>
            <span class="nx">response</span><span class="p">=&gt;{</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;成功了&#34;</span><span class="p">,</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);},</span>
            <span class="nx">error</span><span class="p">=&gt;{</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;失败了&#34;</span><span class="p">,</span><span class="nx">error</span><span class="p">);}</span>
        <span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">getStudent</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">点我获取学生信息</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></td></tr></table>
</div>
</div><ul>
<li>启动服务器，运行程序，前端即可请求到端口不一致的服务器的数据</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103700.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103700.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103700.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103700.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103700.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103700.png" /></p>
<p>但是并不是所有的3000请求都会被转发到5000，如果是3000中存在的资源，就不会被转发到5000，直接在3000中拿取。3000没有的资源，就会被转发到5000</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">getStudent</span><span class="o">=</span><span class="p">()=&gt;{</span>
        <span class="c1">// 请求先发给中间代理，中间代理的端口号与客户端一致，由于在package.json中设置了proxy为5000，表示：所有发给3000的请求都会被转发到5000，所以这里发给中间代理3000的请求，又会被转发给5000
</span><span class="c1"></span>        <span class="nx">Axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;http://localhost:3000/students&#39;</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span>
            <span class="nx">response</span><span class="p">=&gt;{</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;成功了&#34;</span><span class="p">,</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);},</span>
            <span class="nx">error</span><span class="p">=&gt;{</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;失败了&#34;</span><span class="p">,</span><span class="nx">error</span><span class="p">);}</span>
        <span class="p">)</span>
        <span class="c1">// 设置proxy为5000，并不是代表所有请求都被转发到了5000，如果是3000中存在的资源，就不会被转发到5000，直接在3000中拿取
</span><span class="c1"></span>        <span class="c1">// 比如这里的index.html是3000中存在的，那么就不会去到服务器5000拿
</span><span class="c1"></span>        <span class="nx">Axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;http://localhost:3000/index.html&#39;</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span>
            <span class="nx">response</span><span class="p">=&gt;{</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;成功了&#34;</span><span class="p">,</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);},</span>
            <span class="nx">error</span><span class="p">=&gt;{</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;失败了&#34;</span><span class="p">,</span><span class="nx">error</span><span class="p">);}</span>
        <span class="p">)</span>
    <span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103711.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103711.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103711.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103711.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103711.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103711.png" /></p>
<p>方法一的局限：3000没有的资源只会找5000要，只能转发到一个服务器</p>
<p><strong>方法二：</strong></p>
<p>建一个名为setupProxy.js的配置文件，文件名不能改，react会自动识别这个配置文件。配置文件中不能用ES6的语法，而要用CIS的语法去写，因为setupProxy.js不是给前端运行的，react会识别这个配置文件，并将它加到webpack配置中，webpack中用的就是CJS语法</p>
<p><strong>增加了文件后，一定要重启项目</strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103721.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103721.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103721.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103721.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103721.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103721.png" /></p>
<p>setupProxy.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js">
<span class="c1">// 此包在安装react脚手架时就安装了
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">proxy</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;http-proxy-middleware&#39;</span><span class="p">)</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">app</span><span class="p">){</span>
    <span class="cm">/** proxy第一个参数：请求的前缀；第二个参数：转发详情
</span><span class="cm">     *      1.proxy：表示将带有某个前缀的请求转发到另一个网址
</span><span class="cm">     *      2.changeOrigin：控制服务器收到的请求头中Host字段的值，Host：标识着本次请求从哪里发出的
</span><span class="cm">     *          为false（默认）：Host值为真正发出请求的来源，此例中即为3000
</span><span class="cm">     *          为true：Host值为转发后的网址，此例中为5000或5001。最好改为true，因为避免服务器知道你实际上是3000发出的请求，就会对你有一些限制
</span><span class="cm">     *      3.pathRewrite：修改请求前缀
</span><span class="cm">     */</span>

    <span class="c1">// 表示只要是3000，并且带了/api1前缀的请求，即前面有http://localhost:3000/api1的请求，就会被转发到http://localhost:5000/api1。这时我们需要去掉前缀，所以用pathRewrite去掉前缀。
</span><span class="c1"></span>    <span class="c1">// 所以只要有http://localhost:3000/api1的请求，就会被转发到http://localhost:5000
</span><span class="c1"></span>    <span class="c1">// 同理只要有http://localhost:3000/api2的请求，就会被转发到http://localhost:5001
</span><span class="c1"></span>    <span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span>
        <span class="nx">proxy</span><span class="p">(</span><span class="s1">&#39;/api1&#39;</span><span class="p">,{</span>
            <span class="nx">target</span><span class="o">:</span><span class="s1">&#39;http://localhost:5000&#39;</span><span class="p">,</span>
            <span class="nx">changeOrigin</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span>
            <span class="nx">pathRewrite</span><span class="o">:</span><span class="p">{</span><span class="s1">&#39;^/api1&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span>
        <span class="p">}),</span>
        <span class="nx">proxy</span><span class="p">(</span><span class="s1">&#39;/api2&#39;</span><span class="p">,{</span>
            <span class="nx">target</span><span class="o">:</span><span class="s1">&#39;http://localhost:5001&#39;</span><span class="p">,</span>
            <span class="nx">changeOrigin</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span>
            <span class="nx">pathRewrite</span><span class="o">:</span><span class="p">{</span><span class="s1">&#39;^/api2&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span>
        <span class="p">})</span>
    <span class="p">)</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>App.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="nx">Axios</span> <span class="nx">from</span> <span class="s1">&#39;axios&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>

    <span class="nx">getStudent</span><span class="o">=</span><span class="p">()=&gt;{</span>
        <span class="c1">// 如果3000中没有请求的这个资源，就会走/api1配置的这个代理：http://localhost:3000/api1前缀的请求被转发到http://localhost:5000
</span><span class="c1"></span>        <span class="nx">Axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;http://localhost:3000/api1/students&#39;</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span>
            <span class="nx">response</span><span class="p">=&gt;{</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;成功了，学生为：&#34;</span><span class="p">,</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);},</span>
            <span class="nx">error</span><span class="p">=&gt;{</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;失败了&#34;</span><span class="p">,</span><span class="nx">error</span><span class="p">);}</span>
        <span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">getCar</span><span class="o">=</span><span class="p">()=&gt;{</span>
        <span class="c1">// 如果3000中没有请求的这个资源，就会走/api2配置的这个代理：http://localhost:3000/api2前缀的请求被转发到http://localhost:5001
</span><span class="c1"></span>        <span class="nx">Axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;http://localhost:3000/api2/cars&#39;</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span>
            <span class="nx">response</span><span class="p">=&gt;{</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;成功了，汽车为：&#34;</span><span class="p">,</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);},</span>
            <span class="nx">error</span><span class="p">=&gt;{</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;失败了&#34;</span><span class="p">,</span><span class="nx">error</span><span class="p">);}</span>
        <span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">getStudent</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">点我获取学生信息</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">getCar</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">点我获取汽车信息</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103734.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103734.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103734.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103734.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103734.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103734.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103745.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103745.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103745.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103745.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103745.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103745.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103757.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103757.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103757.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103757.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103757.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103757.png" /></p>
<h2 id="12github搜索案例">12.github搜索案例</h2>
<h3 id="1静态组件-1">1.静态组件</h3>
<ul>
<li>先将普通前端项目转化为react前端项目</li>
<li>再拆分组件，拆分的时候注意查看html中可以舍弃的标签在css中有没有给它设置样式</li>
<li>拆分时记得在主组件中引入子组件，并且将组件放在该渲染的位置</li>
<li>样式也要拆分，先将所有样式放在父组件的样式中，然后根据不同子组件将样式进行拆分</li>
</ul>
<p>注意：</p>
<ol>
<li>第三方样式库，如bootStrap.css最好放在public文件夹中，在public文件夹中建一个css文件夹，将第三方样式放在里面。放在public的样式应该被index.html文件引入。其他样式就放在src文件夹中（<strong>如果要运行其他项目，需要将index.html中引入bootStrap样式的代码注释掉</strong>）</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103808.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103808.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103808.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103808.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103808.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103808.png" /></p>
<ol start="2">
<li>注意修改class为className（vscode中ctrl+shift+l表示全选中文件中的出现的所有某个字段）</li>
<li>注意修改外部样式为style={{key,value}}形式</li>
</ol>
<h3 id="2axios发送请求">2.axios发送请求</h3>
<p>问题：如果向github服务器发送的请求次数多了，github就会禁止发送请求。</p>
<p>解决方法：设置一个中间服务器，端口号假设为5000，3000向5000发送请求，5000再向github服务器发送请求，请求的返回数据再返回给3000。5000请求github次数多了，github就会禁止5000再向它发送请求，但是在中间服务器5000中还设有另一个接口，就是返回模拟数据给3000。</p>
<p>所以如果5000向github发送请求，那么5000返回的就是真实数据，如果5000不能向github发送请求了，就直接返回模拟数据给3000</p>
<ol>
<li>
<p>启动5000服务器</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103820.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103820.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103820.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103820.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103820.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103820.png" /></p>
</li>
<li>
<p>配置setupProxy</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 此包在安装react脚手架时就安装了
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">proxy</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;http-proxy-middleware&#39;</span><span class="p">)</span>
   
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">app</span><span class="p">){</span>
    <span class="cm">/** proxy第一个参数：请求的前缀；第二个参数：转发详情
</span><span class="cm">     *      1.proxy：表示将带有某个前缀的请求转发到另一个网址
</span><span class="cm">     *      2.changeOrigin：控制服务器收到的请求头中Host字段的值，Host：标识着本次请求从哪里发出的
</span><span class="cm">     *          为false（默认）：Host值为真正发出请求的来源，此例中即为3000
</span><span class="cm">     *          为true：Host值为转发后的网址，此例中为5000或5001。最好改为true，因为避免服务器知道你实际上是3000发出的请求，就会对你有一些限制
</span><span class="cm">     *      3.pathRewrite：修改请求前缀
</span><span class="cm">     */</span>
   
    <span class="c1">// 表示只要是3000，并且带了/api1前缀的请求，即前面有http://localhost:3000/api1的请求，就会被转发到http://localhost:5000/api1。这时我们需要去掉前缀，所以用pathRewrite去掉前缀。
</span><span class="c1"></span>    <span class="c1">// 所以只要有http://localhost:3000/api1的请求，就会被转发到http://localhost:5000
</span><span class="c1"></span>    <span class="c1">// 同理只要有http://localhost:3000/api2的请求，就会被转发到http://localhost:5001
</span><span class="c1"></span>    <span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span>
        <span class="nx">proxy</span><span class="p">(</span><span class="s1">&#39;/api1&#39;</span><span class="p">,{</span>
            <span class="nx">target</span><span class="o">:</span><span class="s1">&#39;http://localhost:5000&#39;</span><span class="p">,</span>
            <span class="nx">changeOrigin</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span>
            <span class="nx">pathRewrite</span><span class="o">:</span><span class="p">{</span><span class="s1">&#39;^/api1&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span>
        <span class="p">})</span>
    <span class="p">)</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>发送请求</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 这里客户端为3000服务器为5000，而且5000服务器中没有解决跨域问题。所以需要设置代理，代理端口号为3000，所有发送给3000的请求都会被转发到5000
</span><span class="c1"></span>        <span class="c1">// 这里有一个简写的方法：如果当前客户端为3000，代码中可以省略主机名+3000，即省略http://localhost:3000
</span><span class="c1"></span>        <span class="nx">axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="sb">`/api1/search/users?q=</span><span class="si">${</span><span class="nx">keywords</span><span class="si">}</span><span class="sb">`</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span>
            <span class="nx">response</span><span class="p">=&gt;{</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;成功了&#34;</span><span class="p">,</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);},</span>
            <span class="nx">error</span><span class="p">=&gt;{</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;失败了&#34;</span><span class="p">,</span><span class="nx">error</span><span class="p">);}</span>
        <span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h3 id="3展示数据">3.展示数据</h3>
<p>分析请求回来的数据：
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103835.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103835.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103835.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103835.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103835.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103835.png" /></p>
<p>由于数据是在Search组件中请求回来的，需要在List组件中展示，所以需要先把数据传给父组件App，再由父组件传给List组件。</p>
<h3 id="4完善案例">4.完善案例</h3>
<p>效果：</p>
<ol>
<li>
<p>一进页面，还没有搜索任何东西的时候，页面显示“欢迎使用，输入关键字点击搜索，即可获取github用户”</p>
</li>
<li>
<p>点击搜索后，在没返回数据之前，显示加载中</p>
</li>
<li>
<p>成功返回数据后，显示返回的数据</p>
</li>
<li>
<p>请求失败后，显示“请求失败”</p>
</li>
</ol>
<p>实现：</p>
<ul>
<li>
<p>不同时刻显示不同页面，由于状态的改变必会驱动页面改变，所以需要在状态中设置这四种情况对应的属性</p>
</li>
<li>
<p>在Search组件中根据不同时刻修改state属性的属性值，并传给App组件</p>
</li>
<li>
<p>App组件得到修改后的对象属性，进而setState，并将state对象传给List子组件进行条件展示</p>
</li>
</ul>
<p>注意：<strong>react中不能直接渲染一个对象到页面，可以展示对象的某个属性</strong></p>
<p>App.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="nx">Search</span> <span class="nx">from</span> <span class="s1">&#39;./component/Search/index&#39;</span>
<span class="kr">import</span> <span class="nx">List</span> <span class="nx">from</span> <span class="s1">&#39;./component/List/index&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>

    <span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="nx">first</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span>  <span class="c1">//是否第一次打开页面
</span><span class="c1"></span>        <span class="nx">loading</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span>  <span class="c1">//是否正在加载中
</span><span class="c1"></span>        <span class="nx">error</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>  <span class="c1">//存储错误信息
</span><span class="c1"></span>        <span class="nx">people</span><span class="o">:</span><span class="p">[]};</span>  <span class="c1">//用户数据
</span><span class="c1"></span>
    <span class="c1">// 点击查询按钮时，获取修改了值的属性对象，再更新状态中相应的属性
</span><span class="c1"></span>    <span class="nx">updateState</span><span class="o">=</span><span class="p">(</span><span class="nx">stateObj</span><span class="p">)=&gt;{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">(</span><span class="nx">stateObj</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;container&#34;</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">Search</span> <span class="nx">updateState</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">updateState</span><span class="p">}</span><span class="o">/&gt;</span>
                <span class="o">&lt;</span><span class="nx">List</span> <span class="p">{...</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">}</span><span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></td></tr></table>
</div>
</div><p>Search.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="nx">axios</span> <span class="nx">from</span> <span class="s1">&#39;axios&#39;</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Search</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>

    <span class="nx">handleClick</span><span class="o">=</span><span class="p">()=&gt;{</span>
        <span class="c1">// 获取用户的输入
</span><span class="c1"></span>        <span class="c1">// 连续结构赋值并给拿到的属性取别名
</span><span class="c1"></span>        <span class="c1">// 表示：从this中拿到inputElement对象的value属性，并给value属性取一个别名叫作keywords
</span><span class="c1"></span>        <span class="kr">const</span> <span class="p">{</span><span class="nx">inputElement</span><span class="o">:</span><span class="p">{</span><span class="nx">value</span><span class="o">:</span><span class="nx">keywords</span><span class="p">}}</span> <span class="o">=</span> <span class="k">this</span>

        <span class="c1">// 发送网络请求
</span><span class="c1"></span>        <span class="c1">// 这里客户端和服务器的主机名和端口不一样，但能请求成功，是因为github服务器在后端用了cors加了一个特殊的响应头解决了跨域问题
</span><span class="c1"></span>        
        <span class="c1">// 在点击搜索按钮后，发送请求前，设置页面的first为false，loading设置为true
</span><span class="c1"></span>        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">updateState</span><span class="p">({</span><span class="nx">first</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">loading</span><span class="o">:</span><span class="kc">true</span><span class="p">});</span>
        
        <span class="c1">// axios.get(`https://api.github.comdd/search/users?q=${keywords}`).then(
</span><span class="c1"></span>        <span class="c1">//     response=&gt;{console.log(&#34;成功了&#34;,response.data);},
</span><span class="c1"></span>        <span class="c1">//     error=&gt;{console.log(&#34;失败了&#34;,error);}
</span><span class="c1"></span>        <span class="c1">// )
</span><span class="c1"></span>
        <span class="c1">// 这里客户端为3000服务器为5000，而且5000服务器中没有解决跨域问题。所以需要设置代理，代理端口号为3000，所有发送给3000的请求都会被转发到5000
</span><span class="c1"></span>        <span class="c1">// 这里有一个简写的方法：如果当前客户端为3000，代码中可以省略主机名+3000，即省略http://localhost:3000
</span><span class="c1"></span>           <span class="nx">axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="sb">`/api1/search/users?q=</span><span class="si">${</span><span class="nx">keywords</span><span class="si">}</span><span class="sb">`</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span>
               <span class="c1">// 请求成功时将通知App更新状态
</span><span class="c1"></span>               <span class="nx">response</span><span class="p">=&gt;{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">updateState</span><span class="p">({</span><span class="nx">people</span><span class="o">:</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">items</span><span class="p">,</span><span class="nx">loading</span><span class="o">:</span><span class="kc">false</span><span class="p">})},</span>
               <span class="c1">// 请求失败时将通知App更新状态
</span><span class="c1"></span>               <span class="nx">error</span><span class="p">=&gt;{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">updateState</span><span class="p">({</span><span class="nx">error</span><span class="o">:</span><span class="nx">error</span><span class="p">,</span><span class="nx">loading</span><span class="o">:</span><span class="kc">false</span><span class="p">})}</span>
         <span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">section</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;jumbotron&#34;</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">h3</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;jumbotron-heading&#34;</span> <span class="o">&gt;</span><span class="nx">Search</span> <span class="nx">Github</span> <span class="nx">Users</span><span class="o">&lt;</span><span class="err">/h3&gt;</span>
                <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                    <span class="p">{</span><span class="cm">/* 回调函数的形式定义ref，将input输入框结点赋值给实例对象中的inputElement属性 */</span><span class="p">}</span>
                    <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">currentCode</span><span class="p">=&gt;</span><span class="k">this</span><span class="p">.</span><span class="nx">inputElement</span><span class="o">=</span><span class="nx">currentCode</span><span class="p">}</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">&#34;enter the name you search&#34;</span><span class="o">/&gt;&amp;</span><span class="nx">nbsp</span><span class="p">;</span><span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleClick</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">Search</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                <span class="o">&lt;</span><span class="err">/div&gt;</span>
            <span class="o">&lt;</span><span class="err">/section&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>List.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="p">{</span> <span class="nx">object</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;prop-types&#39;</span>
<span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="s1">&#39;./index.css&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">List</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">first</span><span class="p">,</span><span class="nx">loading</span><span class="p">,</span><span class="nx">error</span><span class="p">,</span><span class="nx">people</span><span class="p">}</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">first</span><span class="p">,</span><span class="nx">loading</span><span class="p">,</span><span class="nx">error</span><span class="p">,</span><span class="nx">people</span><span class="p">);</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;row&#34;</span><span class="o">&gt;</span>
                <span class="p">{</span>
                    <span class="c1">// 因为在jsx中的大括号内只能写表达式，不能写if这种语句判断，所以选择用嵌套三元式来进行条件判断
</span><span class="c1"></span>                    <span class="c1">// react中不能直接渲染一个对象到页面，可以展示对象的某个属性，所以显示error对象中的message属性
</span><span class="c1"></span>                    <span class="nx">first</span><span class="o">?&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">欢迎使用</span><span class="err">，</span><span class="nx">请输入关键字进行搜索用户</span><span class="o">&lt;</span><span class="err">/h2&gt;:</span>
                    <span class="nx">loading</span><span class="o">?&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">加载中</span><span class="p">.........</span><span class="o">&lt;</span><span class="err">/h2&gt;:</span>
                    <span class="nx">error</span><span class="o">?&lt;</span><span class="nx">h2</span> <span class="nx">style</span><span class="o">=</span><span class="p">{{</span><span class="nx">color</span><span class="o">:</span><span class="s2">&#34;red&#34;</span><span class="p">}}</span><span class="o">&gt;</span><span class="nx">错误信息</span><span class="o">:</span><span class="p">{</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;:</span>
                    <span class="nx">people</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">item</span><span class="p">=&gt;{</span>
                        <span class="k">return</span> <span class="p">(</span>
                            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;card&#34;</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="o">&gt;</span>
                                <span class="p">{</span><span class="cm">/* href中如果设置了target=&#34;_blank&#34;，另开一个页面。但是需要和rel=&#34;noreferrer&#34;一起使用，否则会弹出警告 */</span><span class="p">}</span>
                                <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">rel</span><span class="o">=</span><span class="s2">&#34;noreferrer&#34;</span> <span class="nx">href</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">html_url</span><span class="p">}</span> <span class="nx">target</span><span class="o">=</span><span class="s2">&#34;_blank&#34;</span><span class="o">&gt;</span>
                                    <span class="p">{</span><span class="cm">/* img标签必须设置一个alt属性：表示当图片加载失败时显示的文字，否则会警告 */</span><span class="p">}</span>
                                    <span class="o">&lt;</span><span class="nx">img</span> <span class="nx">alt</span><span class="o">=</span><span class="s2">&#34;Avatar&#34;</span> <span class="nx">src</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">avatar_url</span><span class="p">}</span> <span class="nx">style</span><span class="o">=</span><span class="p">{{</span><span class="nx">width</span><span class="o">:</span><span class="s1">&#39;100px&#39;</span><span class="p">}}</span><span class="o">/&gt;</span>
                                <span class="o">&lt;</span><span class="err">/a&gt;</span>
                                <span class="o">&lt;</span><span class="nx">p</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;card-text&#34;</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">login</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
                            <span class="o">&lt;</span><span class="err">/div&gt;</span>
                        <span class="p">)</span>
                    <span class="p">})</span>
                <span class="p">}</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></td></tr></table>
</div>
</div><h2 id="13消息订阅与发布">13.消息订阅与发布</h2>
<p>订阅步骤：</p>
<ol>
<li>
<p>指定消息名</p>
</li>
<li>
<p>接收数据（包含消息名、数据）</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103914.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103914.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103914.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103914.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103914.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103914.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103927.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103927.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103927.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103927.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103927.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103927.png" /></p>
</li>
</ol>
<p>发布步骤：</p>
<ol>
<li>
<p>指定消息名</p>
</li>
<li>
<p>携带数据</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103937.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103937.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103937.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103937.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103937.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002103937.png" /></p>
</li>
</ol>
<p>在需要接收数据的组件中订阅消息，指定消息名，**如果有人发布了这个消息，那么你指定的回调就要被调用。**不是你调的，是发布消息者调的，别人在调用函数的时候需要指定消息名和携带这个消息的数据</p>
<p>消息订阅与发布需要借助工具库：有很多工具库，这里我们选择Pubsub库</p>
<ol>
<li>安装库：npm i pubsub-js</li>
<li>导入库：import PubSub from &lsquo;pubsub-js&rsquo;</li>
</ol>
<h3 id="1优化github搜索案例">1.优化github搜索案例</h3>
<p><strong>可以做到任何组件之间的数据直接传递</strong></p>
<p><code>之前的思想：</code>Search组件中的搜索举动影响着List组件中的展示，但由于兄弟组件之间无法直接传递数据，所以借助App父组件，将所有数据都放在App父组件的state中，Search的举动影响着那些状态属性，所以每改变一次，就将改变的状态属性传给父组件，父组件再去修改自己状态中的相应属性，然后传给List子组件去动态展示</p>
<p><code>现在的思想</code>：利用消息发布与订阅，Search组件负责发布消息，List组件负责订阅消息，所以将所有的数据放在List组件的State中。Search的举动影响着那些状态属性，所以每改变一次，就将改变的状态属性数据发布一次，那么List组件就会动态订阅消息，再进行setState状态修改，进而驱动页面动态显示数据</p>
<p>注意事项：</p>
<ul>
<li>
<p>消息的订阅一般放在componentDidMount，组件挂载后</p>
</li>
<li>
<p>subscribe方法中第二个参数：回调函数，<strong>函数的参数必须是两个，第一个为消息名，第二个为数据</strong>，如果没有用到某个参数，可以用<code>_</code>占位符代替那个参数</p>
</li>
<li>
<p>一般需要指定一个变量接收消息订阅，方便在取消订阅的时候能找的到取消的是哪一个消息订阅。如this.token=PubSub.subscribe(&lsquo;stateObj&rsquo;,(_,data)=&gt;{this.setState(data)});</p>
<p>PubSub.unsubscribe(this.token);</p>
</li>
</ul>
<p>App.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="nx">Search</span> <span class="nx">from</span> <span class="s1">&#39;./component/Search/index&#39;</span>
<span class="kr">import</span> <span class="nx">List</span> <span class="nx">from</span> <span class="s1">&#39;./component/List/index&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;container&#34;</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">Search</span><span class="o">/&gt;</span>
                <span class="o">&lt;</span><span class="nx">List</span><span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></td></tr></table>
</div>
</div><p>Search.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="nx">axios</span> <span class="nx">from</span> <span class="s1">&#39;axios&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">PubSub</span> <span class="nx">from</span> <span class="s1">&#39;pubsub-js&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Search</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>

    <span class="nx">handleClick</span><span class="o">=</span><span class="p">()=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">inputElement</span><span class="o">:</span><span class="p">{</span><span class="nx">value</span><span class="o">:</span><span class="nx">keywords</span><span class="p">}}</span> <span class="o">=</span> <span class="k">this</span>
        
        <span class="c1">// 在点击搜索按钮后，发送请求前，发布消息：{first:false,loading:true}，消息名为：stateObj
</span><span class="c1"></span>        <span class="nx">PubSub</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="s1">&#39;stateObj&#39;</span><span class="p">,{</span><span class="nx">first</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">loading</span><span class="o">:</span><span class="kc">true</span><span class="p">});</span>

        <span class="c1">// axios.get(`https://api.github.comdd/search/users?q=${keywords}`).then(
</span><span class="c1"></span>        <span class="c1">//     response=&gt;{console(&#34;成功了&#34;,response.data);},
</span><span class="c1"></span>        <span class="c1">//     error=&gt;{console(&#34;失败了&#34;,error);}
</span><span class="c1"></span>        <span class="c1">// )
</span><span class="c1"></span>
        <span class="c1">// 这里客户端为3000服务器为5000，而且5000服务器中没有解决跨域问题。所以需要设置代理，代理端口号为3000，所有发送给3000的请求都会被转发到5000
</span><span class="c1"></span>        <span class="c1">// 这里有一个简写的方法：如果当前客户端为3000，代码中可以省略主机名+3000，即省略http://localhost:3000
</span><span class="c1"></span>        <span class="nx">axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="sb">`/api1/search/users?q=</span><span class="si">${</span><span class="nx">keywords</span><span class="si">}</span><span class="sb">`</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span>
            <span class="c1">// 请求成功时，发布消息：{people:response.data.items,loading:false}，消息名为：stateObj
</span><span class="c1"></span>            <span class="nx">response</span><span class="p">=&gt;{</span><span class="nx">PubSub</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="s1">&#39;stateObj&#39;</span><span class="p">,{</span><span class="nx">people</span><span class="o">:</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">items</span><span class="p">,</span><span class="nx">loading</span><span class="o">:</span><span class="kc">false</span><span class="p">});},</span>
            <span class="c1">// 请求失败时，发布消息：{error:error,loading:false}，消息名为：stateObj
</span><span class="c1"></span>            <span class="nx">error</span><span class="p">=&gt;{</span><span class="nx">PubSub</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="s1">&#39;stateObj&#39;</span><span class="p">,{</span><span class="nx">error</span><span class="o">:</span><span class="nx">error</span><span class="p">,</span><span class="nx">loading</span><span class="o">:</span><span class="kc">false</span><span class="p">});}</span>
        <span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">section</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;jumbotron&#34;</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">h3</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;jumbotron-heading&#34;</span> <span class="o">&gt;</span><span class="nx">Search</span> <span class="nx">Github</span> <span class="nx">Users</span><span class="o">&lt;</span><span class="err">/h3&gt;</span>
                <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">currentCode</span><span class="p">=&gt;</span><span class="k">this</span><span class="p">.</span><span class="nx">inputElement</span><span class="o">=</span><span class="nx">currentCode</span><span class="p">}</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">&#34;enter the name you search&#34;</span><span class="o">/&gt;&amp;</span><span class="nx">nbsp</span><span class="p">;</span><span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleClick</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">Search</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                <span class="o">&lt;</span><span class="err">/div&gt;</span>
            <span class="o">&lt;</span><span class="err">/section&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></td></tr></table>
</div>
</div><p>List.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">PubSub</span> <span class="nx">from</span> <span class="s1">&#39;pubsub-js&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="s1">&#39;./index.css&#39;</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">List</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>

    <span class="nx">state</span><span class="o">=</span><span class="p">{</span>
        <span class="nx">first</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span>  <span class="c1">//是否第一次打开页面
</span><span class="c1"></span>        <span class="nx">loading</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span>  <span class="c1">//是否正在加载中
</span><span class="c1"></span>        <span class="nx">error</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>  <span class="c1">//存储错误信息
</span><span class="c1"></span>        <span class="nx">people</span><span class="o">:</span><span class="p">[]</span>  <span class="c1">//用户数据
</span><span class="c1"></span>    <span class="p">};</span>  

    <span class="c1">// 将订阅消息放在componentDidMount中，组件挂载完毕后，调用一次componentDidMount函数，那么就开启了一个消息订阅
</span><span class="c1"></span>    <span class="c1">// subscribe中第二个参数：回调函数，回调函数的参数必须有两个，第一个是消息名，第二个是数据。如果有某个参数用不到，可以用_占位符代替，一下例子中就用占位符代替了msg
</span><span class="c1"></span>    <span class="nx">componentDidMount</span><span class="p">(){</span>
        <span class="c1">// 指定变量接收消息订阅，方便取消消息订阅时能找到是哪一个消息订阅
</span><span class="c1"></span>        <span class="c1">// 只要一发布stateObj消息，就会调用回调函数，从而更新state
</span><span class="c1"></span>        <span class="k">this</span><span class="p">.</span><span class="nx">token</span><span class="o">=</span><span class="nx">PubSub</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="s1">&#39;stateObj&#39;</span><span class="p">,(</span><span class="nx">_</span><span class="p">,</span><span class="nx">data</span><span class="p">)=&gt;{</span><span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">(</span><span class="nx">data</span><span class="p">)});</span>
    <span class="p">}</span>

    <span class="c1">// 在组件被卸载之前取消消息订阅
</span><span class="c1"></span>    <span class="nx">componentWillUnmount</span><span class="p">(){</span>
        <span class="nx">PubSub</span><span class="p">.</span><span class="nx">unsubscribe</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">token</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>

        <span class="kr">const</span> <span class="p">{</span><span class="nx">first</span><span class="p">,</span><span class="nx">loading</span><span class="p">,</span><span class="nx">error</span><span class="p">,</span><span class="nx">people</span><span class="p">}</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;row&#34;</span><span class="o">&gt;</span>
                <span class="p">{</span>
                    <span class="c1">// 因为在jsx中的大括号内只能写表达式，不能写if这种语句判断，所以选择用嵌套三元式来进行条件判断
</span><span class="c1"></span>                    <span class="c1">// react中不能直接渲染一个对象到页面，可以展示对象的某个属性，所以显示error对象中的message属性
</span><span class="c1"></span>                    <span class="nx">first</span><span class="o">?&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">欢迎使用</span><span class="err">，</span><span class="nx">请输入关键字进行搜索用户</span><span class="o">&lt;</span><span class="err">/h2&gt;:</span>
                    <span class="nx">loading</span><span class="o">?&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">加载中</span><span class="p">.........</span><span class="o">&lt;</span><span class="err">/h2&gt;:</span>
                    <span class="nx">error</span><span class="o">?&lt;</span><span class="nx">h2</span> <span class="nx">style</span><span class="o">=</span><span class="p">{{</span><span class="nx">color</span><span class="o">:</span><span class="s2">&#34;red&#34;</span><span class="p">}}</span><span class="o">&gt;</span><span class="nx">错误信息</span><span class="o">:</span><span class="p">{</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;:</span>
                    <span class="nx">people</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">item</span><span class="p">=&gt;{</span>
                        <span class="k">return</span> <span class="p">(</span>
                            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;card&#34;</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="o">&gt;</span>
                                <span class="p">{</span><span class="cm">/* href中如果设置了target=&#34;_blank&#34;，另开一个页面。但是需要和rel=&#34;noreferrer&#34;一起使用，否则会弹出警告 */</span><span class="p">}</span>
                                <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">rel</span><span class="o">=</span><span class="s2">&#34;noreferrer&#34;</span> <span class="nx">href</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">html_url</span><span class="p">}</span> <span class="nx">target</span><span class="o">=</span><span class="s2">&#34;_blank&#34;</span><span class="o">&gt;</span>
                                    <span class="p">{</span><span class="cm">/* img标签必须设置一个alt属性：表示当图片加载失败时显示的文字，否则会警告 */</span><span class="p">}</span>
                                    <span class="o">&lt;</span><span class="nx">img</span> <span class="nx">alt</span><span class="o">=</span><span class="s2">&#34;Avatar&#34;</span> <span class="nx">src</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">avatar_url</span><span class="p">}</span> <span class="nx">style</span><span class="o">=</span><span class="p">{{</span><span class="nx">width</span><span class="o">:</span><span class="s1">&#39;100px&#39;</span><span class="p">}}</span><span class="o">/&gt;</span>
                                <span class="o">&lt;</span><span class="err">/a&gt;</span>
                                <span class="o">&lt;</span><span class="nx">p</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;card-text&#34;</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">login</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
                            <span class="o">&lt;</span><span class="err">/div&gt;</span>
                        <span class="p">)</span>
                    <span class="p">})</span>
                <span class="p">}</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="14fetch发送请求">14.fetch发送请求</h2>
<p><a href="https://segmentfault.com/a/1190000003810652" target="_blank" rel="noopener noreffer">学习文档</a></p>
<p>发送ajax请求有三种方法：</p>
<ul>
<li>原生xhr（XMLHttpRequest）</li>
<li>jQuery（封装的xhr，需要安装）</li>
<li>axios（封装xhr，需要安装）</li>
<li>fetch：
<ul>
<li>跟xhr同级，不再使用xhr对象提交请求</li>
<li>是js的原生函数，不需要安装</li>
<li>promise风格</li>
</ul>
</li>
</ul>
<p>知识点：</p>
<ul>
<li>
<p>fetch主要是关注分离思想：分步骤做某件事，如果当前步骤成功了，再往下继续做，如果失败了，就不继续做。如果是请求数据：那么先看服务器连接成不成功，再看数据返回成不成功</p>
</li>
<li>
<p>promise实例才能.then，.then是用来指定成功的回调和失败的回调的。<strong>.then的实例对象的状态和值取决于当前.then的返回值。</strong></p>
</li>
<li>
<p><strong>如果.then的返回值为非promise值，那么.then的promise实例对象的状态为成功，值为这个非promise值</strong></p>
</li>
<li>
<p><strong>如果.then的返回值为promise对象，那么.then的promise实例对象就为当前返回的这个promise实例对象</strong></p>
</li>
<li>
<p>只有断网或者其他不可抗因素，才会使.then的promise实例对象的状态为失败</p>
</li>
<li>
<p>返回初始化promise对象是可以终止promise链的</p>
<p>​        return new Promise(()=&gt;{});</p>
</li>
<li>
<p>promise实例可以在最后统一处理错误，但是在最后统一处理错误的话，那么.then中就只有成功的情况，就可以用await简化.then。</p>
</li>
<li>
<p>await后面接的是promise实例对象，可以等到这个promise实例对象的成功的结果，但是需要在await所在函数上添加async。由于await只能等到成功的结果，所以需要用try、catch捕捉失败的情况</p>
</li>
<li>
<p>服务器请求成功中的response.json()是一个promise实例对象。如果数据获取成功了，那么.then的promise实例对象的状态为成功，值为获取的数据。如果数据获取数据失败了，那么.then的promise实例对象的状态为失败，值为失败原因。如果抛出异常了，.then的promise实例对象的状态为失败，值为抛出的异常</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 不规范的fetch写法
</span><span class="c1"></span>        <span class="nx">fetch</span><span class="p">(</span><span class="sb">`/api1/search/users2?q=</span><span class="si">${</span><span class="nx">keywords</span><span class="si">}</span><span class="sb">`</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span>
            <span class="c1">// 此处的response.json()为一个实例对象，数据获取成功了，那么.then的promise实例对象的状态为成功，值为获取的数据。如果数据获取数据失败了，那么.then的promise实例对象的状态为失败，值为失败原因。
</span><span class="c1"></span>            <span class="nx">response</span><span class="p">=&gt;{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;连接服务器成功了&#34;</span><span class="p">);</span>
                <span class="c1">// 访问数据
</span><span class="c1"></span>                <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span>
                    <span class="nx">response</span><span class="p">=&gt;{</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;访问数据成功了&#34;</span><span class="p">,</span><span class="nx">response</span><span class="p">)},</span>
                    <span class="nx">error</span><span class="p">=&gt;{</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;访问数据失败了&#34;</span><span class="p">,</span><span class="nx">error</span><span class="p">)}</span>
                <span class="p">)</span>
            <span class="p">},</span>
            <span class="nx">error</span><span class="p">=&gt;{</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;连接服务器失败了&#34;</span><span class="p">,</span><span class="nx">error</span><span class="p">);}</span>
        <span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<p>应用到github搜索案例上：</p>
<p>Search.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="nx">axios</span> <span class="nx">from</span> <span class="s1">&#39;axios&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">PubSub</span> <span class="nx">from</span> <span class="s1">&#39;pubsub-js&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Search</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>

    <span class="nx">handleClick</span><span class="o">=</span><span class="kr">async</span><span class="p">()=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">inputElement</span><span class="o">:</span><span class="p">{</span><span class="nx">value</span><span class="o">:</span><span class="nx">keywords</span><span class="p">}}</span> <span class="o">=</span> <span class="k">this</span>
        
        <span class="c1">// 在点击搜索按钮后，发送请求前，发布消息：{first:false,loading:true}，消息名为：stateObj
</span><span class="c1"></span>        <span class="nx">PubSub</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="s1">&#39;stateObj&#39;</span><span class="p">,{</span><span class="nx">first</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="nx">loading</span><span class="o">:</span><span class="kc">true</span><span class="p">});</span>

        <span class="c1">// axios.get(`/api1/search/users?q=${keywords}`).then(
</span><span class="c1"></span>        <span class="c1">//     response=&gt;{PubSub.publish(&#39;stateObj&#39;,{people:response.data.items,loading:false});},
</span><span class="c1"></span>        <span class="c1">//     error=&gt;{PubSub.publish(&#39;stateObj&#39;,{error:error,loading:false});}
</span><span class="c1"></span>        <span class="c1">// )
</span><span class="c1"></span>
        <span class="c1">// 不规范的fetch写法
</span><span class="c1"></span>        <span class="c1">// fetch(`/api1/search/users2?q=${keywords}`).then(
</span><span class="c1"></span>        <span class="c1">//     // 此处的response.json()为一个实例对象，数据获取成功了，那么.then的promise实例对象的状态为成功，值为获取的数据。如果数据获取数据失败了，那么.then的promise实例对象的状态为失败，值为失败原因。
</span><span class="c1"></span>        <span class="c1">//     response=&gt;{
</span><span class="c1"></span>        <span class="c1">//         console.log(&#34;连接服务器成功了&#34;);
</span><span class="c1"></span>        <span class="c1">//         // 访问数据
</span><span class="c1"></span>        <span class="c1">//         response.json().then(
</span><span class="c1"></span>        <span class="c1">//             response=&gt;{console.log(&#34;访问数据成功了&#34;,response)},
</span><span class="c1"></span>        <span class="c1">//             error=&gt;{console.log(&#34;访问数据失败了&#34;,error)}
</span><span class="c1"></span>        <span class="c1">//         )
</span><span class="c1"></span>        <span class="c1">//     },
</span><span class="c1"></span>        <span class="c1">//     error=&gt;{console.log(&#34;连接服务器失败了&#34;,error);}
</span><span class="c1"></span>        <span class="c1">// )
</span><span class="c1"></span>
        <span class="c1">// 规范的fetch写法
</span><span class="c1"></span>        <span class="c1">// fetch(`/api1/search/users2?q=${keywords}`).then(
</span><span class="c1"></span>        <span class="c1">//     // 此处的response.json()为一个实例对象，数据获取成功了，那么.then的promise实例对象的状态为成功，值为获取的数据。如果数据获取数据失败了，那么.then的promise实例对象的状态为失败，值为失败原因。
</span><span class="c1"></span>        <span class="c1">//     response=&gt;{
</span><span class="c1"></span>        <span class="c1">//         console.log(&#34;连接服务器成功了&#34;);
</span><span class="c1"></span>        <span class="c1">//         // 访问数据
</span><span class="c1"></span>        <span class="c1">//         // 返回的为promise实例对象，所以此promise实例对象将作为.then的promise实例对象，那么：就可以链式.then
</span><span class="c1"></span>        <span class="c1">//         return response.json();
</span><span class="c1"></span>        <span class="c1">//     },
</span><span class="c1"></span>        <span class="c1">//     error=&gt;{
</span><span class="c1"></span>        <span class="c1">//         console.log(&#34;连接服务器失败了&#34;,error);
</span><span class="c1"></span>        <span class="c1">//         // 返回初始化promise对象是可以终止promise链的
</span><span class="c1"></span>        <span class="c1">//         return new Promise(()=&gt;{});
</span><span class="c1"></span>        <span class="c1">//     }
</span><span class="c1"></span>        <span class="c1">// ).then(
</span><span class="c1"></span>        <span class="c1">//     response=&gt;{console.log(&#34;访问数据成功了&#34;,response)},
</span><span class="c1"></span>        <span class="c1">//     error=&gt;{console.log(&#34;访问数据失败了&#34;,error)}
</span><span class="c1"></span>        <span class="c1">// )
</span><span class="c1"></span>
        <span class="c1">// 优化：统一处理错误
</span><span class="c1"></span>        <span class="c1">// fetch(`/api1/search/users2?q=${keywords}`).then(
</span><span class="c1"></span>        <span class="c1">//     // 此处的response.json()为一个实例对象，数据获取成功了，那么.then的promise实例对象的状态为成功，值为获取的数据。如果数据获取数据失败了，那么.then的promise实例对象的状态为失败，值为失败原因。
</span><span class="c1"></span>        <span class="c1">//     response=&gt;{
</span><span class="c1"></span>        <span class="c1">//         console.log(&#34;连接服务器成功了&#34;);
</span><span class="c1"></span>        <span class="c1">//         // 访问数据
</span><span class="c1"></span>        <span class="c1">//         // 返回的为promise实例对象，所以此promise实例对象将作为.then的promise实例对象，那么：就可以链式.then
</span><span class="c1"></span>        <span class="c1">//         return response.json();
</span><span class="c1"></span>        <span class="c1">//     },
</span><span class="c1"></span>        <span class="c1">// ).then(
</span><span class="c1"></span>        <span class="c1">//     response=&gt;{console.log(&#34;访问数据成功了&#34;,response)},
</span><span class="c1"></span>        <span class="c1">// ).catch(
</span><span class="c1"></span>        <span class="c1">//     error=&gt;{
</span><span class="c1"></span>        <span class="c1">//         console.log(&#34;出现错误&#34;,error);
</span><span class="c1"></span>        <span class="c1">//     }
</span><span class="c1"></span>        <span class="c1">// )
</span><span class="c1"></span>
        <span class="c1">// 优化：await后面接的是promise实例对象，可以等到这个promise实例对象的成功的结果，但是需要在await所在函数上添加async。由于await只能等到成功的结果，所以需要用try、catch捕捉失败的情况
</span><span class="c1"></span>        <span class="c1">// try{
</span><span class="c1"></span>        <span class="c1">//     // 得到的是服务器连接成功的结果
</span><span class="c1"></span>        <span class="c1">//     const response=await fetch(`/api1/search/users2?q=${keywords}`);
</span><span class="c1"></span>        <span class="c1">//     // 得到的是数据获取成功的结果
</span><span class="c1"></span>        <span class="c1">//     const data=await response.json();
</span><span class="c1"></span>        <span class="c1">//     console.log(&#34;请求成功&#34;,data);
</span><span class="c1"></span>        <span class="c1">// }catch(error){
</span><span class="c1"></span>        <span class="c1">//     console.log(&#34;请求出错&#34;,error);
</span><span class="c1"></span>        <span class="c1">// }
</span><span class="c1"></span>
        <span class="c1">// 应用到本例
</span><span class="c1"></span>        <span class="k">try</span><span class="p">{</span>
            <span class="c1">// 得到的是服务器连接成功的结果
</span><span class="c1"></span>            <span class="kr">const</span> <span class="nx">response</span><span class="o">=</span><span class="kr">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="sb">`/api1/search/users2?q=</span><span class="si">${</span><span class="nx">keywords</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
            <span class="c1">// 得到的是数据获取成功的结果
</span><span class="c1"></span>            <span class="kr">const</span> <span class="nx">data</span><span class="o">=</span><span class="kr">await</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
            <span class="nx">PubSub</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="s1">&#39;stateObj&#39;</span><span class="p">,{</span><span class="nx">people</span><span class="o">:</span><span class="nx">data</span><span class="p">.</span><span class="nx">items</span><span class="p">,</span><span class="nx">loading</span><span class="o">:</span><span class="kc">false</span><span class="p">});</span>
        <span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="p">){</span>
            <span class="nx">PubSub</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="s1">&#39;stateObj&#39;</span><span class="p">,{</span><span class="nx">error</span><span class="o">:</span><span class="nx">error</span><span class="p">,</span><span class="nx">loading</span><span class="o">:</span><span class="kc">false</span><span class="p">});</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">section</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;jumbotron&#34;</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">h3</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;jumbotron-heading&#34;</span> <span class="o">&gt;</span><span class="nx">Search</span> <span class="nx">Github</span> <span class="nx">Users</span><span class="o">&lt;</span><span class="err">/h3&gt;</span>
                <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">currentCode</span><span class="p">=&gt;</span><span class="k">this</span><span class="p">.</span><span class="nx">inputElement</span><span class="o">=</span><span class="nx">currentCode</span><span class="p">}</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">&#34;enter the name you search&#34;</span><span class="o">/&gt;&amp;</span><span class="nx">nbsp</span><span class="p">;</span><span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleClick</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">Search</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                <span class="o">&lt;</span><span class="err">/div&gt;</span>
            <span class="o">&lt;</span><span class="err">/section&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>总结fetch：</p>
<p>缺点：老版本的浏览器不支持fetch。</p>
<h2 id="15路由">15.路由</h2>
<h3 id="151-spa">15.1 SPA</h3>
<p>单页面，多组件</p>
<p>做一个导航栏按钮的切换效果</p>
<p>以前：先写多个页面，用超链接，点击超链接跳转到另一个页面</p>
<p>现在：使用路由，点击导航链接，引起浏览器路径变化。路径变化被路由器捕捉到，进行组件匹配，从而改变展示区内容</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104041.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104041.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104041.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104041.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104041.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104041.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104051.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104051.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104051.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104051.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104051.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104051.png" /></p>
<h3 id="152-对路由的理解">15.2 对路由的理解</h3>
<p>前端路由就是通过改变浏览器上面地址的<strong>path</strong>来达到显示不同组件的效果，改变地址的<strong>path</strong>不会去到一个新页面，而是改变当前页面内显示的组件</p>
<p>path就是/xxx，不带.html，如果是/xxx.html表示的是一个页面，而/xxx表示一个组件</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104104.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104104.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104104.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104104.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104104.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104104.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104114.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104114.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104114.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104114.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104114.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104114.png" /></p>
<h3 id="153-路由原理history">15.3 路由原理history</h3>
<p>BOM浏览器对象中存在一个history对象：window.history。</p>
<p>history是一个栈，后push的path就存在栈顶</p>
<p><strong>原理：浏览器地址后面跟的永远是history栈顶的path，显示的也是栈顶的path对应的组件</strong></p>
<p>方法一：直接使用H5推出的history身上的API</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>前端路由的基石_history<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>

	<span class="c">&lt;!-- 浏览器地址后面跟的的永远是history栈顶的path，显示的也是栈顶的path对应的组件 --&gt;</span>

	<span class="c">&lt;!-- onclick=&#34;return false&#34; 表示点击连接不会跳转到其他页面 --&gt;</span>
	<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;http://www.atguigu.com&#34;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&#34;return push(&#39;/test1&#39;) &#34;</span><span class="p">&gt;</span>push test1<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
	<span class="p">&lt;</span><span class="nt">button</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&#34;push(&#39;/test2&#39;)&#34;</span><span class="p">&gt;</span>push test2<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
	<span class="p">&lt;</span><span class="nt">button</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&#34;replace(&#39;/test3&#39;)&#34;</span><span class="p">&gt;</span>replace test3<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
	<span class="p">&lt;</span><span class="nt">button</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&#34;back()&#34;</span><span class="p">&gt;</span><span class="ni">&amp;lt;</span>= 回退<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
	<span class="p">&lt;</span><span class="nt">button</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&#34;forword()&#34;</span><span class="p">&gt;</span>前进 =<span class="ni">&amp;gt;</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>

	<span class="c">&lt;!-- 引入此库后，就有一个History对象 --&gt;</span>
	<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https://cdn.bootcss.com/history/4.7.2/history.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
	<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span><span class="p">&gt;</span>
		<span class="c1">// 方法一，直接使用H5推出的history身上的API
</span><span class="c1"></span>		<span class="c1">// 这里的history直接操作的是BOM里面的history对象，直接修改浏览器的访问地址后缀
</span><span class="c1"></span>		<span class="kd">let</span> <span class="nx">history</span> <span class="o">=</span> <span class="nx">History</span><span class="p">.</span><span class="nx">createBrowserHistory</span><span class="p">()</span>

		<span class="kd">function</span> <span class="nx">push</span> <span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
			<span class="c1">// 往BOM中的history栈顶中添加此path
</span><span class="c1"></span>			<span class="nx">history</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span>
			<span class="c1">// onclick=&#34;return return false&#34; 表示点击连接不会跳转到其他页面
</span><span class="c1"></span>			<span class="k">return</span> <span class="kc">false</span>
		<span class="p">}</span>

		<span class="kd">function</span> <span class="nx">replace</span> <span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
			<span class="c1">// 表示替换掉栈顶的那个元素
</span><span class="c1"></span>			<span class="nx">history</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span>
		<span class="p">}</span>

		<span class="kd">function</span> <span class="nx">back</span><span class="p">()</span> <span class="p">{</span>
			<span class="c1">// 将history堆栈中的指针位置减1
</span><span class="c1"></span>			<span class="nx">history</span><span class="p">.</span><span class="nx">goBack</span><span class="p">()</span>
		<span class="p">}</span>

		<span class="kd">function</span> <span class="nx">forword</span><span class="p">()</span> <span class="p">{</span>
			<span class="c1">// 将history堆栈中的指针位置加1
</span><span class="c1"></span>			<span class="nx">history</span><span class="p">.</span><span class="nx">goForward</span><span class="p">()</span>
		<span class="p">}</span>

		<span class="c1">// history监听
</span><span class="c1"></span>		<span class="c1">// 只要路径变化了就会触发此回调函数
</span><span class="c1"></span>		<span class="nx">history</span><span class="p">.</span><span class="nx">listen</span><span class="p">((</span><span class="nx">location</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
			<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;请求路由路径变化了&#39;</span><span class="p">,</span> <span class="nx">location</span><span class="p">)</span>
		<span class="p">})</span>
	<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104128.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104128.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104128.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104128.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104128.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104128.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104139.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104139.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104139.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104139.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104139.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104139.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104148.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104148.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104148.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104148.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104148.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104148.png" /></p>
<p>方法二：hash值（锚点）</p>
<p>#后面的path不会作为资源发送给服务器，也就是不干涉请求资源的路径</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>前端路由的基石_history<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>

	<span class="c">&lt;!-- 浏览器地址后面跟的的永远是history栈顶的path，显示的也是栈顶的path对应的组件 --&gt;</span>

	<span class="c">&lt;!-- onclick=&#34;return false&#34; 表示点击连接不会跳转到其他页面 --&gt;</span>
	<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;http://www.atguigu.com&#34;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&#34;return push(&#39;/test1&#39;) &#34;</span><span class="p">&gt;</span>push test1<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
	<span class="p">&lt;</span><span class="nt">button</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&#34;push(&#39;/test2&#39;)&#34;</span><span class="p">&gt;</span>push test2<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
	<span class="p">&lt;</span><span class="nt">button</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&#34;replace(&#39;/test3&#39;)&#34;</span><span class="p">&gt;</span>replace test3<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
	<span class="p">&lt;</span><span class="nt">button</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&#34;back()&#34;</span><span class="p">&gt;</span><span class="ni">&amp;lt;</span>= 回退<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
	<span class="p">&lt;</span><span class="nt">button</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&#34;forword()&#34;</span><span class="p">&gt;</span>前进 =<span class="ni">&amp;gt;</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>

	<span class="c">&lt;!-- 引入此库后，就有一个History对象 --&gt;</span>
	<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https://cdn.bootcss.com/history/4.7.2/history.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
	<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span><span class="p">&gt;</span>
		<span class="c1">// 方法二，hash值（锚点）
</span><span class="c1"></span>        <span class="c1">// 这里的history直接操作的是BOM里面的history对象，自动在浏览器访问地址后面加上#/，点击链接改变的浏览器地址部分，全在#/后面，而#后面的部分不会作为请求资源
</span><span class="c1"></span>		<span class="kd">let</span> <span class="nx">history</span> <span class="o">=</span> <span class="nx">History</span><span class="p">.</span><span class="nx">createHashHistory</span><span class="p">()</span>

		<span class="kd">function</span> <span class="nx">push</span> <span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
			<span class="c1">// 往BOM中的history栈中添加此path
</span><span class="c1"></span>			<span class="nx">history</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span>
			<span class="c1">// onclick=&#34;return return false&#34; 表示点击连接不会跳转到其他页面
</span><span class="c1"></span>			<span class="k">return</span> <span class="kc">false</span>
		<span class="p">}</span>

		<span class="kd">function</span> <span class="nx">replace</span> <span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
			<span class="c1">// 表示替换掉栈顶的那个元素
</span><span class="c1"></span>			<span class="nx">history</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span>
		<span class="p">}</span>

		<span class="kd">function</span> <span class="nx">back</span><span class="p">()</span> <span class="p">{</span>
			<span class="c1">// 将栈顶元素出栈
</span><span class="c1"></span>			<span class="nx">history</span><span class="p">.</span><span class="nx">goBack</span><span class="p">()</span>
		<span class="p">}</span>

		<span class="kd">function</span> <span class="nx">forword</span><span class="p">()</span> <span class="p">{</span>
			<span class="c1">// 将goBack出栈的那个栈顶元素重新进栈
</span><span class="c1"></span>			<span class="nx">history</span><span class="p">.</span><span class="nx">goForward</span><span class="p">()</span>
		<span class="p">}</span>

		<span class="c1">// history监听
</span><span class="c1"></span>		<span class="c1">// 只要路径变化了就会触发此回调函数
</span><span class="c1"></span>		<span class="nx">history</span><span class="p">.</span><span class="nx">listen</span><span class="p">((</span><span class="nx">location</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
			<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;请求路由路径变化了&#39;</span><span class="p">,</span> <span class="nx">location</span><span class="p">)</span>
		<span class="p">})</span>
	<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104159.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104159.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104159.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104159.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104159.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104159.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104209.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104209.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104209.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104209.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104209.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104209.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104219.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104219.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104219.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104219.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104219.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104219.png" /></p>
<h3 id="154-react-router-dom理解">15.4 react-router-dom理解</h3>
<p>react-router库有三个方面：</p>
<ol>
<li>web，针对web用</li>
<li>native</li>
<li>any</li>
</ol>
<p>现在所学的是第一种，针对web用的，所以用的是react-router-dom库</p>
<p>（印记中文中有react-router相关中文文档）</p>
<h3 id="155-路由的基本使用">15.5 路由的基本使用</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104229.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104229.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104229.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104229.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104229.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104229.png" /></p>
<ol>
<li>
<p>安装react-router-dom</p>
<p>npm install react-router-dom</p>
</li>
<li>
<p>找到导航栏，找到展示区。思想：点击导航链接，引起浏览器路径变化。路径变化被路由器捕捉到，进行组件匹配，从而改变展示区内容</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104243.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104243.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104243.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104243.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104243.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104243.png" /></p>
</li>
<li>
<p>编写路由链接：指定点击链接后，改变浏览器path</p>
</li>
<li>
<p>注册路由：指定每个path对应的是哪个组件，key为path，value为组件</p>
</li>
</ol>
<p>注意：</p>
<ul>
<li>记得导入组件</li>
<li>由于Link标签和Route标签都需要包含在路由器标签中，所以直接将路由器标签在组件被使用的地方包含整个组件</li>
<li>不同路由器标签表示不同路由器，所以不能用两个路由器标签分别包含Link和Route</li>
<li>路由器分为BrowserRouter和HashRouter，主要区别见15.20</li>
<li>Route中的component属性首字母小写，属性值为{组件名}形式，而不是&lt;组件名/&gt;形式</li>
</ul>
<p>About.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">About</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">h3</span><span class="o">&gt;</span><span class="nx">我是About的内容</span><span class="o">&lt;</span><span class="err">/h3&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Home.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Home</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">h3</span><span class="o">&gt;</span><span class="nx">我是Home的内容</span><span class="o">&lt;</span><span class="err">/h3&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>index.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="nx">ReactDom</span> <span class="nx">from</span> <span class="s1">&#39;react-dom&#39;</span>
<span class="c1">// 记得要引入组件
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">BrowserRouter</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-router-dom&#39;</span>
<span class="kr">import</span> <span class="nx">App</span> <span class="nx">from</span> <span class="s1">&#39;./App&#39;</span>

<span class="nx">ReactDom</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>
    <span class="c1">// 直接将路由器标签包含整个组件，那么组件中就不存在不同路由器标签互相不能访问的问题
</span><span class="c1"></span>    <span class="o">&lt;</span><span class="nx">BrowserRouter</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">App</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="err">/BrowserRouter&gt;,</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;root&#34;</span><span class="p">)</span>
    <span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>App.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="c1">// Link、Route首字母大写，是组件
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">Link</span><span class="p">,</span> <span class="nx">Route</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-router-dom&#39;</span>
<span class="kr">import</span> <span class="nx">About</span> <span class="nx">from</span> <span class="s1">&#39;./component/About&#39;</span>
<span class="kr">import</span> <span class="nx">Home</span> <span class="nx">from</span> <span class="s1">&#39;./component/Home&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;row&#34;</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;col-xs-offset-2 col-xs-8&#34;</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;page-header&#34;</span><span class="o">&gt;&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">React</span> <span class="nx">Router</span> <span class="nx">Demo</span><span class="o">&lt;</span><span class="err">/h2&gt;&lt;/div&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;row&#34;</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;col-xs-2 col-xs-offset-2&#34;</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;list-group&#34;</span><span class="o">&gt;</span>
                            <span class="p">{</span><span class="cm">/* 原生html中，靠a标签跳转到不用页面实现导航功能 */</span><span class="p">}</span>
                            <span class="p">{</span><span class="cm">/* &lt;a className=&#34;list-group-item active&#34; href=&#34;./about.html&#34;&gt;About&lt;/a&gt;
</span><span class="cm">                            &lt;a className=&#34;list-group-item&#34; href=&#34;./home.html&#34;&gt;Home&lt;/a&gt; */</span><span class="p">}</span>

                            <span class="p">{</span><span class="cm">/* 在React路由中靠路由链接实现切换组件-------编写路由链接 */</span><span class="p">}</span>
                            <span class="p">{</span><span class="cm">/* 不是href了，而是to，并且to属性值为path，即 /组件名 这种形式的 */</span><span class="p">}</span>
                            <span class="p">{</span><span class="cm">/* 路由链接需要被包含在路由器里面，所以外侧需要包含一个Router标签，但是Router标签有两种：BrowserRouter、HashRouter，需要在其中选择一个。二者区别在 路由原理history 中有详解。一般路由器标签都直接放在组件使用的地方，直接包含整个组件 */</span><span class="p">}</span>
                            <span class="p">{</span><span class="cm">/* 在组件内部使用多个路由器标签，代表的是不同的路由器，互相不相干，所以一般直接将路由器标签放在组件被使用的地方，直接包含整个组件 */</span><span class="p">}</span>
                            <span class="o">&lt;</span><span class="nx">Link</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;list-group-item active&#34;</span> <span class="nx">to</span><span class="o">=</span><span class="s2">&#34;/about&#34;</span><span class="o">&gt;</span><span class="nx">About</span><span class="o">&lt;</span><span class="err">/Link&gt;</span>
                            <span class="o">&lt;</span><span class="nx">Link</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;list-group-item&#34;</span> <span class="nx">to</span><span class="o">=</span><span class="s2">&#34;/home&#34;</span><span class="o">&gt;</span><span class="nx">Home</span><span class="o">&lt;</span><span class="err">/Link&gt;</span>
                        <span class="o">&lt;</span><span class="err">/div&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;col-xs-6&#34;</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;panel&#34;</span><span class="o">&gt;</span>
                            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;panel-body&#34;</span><span class="o">&gt;</span>
                                <span class="p">{</span><span class="cm">/* 注册路由 */</span><span class="p">}</span>
                                <span class="p">{</span><span class="cm">/* 一定要注意component首字母小写 */</span><span class="p">}</span>
                                <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s1">&#39;/about&#39;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">About</span><span class="p">}</span><span class="o">/&gt;</span>
                                <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s1">&#39;/home&#39;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Home</span><span class="p">}</span><span class="o">/&gt;</span>
                            <span class="o">&lt;</span><span class="err">/div&gt;</span>
                        <span class="o">&lt;</span><span class="err">/div&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="o">&lt;</span><span class="err">/div&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>样式需要引入第三方库</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104301.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104301.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104301.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104301.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104301.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104301.png" /></p>
<p>index.html</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 引入第三方样式：bootstrap --&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;./css/bootstrap.css&#34;</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>主页面<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;root&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104322.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104322.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104322.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104322.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104322.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104322.png" /></p>
<p>细节：其实浏览器是不认识Link这种链接的，所以浏览器会自动将Link链接转为a链接，并加一些监听让其实现不跳转</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104345.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104345.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104345.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104345.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104345.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104345.png" /></p>
<h3 id="156-路由组件与一般组件">15.6 路由组件与一般组件</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104354.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104354.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104354.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104354.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104354.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104354.png" /></p>
<p>location.pathname、match.path、match.url都可以获取当前组件所处的路由路径</p>
<h3 id="157-navlink的使用高亮">15.7 NavLink的使用（高亮）</h3>
<p>对于booptstrap来说，点击链接，链接变成高亮的话，需要在className属性值后面追加一个active</p>
<p><strong>而直接使用NavLink代替Link，就可以达到点击链接后，改变链接的样式</strong></p>
<ul>
<li>
<p>先引入NavLink组件从react-router-dom包中</p>
</li>
<li>
<p>NavLink默认是点击链接后，往className属性值的后面追加一个active，但是可以用activeClassName属性指定点击链接后追加的是什么</p>
</li>
<li>
<p>需要注意的点是：bootstrap样式的权重很高，如果追加的是自己定义的样式，那么需要在每一个样式后面加上 !important</p>
</li>
</ul>
<p>index.heml</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 引入第三方样式：bootstrap --&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;./css/bootstrap.css&#34;</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
        <span class="c">/* bootstrap样式的权重很高，所以加上!important */</span>
        <span class="p">.</span><span class="nc">testNavLink</span><span class="p">{</span><span class="k">background-color</span><span class="p">:</span><span class="kc">cadetblue</span> <span class="cp">!important</span><span class="p">}</span><span class="o">;</span>
    <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>主页面<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;root&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>App.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="c1">// Link、Route首字母大写，是组件
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">NavLink</span><span class="p">,</span> <span class="nx">Route</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-router-dom&#39;</span>
<span class="kr">import</span> <span class="nx">About</span> <span class="nx">from</span> <span class="s1">&#39;./component/About&#39;</span>
<span class="kr">import</span> <span class="nx">Home</span> <span class="nx">from</span> <span class="s1">&#39;./component/Home&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;row&#34;</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;col-xs-offset-2 col-xs-8&#34;</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;page-header&#34;</span><span class="o">&gt;&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">React</span> <span class="nx">Router</span> <span class="nx">Demo</span><span class="o">&lt;</span><span class="err">/h2&gt;&lt;/div&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;row&#34;</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;col-xs-2 col-xs-offset-2&#34;</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;list-group&#34;</span><span class="o">&gt;</span>
                            <span class="p">{</span><span class="cm">/* 原生html中，靠a标签跳转到不用页面实现导航功能 */</span><span class="p">}</span>
                            <span class="p">{</span><span class="cm">/* &lt;a className=&#34;list-group-item active&#34; href=&#34;./about.html&#34;&gt;About&lt;/a&gt;
</span><span class="cm">                            &lt;a className=&#34;list-group-item&#34; href=&#34;./home.html&#34;&gt;Home&lt;/a&gt; */</span><span class="p">}</span>

                            <span class="p">{</span><span class="cm">/* 在React路由中靠路由链接实现切换组件-------编写路由链接 */</span><span class="p">}</span>
                            <span class="p">{</span><span class="cm">/* 不是href了，而是to，并且to属性值为path，即 /组件名 这种形式的 */</span><span class="p">}</span>
                            <span class="p">{</span><span class="cm">/* 路由链接需要被包含在路由器里面，所以外侧需要包含一个Router标签，但是Router标签有两种：BrowserRouter、HashRouter，需要在其中选择一个。二者区别在 路由原理history 中有详解。一般路由器标签都直接放在组件使用的地方，直接包含整个组件 */</span><span class="p">}</span>
                            <span class="p">{</span><span class="cm">/* 在组件内部使用多个路由器标签，代表的是不同的路由器，互相不相干，所以一般直接将路由器标签放在组件被使用的地方，直接包含整个组件 */</span><span class="p">}</span>
                            <span class="o">&lt;</span><span class="nx">NavLink</span> <span class="nx">activeClassName</span><span class="o">=</span><span class="s2">&#34;testNavLink&#34;</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;list-group-item&#34;</span> <span class="nx">to</span><span class="o">=</span><span class="s2">&#34;/about&#34;</span><span class="o">&gt;</span><span class="nx">About</span><span class="o">&lt;</span><span class="err">/NavLink&gt;</span>
                            <span class="o">&lt;</span><span class="nx">NavLink</span> <span class="nx">activeClassName</span><span class="o">=</span><span class="s2">&#34;testNavLink&#34;</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;list-group-item&#34;</span> <span class="nx">to</span><span class="o">=</span><span class="s2">&#34;/home&#34;</span><span class="o">&gt;</span><span class="nx">Home</span><span class="o">&lt;</span><span class="err">/NavLink&gt;</span>
                        <span class="o">&lt;</span><span class="err">/div&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;col-xs-6&#34;</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;panel&#34;</span><span class="o">&gt;</span>
                            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;panel-body&#34;</span><span class="o">&gt;</span>
                                <span class="p">{</span><span class="cm">/* 注册路由 */</span><span class="p">}</span>
                                <span class="p">{</span><span class="cm">/* 一定要注意component首字母小写 */</span><span class="p">}</span>
                                <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s1">&#39;/about&#39;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">About</span><span class="p">}</span><span class="o">/&gt;</span>
                                <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s1">&#39;/home&#39;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Home</span><span class="p">}</span><span class="o">/&gt;</span>
                            <span class="o">&lt;</span><span class="err">/div&gt;</span>
                        <span class="o">&lt;</span><span class="err">/div&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="o">&lt;</span><span class="err">/div&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104408.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104408.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104408.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104408.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104408.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104408.png" /></p>
<h3 id="158-二次封装navlink">15.8 二次封装NavLink</h3>
<p>虽然NavLink上的activeClassName可以指定链接被点击后，className后面能追加的属性名，但是如果页面中有很多个链接，className都相同，并且点击链接后都变成橙色 ，那么页面中就有很多NavLink标签，并且很多重复的属性。</p>
<p>我们可以把NavLink进行二次封装，将相同的属性封装起来，<strong>不同的属性值通过props传递</strong>。不同的标签体内容，也可以通过props传递，只不过标签体内容传递到props里面，是一个value，它的key默认指定为children。通过this.props.children就可以得到传递的标签体内容</p>
<p>index.html</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 引入第三方样式：bootstrap --&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;./css/bootstrap.css&#34;</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
        <span class="c">/* bootstrap样式的权重很高，所以加上!important */</span>
        <span class="p">.</span><span class="nc">testNavLink</span><span class="p">{</span><span class="k">background-color</span><span class="p">:</span><span class="kc">cadetblue</span> <span class="cp">!important</span><span class="p">}</span><span class="o">;</span>
    <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>主页面<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;root&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>MyNavLink.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">NavLink</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-router-dom&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">MyNavLink</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="p">{</span><span class="cm">/* 这里不需要将所有传递的属性一一以键值对的形式写在标签上，直接用...{this.props}展开运算符。
</span><span class="cm">                包括标签体内容children，因为在标签上写children属性和直接在开始标签和结束标签之间写标签体内容是一样的 */</span><span class="p">}</span>
                <span class="o">&lt;</span><span class="nx">NavLink</span> <span class="nx">activeClassName</span><span class="o">=</span><span class="s2">&#34;testNavLink&#34;</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;list-group-item&#34;</span> <span class="p">{...</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">}</span><span class="o">&gt;&lt;</span><span class="err">/NavLink&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>App.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="c1">// Link、Route首字母大写，是组件
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">Route</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-router-dom&#39;</span>

<span class="kr">import</span> <span class="nx">About</span> <span class="nx">from</span> <span class="s1">&#39;./pages/About&#39;</span>
<span class="kr">import</span> <span class="nx">Home</span> <span class="nx">from</span> <span class="s1">&#39;./pages/Home&#39;</span>
<span class="kr">import</span> <span class="nx">Header</span> <span class="nx">from</span> <span class="s1">&#39;./component/Header&#39;</span>
<span class="kr">import</span> <span class="nx">MyNavLink</span> <span class="nx">from</span> <span class="s1">&#39;./component/MyNavLink&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">Header</span><span class="o">/&gt;</span>
                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;row&#34;</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;col-xs-2 col-xs-offset-2&#34;</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;list-group&#34;</span><span class="o">&gt;</span>
                            <span class="p">{</span><span class="cm">/* 原生html中，靠a标签跳转到不用页面实现导航功能 */</span><span class="p">}</span>
                            <span class="p">{</span><span class="cm">/* &lt;a className=&#34;list-group-item active&#34; href=&#34;./about.html&#34;&gt;About&lt;/a&gt;
</span><span class="cm">                            &lt;a className=&#34;list-group-item&#34; href=&#34;./home.html&#34;&gt;Home&lt;/a&gt; */</span><span class="p">}</span>

                            <span class="p">{</span><span class="cm">/* 在React路由中靠路由链接实现切换组件-------编写路由链接 */</span><span class="p">}</span>
                            <span class="p">{</span><span class="cm">/* 不是href了，而是to，并且to属性值为path，即 /组件名 这种形式的 */</span><span class="p">}</span>
                            <span class="p">{</span><span class="cm">/* 路由链接需要被包含在路由器里面，所以外侧需要包含一个Router标签，但是Router标签有两种：BrowserRouter、HashRouter，需要在其中选择一个。二者区别在 路由原理history 中有详解。一般路由器标签都直接放在组件使用的地方，直接包含整个组件 */</span><span class="p">}</span>
                            <span class="p">{</span><span class="cm">/* 在组件内部使用多个路由器标签，代表的是不同的路由器，互相不相干，所以一般直接将路由器标签放在组件被使用的地方，直接包含整个组件 */</span><span class="p">}</span>
                            
                            <span class="p">{</span><span class="cm">/* 不同的属性值，通过props传递。不同的标签体，也可以通过props传递，传递后的value为children，值为传递的标签体内容，在MyNavLink中可以通过this.props.children拿到传递的标签体内容 */</span><span class="p">}</span>
                            <span class="o">&lt;</span><span class="nx">MyNavLink</span> <span class="nx">to</span><span class="o">=</span><span class="s2">&#34;/about&#34;</span><span class="o">&gt;</span><span class="nx">About</span><span class="o">&lt;</span><span class="err">/MyNavLink&gt;</span>
                            <span class="o">&lt;</span><span class="nx">MyNavLink</span> <span class="nx">to</span><span class="o">=</span><span class="s2">&#34;/home&#34;</span><span class="o">&gt;</span><span class="nx">Home</span><span class="o">&lt;</span><span class="err">/MyNavLink&gt;</span>
                        <span class="o">&lt;</span><span class="err">/div&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;col-xs-6&#34;</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;panel&#34;</span><span class="o">&gt;</span>
                            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;panel-body&#34;</span><span class="o">&gt;</span>
                                <span class="p">{</span><span class="cm">/* 注册路由 */</span><span class="p">}</span>
                                <span class="p">{</span><span class="cm">/* 一定要注意component首字母小写 */</span><span class="p">}</span>
                                <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s1">&#39;/about&#39;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">About</span><span class="p">}</span><span class="o">/&gt;</span>
                                <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s1">&#39;/home&#39;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Home</span><span class="p">}</span><span class="o">/&gt;</span>
                            <span class="o">&lt;</span><span class="err">/div&gt;</span>
                        <span class="o">&lt;</span><span class="err">/div&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="o">&lt;</span><span class="err">/div&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></td></tr></table>
</div>
</div><h3 id="159-switch">15.9 Switch</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104423.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104423.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104423.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104423.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104423.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104423.png" /></p>
<p>防止注册路由的时候，一个路径对应多个组件，这多个组件都生效的情况。当用Switch标签将注册的所有路由包裹起来时，即使一个path对应着多个组件，那么永远只会对第一个生效</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104435.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104435.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104435.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104435.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104435.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104435.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104445.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104445.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104445.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104445.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104445.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104445.png" /></p>
<p>App.js</p>
<p>（Switch组件要引入）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="c1">// Link、Route首字母大写，是组件
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">Route</span><span class="p">,</span> <span class="nx">Switch</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-router-dom&#39;</span>

<span class="kr">import</span> <span class="nx">About</span> <span class="nx">from</span> <span class="s1">&#39;./pages/About&#39;</span>
<span class="kr">import</span> <span class="nx">Home</span> <span class="nx">from</span> <span class="s1">&#39;./pages/Home&#39;</span>
<span class="kr">import</span> <span class="nx">Test</span> <span class="nx">from</span> <span class="s1">&#39;./pages/Test&#39;</span>
<span class="kr">import</span> <span class="nx">Header</span> <span class="nx">from</span> <span class="s1">&#39;./component/Header&#39;</span>
<span class="kr">import</span> <span class="nx">MyNavLink</span> <span class="nx">from</span> <span class="s1">&#39;./component/MyNavLink&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">Header</span><span class="o">/&gt;</span>
                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;row&#34;</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;col-xs-2 col-xs-offset-2&#34;</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;list-group&#34;</span><span class="o">&gt;</span>
                            <span class="p">{</span><span class="cm">/* 原生html中，靠a标签跳转到不用页面实现导航功能 */</span><span class="p">}</span>
                            <span class="p">{</span><span class="cm">/* &lt;a className=&#34;list-group-item active&#34; href=&#34;./about.html&#34;&gt;About&lt;/a&gt;
</span><span class="cm">                            &lt;a className=&#34;list-group-item&#34; href=&#34;./home.html&#34;&gt;Home&lt;/a&gt; */</span><span class="p">}</span>

                            <span class="p">{</span><span class="cm">/* 在React路由中靠路由链接实现切换组件-------编写路由链接 */</span><span class="p">}</span>
                            <span class="p">{</span><span class="cm">/* 不是href了，而是to，并且to属性值为path，即 /组件名 这种形式的 */</span><span class="p">}</span>
                            <span class="p">{</span><span class="cm">/* 路由链接需要被包含在路由器里面，所以外侧需要包含一个Router标签，但是Router标签有两种：BrowserRouter、HashRouter，需要在其中选择一个。二者区别在 路由原理history 中有详解。一般路由器标签都直接放在组件使用的地方，直接包含整个组件 */</span><span class="p">}</span>
                            <span class="p">{</span><span class="cm">/* 在组件内部使用多个路由器标签，代表的是不同的路由器，互相不相干，所以一般直接将路由器标签放在组件被使用的地方，直接包含整个组件 */</span><span class="p">}</span>
                            
                            <span class="p">{</span><span class="cm">/* 不同的属性值，通过props传递。不同的标签体，也可以通过props传递，传递后的value为children，值为传递的标签体内容，在MyNavLink中可以通过this.props.children拿到传递的标签体内容 */</span><span class="p">}</span>
                            <span class="o">&lt;</span><span class="nx">MyNavLink</span> <span class="nx">to</span><span class="o">=</span><span class="s2">&#34;/about&#34;</span><span class="o">&gt;</span><span class="nx">About</span><span class="o">&lt;</span><span class="err">/MyNavLink&gt;</span>
                            <span class="o">&lt;</span><span class="nx">MyNavLink</span> <span class="nx">to</span><span class="o">=</span><span class="s2">&#34;/home&#34;</span><span class="o">&gt;</span><span class="nx">Home</span><span class="o">&lt;</span><span class="err">/MyNavLink&gt;</span>
                        <span class="o">&lt;</span><span class="err">/div&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;col-xs-6&#34;</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;panel&#34;</span><span class="o">&gt;</span>
                            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;panel-body&#34;</span><span class="o">&gt;</span>
                                <span class="p">{</span><span class="cm">/* 加了Switch，一个path对应多个组件时，只对第一个组件生效，不加的话就对两个都生效 */</span><span class="p">}</span>
                                <span class="o">&lt;</span><span class="nx">Switch</span><span class="o">&gt;</span>
                                    <span class="p">{</span><span class="cm">/* 注册路由 */</span><span class="p">}</span>
                                    <span class="p">{</span><span class="cm">/* 一定要注意component首字母小写 */</span><span class="p">}</span>
                                    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s1">&#39;/about/a/b&#39;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">About</span><span class="p">}</span><span class="o">/&gt;</span>
                                    <span class="p">{</span><span class="cm">/* 一个path对应两个组件 */</span><span class="p">}</span>
                                    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s1">&#39;/home&#39;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Home</span><span class="p">}</span><span class="o">/&gt;</span>
                                    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s1">&#39;/home&#39;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Test</span><span class="p">}</span><span class="o">/&gt;</span>
                                <span class="o">&lt;</span><span class="err">/Switch&gt;</span>
                            <span class="o">&lt;</span><span class="err">/div&gt;</span>
                        <span class="o">&lt;</span><span class="err">/div&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="o">&lt;</span><span class="err">/div&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="1510-解决样式丢失问题">15.10 解决样式丢失问题</h3>
<p>localhost:3000是react脚手架内置的一个服务器，是由webpack、devServer开启的一个服务器。<strong>它的主机号加端口号代表的就是React脚手架中的public文件夹</strong></p>
<p><strong>如果请求的资源是正确的，就返回相应资源。如果请求的资源不存在，就返回public中的index.html</strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104458.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104458.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104458.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104458.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104458.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104458.png" /></p>
<p><strong>当路由path为两级以上，刷新页面后样式丢失的原因：</strong></p>
<p>当路由的path路径为两级及两级以上时，如<Route path="/test1/test2/about" component={About}/>，浏览器在第一次进页面，请求bootstrap资源时的request url是正确的：http://localhost:3000/css/bootstrap.css，所以能成功请求到bootstrap样式。但是一旦将页面刷新后，浏览器请求bootstrap资源的地址就发生了变化，将path路径最后一级路径前的所有路径都加到了 bootstrap资源请求路径中端口号的后面：http://localhost:3000/test/test2/css/bootstrap.css，bootstrap路径不在此请求路径中，所以请求bootstrap样式失败，直接返回的是public中的index.html</p>
<p>第一次进页面：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104509.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104509.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104509.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104509.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104509.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104509.png" /></p>
<p>刷新页面后：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104520.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104520.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104520.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104520.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104520.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104520.png" /></p>
<p><strong>解决方法：</strong></p>
<ol>
<li>
<p>去掉html中引入bootstrap库路径最前面的<code>.</code>     （将相对路径改为绝对路径）</p>
<p>index.html</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- ./css/bootstrap.css表示index.html同级目录下的css文件夹下的bootstrap.css文件 --&gt;</span>
    <span class="c">&lt;!-- /css/bootstrap.css，去掉.表示：由于浏览器的localhost:3000表示的就是public，而localhost:3000又可以省略不写，所以/css/bootstrap.css表示直接在public文件夹下去找css/bootstrap.css，不会因为刷新页面而改变请求路径了 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;/css/bootstrap.css&#34;</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
        <span class="c">/* bootstrap样式的权重很高，所以加上!important */</span>
        <span class="p">.</span><span class="nc">testNavLink</span><span class="p">{</span><span class="k">background-color</span><span class="p">:</span><span class="kc">cadetblue</span> <span class="cp">!important</span><span class="p">}</span><span class="o">;</span>
    <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>主页面<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;root&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>用<code>%PUBLIC_URL%</code>代替<code>.</code> （只适合在react脚手架里面这么写，在其他地方没有这东西）    （将相对路径改为绝对路径）</p>
<p>index.html</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 引入第三方样式：bootstrap --&gt;</span>
    <span class="c">&lt;!-- %PUBLIC_URL%就表示public --&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;%PUBLIC_URL%/css/bootstrap.css&#34;</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
        <span class="c">/* bootstrap样式的权重很高，所以加上!important */</span>
        <span class="p">.</span><span class="nc">testNavLink</span><span class="p">{</span><span class="k">background-color</span><span class="p">:</span><span class="kc">cadetblue</span> <span class="cp">!important</span><span class="p">}</span><span class="o">;</span>
    <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>主页面<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;root&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>方法三（用的少）：用HashRouter，因为HashRouter会自动在浏览器地址后面加上#，#后面的不会作为请求资源。如果path为‘/test/test2/about’，点击链接后，浏览器地址会变成：http://localhost:3000/#/test/test2/about，#后面的不会作为请求资源路径，所以/test/test2/about不会存在于请求资源路径中，不会出现请求bootstrap资源的请求路径为：http://localhost:3000/#/test/test2/about这种情况。</p>
<p>index.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="nx">ReactDom</span> <span class="nx">from</span> <span class="s1">&#39;react-dom&#39;</span>
<span class="c1">// 记得要引入组件
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">HashRouter</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-router-dom&#39;</span>
<span class="kr">import</span> <span class="nx">App</span> <span class="nx">from</span> <span class="s1">&#39;./App&#39;</span>
   
<span class="nx">ReactDom</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>
    <span class="c1">// 直接将路由器标签包含整个组件，那么组件中就不存在不同路由器标签互相不能访问的问题
</span><span class="c1"></span>    <span class="o">&lt;</span><span class="nx">HashRouter</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">App</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="err">/HashRouter&gt;,</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;root&#34;</span><span class="p">)</span>
    <span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h3 id="1511-路由的模糊匹配和严格匹配">15.11 路由的模糊匹配和严格匹配</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104533.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104533.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104533.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104533.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104533.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104533.png" /></p>
<p>路由默认是模糊匹配的，<code>exact=&quot;false&quot;</code>，给的路径不少于要的路径，且顺序位置要对应上</p>
<p>情况一：给的路径少于要的路径，就不能匹配</p>
<p>​	<MyNavLink to="/about">About</MyNavLink></p>
<p>​	<Route path='/about/a/a' component={About}/></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104544.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104544.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104544.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104544.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104544.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104544.png" /></p>
<p>情况二：给的路径多，要的路径少。能匹配，因为匹配是将一个个路径拎出来，about a b与about匹配，发现路由的path为about与给的路径：about a b中的第一个匹配成功</p>
<p>​	<MyNavLink to="/about/a/b">About</MyNavLink></p>
<p>​	<Route path='/about/' component={About}/></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104556.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104556.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104556.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104556.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104556.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104556.png" /></p>
<p>情况三：给的路径与要的路径字段位置不匹配。不能匹配成功，因为匹配是按位置顺序匹配的，第一个没匹配成功就不会再继续匹配</p>
<p>​	<MyNavLink to="/a/about/b">About</MyNavLink></p>
<p>​	<Route path='/about/' component={About}/></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104614.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104614.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104614.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104614.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104614.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104614.png" /></p>
<p>解决：开启严格匹配，在路由上加一个<code>exact属性</code>，默认为false，设置其为true即可开启严格匹配。</p>
<p>​	<MyNavLink to="/about/a/b">About</MyNavLink></p>
<p>​	<Route exact path='/about/' component={About}/></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104625.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104625.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104625.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104625.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104625.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104625.png" /></p>
<p><strong>但是严格匹配不能随便开启。开启时机：模糊匹配出问题的时候再开启严格匹配。因为随意开启严格匹配有时候会出现问题，比如多级路由的时候（详见15.13嵌套路由）</strong></p>
<h3 id="1512-redirect重定向">15.12 Redirect重定向</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104635.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104635.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104635.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104635.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104635.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104635.png" /></p>
<p>当所有路由都匹配不上点击路由链接后给的路由地址时，可以使用重定向直接指定路由到哪里去，比如实现一进页面就显示的是About组件的内容：<Redirect to='/about'/></p>
<p>App.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="c1">// Link、Route首字母大写，是组件
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">Route</span><span class="p">,</span> <span class="nx">Redirect</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-router-dom&#39;</span>

<span class="kr">import</span> <span class="nx">About</span> <span class="nx">from</span> <span class="s1">&#39;./pages/About&#39;</span>
<span class="kr">import</span> <span class="nx">Home</span> <span class="nx">from</span> <span class="s1">&#39;./pages/Home&#39;</span>
<span class="kr">import</span> <span class="nx">Header</span> <span class="nx">from</span> <span class="s1">&#39;./component/Header&#39;</span>
<span class="kr">import</span> <span class="nx">MyNavLink</span> <span class="nx">from</span> <span class="s1">&#39;./component/MyNavLink&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">Header</span><span class="o">/&gt;</span>
                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;row&#34;</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;col-xs-2 col-xs-offset-2&#34;</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;list-group&#34;</span><span class="o">&gt;</span>
                            <span class="p">{</span><span class="cm">/* 原生html中，靠a标签跳转到不用页面实现导航功能 */</span><span class="p">}</span>
                            <span class="p">{</span><span class="cm">/* &lt;a className=&#34;list-group-item active&#34; href=&#34;./about.html&#34;&gt;About&lt;/a&gt;
</span><span class="cm">                            &lt;a className=&#34;list-group-item&#34; href=&#34;./home.html&#34;&gt;Home&lt;/a&gt; */</span><span class="p">}</span>

                            <span class="p">{</span><span class="cm">/* 在React路由中靠路由链接实现切换组件-------编写路由链接 */</span><span class="p">}</span>
                            <span class="p">{</span><span class="cm">/* 不是href了，而是to，并且to属性值为path，即 /组件名 这种形式的 */</span><span class="p">}</span>
                            <span class="p">{</span><span class="cm">/* 路由链接需要被包含在路由器里面，所以外侧需要包含一个Router标签，但是Router标签有两种：BrowserRouter、HashRouter，需要在其中选择一个。二者区别在 路由原理history 中有详解。一般路由器标签都直接放在组件使用的地方，直接包含整个组件 */</span><span class="p">}</span>
                            <span class="p">{</span><span class="cm">/* 在组件内部使用多个路由器标签，代表的是不同的路由器，互相不相干，所以一般直接将路由器标签放在组件被使用的地方，直接包含整个组件 */</span><span class="p">}</span>
                            
                            <span class="p">{</span><span class="cm">/* 不同的属性值，通过props传递。不同的标签体，也可以通过props传递，传递后的value为children，值为传递的标签体内容，在MyNavLink中可以通过this.props.children拿到传递的标签体内容 */</span><span class="p">}</span>
                            <span class="o">&lt;</span><span class="nx">MyNavLink</span> <span class="nx">to</span><span class="o">=</span><span class="s2">&#34;/about&#34;</span><span class="o">&gt;</span><span class="nx">About</span><span class="o">&lt;</span><span class="err">/MyNavLink&gt;</span>
                            <span class="o">&lt;</span><span class="nx">MyNavLink</span> <span class="nx">to</span><span class="o">=</span><span class="s2">&#34;/home&#34;</span><span class="o">&gt;</span><span class="nx">Home</span><span class="o">&lt;</span><span class="err">/MyNavLink&gt;</span>
                        <span class="o">&lt;</span><span class="err">/div&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;col-xs-6&#34;</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;panel&#34;</span><span class="o">&gt;</span>
                            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;panel-body&#34;</span><span class="o">&gt;</span>
                                    <span class="p">{</span><span class="cm">/* 注册路由 */</span><span class="p">}</span>
                                    <span class="p">{</span><span class="cm">/* 一定要注意component首字母小写 */</span><span class="p">}</span>
                                    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s1">&#39;/about&#39;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">About</span><span class="p">}</span><span class="o">/&gt;</span>
                                    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s1">&#39;/home&#39;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Home</span><span class="p">}</span><span class="o">/&gt;</span>
                                    <span class="o">&lt;</span><span class="nx">Redirect</span> <span class="nx">to</span><span class="o">=</span><span class="s1">&#39;/about&#39;</span><span class="o">/&gt;</span>
                            <span class="o">&lt;</span><span class="err">/div&gt;</span>
                        <span class="o">&lt;</span><span class="err">/div&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="o">&lt;</span><span class="err">/div&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104754.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104754.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104754.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104754.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104754.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104754.png" /></p>
<h3 id="1513-嵌套路由">15.13 嵌套路由</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104805.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104805.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104805.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104805.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104805.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104805.png" /></p>
<ul>
<li>
<p>子路由和子路由链接不需要用路由器标签包裹起来</p>
</li>
<li>
<p>路由链接匹配路由的顺序，是按照注册路由的顺序来的。每一个具体路由链接与路由的匹配规则是从左向右，一旦从左向右出现匹配不成功的path字段，就匹配失败</p>
</li>
<li>
<p>路由链接一旦执行重定向指定的路由，就不会再继续匹配后面的路由</p>
</li>
<li>
<p>子路由要写上父路由的path值的原因是：父路由先注册，子路由后注册，子路由中的路由链接匹配顺序就是从父路由的路由中开始，如果子路由没有加上父路由的path，那么子路由的路由链接上也应该没有父路由的path，那么子路由的路由链接从父路由中开始匹配的，就匹配不到任何父路由，那么就会走父组件的重定向，一旦走了父组件的重定向指定的路由，那么就不会再继续匹配后面的路由了，所以最终显示的是父组件的重定向指定的路由对应的组件，不会显示任何子路由对应的组件</p>
<p>如果子路由的path值前面加上了父路由的path值，那么子路由链接匹配时，会匹配成功父路由，父路由对应的组件就会显示出来。子路由链接继续匹配，匹配到子路由那么子路由对应的组件也会显示出来达到了点击子路由链接时，既不丢弃父组件也会显示子组件</p>
</li>
<li>
<p>如果在父路由中开启了严格匹配，那么子路由链接按照注册顺序匹配时，匹配不到任何父路由，所以会走重定向，一旦走了重定向指定的路由，就不会再继续匹配后面的路由了，所以也匹配不到任何子路由</p>
</li>
</ul>
<p>App.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="c1">// Link、Route首字母大写，是组件
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">Route</span><span class="p">,</span> <span class="nx">Redirect</span><span class="p">,</span> <span class="nx">Switch</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-router-dom&#39;</span>

<span class="kr">import</span> <span class="nx">About</span> <span class="nx">from</span> <span class="s1">&#39;./pages/About&#39;</span>
<span class="kr">import</span> <span class="nx">Home</span> <span class="nx">from</span> <span class="s1">&#39;./pages/Home&#39;</span>
<span class="kr">import</span> <span class="nx">Header</span> <span class="nx">from</span> <span class="s1">&#39;./component/Header&#39;</span>
<span class="kr">import</span> <span class="nx">MyNavLink</span> <span class="nx">from</span> <span class="s1">&#39;./component/MyNavLink&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">Header</span><span class="o">/&gt;</span>
                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;row&#34;</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;col-xs-2 col-xs-offset-2&#34;</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;list-group&#34;</span><span class="o">&gt;</span>
                            <span class="p">{</span><span class="cm">/* 原生html中，靠a标签跳转到不用页面实现导航功能 */</span><span class="p">}</span>
                            <span class="p">{</span><span class="cm">/* &lt;a className=&#34;list-group-item active&#34; href=&#34;./about.html&#34;&gt;About&lt;/a&gt;
</span><span class="cm">                            &lt;a className=&#34;list-group-item&#34; href=&#34;./home.html&#34;&gt;Home&lt;/a&gt; */</span><span class="p">}</span>

                            <span class="p">{</span><span class="cm">/* 在React路由中靠路由链接实现切换组件-------编写路由链接 */</span><span class="p">}</span>
                            <span class="p">{</span><span class="cm">/* 不是href了，而是to，并且to属性值为path，即 /组件名 这种形式的 */</span><span class="p">}</span>
                            <span class="p">{</span><span class="cm">/* 路由链接需要被包含在路由器里面，所以外侧需要包含一个Router标签，但是Router标签有两种：BrowserRouter、HashRouter，需要在其中选择一个。二者区别在 路由原理history 中有详解。一般路由器标签都直接放在组件使用的地方，直接包含整个组件 */</span><span class="p">}</span>
                            <span class="p">{</span><span class="cm">/* 在组件内部使用多个路由器标签，代表的是不同的路由器，互相不相干，所以一般直接将路由器标签放在组件被使用的地方，直接包含整个组件 */</span><span class="p">}</span>
                            
                            <span class="p">{</span><span class="cm">/* 不同的属性值，通过props传递。不同的标签体，也可以通过props传递，传递后的value为children，值为传递的标签体内容，在MyNavLink中可以通过this.props.children拿到传递的标签体内容 */</span><span class="p">}</span>
                            <span class="o">&lt;</span><span class="nx">MyNavLink</span> <span class="nx">to</span><span class="o">=</span><span class="s2">&#34;/about&#34;</span><span class="o">&gt;</span><span class="nx">About</span><span class="o">&lt;</span><span class="err">/MyNavLink&gt;</span>
                            <span class="o">&lt;</span><span class="nx">MyNavLink</span> <span class="nx">to</span><span class="o">=</span><span class="s2">&#34;/home&#34;</span><span class="o">&gt;</span><span class="nx">Home</span><span class="o">&lt;</span><span class="err">/MyNavLink&gt;</span>
                        <span class="o">&lt;</span><span class="err">/div&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;col-xs-6&#34;</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;panel&#34;</span><span class="o">&gt;</span>
                            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;panel-body&#34;</span><span class="o">&gt;</span>
                                <span class="o">&lt;</span><span class="nx">Switch</span><span class="o">&gt;</span>
                                    <span class="p">{</span><span class="cm">/* 组件级别最高，所以是最先注册路由 */</span><span class="p">}</span>
                                    <span class="p">{</span><span class="cm">/* 一定要注意component首字母小写 */</span><span class="p">}</span>
                                    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">exact</span> <span class="nx">path</span><span class="o">=</span><span class="s1">&#39;/about&#39;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">About</span><span class="p">}</span><span class="o">/&gt;</span>
                                    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s1">&#39;/home&#39;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Home</span><span class="p">}</span><span class="o">/&gt;</span>
                                    <span class="o">&lt;</span><span class="nx">Redirect</span> <span class="nx">to</span><span class="o">=</span><span class="s1">&#39;/about&#39;</span><span class="o">/&gt;</span>
                                <span class="o">&lt;</span><span class="err">/Switch&gt;</span>
                            <span class="o">&lt;</span><span class="err">/div&gt;</span>
                        <span class="o">&lt;</span><span class="err">/div&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="o">&lt;</span><span class="err">/div&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Home.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">Route</span><span class="p">,</span> <span class="nx">Redirect</span><span class="p">,</span> <span class="nx">Switch</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-router-dom&#39;</span>
<span class="kr">import</span> <span class="nx">MyNavLink</span> <span class="nx">from</span> <span class="s1">&#39;../../component/MyNavLink&#39;</span>
<span class="kr">import</span> <span class="nx">Message</span> <span class="nx">from</span> <span class="s1">&#39;./Message&#39;</span>
<span class="kr">import</span> <span class="nx">News</span> <span class="nx">from</span> <span class="s1">&#39;./News&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Home</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">Home组件内容</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">ul</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;nav nav-tabs&#34;</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span>
                            <span class="p">{</span><span class="cm">/* 先匹配父组件中先注册的路由，to=&#34;/home/news&#34;能和path=&#34;/home&#34;匹配上，所以能显示Home组件的内容，再继续匹配到子组件中的路由，能和path=&#34;/home/news&#34;匹配上，所以也能显示News组件的内容 */</span><span class="p">}</span>
                            <span class="o">&lt;</span><span class="nx">MyNavLink</span> <span class="nx">to</span><span class="o">=</span><span class="s2">&#34;/home/news&#34;</span><span class="o">&gt;</span><span class="nx">News</span><span class="o">&lt;</span><span class="err">/MyNavLink&gt;</span>
                        <span class="o">&lt;</span><span class="err">/li&gt;</span>
                        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span>
                            <span class="o">&lt;</span><span class="nx">MyNavLink</span> <span class="nx">to</span><span class="o">=</span><span class="s2">&#34;/home/message&#34;</span><span class="o">&gt;</span><span class="nx">Message</span><span class="o">&lt;</span><span class="err">/MyNavLink&gt;</span>
                        <span class="o">&lt;</span><span class="err">/li&gt;</span>
                        <span class="o">&lt;</span><span class="err">/ul&gt;</span>
                        <span class="o">&lt;</span><span class="nx">Switch</span><span class="o">&gt;</span>
                            <span class="p">{</span><span class="cm">/* 组件级别其次，第二注册的路由 */</span><span class="p">}</span>
                            <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&#34;/home/news&#34;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">News</span><span class="p">}</span><span class="o">/&gt;</span>
                            <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&#34;/home/message&#34;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Message</span><span class="p">}</span><span class="o">/&gt;</span>
                            <span class="o">&lt;</span><span class="nx">Redirect</span> <span class="nx">to</span><span class="o">=</span><span class="s2">&#34;/home/news&#34;</span><span class="o">/&gt;</span>
                        <span class="o">&lt;</span><span class="err">/Switch&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>News.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">News</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">news001</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">news002</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">news003</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
            <span class="o">&lt;</span><span class="err">/ul&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Message.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Message</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span>
                    <span class="p">{</span><span class="cm">/* 浏览器根据此请求路径找不到相关资源，会默认显示public下的index.html */</span><span class="p">}</span>
                    <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&#34;/message1&#34;</span><span class="o">&gt;</span><span class="nx">message001</span><span class="o">&lt;</span><span class="err">/a&gt;&amp;nbsp;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="err">/li&gt;</span>
                <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&#34;/message2&#34;</span><span class="o">&gt;</span><span class="nx">message002</span><span class="o">&lt;</span><span class="err">/a&gt;&amp;nbsp;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="err">/li&gt;</span>
                <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&#34;/message/3&#34;</span><span class="o">&gt;</span><span class="nx">message003</span><span class="o">&lt;</span><span class="err">/a&gt;&amp;nbsp;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="err">/li&gt;</span>
            <span class="o">&lt;</span><span class="err">/ul&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="1514-向路由组件传递参数params数据">15.14 向路由组件传递参数params数据</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104820.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104820.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104820.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104820.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104820.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104820.png" /></p>
<ol>
<li>在编写路由链接时，<strong>传递参数</strong>，格式：路由链接的路由path/参数值1/参数值2</li>
<li>在注册路由时，<strong>声明接收</strong>参数，格式：路由path/参数1/参数2</li>
<li><strong>在路由对应组件中接收参数：</strong>/:参数名1/:参数名2，传递的参数以props的形式传递给路由对应的组件，参数都放在props对象中的match对象中的params对象中</li>
</ol>
<p>Message.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">Link</span><span class="p">,</span> <span class="nx">Route</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-router-dom&#39;</span>
<span class="kr">import</span> <span class="nx">Detail</span> <span class="nx">from</span> <span class="s1">&#39;./Detail&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Message</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="nx">messageArr</span><span class="o">:</span><span class="p">[</span>
        <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">title</span><span class="o">:</span><span class="s2">&#34;消息1&#34;</span><span class="p">},</span>
        <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span><span class="nx">title</span><span class="o">:</span><span class="s2">&#34;消息2&#34;</span><span class="p">},</span>
        <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">3</span><span class="p">,</span><span class="nx">title</span><span class="o">:</span><span class="s2">&#34;消息3&#34;</span><span class="p">}</span>
    <span class="p">]}</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">messageArr</span><span class="p">}</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
                    <span class="p">{</span>
                        <span class="nx">messageArr</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">item</span><span class="p">=&gt;{</span>
                            <span class="c1">// 带上祖先路由的path
</span><span class="c1"></span>                            <span class="k">return</span> <span class="p">(</span>
                                <span class="o">&lt;</span><span class="nx">li</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="o">&gt;</span>
                                    <span class="p">{</span><span class="cm">/* 向路由组件传递params参数 */</span><span class="p">}</span>
                                    <span class="p">{</span><span class="cm">/* Link是标签，而反引号``属于js的语法，所以要在外侧包一个{} */</span><span class="p">}</span>
                                    <span class="o">&lt;</span><span class="nx">Link</span> <span class="nx">to</span><span class="o">=</span><span class="p">{</span><span class="sb">`/home/message/detail/</span><span class="si">${</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">/</span><span class="si">${</span><span class="nx">item</span><span class="p">.</span><span class="nx">title</span><span class="si">}</span><span class="sb">`</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/Link&gt;</span>
                                <span class="o">&lt;</span><span class="err">/li&gt;</span>
                            <span class="p">)</span>
                        <span class="p">})</span>
                    <span class="p">}</span>
                <span class="o">&lt;</span><span class="err">/ul&gt;</span>
                <span class="p">{</span><span class="cm">/* 声明接收params参数，参数以props传递到路由对应的组件中了,参数存放在props中的match对象中的params对象中，参数以key value键值对的形式存放 */</span><span class="p">}</span>
                <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&#34;/home/message/detail/:id/:title&#34;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Detail</span><span class="p">}</span><span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Detail.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>

<span class="kr">const</span> <span class="nx">detailMsg</span><span class="o">=</span><span class="p">[</span>
    <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">context</span><span class="o">:</span><span class="s2">&#34;你是猪&#34;</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span><span class="nx">context</span><span class="o">:</span><span class="s2">&#34;天天就知道睡觉&#34;</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">3</span><span class="p">,</span><span class="nx">context</span><span class="o">:</span><span class="s2">&#34;就知道吃饭&#34;</span><span class="p">}</span>
<span class="p">]</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Detail</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">id</span><span class="p">,</span><span class="nx">title</span><span class="p">}</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">match</span><span class="p">.</span><span class="nx">params</span><span class="p">;</span>
        <span class="c1">// find得到的是满足条件的那个数组项，而filter得到的是将满足条件的数组项封装成的那个数组
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">matchMsg</span><span class="o">=</span><span class="nx">detailMsg</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">item</span><span class="p">=&gt;{</span>
            <span class="k">return</span> <span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="o">==</span><span class="nx">id</span>
        <span class="p">})</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">ID</span><span class="o">:</span><span class="p">{</span><span class="nx">id</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                    <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">TITLE</span><span class="o">:</span><span class="p">{</span><span class="nx">title</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                    <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">CONTEXT</span><span class="o">:</span><span class="p">{</span><span class="nx">matchMsg</span><span class="p">.</span><span class="nx">context</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                <span class="o">&lt;</span><span class="err">/ul&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104836.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104836.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104836.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104836.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104836.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104836.png" /></p>
<h3 id="1515-向路由器传递参数search数据">15.15 向路由器传递参数search数据</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104846.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104846.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104846.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104846.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104846.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104846.png" /></p>
<ol>
<li><strong>传递参数</strong>，以?开始，每个参数之间用&amp;连接：路由链接path路径/?参数1=参数值&amp;参数2=参数值</li>
<li><strong>声明接收参数</strong>，在注册路由时不需要写任何接收参数，正常注册路由即可</li>
<li><strong>路由对应组件中接收参数</strong>，接收参数从this.props.location.search中拿，参数类型为urlencoded编码的字符串</li>
</ol>
<p>Message.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">Link</span><span class="p">,</span> <span class="nx">Route</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-router-dom&#39;</span>
<span class="kr">import</span> <span class="nx">Detail</span> <span class="nx">from</span> <span class="s1">&#39;./Detail&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Message</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="nx">messageArr</span><span class="o">:</span><span class="p">[</span>
        <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">title</span><span class="o">:</span><span class="s2">&#34;消息1&#34;</span><span class="p">},</span>
        <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span><span class="nx">title</span><span class="o">:</span><span class="s2">&#34;消息2&#34;</span><span class="p">},</span>
        <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">3</span><span class="p">,</span><span class="nx">title</span><span class="o">:</span><span class="s2">&#34;消息3&#34;</span><span class="p">}</span>
    <span class="p">]}</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">messageArr</span><span class="p">}</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
                    <span class="p">{</span>
                        <span class="nx">messageArr</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">item</span><span class="p">=&gt;{</span>
                            <span class="c1">// 带上祖先路由的path
</span><span class="c1"></span>                            <span class="k">return</span> <span class="p">(</span>
                                <span class="o">&lt;</span><span class="nx">li</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="o">&gt;</span>
                                    <span class="p">{</span><span class="cm">/* 向路由组件传递params参数 */</span><span class="p">}</span>
                                    <span class="p">{</span><span class="cm">/* Link是标签，而反引号``属于js的语法，所以要在外侧包一个{} */</span><span class="p">}</span>
                                    <span class="p">{</span><span class="cm">/* &lt;Link to={`/home/message/detail/${item.id}/${item.title}`}&gt;{item.title}&lt;/Link&gt; */</span><span class="p">}</span>

                                    <span class="p">{</span><span class="cm">/* 向路由组件传递search参数,以?开始，每个参数之间用&amp;连接 */</span><span class="p">}</span>
                                    <span class="o">&lt;</span><span class="nx">Link</span> <span class="nx">to</span><span class="o">=</span><span class="p">{</span><span class="sb">`/home/message/detail/?id=</span><span class="si">${</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">&amp;title=</span><span class="si">${</span><span class="nx">item</span><span class="p">.</span><span class="nx">title</span><span class="si">}</span><span class="sb">`</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/Link&gt;</span>
                                <span class="o">&lt;</span><span class="err">/li&gt;</span>
                            <span class="p">)</span>
                        <span class="p">})</span>
                    <span class="p">}</span>
                <span class="o">&lt;</span><span class="err">/ul&gt;</span>
                <span class="p">{</span><span class="cm">/* 声明接收params参数，参数以props传递到路由对应的组件中了,参数存放在props中的match对象中的params对象中，参数以key value键值对的形式存放 */</span><span class="p">}</span>
                <span class="p">{</span><span class="cm">/* &lt;Route path=&#34;/home/message/detail/:id/:title&#34; component={Detail}/&gt; */</span><span class="p">}</span>

                <span class="p">{</span><span class="cm">/* 声明接收search参数，search参数不需要在注册路由时声明接收，正常注册路由即可。且参数以urlencoded编码方式存放在props的localhost的search中:  参数1:参数值&amp;参数2:参数值 */</span><span class="p">}</span>
                <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&#34;/home/message/detail&#34;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Detail</span><span class="p">}</span><span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Detail.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="nx">qs</span> <span class="nx">from</span> <span class="s1">&#39;querystring&#39;</span>

<span class="kr">const</span> <span class="nx">detailMsg</span><span class="o">=</span><span class="p">[</span>
    <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">context</span><span class="o">:</span><span class="s2">&#34;你是猪&#34;</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span><span class="nx">context</span><span class="o">:</span><span class="s2">&#34;天天就知道睡觉&#34;</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">3</span><span class="p">,</span><span class="nx">context</span><span class="o">:</span><span class="s2">&#34;就知道吃饭&#34;</span><span class="p">}</span>
<span class="p">]</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Detail</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// 向路由传递params参数时，接收参数从props.match.params中拿，参数类型为键值对
</span><span class="c1"></span>        <span class="c1">// const {id,title}=this.props.match.params;
</span><span class="c1"></span>
        <span class="c1">// 向路由传递params参数时，接收参数从props.location.searc中拿，参数类型为urlencoded编码的字符串
</span><span class="c1"></span>        <span class="kr">const</span> <span class="p">{</span><span class="nx">search</span><span class="p">}</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">location</span>
        <span class="c1">// 从字符串1位开始截取字符串，去掉参数字符串首部的?号
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">detail</span> <span class="o">=</span> <span class="nx">search</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1">// 将urlencoded编码转换为键值对对象形式
</span><span class="c1"></span>        <span class="kr">const</span> <span class="p">{</span><span class="nx">id</span><span class="p">,</span><span class="nx">title</span><span class="p">}</span><span class="o">=</span><span class="nx">qs</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">detail</span><span class="p">)</span>          

        <span class="c1">// find得到的是满足条件的那个数组项，而filter得到的是将满足条件的数组项封装成的那个数组
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">matchMsg</span><span class="o">=</span><span class="nx">detailMsg</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">item</span><span class="p">=&gt;{</span>
            <span class="k">return</span> <span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="o">==</span><span class="nx">id</span>
        <span class="p">})</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">ID</span><span class="o">:</span><span class="p">{</span><span class="nx">id</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                    <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">TITLE</span><span class="o">:</span><span class="p">{</span><span class="nx">title</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                    <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">CONTEXT</span><span class="o">:</span><span class="p">{</span><span class="nx">matchMsg</span><span class="p">.</span><span class="nx">context</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                <span class="o">&lt;</span><span class="err">/ul&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="1516-向路由组件传递state参数">15.16 向路由组件传递state参数</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104900.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104900.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104900.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104900.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104900.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104900.png" /></p>
<ol>
<li><strong>传递参数</strong>，向路由组件传递state参数,to值必须为一个对象，每个属性格式为键值对,state属性值也必须为一个对象，参数格式为键值对</li>
<li><strong>声明接收参数</strong>，state参数不需要在注册路由时声明接收，正常注册路由即可。且参数以key value存放在props的localhost的state中</li>
<li><strong>路由对应组件中接收参数</strong>，接收参数从props.location.state中拿，参数类型为键值对</li>
</ol>
<ul>
<li>state传参不会在浏览器地址栏显示出来，刷新页面，参数不会丢，因为BrowserRouter是一直操作history对象的，history对象中也存放了一个location对象，所以state数据会一直保存在history中，除非清空浏览器缓存，所以刷新页面不会导致state数据的丢失</li>
</ul>
<p>Message.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">Link</span><span class="p">,</span> <span class="nx">Route</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-router-dom&#39;</span>
<span class="kr">import</span> <span class="nx">Detail</span> <span class="nx">from</span> <span class="s1">&#39;./Detail&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Message</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="nx">messageArr</span><span class="o">:</span><span class="p">[</span>
        <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">title</span><span class="o">:</span><span class="s2">&#34;消息1&#34;</span><span class="p">},</span>
        <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span><span class="nx">title</span><span class="o">:</span><span class="s2">&#34;消息2&#34;</span><span class="p">},</span>
        <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">3</span><span class="p">,</span><span class="nx">title</span><span class="o">:</span><span class="s2">&#34;消息3&#34;</span><span class="p">}</span>
    <span class="p">]}</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">messageArr</span><span class="p">}</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
                    <span class="p">{</span>
                        <span class="nx">messageArr</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">item</span><span class="p">=&gt;{</span>
                            <span class="c1">// 带上祖先路由的path
</span><span class="c1"></span>                            <span class="k">return</span> <span class="p">(</span>
                                <span class="o">&lt;</span><span class="nx">li</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="o">&gt;</span>
                                    <span class="p">{</span><span class="cm">/* 向路由组件传递params参数 */</span><span class="p">}</span>
                                    <span class="p">{</span><span class="cm">/* Link是标签，而反引号``属于js的语法，所以要在外侧包一个{} */</span><span class="p">}</span>
                                    <span class="p">{</span><span class="cm">/* &lt;Link to={`/home/message/detail/${item.id}/${item.title}`}&gt;{item.title}&lt;/Link&gt; */</span><span class="p">}</span>

                                    <span class="p">{</span><span class="cm">/* 向路由组件传递search参数,以?开始，每个参数之间用&amp;连接 */</span><span class="p">}</span>
                                    <span class="p">{</span><span class="cm">/* &lt;Link to={`/home/message/detail/?id=${item.id}&amp;title=${item.title}`}&gt;{item.title}&lt;/Link&gt; */</span><span class="p">}</span>

                                    <span class="p">{</span><span class="cm">/* 向路由组件传递state参数,to值必须为一个对象，每个属性格式为键值对,state属性值也必须为一个对象，参数格式为键值对*/</span><span class="p">}</span>
                                    <span class="p">{</span><span class="cm">/* 最外侧括号表示html中写的是js代码，里侧的括号表示to属性值为一个对象 */</span><span class="p">}</span>
                                    <span class="o">&lt;</span><span class="nx">Link</span> <span class="nx">to</span><span class="o">=</span><span class="p">{{</span><span class="nx">pathname</span><span class="o">:</span><span class="s1">&#39;/home/message/detail&#39;</span><span class="p">,</span><span class="nx">state</span><span class="o">:</span><span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span><span class="nx">title</span><span class="o">:</span><span class="nx">item</span><span class="p">.</span><span class="nx">title</span><span class="p">}}}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/Link&gt;</span>
                                <span class="o">&lt;</span><span class="err">/li&gt;</span>
                            <span class="p">)</span>
                        <span class="p">})</span>
                    <span class="p">}</span>
                <span class="o">&lt;</span><span class="err">/ul&gt;</span>
                <span class="p">{</span><span class="cm">/* 声明接收params参数，参数以props传递到路由对应的组件中了,参数存放在props中的match对象中的params对象中，参数以key value键值对的形式存放 */</span><span class="p">}</span>
                <span class="p">{</span><span class="cm">/* &lt;Route path=&#34;/home/message/detail/:id/:title&#34; component={Detail}/&gt; */</span><span class="p">}</span>

                <span class="p">{</span><span class="cm">/* 声明接收search参数，search参数不需要在注册路由时声明接收，正常注册路由即可。且参数以urlencoded编码方式存放在props的localhost的search中:  参数1:参数值&amp;参数2:参数值 */</span><span class="p">}</span>
                <span class="p">{</span><span class="cm">/* &lt;Route path=&#34;/home/message/detail&#34; component={Detail}/&gt; */</span><span class="p">}</span>

                 <span class="p">{</span><span class="cm">/* 声明接收state参数，state参数不需要在注册路由时声明接收，正常注册路由即可。且参数以key value存放在props的localhost的state中 */</span><span class="p">}</span>
                 <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&#34;/home/message/detail&#34;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Detail</span><span class="p">}</span><span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Detail.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="nx">qs</span> <span class="nx">from</span> <span class="s1">&#39;querystring&#39;</span>

<span class="kr">const</span> <span class="nx">detailMsg</span><span class="o">=</span><span class="p">[</span>
    <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">context</span><span class="o">:</span><span class="s2">&#34;你是猪&#34;</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span><span class="nx">context</span><span class="o">:</span><span class="s2">&#34;天天就知道睡觉&#34;</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">3</span><span class="p">,</span><span class="nx">context</span><span class="o">:</span><span class="s2">&#34;就知道吃饭&#34;</span><span class="p">}</span>
<span class="p">]</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Detail</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// 向路由传递params参数时，接收参数从props.match.params中拿，参数类型为键值对
</span><span class="c1"></span>        <span class="c1">// const {id,title}=this.props.match.params;
</span><span class="c1"></span>
        <span class="c1">// 向路由传递search参数时，接收参数从props.location.search中拿，参数类型为urlencoded编码的字符串
</span><span class="c1"></span>        <span class="c1">// const {search}=this.props.location
</span><span class="c1"></span>        <span class="c1">// // 从字符串1位开始截取字符串，去掉参数字符串首部的?号
</span><span class="c1"></span>        <span class="c1">// const detail = search.substring(1)
</span><span class="c1"></span>        <span class="c1">// // 将urlencoded编码转换为键值对对象形式
</span><span class="c1"></span>        <span class="c1">// const {id,title}=qs.parse(detail)
</span><span class="c1"></span>
        <span class="c1">// 向路由传递state参数时，接收参数从props.location.state中拿，参数类型为键值对
</span><span class="c1"></span>        <span class="c1">// 如果路由没传state参数，那么this.props.location.state就为默认值undefined，从undefined中取值就会报错，所以当没传state参数时，让其为空对象，而不是默认值undefined
</span><span class="c1"></span>        <span class="kr">const</span> <span class="p">{</span><span class="nx">id</span><span class="p">,</span><span class="nx">title</span><span class="p">}</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">state</span><span class="o">||</span><span class="p">{};</span>

        <span class="c1">// find得到的是满足条件的那个数组项，而filter得到的是将满足条件的数组项封装成的那个数组
</span><span class="c1"></span>        <span class="c1">// 如果this.props.location.state没有id属性，id为undefined，detailMsg中没有id值与undefined相同，所以matchMsg为undefined，那么下面matchMsg.context就会报错，所以当没有值与state中的id相同时，让matchMsg为空对象
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">matchMsg</span><span class="o">=</span><span class="nx">detailMsg</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">item</span><span class="p">=&gt;{</span>
            <span class="k">return</span> <span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="o">==</span><span class="nx">id</span>
        <span class="p">})</span><span class="o">||</span><span class="p">{}</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">ID</span><span class="o">:</span><span class="p">{</span><span class="nx">id</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                    <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">TITLE</span><span class="o">:</span><span class="p">{</span><span class="nx">title</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                    <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">CONTEXT</span><span class="o">:</span><span class="p">{</span><span class="nx">matchMsg</span><span class="p">.</span><span class="nx">context</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                <span class="o">&lt;</span><span class="err">/ul&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="1517push与replace">15.17push与replace</h3>
<p>push:</p>
<ul>
<li>压栈的方式，当前组件路径永远在history栈顶</li>
<li>所有的都会留下记录，都能返回和前进</li>
</ul>
<p>replace：开启方法是在编写路由链接时设置replace属性为true</p>
<ul>
<li>替换掉栈顶路由路径，不会留下历史记录</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="o">&lt;</span><span class="nx">Link</span> <span class="nx">replace</span> <span class="nx">to</span><span class="o">=</span><span class="p">{{</span><span class="nx">pathname</span><span class="o">:</span><span class="s1">&#39;/home/message/detail&#39;</span><span class="p">,</span><span class="nx">state</span><span class="o">:</span><span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span><span class="nx">title</span><span class="o">:</span><span class="nx">item</span><span class="p">.</span><span class="nx">title</span><span class="p">}}}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/Link&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Message.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">Link</span><span class="p">,</span> <span class="nx">Route</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-router-dom&#39;</span>
<span class="kr">import</span> <span class="nx">Detail</span> <span class="nx">from</span> <span class="s1">&#39;./Detail&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Message</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="nx">messageArr</span><span class="o">:</span><span class="p">[</span>
        <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">title</span><span class="o">:</span><span class="s2">&#34;消息1&#34;</span><span class="p">},</span>
        <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span><span class="nx">title</span><span class="o">:</span><span class="s2">&#34;消息2&#34;</span><span class="p">},</span>
        <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">3</span><span class="p">,</span><span class="nx">title</span><span class="o">:</span><span class="s2">&#34;消息3&#34;</span><span class="p">}</span>
    <span class="p">]}</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">messageArr</span><span class="p">}</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
                    <span class="p">{</span>
                        <span class="nx">messageArr</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">item</span><span class="p">=&gt;{</span>
                            <span class="c1">// 带上祖先路由的path
</span><span class="c1"></span>                            <span class="k">return</span> <span class="p">(</span>
                                <span class="o">&lt;</span><span class="nx">li</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="o">&gt;</span>
                                    <span class="p">{</span><span class="cm">/* 向路由组件传递params参数 */</span><span class="p">}</span>
                                    <span class="p">{</span><span class="cm">/* Link是标签，而反引号``属于js的语法，所以要在外侧包一个{} */</span><span class="p">}</span>
                                    <span class="p">{</span><span class="cm">/* replace开启替换history栈顶的路由路径，每点击消息链接，会替换掉/home/message，再点击就会替换掉刚刚的消息链接路由路径，所以点击返回，返回的是/home/news */</span><span class="p">}</span>
                                    <span class="o">&lt;</span><span class="nx">Link</span> <span class="nx">replace</span> <span class="nx">to</span><span class="o">=</span><span class="p">{</span><span class="sb">`/home/message/detail/</span><span class="si">${</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">/</span><span class="si">${</span><span class="nx">item</span><span class="p">.</span><span class="nx">title</span><span class="si">}</span><span class="sb">`</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/Link&gt;</span>

                                    <span class="p">{</span><span class="cm">/* 向路由组件传递search参数,以?开始，每个参数之间用&amp;连接 */</span><span class="p">}</span>
                                    <span class="p">{</span><span class="cm">/* &lt;Link to={`/home/message/detail/?id=${item.id}&amp;title=${item.title}`}&gt;{item.title}&lt;/Link&gt; */</span><span class="p">}</span>

                                    <span class="p">{</span><span class="cm">/* 向路由组件传递state参数,to值必须为一个对象，每个属性格式为键值对,state属性值也必须为一个对象，参数格式为键值对*/</span><span class="p">}</span>
                                    <span class="p">{</span><span class="cm">/* 最外侧括号表示html中写的是js代码，里侧的括号表示to属性值为一个对象 */</span><span class="p">}</span>
                                    <span class="p">{</span><span class="cm">/* &lt;Link replace to={{pathname:&#39;/home/message/detail&#39;,state:{id:item.id,title:item.title}}}&gt;{item.title}&lt;/Link&gt; */</span><span class="p">}</span>
                                <span class="o">&lt;</span><span class="err">/li&gt;</span>
                            <span class="p">)</span>
                        <span class="p">})</span>
                    <span class="p">}</span>
                <span class="o">&lt;</span><span class="err">/ul&gt;</span>
                <span class="p">{</span><span class="cm">/* 声明接收params参数，参数以props传递到路由对应的组件中了,参数存放在props中的match对象中的params对象中，参数以key value键值对的形式存放 */</span><span class="p">}</span>
                <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&#34;/home/message/detail/:id/:title&#34;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Detail</span><span class="p">}</span><span class="o">/&gt;</span>

                <span class="p">{</span><span class="cm">/* 声明接收search参数，search参数不需要在注册路由时声明接收，正常注册路由即可。且参数以urlencoded编码方式存放在props的localhost的search中:  参数1:参数值&amp;参数2:参数值 */</span><span class="p">}</span>
                <span class="p">{</span><span class="cm">/* &lt;Route path=&#34;/home/message/detail&#34; component={Detail}/&gt; */</span><span class="p">}</span>

                 <span class="p">{</span><span class="cm">/* 声明接收state参数，state参数不需要在注册路由时声明接收，正常注册路由即可。且参数以key value存放在props的localhost的state中 */</span><span class="p">}</span>
                 <span class="p">{</span><span class="cm">/* &lt;Route path=&#34;/home/message/detail&#34; component={Detail}/&gt; */</span><span class="p">}</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="1518-编程式路由导航">15.18 编程式路由导航</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104924.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104924.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104924.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104924.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104924.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104924.png" /></p>
<p>实现不点击链接也能跳转路由，即不用Link、NavLink，比如点击某个按钮实现跳转路由：利用<strong>路由组件中的history对象</strong>中的push方法实现push形式的路由跳转，replace方法实现replace形式的跳转</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104937.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104937.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104937.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104937.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104937.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104937.png" /></p>
<p>go：参数为nubmer，表示前进几步，可以为负值，负值表示后退</p>
<p>goBack：后退一步</p>
<p>goForward：前进一步</p>
<p>push：以push形式路由</p>
<p>replace：以replace形式路由</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104950.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104950.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104950.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104950.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104950.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002104950.png" /></p>
<p>pathname、path、url都可以获取当前组件所处的路由路径</p>
<p>Message.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">Link</span><span class="p">,</span> <span class="nx">Route</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-router-dom&#39;</span>
<span class="kr">import</span> <span class="nx">Detail</span> <span class="nx">from</span> <span class="s1">&#39;./Detail&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Message</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="nx">messageArr</span><span class="o">:</span><span class="p">[</span>
        <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">title</span><span class="o">:</span><span class="s2">&#34;消息1&#34;</span><span class="p">},</span>
        <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span><span class="nx">title</span><span class="o">:</span><span class="s2">&#34;消息2&#34;</span><span class="p">},</span>
        <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">3</span><span class="p">,</span><span class="nx">title</span><span class="o">:</span><span class="s2">&#34;消息3&#34;</span><span class="p">}</span>
    <span class="p">]}</span>

    <span class="nx">pushShow</span><span class="o">=</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span><span class="nx">title</span><span class="p">)=&gt;{</span>
        <span class="c1">// push跳转+携带params参数
</span><span class="c1"></span>        <span class="c1">// this.props.history.push(`/home/message/detail/${id}/${title}`)
</span><span class="c1"></span>
        <span class="c1">// push跳转+携带search参数
</span><span class="c1"></span>        <span class="c1">// this.props.history.push(`/home/message/detail/?id=${id}&amp;title=${title}`)
</span><span class="c1"></span>
        <span class="c1">// push跳转+携带state参数
</span><span class="c1"></span>        <span class="c1">// push可以携带两个参数：path,state
</span><span class="c1"></span>        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;/home/message/detail&#39;</span><span class="p">,{</span><span class="nx">id</span><span class="p">,</span><span class="nx">title</span><span class="p">})</span>
    <span class="p">}</span>

    <span class="nx">replaceShow</span><span class="o">=</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span><span class="nx">title</span><span class="p">)=&gt;{</span>
        <span class="c1">// replace跳转+携带params参数
</span><span class="c1"></span>        <span class="c1">// this.props.history.replace(`/home/message/detail/${id}/${title}`)
</span><span class="c1"></span>
        <span class="c1">// replace跳转+携带search参数
</span><span class="c1"></span>        <span class="c1">// this.props.history.replace(`/home/message/detail/?id=${id}&amp;title=${title}`)
</span><span class="c1"></span>
        <span class="c1">// replace跳转+携带state参数
</span><span class="c1"></span>        <span class="c1">// replace可以携带两个参数：path,state
</span><span class="c1"></span>        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;/home/message/detail&#39;</span><span class="p">,{</span><span class="nx">id</span><span class="p">,</span><span class="nx">title</span><span class="p">})</span>
    <span class="p">}</span>

    <span class="nx">back</span><span class="o">=</span><span class="p">()=&gt;{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">goBack</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="nx">forward</span><span class="o">=</span><span class="p">()=&gt;{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">goForward</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">messageArr</span><span class="p">}</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
                    <span class="p">{</span>
                        <span class="nx">messageArr</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">item</span><span class="p">=&gt;{</span>
                            <span class="c1">// 带上祖先路由的path
</span><span class="c1"></span>                            <span class="k">return</span> <span class="p">(</span>
                                <span class="o">&lt;</span><span class="nx">li</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="o">&gt;</span>
                                    <span class="p">{</span><span class="cm">/* 向路由组件传递params参数 */</span><span class="p">}</span>
                                    <span class="p">{</span><span class="cm">/* Link是标签，而反引号``属于js的语法，所以要在外侧包一个{} */</span><span class="p">}</span>
                                    <span class="p">{</span><span class="cm">/* replace开启替换history栈顶的路由路径，每点击消息链接，会替换掉/home/message，再点击就会替换掉刚刚的消息链接路由路径，所以点击返回，返回的是/home/news */</span><span class="p">}</span>
                                    <span class="o">&lt;</span><span class="nx">Link</span> <span class="nx">replace</span> <span class="nx">to</span><span class="o">=</span><span class="p">{</span><span class="sb">`/home/message/detail/</span><span class="si">${</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">/</span><span class="si">${</span><span class="nx">item</span><span class="p">.</span><span class="nx">title</span><span class="si">}</span><span class="sb">`</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/Link&gt;</span>

                                    <span class="p">{</span><span class="cm">/* 向路由组件传递search参数,以?开始，每个参数之间用&amp;连接 */</span><span class="p">}</span>
                                    <span class="p">{</span><span class="cm">/* &lt;Link to={`/home/message/detail/?id=${item.id}&amp;title=${item.title}`}&gt;{item.title}&lt;/Link&gt; */</span><span class="p">}</span>

                                    <span class="p">{</span><span class="cm">/* 向路由组件传递state参数,to值必须为一个对象，每个属性格式为键值对,state属性值也必须为一个对象，参数格式为键值对*/</span><span class="p">}</span>
                                    <span class="p">{</span><span class="cm">/* 最外侧括号表示html中写的是js代码，里侧的括号表示to属性值为一个对象 */</span><span class="p">}</span>
                                    <span class="p">{</span><span class="cm">/* &lt;Link replace to={{pathname:&#39;/home/message/detail&#39;,state:{id:item.id,title:item.title}}}&gt;{item.title}&lt;/Link&gt; */</span><span class="p">}</span>

                                    <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{()=&gt;{</span><span class="k">this</span><span class="p">.</span><span class="nx">pushShow</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span><span class="nx">item</span><span class="p">.</span><span class="nx">title</span><span class="p">)}}</span><span class="o">&gt;</span><span class="nx">push跳转</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                                    <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{()=&gt;{</span><span class="k">this</span><span class="p">.</span><span class="nx">replaceShow</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span><span class="nx">item</span><span class="p">.</span><span class="nx">title</span><span class="p">)}}</span><span class="o">&gt;</span><span class="nx">replace跳转</span><span class="o">&lt;</span><span class="err">/button&gt;    </span>
                            
                                <span class="o">&lt;</span><span class="err">/li&gt;</span>
                            <span class="p">)</span>
                        <span class="p">})</span>
                    <span class="p">}</span>
                <span class="o">&lt;</span><span class="err">/ul&gt;</span>
                <span class="p">{</span><span class="cm">/* 声明接收params参数，参数以props传递到路由对应的组件中了,参数存放在props中的match对象中的params对象中，参数以key value键值对的形式存放 */</span><span class="p">}</span>
                <span class="p">{</span><span class="cm">/* &lt;Route path=&#34;/home/message/detail/:id/:title&#34; component={Detail}/&gt; */</span><span class="p">}</span>

                <span class="p">{</span><span class="cm">/* 声明接收search参数，search参数不需要在注册路由时声明接收，正常注册路由即可。且参数以urlencoded编码方式存放在props的localhost的search中:  参数1:参数值&amp;参数2:参数值 */</span><span class="p">}</span>
                <span class="p">{</span><span class="cm">/* &lt;Route path=&#34;/home/message/detail&#34; component={Detail}/&gt; */</span><span class="p">}</span>

                 <span class="p">{</span><span class="cm">/* 声明接收state参数，state参数不需要在注册路由时声明接收，正常注册路由即可。且参数以key value存放在props的localhost的state中 */</span><span class="p">}</span>
                 <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&#34;/home/message/detail&#34;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Detail</span><span class="p">}</span><span class="o">/&gt;</span>

                 <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">back</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">回退</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                 <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">forward</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">前进</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Detail.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="nx">qs</span> <span class="nx">from</span> <span class="s1">&#39;querystring&#39;</span>

<span class="kr">const</span> <span class="nx">detailMsg</span><span class="o">=</span><span class="p">[</span>
    <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">context</span><span class="o">:</span><span class="s2">&#34;你是猪&#34;</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span><span class="nx">context</span><span class="o">:</span><span class="s2">&#34;天天就知道睡觉&#34;</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="mi">3</span><span class="p">,</span><span class="nx">context</span><span class="o">:</span><span class="s2">&#34;就知道吃饭&#34;</span><span class="p">}</span>
<span class="p">]</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Detail</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// 向路由传递params参数时，接收参数从props.match.params中拿，参数类型为键值对
</span><span class="c1"></span>        <span class="c1">// const {id,title}=this.props.match.params;
</span><span class="c1"></span>
        <span class="c1">// 向路由传递search参数时，接收参数从props.location.search中拿，参数类型为urlencoded编码的字符串
</span><span class="c1"></span>        <span class="c1">// const {search}=this.props.location
</span><span class="c1"></span>        <span class="c1">// // 从字符串1位开始截取字符串，去掉参数字符串首部的?号
</span><span class="c1"></span>        <span class="c1">// const detail = search.substring(1)
</span><span class="c1"></span>        <span class="c1">// // 将urlencoded编码转换为键值对对象形式
</span><span class="c1"></span>        <span class="c1">// const {id,title}=qs.parse(detail)
</span><span class="c1"></span>
        <span class="c1">// 向路由传递state参数时，接收参数从props.location.state中拿，参数类型为键值对
</span><span class="c1"></span>        <span class="c1">// 如果路由没传state参数，那么this.props.location.state就为默认值undefined，从undefined中取值就会报错，所以当没传state参数时，让其为空对象，而不是默认值undefined
</span><span class="c1"></span>        <span class="kr">const</span> <span class="p">{</span><span class="nx">id</span><span class="p">,</span><span class="nx">title</span><span class="p">}</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">state</span><span class="o">||</span><span class="p">{};</span>

        <span class="c1">// find得到的是满足条件的那个数组项，而filter得到的是将满足条件的数组项封装成的那个数组
</span><span class="c1"></span>        <span class="c1">// 如果this.props.location.state没有id属性，id为undefined，detailMsg中没有id值与undefined相同，所以matchMsg为undefined，那么下面matchMsg.context就会报错，所以当没有值与state中的id相同时，让matchMsg为空对象
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">matchMsg</span><span class="o">=</span><span class="nx">detailMsg</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">item</span><span class="p">=&gt;{</span>
            <span class="k">return</span> <span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="o">==</span><span class="nx">id</span>
        <span class="p">})</span><span class="o">||</span><span class="p">{}</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">ID</span><span class="o">:</span><span class="p">{</span><span class="nx">id</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                    <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">TITLE</span><span class="o">:</span><span class="p">{</span><span class="nx">title</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                    <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span><span class="nx">CONTEXT</span><span class="o">:</span><span class="p">{</span><span class="nx">matchMsg</span><span class="p">.</span><span class="nx">context</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                <span class="o">&lt;</span><span class="err">/ul&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="1519-withrouter使用">15.19 withRouter使用</h3>
<p>是react-router-dom中的一个方法，需要引入</p>
<p>withRouter作用：可以让一般组件也能使用路由组件的api，比如this.props自动有history、location、match属性</p>
<p>现在Header组件内也加上回退、前进、go按钮</p>
<p>Header.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">withRouter</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-router-dom&#39;</span>

<span class="kr">class</span> <span class="nx">Header</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">back</span><span class="o">=</span><span class="p">()=&gt;{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">goBack</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="nx">forward</span><span class="o">=</span><span class="p">()=&gt;{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">goForward</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="nx">go</span><span class="o">=</span><span class="p">()=&gt;{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">go</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;col-xs-offset-2 col-xs-8&#34;</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;page-header&#34;</span><span class="o">&gt;&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">React</span> <span class="nx">Router</span> <span class="nx">Demo</span><span class="o">&lt;</span><span class="err">/h2&gt;&lt;/div&gt;</span>
                    <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">back</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">回退</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                    <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">forward</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">前进</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                    <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">go</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">go</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 默认暴露出withRouter(Header)的返回值，withRouter能让一般组件也能使用路由组件的api，返回值为能使用路由组件api的新的一般组件
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="nx">withRouter</span><span class="p">(</span><span class="nx">Header</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="1520-browserrouter和hashrouter的区别">15.20 BrowserRouter和HashRouter的区别</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105007.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105007.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105007.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105007.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105007.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105007.png" /></p>
<p>在向路由组件传递state参数时，由于这种传参方式不会在浏览器地址栏中显示出来参数，而HashRputer靠的就是地址栏后面的哈希值，所以使用HashRouter时，会造成参数的丢失。BrowserRouter使用的是浏览器BOM内置的history对象，与this.props.history对象不一样，所以刷新页面不影响路由携带的参数，因为state保存在了浏览器内置history栈中。而HashRouter没有使用浏览器内置history，它使用的是url的哈希值，由于state参数不会在地址栏显示出来，所以没有人帮它记住历史path，所以刷新页面会造成路由参数丢失</p>
<p>所以BrowserRouter用的多，但是HashRouter的兼容性比较好</p>
<h2 id="16-antd">16. antd</h2>
<h3 id="161-antd的基本使用">16.1 antd的基本使用</h3>
<ul>
<li>
<p>ant-design：第三方组件库</p>
</li>
<li>
<p>需要安装：npm install antd</p>
</li>
<li>
<p>引入库：import antd from &lsquo;antd&rsquo;，如果from后面只有一个包名，那么会默认去node_modules中找</p>
</li>
<li>
<p>需要引入antd包下的dist文件夹中的antd.css样式，样式才有效：import antdcss from &lsquo;antd/dist/antd.css&rsquo;</p>
<p>App.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
  
<span class="kr">import</span> <span class="nx">antd</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Button</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;antd&#39;</span>
<span class="c1">// 需要引入antd样式，样式才有效
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">antdcss</span> <span class="nx">from</span> <span class="s1">&#39;antd/dist/antd.css&#39;</span>
  
<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">button</span><span class="o">&gt;</span><span class="nx">普通按钮</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                <span class="o">&lt;</span><span class="nx">Button</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;primary&#34;</span><span class="o">&gt;</span><span class="nx">主要按钮</span><span class="o">&lt;</span><span class="err">/Button&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105020.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105020.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105020.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105020.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105020.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105020.png" /></p>
</li>
<li>
<p>有很多子库，安装antd库的时候就已经安装了子库，但是使用的时候需要分别引入，因为子库中的内容，antd主库中没有。比如：如果需要使用antd中的图标，就需要引入@ant-design/icons库，针对不同图标对应的不同组件，从@ant-design/icons库中引入</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
  
<span class="kr">import</span> <span class="nx">antd</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Button</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;antd&#39;</span>
<span class="c1">// 需要引入antd样式，样式才有效
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">antdcss</span> <span class="nx">from</span> <span class="s1">&#39;antd/dist/antd.css&#39;</span>
<span class="c1">// 引入antd的子库：图标库，需引入图标库中图标对应的组件
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">RedditOutlined</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;@ant-design/icons&#39;</span>
  
<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">button</span><span class="o">&gt;</span><span class="nx">普通按钮</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                <span class="o">&lt;</span><span class="nx">Button</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;primary&#34;</span><span class="o">&gt;</span><span class="nx">主要按钮</span><span class="o">&lt;</span><span class="err">/Button&gt;</span>
                <span class="o">&lt;</span><span class="nx">RedditOutlined</span> <span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105035.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105035.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105035.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105035.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105035.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105035.png" /></p>
</li>
</ul>
<h3 id="162-antd样式的按需引入">16.2 antd样式的按需引入</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105045.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105045.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105045.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105045.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105045.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105045.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105054.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105054.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105054.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105054.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105054.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105054.png" /></p>
<p>直接引入@ant-design/icons表示引入所有antd组件的样式，文件会很大，而且我们用到的只有那么几个组件，其他组件样式引入后根本没用。</p>
<p><strong>按需引入样式的方法：修改react配置</strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105106.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105106.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105106.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105106.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105106.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105106.png" /></p>
<p>方法一：可以使用 create-react-app 提供的<strong>npm run eject</strong>命令将所有react内建的配置暴露出来。这种方法非常不推荐使用，因为一旦暴露出来，不小心修改错了，那么会导致项目都运行不起来，而且是不可恢复的</p>
<p>执行命令后react脚手架会出现一个config文件夹，里面存放着配置文件</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105113.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105113.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105113.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105113.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105113.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105113.png" /></p>
<p>方法二：</p>
<ol>
<li>
<p>将要修改的内容单独放在一个文件中，这个文件一般是在根目录中创建一个config-overrides.js文件，用于修改默认配置</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105127.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105127.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105127.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105127.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105127.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105127.png" /></p>
</li>
<li>
<p>npm add react-app-rewired customize-cra：安装react-app-rewired    customize-cra这两个包， customize-cra包用于找到craco.config.js配置文件，并执行。react-app-rewired包用于启动项目，因为用customize-cra修改配置时，会导致用原来的react-scripts start命令不能启动脚手架，所以需要安装这个包去启动项目</p>
</li>
<li>
<p>npm start是个短命令，原命令是：react-scripts start。用customize-cra修改配置后，原来的react-scripts start不能启动项目了，所以需要在package.json中修改启动命令，用刚下载的react-app-rewired去启动项目</p>
<p>修改start、build、test的命令</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105139.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105139.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105139.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105139.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105139.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105139.png" /></p>
</li>
<li>
<p>npm add babel-plugin-import：安装babel-plugin-import插件，这个插件支持样式按需引入</p>
</li>
<li>
<p>修改config-overrides.js文件内容</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-json" data-lang="json"><span class="err">//</span> <span class="err">修改默认配置</span>
<span class="err">const</span> <span class="p">{</span> <span class="err">override,</span> <span class="err">fixBabelImports</span> <span class="p">}</span> <span class="err">=</span> <span class="err">require(&#39;customize-cra&#39;);</span>
   
<span class="err">//</span> <span class="err">import表示引入，antd表示引入的是antd的东西，es表示用了es规范，css表示引入的是样式</span>
<span class="err">module.exports</span> <span class="err">=</span> <span class="err">override(</span>
  <span class="err">fixBabelImports(&#39;import&#39;,</span> <span class="p">{</span>
    <span class="err">libraryName:</span> <span class="err">&#39;antd&#39;,</span>
    <span class="err">libraryDirectory:</span> <span class="err">&#39;es&#39;,</span>
    <span class="err">style:</span> <span class="err">&#39;css&#39;,</span>
  <span class="p">}</span><span class="err">),</span>
<span class="err">);</span>
</code></pre></td></tr></table>
</div>
</div><p>做完了以上5步后，在写代码的时候就可以不用引入import antdcss from &lsquo;antd/dist/antd.css&rsquo;样式了</p>
<p>出现问题：修改package.json文件react-app-rewired后，用npm start发现启动不了项目。</p>
<p>解决方法：</p>
<p><a href="https://www.cnblogs.com/tu-0718/p/12541841.html">https://www.cnblogs.com/tu-0718/p/12541841.html</a></p>
<p><a href="https://www.cnblogs.com/qianxiaox/p/13830977.html">https://www.cnblogs.com/qianxiaox/p/13830977.html</a></p>
</li>
</ol>
<h3 id="163-antd自定义主题">16.3 antd自定义主题</h3>
<p>antd底层样式全是用less写的，react会自动将less编译成css，如果你要修改antd组件的样式，<strong>需要安装less 和 less-loader</strong>，antd组件样式底层是用less写的，要改就要先安装less，由于需要将less编译为css，所以需要安装less-loader。之前不用安装是因为之前底层已经自动编译好了。</p>
<p>例子：修改底层主题颜色，antd的主题颜色是蓝色</p>
<ol>
<li>
<p>安装less 和 less-loader：npm</p>
</li>
<li>
<p>修改config-overrides.js，将style:&lsquo;css&rsquo;，修改为style:true，因为现在不是将css按需引入，而是将修改后的less，再编译成css按需引入</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105203.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105203.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105203.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105203.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105203.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105203.png" /></p>
</li>
<li>
<p>引入addLessLoader</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105214.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105214.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105214.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105214.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105214.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105214.png" /></p>
</li>
<li>
<p>添加代码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-json" data-lang="json"><span class="err">//</span> <span class="err">javascriptEnabled表示能用js修改底层less样式文件</span>
<span class="err">//</span> <span class="err">这里不能用modifyVars去修改主题样式了，因为现在less-loader更新了，不再用modifyVars去修改主题样式了，而是用lessOptions对象</span>
<span class="err">//</span> <span class="err">addLessLoader:修改antd底层样式的方法</span>
<span class="err">addLessLoader(</span><span class="p">{</span>
    <span class="err">//</span> <span class="err">坑：如果你使用的less-loader是5.0.0版本的，就不要加lessOptions，直接写里面两个属性</span>
    <span class="err">lessOptions:{</span>
      <span class="err">javascriptEnabled:</span> <span class="err">true,</span>
      <span class="err">modifyVars:</span> <span class="err">{</span> <span class="err">&#39;@primary-color&#39;:</span> <span class="err">&#39;green&#39;</span> <span class="p">}</span><span class="err">,</span>
    <span class="err">}</span>
  <span class="err">}),</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<p>报错1：addlessloader is not defined，可能是因为你使用的less-loader是5.0.0版本，要去掉lessOptions，直接配置里面的选项</p>
<p>报错2：this.getOptions is not a function，less-loader版本过高，降低版本，建议不要降到5.0.0版本，因为5.0.0版本不能加lessOption</p>
<ul>
<li>npm uninstall less-loader</li>
<li>npm install <a href="mailto:less-loader@6.0.0">less-loader@6.0.0</a></li>
</ul>
<p><strong>坑：如果你使用的less-loader是5.0.0版本的，就不要加lessOptions，直接配置里面两个属性</strong></p>
<h2 id="17-redux">17. redux</h2>
<h3 id="171-redux简介">17.1 redux简介</h3>
<ol>
<li>
<p>英文文档: <a href="https://redux.js.org/">https://redux.js.org/</a></p>
</li>
<li>
<p>中文文档: <a href="http://www.redux.org.cn/">http://www.redux.org.cn/</a></p>
</li>
<li>
<p>Github: <a href="https://github.com/reactjs/redux">https://github.com/reactjs/redux</a></p>
</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105229.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105229.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105229.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105229.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105229.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105229.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105238.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105238.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105238.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105238.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105238.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105238.png" /></p>
<h3 id="172-redux工作流程">17.2 redux工作流程</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105248.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105248.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105248.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105248.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105248.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105248.png" /></p>
<p><strong>React Components</strong>：提出要对redux里面的状态进行某些动作，比如想对redux中的状态数据进行+运算</p>
<p><strong>Action Creators</strong>：当React Components要对redux里面的状态数据操作时，将要做的动作（如：加法运算）封装在一个对象action对象中，对象中包含两个属性：</p>
<ol>
<li>type：动作类型，比如+。</li>
<li>2.data：数据，比如1。</li>
</ol>
<p><strong>dispatch</strong>函数：将参数action对象分发给Store去做，存在于store对象中</p>
<p><strong>Store</strong>：是一个指挥者，负责将收到的动作对象交给Reducers去做，并获取到完成后的结果</p>
<p><strong>Reducers</strong>：</p>
<ul>
<li>
<p>本质是一个函数：</p>
<p>​	接收参数：preState、action对象</p>
<p>​	返回值：newState</p>
</li>
</ul>
<ol>
<li>
<p>初始化状态。由于加工状态的时候，需要知道加工前的状态&mdash;&mdash;&ndash;previousState，以及要进行加工的动作&mdash;&mdash;-action对象，比如：+1这个动作，需要知道之前一次的数是多少，才能进行+1运算。</p>
<p>但是第一次加工的时候，状态并没有初始值，所以Reducers还能初始化状态。当previousState没有值时，那么它的初始值为undefined。</p>
<p>当为初始化动作时，action对象中，preState为undefined，type内置为：<strong>@@init+随机生成的字符串</strong>，（后面加上随机生成的字符串，是为了防止初始化的type，和加工状态的type重名）。data：没有任何值。在reduce.js中指定状态初始值为多少</p>
</li>
</ol>
<ul>
<li>
<p>当为初始化状态时，reduce中的方法是由store自动调用的</p>
</li>
<li>
<p>当为加工状态时，reduce里面的方法是当在组件中使用store.dispatch(action)方法后，再调用的</p>
</li>
</ul>
<ol start="2">
<li>加工状态，能修改redux里面的状态，先获取上一次的状态，再对上一次的状态进行加工动作,得到结果newState，将结果返回给Store，React Components通过getState得到新状态</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105301.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105301.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105301.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105301.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105301.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105301.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105310.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105310.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105310.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105310.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105310.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105310.png" /></p>
<h3 id="173-求和案例">17.3 求和案例</h3>
<h4 id="1-纯react版">1. 纯react版</h4>
<p>状态放在组件自身上</p>
<p>Count.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Count</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="nx">count</span><span class="o">:</span><span class="mi">0</span><span class="p">}</span>

    <span class="nx">increment</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">count</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>
        <span class="c1">// value是一个字符串，所以需要-0转为数字再进行运算
</span><span class="c1"></span>        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">count</span><span class="o">:</span><span class="nx">count</span><span class="o">+</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">)});</span>
    <span class="p">}</span>

    <span class="nx">decrement</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">count</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">count</span><span class="o">:</span><span class="nx">count</span><span class="o">-</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">)});</span>
    <span class="p">}</span>

    <span class="nx">incrementIfOdd</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">count</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">count</span><span class="o">%</span><span class="mi">2</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">){</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">count</span><span class="o">:</span><span class="nx">count</span><span class="o">+</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">)});</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">incrementAsync</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">count</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>
        <span class="c1">// 每次点击按钮后，过2秒再执行这个函数
</span><span class="c1"></span>        <span class="nx">setTimeout</span><span class="p">(()=&gt;{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">count</span><span class="o">:</span><span class="nx">count</span><span class="o">+</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">)});</span>
        <span class="p">},</span><span class="mi">2000</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">count</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">当前求和为</span><span class="err">：</span><span class="p">{</span><span class="nx">count</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                <span class="p">{</span><span class="cm">/* 获取选中的结点 */</span><span class="p">}</span>
                <span class="o">&lt;</span><span class="nx">select</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">c</span><span class="p">=&gt;{</span><span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="o">=</span><span class="nx">c</span><span class="p">}}</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">option</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;1&#34;</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
                    <span class="o">&lt;</span><span class="nx">option</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;2&#34;</span><span class="o">&gt;</span><span class="mi">2</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
                    <span class="o">&lt;</span><span class="nx">option</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;3&#34;</span><span class="o">&gt;</span><span class="mi">3</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
                <span class="o">&lt;</span><span class="err">/select&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">increment</span><span class="p">}</span><span class="o">&gt;+&lt;</span><span class="err">/button&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">decrement</span><span class="p">}</span><span class="o">&gt;-&lt;</span><span class="err">/button&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">incrementIfOdd</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">当前求和为奇数时再加</span><span class="o">&lt;</span><span class="err">/button&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">incrementAsync</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">异步加</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="2-精简版的redux">2. 精简版的redux</h4>
<p>即不用Action Creators创建action对象</p>
<p>做一个计算器</p>
<p>（1）去除Count组件自身的状态（如果只有Count组件自己用的或者被很少组件需要的状态，就直接放在组件内部）</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105718.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105718.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105718.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105718.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105718.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105718.png" /></p>
<ol>
<li>
<p>安装redux：npm i redux</p>
</li>
<li>
<p>创建一个redux文件夹，存放唯一的store.js文件和reducer.js，当一个组件需要用到redux中的状态时，就会为这个组件单独建一个reducer，所以最好命名为：一看就知道是哪个组件的名字。比如Count组件的reducer，可以命名为count_reducer</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105328.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105328.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105328.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105328.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105328.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105328.png" /></p>
</li>
<li>
<p>store.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="cm">/**
</span><span class="cm"> * 该文件专门用于暴露一个store对象，整个应用只有一个store对象
</span><span class="cm"> */</span>
   
<span class="c1">// 引入创建store对象的方法
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">createStore</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;redux&#34;</span><span class="p">;</span>
<span class="c1">// 引入为Count组件服务的reducer对象
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">countReducer</span> <span class="nx">from</span> <span class="s1">&#39;./count_reducer&#39;</span>
   
<span class="c1">// 创建store的同时，指定为store做事的reducer
</span><span class="c1">// 并默认暴露
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="nx">createStore</span><span class="p">(</span><span class="nx">countReducer</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>count_reducer.js</p>
<p>注意：</p>
<ul>
<li>
<p>redux中的state初始化是由store自动调用的</p>
</li>
<li>
<p>redux只负责管理state，加工和初始化state，不负责更新页面渲染，不能像setState一样，一改变state就自动重新渲染页面。</p>
<p>解决：用store.ubscribe去监听reducer中的状态，一旦有状态改变，那么就自己去调用render重新渲染组件。自己调用render的方法有：1.this.setState({})，改变state时，不改变任何东西，传递一个空对象，那么react也会重新调用render  2.用forceUpdate不修改状态也能强制更新组件：this.forceUpdate();</p>
</li>
<li>
<p>结合17.2来看</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="cm">/**
</span><span class="cm"> * 该组件是创建一个为Count组件服务的reducer
</span><span class="cm"> */</span>
   
<span class="c1">// 初始化方法一：
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">initState</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="c1">// 
</span><span class="c1">// 如果type为初始化，那么就初始化state为initState，下一次由组件触发函数发生时，获取到的参数preState就为初始化state值，所以可以直接给preState赋initState值
</span><span class="c1">// 参数中赋值表示如果preState为undefined，那么就会被赋值为initState，如果preState有值，那么就不会执行preState=initState
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nx">countReducer</span><span class="p">(</span><span class="nx">preState</span><span class="o">=</span><span class="nx">initState</span><span class="p">,</span><span class="nx">action</span><span class="p">){</span>
    <span class="kr">const</span> <span class="p">{</span><span class="nx">type</span><span class="p">,</span><span class="nx">data</span><span class="p">}</span><span class="o">=</span><span class="nx">action</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">preState</span><span class="p">);</span>
    <span class="c1">// 使用switch直接按条件返回结果，由于当初始化时给preState设置了初始化state值，所以初始化时直接返回preState
</span><span class="c1"></span>    <span class="k">switch</span> <span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="s1">&#39;increment&#39;</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">preState</span><span class="o">+</span><span class="nx">data</span><span class="p">;</span>
        <span class="k">case</span> <span class="s1">&#39;decrement&#39;</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">preState</span><span class="o">-</span><span class="nx">data</span><span class="p">;</span>
        <span class="k">default</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">preState</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
   
<span class="c1">// // 初始化方法二：
</span><span class="c1">// // 如果type为初始化，那么就初始化state为initState，下一次由组件触发函数发生时，获取到的参数preState就为初始化state值，所以可以直接给preState赋initState值
</span><span class="c1">// // 参数中赋值表示如果preState为undefined，那么就会被赋值为initState，如果preState有值，那么就不会执行preState=initState
</span><span class="c1">// export default function countReducer(preState,action){
</span><span class="c1">//     if(preState===undefined)
</span><span class="c1">//     // 设置你想初始化的值
</span><span class="c1">//     preState=0;
</span><span class="c1">//     const {type,data}=action;
</span><span class="c1">//     // 使用switch直接按条件返回结果，由于当初始化时给preState设置了初始化state值，所以初始化时直接返回preState
</span><span class="c1">//     switch (type) {
</span><span class="c1">//         case &#39;increment&#39;:
</span><span class="c1">//             return preState+data;
</span><span class="c1">//         case &#39;decrement&#39;:
</span><span class="c1">//             return preState+data;
</span><span class="c1">//         default:
</span><span class="c1">//             return preState;
</span><span class="c1">//     }
</span><span class="c1">// }
</span><span class="c1"></span>   
<span class="c1">// // 初始化方法三：
</span><span class="c1">// // 
</span><span class="c1">// // 如果type为初始化，那么就初始化state为initState，下一次由组件触发函数发生时，获取到的参数preState就为初始化state值，所以可以直接给preState赋initState值
</span><span class="c1">// // 参数中赋值表示如果preState为undefined，那么就会被赋值为initState，如果preState有值，那么就不会执行preState=initState
</span><span class="c1">// export default function countReducer(preState,action){
</span><span class="c1">//     const {type,data}=action;
</span><span class="c1">//     // 使用switch直接按条件返回结果，由于当初始化时给preState设置了初始化state值，所以初始化时直接返回preState
</span><span class="c1">//     switch (type) {
</span><span class="c1">//         case &#39;increment&#39;:
</span><span class="c1">//             return preState+data;
</span><span class="c1">//         case &#39;decrement&#39;:
</span><span class="c1">//             return preState+data;
</span><span class="c1">//         default:
</span><span class="c1">//             return 0;
</span><span class="c1">//     }
</span><span class="c1">//     // 不是increment也不是decrement，那就是初始化，所以直接返回要初始化的值，这里写的是0
</span><span class="c1">// }
</span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Count.js</p>
<p>store三大方法：</p>
<ul>
<li>getState()，获取状态</li>
<li>dispatch({type:xxx,data:xxx})，参数为action对象</li>
<li>subScribe(()=&gt;{})，一旦reducer中的状态有变化，就会触发里面的回调函数</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="nx">store</span> <span class="nx">from</span> <span class="s1">&#39;../../redux/store&#39;</span><span class="p">;</span>
   
<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Count</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
   
    <span class="nx">componentDidMount</span><span class="o">=</span><span class="p">()=&gt;{</span>
        <span class="c1">// 在组件挂载完毕时，监听reducer中的状态变化，一旦有状态改变就会调用里面的回调
</span><span class="c1"></span>        <span class="nx">store</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(()=&gt;{</span>
            <span class="c1">// 在不修改该组件自身state的情况下，手动更新组件
</span><span class="c1"></span>            <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({});</span>
            <span class="c1">// this.forceUpdate();
</span><span class="c1"></span>        <span class="p">})</span>
    <span class="p">}</span>
   
    <span class="nx">increment</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="c1">// value是一个字符串，所以需要-0转为数字再进行运算
</span><span class="c1"></span>        <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">({</span><span class="nx">type</span><span class="o">:</span><span class="s2">&#34;increment&#34;</span><span class="p">,</span><span class="nx">data</span><span class="o">:</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">)});</span>
    <span class="p">}</span>
   
    <span class="nx">decrement</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">({</span><span class="nx">type</span><span class="o">:</span><span class="s2">&#34;decrement&#34;</span><span class="p">,</span><span class="nx">data</span><span class="o">:</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">)});</span>
    <span class="p">}</span>
   
    <span class="nx">incrementIfOdd</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">store</span><span class="p">.</span><span class="nx">getState</span><span class="p">()</span><span class="o">%</span><span class="mi">2</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">){</span>
            <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">({</span><span class="nx">type</span><span class="o">:</span><span class="s2">&#34;increment&#34;</span><span class="p">,</span><span class="nx">data</span><span class="o">:</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">)});</span>
        <span class="p">}</span>
    <span class="p">}</span>
   
    <span class="nx">incrementAsync</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="c1">// 每次点击按钮后，过2秒再执行这个函数
</span><span class="c1"></span>        <span class="nx">setTimeout</span><span class="p">(()=&gt;{</span>
            <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">({</span><span class="nx">type</span><span class="o">:</span><span class="s2">&#34;increment&#34;</span><span class="p">,</span><span class="nx">data</span><span class="o">:</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">)});</span>
        <span class="p">},</span><span class="mi">2000</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">当前求和为</span><span class="err">：</span><span class="p">{</span><span class="nx">store</span><span class="p">.</span><span class="nx">getState</span><span class="p">()}</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                <span class="p">{</span><span class="cm">/* 获取选中的结点 */</span><span class="p">}</span>
                <span class="o">&lt;</span><span class="nx">select</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">c</span><span class="p">=&gt;{</span><span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="o">=</span><span class="nx">c</span><span class="p">}}</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">option</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;1&#34;</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
                    <span class="o">&lt;</span><span class="nx">option</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;2&#34;</span><span class="o">&gt;</span><span class="mi">2</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
                    <span class="o">&lt;</span><span class="nx">option</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;3&#34;</span><span class="o">&gt;</span><span class="mi">3</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
                <span class="o">&lt;</span><span class="err">/select&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">increment</span><span class="p">}</span><span class="o">&gt;+&lt;</span><span class="err">/button&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">decrement</span><span class="p">}</span><span class="o">&gt;-&lt;</span><span class="err">/button&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">incrementIfOdd</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">当前求和为奇数时再加</span><span class="o">&lt;</span><span class="err">/button&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">incrementAsync</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">异步加</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h4 id="3-完整版的redux">3. 完整版的redux</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105800.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105800.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105800.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105800.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105800.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105800.png" /></p>
<p>store.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="cm">/**
</span><span class="cm"> * 该模块专门用于暴露一个store对象，整个应用只有一个store对象
</span><span class="cm"> */</span>

<span class="c1">// 引入创建store对象的方法
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">createStore</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;redux&#34;</span><span class="p">;</span>
<span class="c1">// 引入为Count组件服务的reducer对象
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">countReducer</span> <span class="nx">from</span> <span class="s1">&#39;./count_reducer&#39;</span>

<span class="c1">// 创建store的同时，指定为store做事的reducer
</span><span class="c1">// 并默认暴露
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="nx">createStore</span><span class="p">(</span><span class="nx">countReducer</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>count_reducer.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="cm">/**
</span><span class="cm"> * 该模块是创建一个为Count组件服务的reducer
</span><span class="cm"> */</span>

 <span class="kr">import</span> <span class="p">{</span><span class="nx">INCREMENT</span><span class="p">,</span> <span class="nx">DECREMENT</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;./constant&#39;</span>
<span class="c1">// 初始化方法一：
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">initState</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="c1">// 
</span><span class="c1">// 如果type为初始化，那么就初始化state为initState，下一次由组件触发函数发生时，获取到的参数preState就为初始化state值，所以可以直接给preState赋initState值
</span><span class="c1">// 参数中赋值表示如果preState为undefined，那么就会被赋值为initState，如果preState有值，那么就不会执行preState=initState
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nx">countReducer</span><span class="p">(</span><span class="nx">preState</span><span class="o">=</span><span class="nx">initState</span><span class="p">,</span><span class="nx">action</span><span class="p">){</span>
    <span class="kr">const</span> <span class="p">{</span><span class="nx">type</span><span class="p">,</span><span class="nx">data</span><span class="p">}</span><span class="o">=</span><span class="nx">action</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">preState</span><span class="p">);</span>
    <span class="c1">// 使用switch直接按条件返回结果，由于当初始化时给preState设置了初始化state值，所以初始化时直接返回preState
</span><span class="c1"></span>    <span class="k">switch</span> <span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="nx">INCREMENT</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">preState</span><span class="o">+</span><span class="nx">data</span><span class="p">;</span>
        <span class="k">case</span> <span class="nx">DECREMENT</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">preState</span><span class="o">-</span><span class="nx">data</span><span class="p">;</span>
        <span class="k">default</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">preState</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// // 初始化方法二：
</span><span class="c1">// // 如果type为初始化，那么就初始化state为initState，下一次由组件触发函数发生时，获取到的参数preState就为初始化state值，所以可以直接给preState赋initState值
</span><span class="c1">// // 参数中赋值表示如果preState为undefined，那么就会被赋值为initState，如果preState有值，那么就不会执行preState=initState
</span><span class="c1">// export default function countReducer(preState,action){
</span><span class="c1">//     if(preState===undefined)
</span><span class="c1">//     // 设置你想初始化的值
</span><span class="c1">//     preState=0;
</span><span class="c1">//     const {type,data}=action;
</span><span class="c1">//     // 使用switch直接按条件返回结果，由于当初始化时给preState设置了初始化state值，所以初始化时直接返回preState
</span><span class="c1">//     switch (type) {
</span><span class="c1">//         case &#39;increment&#39;:
</span><span class="c1">//             return preState+data;
</span><span class="c1">//         case &#39;decrement&#39;:
</span><span class="c1">//             return preState+data;
</span><span class="c1">//         default:
</span><span class="c1">//             return preState;
</span><span class="c1">//     }
</span><span class="c1">// }
</span><span class="c1"></span>
<span class="c1">// // 初始化方法三：
</span><span class="c1">// // 
</span><span class="c1">// // 如果type为初始化，那么就初始化state为initState，下一次由组件触发函数发生时，获取到的参数preState就为初始化state值，所以可以直接给preState赋initState值
</span><span class="c1">// // 参数中赋值表示如果preState为undefined，那么就会被赋值为initState，如果preState有值，那么就不会执行preState=initState
</span><span class="c1">// export default function countReducer(preState,action){
</span><span class="c1">//     const {type,data}=action;
</span><span class="c1">//     // 使用switch直接按条件返回结果，由于当初始化时给preState设置了初始化state值，所以初始化时直接返回preState
</span><span class="c1">//     switch (type) {
</span><span class="c1">//         case &#39;increment&#39;:
</span><span class="c1">//             return preState+data;
</span><span class="c1">//         case &#39;decrement&#39;:
</span><span class="c1">//             return preState+data;
</span><span class="c1">//         default:
</span><span class="c1">//             return 0;
</span><span class="c1">//     }
</span><span class="c1">//     // 不是increment也不是decrement，那就是初始化，所以直接返回要初始化的值，这里写的是0
</span><span class="c1">// }
</span></code></pre></td></tr></table>
</div>
</div><p>count_action.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="cm">/**
</span><span class="cm"> * 
</span><span class="cm"> * 该模块专门为Count组件创建action对象
</span><span class="cm"> * 
</span><span class="cm"> */</span>

 <span class="kr">import</span> <span class="p">{</span><span class="nx">INCREMENT</span><span class="p">,</span> <span class="nx">DECREMENT</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;./constant&#39;</span>

<span class="c1">// 箭头函数体中，如果只有一行代码，并且是返回之，那么可以省略{}和return，但是如果返回的是一个对象那么()=&gt;{xxx:xxx}会报错，因为会把这个大括号解析为是一个代码块，而不是对象外面的大括号。
</span><span class="c1">// 方法一：加上{}和return
</span><span class="c1">// const incrementAction = (data) =&gt; {return {type:&#39;increment&#39;,data:data}};
</span><span class="c1">// 方法二：对象外面加一个小括号
</span><span class="c1"></span>
<span class="c1">// 分别暴露
</span><span class="c1"></span><span class="kr">export</span> <span class="kr">const</span> <span class="nx">incrementAction</span> <span class="o">=</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">({</span><span class="nx">type</span><span class="o">:</span><span class="nx">INCREMENT</span><span class="p">,</span><span class="nx">data</span><span class="o">:</span><span class="nx">data</span><span class="p">});</span>
<span class="kr">export</span> <span class="kr">const</span> <span class="nx">decrementAction</span> <span class="o">=</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">({</span><span class="nx">type</span><span class="o">:</span><span class="nx">DECREMENT</span><span class="p">,</span><span class="nx">data</span><span class="o">:</span><span class="nx">data</span><span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><p>constant.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="cm">/**
</span><span class="cm"> * 该模块是用于定义action对象中type类型的常量值，目的只有一个：便于管理的同时防止程序员单词写错
</span><span class="cm"> */</span>

<span class="kr">export</span> <span class="kr">const</span> <span class="nx">INCREMENT</span> <span class="o">=</span> <span class="s1">&#39;increment&#39;</span><span class="p">;</span>
<span class="kr">export</span> <span class="kr">const</span> <span class="nx">DECREMENT</span> <span class="o">=</span> <span class="s1">&#39;decrement&#39;</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>Count.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="nx">store</span> <span class="nx">from</span> <span class="s1">&#39;../../redux/store&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">incrementAction</span><span class="p">,</span> <span class="nx">decrementAction</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;../../redux/count_action&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Count</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>

    <span class="nx">componentDidMount</span><span class="o">=</span><span class="p">()=&gt;{</span>
        <span class="c1">// 在组件挂载完毕时，监听reducer中的状态变化，一旦有状态改变就会调用里面的回调
</span><span class="c1"></span>        <span class="nx">store</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(()=&gt;{</span>
            <span class="c1">// 在不修改该组件自身state的情况下，手动更新组件
</span><span class="c1"></span>            <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({});</span>
            <span class="c1">// this.forceUpdate();
</span><span class="c1"></span>        <span class="p">})</span>
    <span class="p">}</span>

    <span class="nx">increment</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="c1">// value是一个字符串，所以需要-0转为数字再进行运算
</span><span class="c1"></span>        <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">incrementAction</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="nx">decrement</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">decrementAction</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="nx">incrementIfOdd</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">store</span><span class="p">.</span><span class="nx">getState</span><span class="p">()</span><span class="o">%</span><span class="mi">2</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">){</span>
            <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">incrementAction</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">incrementAsync</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="c1">// 每次点击按钮后，过2秒再执行这个函数
</span><span class="c1"></span>        <span class="nx">setTimeout</span><span class="p">(()=&gt;{</span>
            <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">incrementAction</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">));</span>
        <span class="p">},</span><span class="mi">2000</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">当前求和为</span><span class="err">：</span><span class="p">{</span><span class="nx">store</span><span class="p">.</span><span class="nx">getState</span><span class="p">()}</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                <span class="p">{</span><span class="cm">/* 获取选中的结点 */</span><span class="p">}</span>
                <span class="o">&lt;</span><span class="nx">select</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">c</span><span class="p">=&gt;{</span><span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="o">=</span><span class="nx">c</span><span class="p">}}</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">option</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;1&#34;</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
                    <span class="o">&lt;</span><span class="nx">option</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;2&#34;</span><span class="o">&gt;</span><span class="mi">2</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
                    <span class="o">&lt;</span><span class="nx">option</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;3&#34;</span><span class="o">&gt;</span><span class="mi">3</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
                <span class="o">&lt;</span><span class="err">/select&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">increment</span><span class="p">}</span><span class="o">&gt;+&lt;</span><span class="err">/button&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">decrement</span><span class="p">}</span><span class="o">&gt;-&lt;</span><span class="err">/button&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">incrementIfOdd</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">当前求和为奇数时再加</span><span class="o">&lt;</span><span class="err">/button&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">incrementAsync</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">异步加</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="4异步action">4.异步action</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105827.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105827.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105827.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105827.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105827.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105827.png" /></p>
<ul>
<li>如果action为一个对象，则为同步action</li>
<li>如果action为一个函数，则为异步action</li>
<li>如果想要修改reducer中的状态，但是具体数据要靠异步任务返回时，比如：我在餐厅点菜，我想30分钟后再吃饭，1.我可以自己看菜单看30分钟，然后再叫服务员上菜，2.还可以告诉服务员，我30分钟后吃饭，你给我控制时间。</li>
<li>对应到redux中就是：比如：我想要5秒后进行计算器加法运算，1. 我可以在组件内自己设一个延时器，5秒后再dispatch一个action对象，由store交给reducer去改变状态。2. 我还可以dispatch的时候，将一个函数形式的action作为参数，store接收到函数式的action时，会自动调用这个函数（需要借助redux-thunk和applyMiddleware才能自动调用，不然不识别函数式的action），可以在这个函数式action中设置一个5秒的延时器，延时器中分发一个同步的action对象给store，再stroe交给reducer去加工状态</li>
<li>所以异步action不是必须要写的，完全可以等待异步任务结束了再去分发同步action</li>
</ul>
<p>store.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="cm">/**
</span><span class="cm"> * 该模块专门用于暴露一个store对象，整个应用只有一个store对象
</span><span class="cm"> */</span>

<span class="c1">// 1.引入创建store对象的方法
</span><span class="c1">// 2.引入第三方组件，允许store调用异步action函数
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">createStore</span><span class="p">,</span> <span class="nx">applyMiddleware</span><span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;redux&#34;</span><span class="p">;</span>
<span class="c1">// 引入redux-thunk允许store调用异步action函数
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">thunk</span> <span class="nx">from</span> <span class="s1">&#39;redux-thunk&#39;</span>
<span class="c1">// 引入为Count组件服务的reducer对象
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">countReducer</span> <span class="nx">from</span> <span class="s1">&#39;./count_reducer&#39;</span>

<span class="c1">// 创建store的同时，指定为store做事的reducer
</span><span class="c1">// 并默认暴露
</span><span class="c1">// 需要将applyMiddleware函数作为创建store的第二个参数传递，一定要是第二个参数，并且将thunk作为参数传给applyMiddleware函数
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="nx">createStore</span><span class="p">(</span><span class="nx">countReducer</span><span class="p">,</span><span class="nx">applyMiddleware</span><span class="p">(</span><span class="nx">thunk</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><p>count_reducer.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="cm">/**
</span><span class="cm"> * 该模块是创建一个为Count组件服务的reducer
</span><span class="cm"> */</span>

 <span class="kr">import</span> <span class="p">{</span><span class="nx">INCREMENT</span><span class="p">,</span> <span class="nx">DECREMENT</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;./constant&#39;</span>
<span class="c1">// 初始化方法一：
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">initState</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="c1">// 
</span><span class="c1">// 如果type为初始化，那么就初始化state为initState，下一次由组件触发函数发生时，获取到的参数preState就为初始化state值，所以可以直接给preState赋initState值
</span><span class="c1">// 参数中赋值表示如果preState为undefined，那么就会被赋值为initState，如果preState有值，那么就不会执行preState=initState
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nx">countReducer</span><span class="p">(</span><span class="nx">preState</span><span class="o">=</span><span class="nx">initState</span><span class="p">,</span><span class="nx">action</span><span class="p">){</span>
    <span class="kr">const</span> <span class="p">{</span><span class="nx">type</span><span class="p">,</span><span class="nx">data</span><span class="p">}</span><span class="o">=</span><span class="nx">action</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">preState</span><span class="p">);</span>
    <span class="c1">// 使用switch直接按条件返回结果，由于当初始化时给preState设置了初始化state值，所以初始化时直接返回preState
</span><span class="c1"></span>    <span class="k">switch</span> <span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="nx">INCREMENT</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">preState</span><span class="o">+</span><span class="nx">data</span><span class="p">;</span>
        <span class="k">case</span> <span class="nx">DECREMENT</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">preState</span><span class="o">-</span><span class="nx">data</span><span class="p">;</span>
        <span class="k">default</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">preState</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// // 初始化方法二：
</span><span class="c1">// // 如果type为初始化，那么就初始化state为initState，下一次由组件触发函数发生时，获取到的参数preState就为初始化state值，所以可以直接给preState赋initState值
</span><span class="c1">// // 参数中赋值表示如果preState为undefined，那么就会被赋值为initState，如果preState有值，那么就不会执行preState=initState
</span><span class="c1">// export default function countReducer(preState,action){
</span><span class="c1">//     if(preState===undefined)
</span><span class="c1">//     // 设置你想初始化的值
</span><span class="c1">//     preState=0;
</span><span class="c1">//     const {type,data}=action;
</span><span class="c1">//     // 使用switch直接按条件返回结果，由于当初始化时给preState设置了初始化state值，所以初始化时直接返回preState
</span><span class="c1">//     switch (type) {
</span><span class="c1">//         case &#39;increment&#39;:
</span><span class="c1">//             return preState+data;
</span><span class="c1">//         case &#39;decrement&#39;:
</span><span class="c1">//             return preState+data;
</span><span class="c1">//         default:
</span><span class="c1">//             return preState;
</span><span class="c1">//     }
</span><span class="c1">// }
</span><span class="c1"></span>
<span class="c1">// // 初始化方法三：
</span><span class="c1">// // 
</span><span class="c1">// // 如果type为初始化，那么就初始化state为initState，下一次由组件触发函数发生时，获取到的参数preState就为初始化state值，所以可以直接给preState赋initState值
</span><span class="c1">// // 参数中赋值表示如果preState为undefined，那么就会被赋值为initState，如果preState有值，那么就不会执行preState=initState
</span><span class="c1">// export default function countReducer(preState,action){
</span><span class="c1">//     const {type,data}=action;
</span><span class="c1">//     // 使用switch直接按条件返回结果，由于当初始化时给preState设置了初始化state值，所以初始化时直接返回preState
</span><span class="c1">//     switch (type) {
</span><span class="c1">//         case &#39;increment&#39;:
</span><span class="c1">//             return preState+data;
</span><span class="c1">//         case &#39;decrement&#39;:
</span><span class="c1">//             return preState+data;
</span><span class="c1">//         default:
</span><span class="c1">//             return 0;
</span><span class="c1">//     }
</span><span class="c1">//     // 不是increment也不是decrement，那就是初始化，所以直接返回要初始化的值，这里写的是0
</span><span class="c1">// }
</span></code></pre></td></tr></table>
</div>
</div><p>count_action.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="cm">/**
</span><span class="cm"> * 
</span><span class="cm"> * 该模块专门为Count组件创建action对象
</span><span class="cm"> * 
</span><span class="cm"> */</span>

 <span class="kr">import</span> <span class="p">{</span><span class="nx">INCREMENT</span><span class="p">,</span> <span class="nx">DECREMENT</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;./constant&#39;</span>

<span class="c1">// 箭头函数体中，如果只有一行代码，并且是返回之，那么可以省略{}和return，但是如果返回的是一个对象那么()=&gt;{xxx:xxx}会报错，因为会把这个大括号解析为是一个代码块，而不是对象外面的大括号。
</span><span class="c1">// 方法一：加上{}和return
</span><span class="c1">// const incrementAction = (data) =&gt; {return {type:&#39;increment&#39;,data:data}};
</span><span class="c1">// 方法二：对象外面加一个小括号
</span><span class="c1"></span>
<span class="c1">// 分别暴露
</span><span class="c1">// 该函数返回一个同步action：对象
</span><span class="c1"></span><span class="kr">export</span> <span class="kr">const</span> <span class="nx">incrementAction</span> <span class="o">=</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">({</span><span class="nx">type</span><span class="o">:</span><span class="nx">INCREMENT</span><span class="p">,</span><span class="nx">data</span><span class="o">:</span><span class="nx">data</span><span class="p">});</span>
<span class="kr">export</span> <span class="kr">const</span> <span class="nx">decrementAction</span> <span class="o">=</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">({</span><span class="nx">type</span><span class="o">:</span><span class="nx">DECREMENT</span><span class="p">,</span><span class="nx">data</span><span class="o">:</span><span class="nx">data</span><span class="p">});</span>

<span class="c1">// 该函数返回一个异步action：函数
</span><span class="c1"></span><span class="kr">export</span> <span class="kr">const</span> <span class="nx">incrementAsyncAction</span> <span class="o">=</span> <span class="p">(</span><span class="nx">data</span><span class="p">,</span><span class="nx">time</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="c1">// 由于只要配置好了redux-thunk，store就会帮你调用这个函数，并且一般在异布action函数中都会分发同步action给store，所以异步action函数可以接受到一个dispatch参数，所以异步action函数中的分发同步action对象时不需要使用store.来调用dispatch函数
</span><span class="c1"></span>    <span class="k">return</span> <span class="p">(</span><span class="nx">dispatch</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
            <span class="nx">dispatch</span><span class="p">(</span><span class="nx">incrementAction</span><span class="p">(</span><span class="nx">data</span><span class="p">));</span>
        <span class="p">},</span><span class="nx">time</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>constant.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="cm">/**
</span><span class="cm"> * 该模块是用于定义action对象中type类型的常量值，目的只有一个：便于管理的同时防止程序员单词写错
</span><span class="cm"> */</span>

<span class="kr">export</span> <span class="kr">const</span> <span class="nx">INCREMENT</span> <span class="o">=</span> <span class="s1">&#39;increment&#39;</span><span class="p">;</span>
<span class="kr">export</span> <span class="kr">const</span> <span class="nx">DECREMENT</span> <span class="o">=</span> <span class="s1">&#39;decrement&#39;</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>Count.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="nx">store</span> <span class="nx">from</span> <span class="s1">&#39;../../redux/store&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">incrementAction</span><span class="p">,</span> <span class="nx">decrementAction</span><span class="p">,</span> <span class="nx">incrementAsyncAction</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;../../redux/count_action&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Count</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>

    <span class="nx">componentDidMount</span><span class="o">=</span><span class="p">()=&gt;{</span>
        <span class="c1">// 在组件挂载完毕时，监听reducer中的状态变化，一旦有状态改变就会调用里面的回调
</span><span class="c1"></span>        <span class="nx">store</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(()=&gt;{</span>
            <span class="c1">// 在不修改该组件自身state的情况下，手动更新组件
</span><span class="c1"></span>            <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({});</span>
            <span class="c1">// this.forceUpdate();
</span><span class="c1"></span>        <span class="p">})</span>
    <span class="p">}</span>

    <span class="nx">increment</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="c1">// value是一个字符串，所以需要-0转为数字再进行运算
</span><span class="c1"></span>        <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">incrementAction</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="nx">decrement</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">decrementAction</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="nx">incrementIfOdd</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">store</span><span class="p">.</span><span class="nx">getState</span><span class="p">()</span><span class="o">%</span><span class="mi">2</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">){</span>
            <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">incrementAction</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// incrementAsync = () =&gt;{
</span><span class="c1"></span>    <span class="c1">//     const {value} = this.selectNumNode;
</span><span class="c1"></span>    <span class="c1">//     // 每次点击按钮后，过2秒再执行这个函数（组件自身设置延时器实现）
</span><span class="c1"></span>    <span class="c1">//     setTimeout(()=&gt;{
</span><span class="c1"></span>    <span class="c1">//         store.dispatch(incrementAction(value-0));
</span><span class="c1"></span>    <span class="c1">//     },2000);
</span><span class="c1"></span>    <span class="c1">// }
</span><span class="c1"></span>
    <span class="nx">incrementAsync</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="c1">// 每次点击按钮后，过2秒再执行这个函数（异步action函数内设置延时器实现）
</span><span class="c1"></span>        <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">incrementAsyncAction</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">当前求和为</span><span class="err">：</span><span class="p">{</span><span class="nx">store</span><span class="p">.</span><span class="nx">getState</span><span class="p">()}</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                <span class="p">{</span><span class="cm">/* 获取选中的结点 */</span><span class="p">}</span>
                <span class="o">&lt;</span><span class="nx">select</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">c</span><span class="p">=&gt;{</span><span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="o">=</span><span class="nx">c</span><span class="p">}}</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">option</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;1&#34;</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
                    <span class="o">&lt;</span><span class="nx">option</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;2&#34;</span><span class="o">&gt;</span><span class="mi">2</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
                    <span class="o">&lt;</span><span class="nx">option</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;3&#34;</span><span class="o">&gt;</span><span class="mi">3</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
                <span class="o">&lt;</span><span class="err">/select&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">increment</span><span class="p">}</span><span class="o">&gt;+&lt;</span><span class="err">/button&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">decrement</span><span class="p">}</span><span class="o">&gt;-&lt;</span><span class="err">/button&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">incrementIfOdd</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">当前求和为奇数时再加</span><span class="o">&lt;</span><span class="err">/button&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">incrementAsync</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">异步加</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="174-react-redux理解">17.4 react-redux理解</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105857.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105857.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105857.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105857.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105857.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105857.png" /></p>
<p>UI组件不与redux打交道，只负责界面，不能使用任何redux的api</p>
<p>容器组件只做两件事：1.传递redux中的状态给UI组件 2.传递操作redux状态的方法给UI组件，让UI组件不直接与redux交互</p>
<h4 id="1-连接容器组件与ui组件">1. 连接容器组件与UI组件</h4>
<ul>
<li>
<p>新建一个容器组件，一般放在containers文件夹中</p>
</li>
<li>
<p>删掉原UI组件中的有关与redux交互的东西</p>
</li>
<li>
<p>npm install react-redux</p>
</li>
<li>
<p>连接UI组件和容器组件</p>
</li>
<li>
<p>渲染到页面的是容器组件，由于容器组件中包含UI组件，所以渲染的同时会将UI组件也渲染到页面，所以App.js中应该渲染的是容器组件</p>
</li>
<li>
<p>容器组件自身引入redux是引入的store，但是它自身不能引入store，所以需要在容器组件的父组件中（例子中为App.js）以props形式将store传给容器组件</p>
</li>
<li>
<p>记得暴露容器组件</p>
</li>
</ul>
<h4 id="2react-redux的基本使用">2.react-redux的基本使用</h4>
<ul>
<li>
<p>使用容器组件与redux进行交互时，redux中的状态改变时，会自动重新渲染页面，不需要监听redux状态改变，手动去重新渲染页面</p>
</li>
<li>
<p>connect第一次调用，即第一个括号中的参数作用是向UI组件传东西，参数名最好固定，参数必须为函数，且第一个参数函数表示传递状态给UI组件，第二个参数函数表示传递操作状态的方法给UI组件，函数的返回值都要为一个对象，对象中的属性名作为UI组件的props中的key，对象中的属性值作为UI组件的props中的value</p>
</li>
<li>
<p>由于第一个函数参数固定是传递状态的，所以默认可以接收到state状态，不需要通过store.getState()方法去获取状态</p>
</li>
<li>
<p>由于第二个函数参数固定是传递操作状态的方法的，那么一定会使用store.dispatch(action)方法，所以默认可以接收到dispatch方法，不需要通过store.dispatch去获取</p>
<p>App.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="nx">Count</span> <span class="nx">from</span> <span class="s1">&#39;./containers/Count&#39;</span>
<span class="kr">import</span> <span class="nx">store</span> <span class="nx">from</span> <span class="s1">&#39;./redux/store&#39;</span>
  
<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="p">{</span><span class="cm">/* 由于容器组件自身不能引入store，所以将store以props形式传给容器组件 */</span><span class="p">}</span>
                <span class="o">&lt;</span><span class="nx">Count</span> <span class="nx">store</span><span class="o">=</span><span class="p">{</span><span class="nx">store</span><span class="p">}</span><span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>容器组件Count.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 引入UI组件
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">CountUI</span> <span class="nx">from</span> <span class="s1">&#39;../components/Count&#39;</span>
  
<span class="c1">// 引入连接UI组件和容器组件、以及连接容器组件与redux的方法:connect
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">connect</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-redux&#39;</span>
  
<span class="kr">import</span> <span class="p">{</span><span class="nx">incrementAction</span><span class="p">,</span> <span class="nx">decrementAction</span><span class="p">,</span> <span class="nx">incrementAsyncAction</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;../redux/count_action&#39;</span>
  
<span class="c1">// mapStateToProps函数返回的对象中的key就作为传递给UI组件props的key，value就作为传递给UI组件的value————状态
</span><span class="c1">// 由于第一个函数参数固定是传递状态的，所以默认可以接收到state状态，不需要通过store.getState()方法去获取状态
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">mapStateToProps</span><span class="o">=</span><span class="p">(</span><span class="nx">state</span><span class="p">)=&gt;{</span>
    <span class="k">return</span> <span class="p">{</span><span class="nx">count</span><span class="o">:</span><span class="nx">state</span><span class="p">};</span>
<span class="p">}</span>
  
<span class="c1">// mapDispatchToProps函数返回的对象中的key就作为传递给UI组件props的key，value就作为传递给UI组件的value————操作状态的方法
</span><span class="c1">// 由于第二个函数参数固定是传递操作状态的方法的，那么一定会使用store.dispatch(action)方法，所以默认可以接收到dispatch方法，不需要通过store.dispatch去获取
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">mapDispatchToProps</span><span class="o">=</span><span class="p">(</span><span class="nx">dispatch</span><span class="p">)=&gt;{</span>
    <span class="k">return</span> <span class="p">{</span><span class="nx">jia</span><span class="o">:</span><span class="nx">data</span> <span class="p">=&gt;</span> <span class="nx">dispatch</span><span class="p">(</span><span class="nx">incrementAction</span><span class="p">(</span><span class="nx">data</span><span class="p">)),</span><span class="nx">jian</span><span class="o">:</span><span class="nx">data</span> <span class="p">=&gt;</span> <span class="nx">dispatch</span><span class="p">(</span><span class="nx">decrementAction</span><span class="p">(</span><span class="nx">data</span><span class="p">)),</span> <span class="nx">asyncAdd</span><span class="o">:</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span><span class="nx">time</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">dispatch</span><span class="p">(</span><span class="nx">incrementAsyncAction</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span><span class="nx">time</span><span class="p">))};</span>
<span class="p">}</span>
  
<span class="c1">// 创建一个容器组件并连接相应的UI组件
</span><span class="c1">// connect第一次调用，即第一个括号中的参数作用是向UI组件传东西，参数名最好固定
</span><span class="c1">// 参数必须为函数，且第一个参数函数表示传递状态给UI组件，第二个参数函数表示传递操作状态的方法给UI组件，函数的返回值都要为一个对象，对象中的属性名作为UI组件的props中的key，对象中的属性值作为UI组件的props中的value
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="nx">connect</span><span class="p">(</span><span class="nx">mapStateToProps</span><span class="p">,</span> <span class="nx">mapDispatchToProps</span><span class="p">)(</span><span class="nx">CountUI</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>UI组件Count.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
  
<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Count</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
  
    <span class="nx">increment</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">jia</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>
  
    <span class="nx">decrement</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">jian</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>
  
    <span class="nx">incrementIfOdd</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">count</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">){</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">jia</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
  
    <span class="nx">incrementAsync</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">asyncAdd</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">,</span><span class="mi">3000</span><span class="p">);</span>
    <span class="p">}</span>
  
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">当前求和为</span><span class="err">：</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">count</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                <span class="p">{</span><span class="cm">/* 获取选中的结点 */</span><span class="p">}</span>
                <span class="o">&lt;</span><span class="nx">select</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">c</span><span class="p">=&gt;{</span><span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="o">=</span><span class="nx">c</span><span class="p">}}</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">option</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;1&#34;</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
                    <span class="o">&lt;</span><span class="nx">option</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;2&#34;</span><span class="o">&gt;</span><span class="mi">2</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
                    <span class="o">&lt;</span><span class="nx">option</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;3&#34;</span><span class="o">&gt;</span><span class="mi">3</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
                <span class="o">&lt;</span><span class="err">/select&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">increment</span><span class="p">}</span><span class="o">&gt;+&lt;</span><span class="err">/button&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">decrement</span><span class="p">}</span><span class="o">&gt;-&lt;</span><span class="err">/button&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">incrementIfOdd</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">当前求和为奇数时再加</span><span class="o">&lt;</span><span class="err">/button&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">incrementAsync</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">异步加</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h4 id="3总结">3.总结</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105922.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105922.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105922.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105922.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105922.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002105922.png" /></p>
<h4 id="4mapdispatchtoprops精简版">4.mapDispatchToProps精简版</h4>
<p>mapDispatchToPropsc参数可以是一个对象，当为对象时，redux会自动调用dispatch，不需要我们手动去调用dispatch</p>
<p>容器组件：Count</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 引入UI组件
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">CountUI</span> <span class="nx">from</span> <span class="s1">&#39;../components/Count&#39;</span>

<span class="c1">// 引入连接UI组件和容器组件、以及连接容器组件与redux的方法:connect
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">connect</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-redux&#39;</span>

<span class="kr">import</span> <span class="p">{</span><span class="nx">incrementAction</span><span class="p">,</span> <span class="nx">decrementAction</span><span class="p">,</span> <span class="nx">incrementAsyncAction</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;../redux/count_action&#39;</span>

<span class="c1">// 创建一个容器组件并连接相应的UI组件
</span><span class="c1">// 1.可以直接将函数体写在参数中
</span><span class="c1">// 2.mapDispatchToProps可以传一个函数，也可以传一个对象，当只传一个对象时，即action对象，redux会自动帮你调用dispatch，不需要自己去调用
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="nx">connect</span><span class="p">(</span>
    <span class="nx">state</span> <span class="p">=&gt;</span> <span class="p">({</span><span class="nx">count</span><span class="o">:</span><span class="nx">state</span><span class="p">}),</span>

    <span class="c1">//mapDispatchToProps的一般写法：传函数
</span><span class="c1"></span>    <span class="c1">// dispatch =&gt; ({
</span><span class="c1"></span>    <span class="c1">//     jia:data =&gt; dispatch(incrementAction(data)),
</span><span class="c1"></span>    <span class="c1">//     jian:data =&gt; dispatch(decrementAction(data)),
</span><span class="c1"></span>    <span class="c1">//     asyncAdd:(data,time) =&gt; dispatch(incrementAsyncAction(data,time))
</span><span class="c1"></span>    <span class="c1">// })
</span><span class="c1"></span>
    <span class="c1">//mapDispatchToProps的简写版：传对象
</span><span class="c1"></span>    <span class="c1">//跟jia:(data) =&gt; ({type:INCREMENT,data:data})作用一样，所以在UI组件中调用jia函数时传递参数传给了incrementAction函数，所以返回结果为一个action对象，当返回为action对象时，redux会自动帮你调用dispatch分发
</span><span class="c1"></span>    <span class="p">{</span>
        <span class="nx">jia</span><span class="o">:</span><span class="nx">incrementAction</span><span class="p">,</span>
        <span class="nx">jian</span><span class="o">:</span><span class="nx">decrementAction</span><span class="p">,</span>
        <span class="nx">asyncAdd</span><span class="o">:</span><span class="nx">incrementAsyncAction</span>
    <span class="p">}</span>
<span class="p">)(</span><span class="nx">CountUI</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="5provider组件的使用">5.Provider组件的使用</h4>
<ul>
<li>使用了react_redux之后，不需要再手动去检测redux中状态改变，connect使得容器组件具有自动检测redux状态改变，并且重新渲染组件的效果</li>
<li>如果有多个容器组件，那么在App.js中就要以props形式传多个store={store}，react-redux中的Provider标签能解决这个问题</li>
</ul>
<p>App.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="nx">Count</span> <span class="nx">from</span> <span class="s1">&#39;./containers/Count&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">Count</span><span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>index.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">ReactDOM</span> <span class="nx">from</span> <span class="s1">&#39;react-dom&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">App</span> <span class="nx">from</span> <span class="s1">&#39;./App&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">store</span> <span class="nx">from</span> <span class="s1">&#39;./redux/store&#39;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">Provider</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-redux&#39;</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>
    <span class="c1">// Provider保证App组件中的所有用到store的地方（App中的所有容器组件），都会给它传store
</span><span class="c1"></span>    <span class="o">&lt;</span><span class="nx">Provider</span> <span class="nx">store</span><span class="o">=</span><span class="p">{</span><span class="nx">store</span><span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">App</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="err">/Provider&gt;,</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;root&#39;</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="6整合ui组件和容器组件">6.整合UI组件和容器组件</h4>
<p>可以将UI组件放在容器组件内部，整合成一个组件，并且都放在containers文件夹下</p>
<ul>
<li>删掉容器组件中，引入UI组件语句</li>
<li>将UI组件代码复制到容器组件中，import语句放在一起</li>
<li>不暴露UI组件，因为只在容器组件内部使用</li>
<li>在connect方法的二次调用中，即第二个括号中使用自定义的UI组件</li>
</ul>
<p>容器Count组件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 引入连接UI组件和容器组件、以及连接容器组件与redux的方法:connect
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">connect</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-redux&#39;</span>
<span class="c1">// 引入action
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">incrementAction</span><span class="p">,</span> <span class="nx">decrementAction</span><span class="p">,</span> <span class="nx">incrementAsyncAction</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;../redux/count_action&#39;</span>

<span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>

<span class="c1">// 自定义UI组件，不需要暴露了，因为只在容器组件中使用
</span><span class="c1"></span><span class="kr">class</span> <span class="nx">Count</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>

    <span class="nx">increment</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">jia</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">decrement</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">jian</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">incrementIfOdd</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">count</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">){</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">jia</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">incrementAsync</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">asyncAdd</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">,</span><span class="mi">3000</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">当前求和为</span><span class="err">：</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">count</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                <span class="p">{</span><span class="cm">/* 获取选中的结点 */</span><span class="p">}</span>
                <span class="o">&lt;</span><span class="nx">select</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">c</span><span class="p">=&gt;{</span><span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="o">=</span><span class="nx">c</span><span class="p">}}</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">option</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;1&#34;</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
                    <span class="o">&lt;</span><span class="nx">option</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;2&#34;</span><span class="o">&gt;</span><span class="mi">2</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
                    <span class="o">&lt;</span><span class="nx">option</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;3&#34;</span><span class="o">&gt;</span><span class="mi">3</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
                <span class="o">&lt;</span><span class="err">/select&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">increment</span><span class="p">}</span><span class="o">&gt;+&lt;</span><span class="err">/button&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">decrement</span><span class="p">}</span><span class="o">&gt;-&lt;</span><span class="err">/button&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">incrementIfOdd</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">当前求和为奇数时再加</span><span class="o">&lt;</span><span class="err">/button&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">incrementAsync</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">异步加</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 创建一个容器组件并连接相应的UI组件
</span><span class="c1">// 1.可以直接将函数体写在参数中
</span><span class="c1">// 2.mapDispatchToProps可以传一个函数，也可以传一个对象，当只传一个对象时，即action对象，redux会自动帮你调用dispatch，不需要自己去调用
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="nx">connect</span><span class="p">(</span>
    <span class="nx">state</span> <span class="p">=&gt;</span> <span class="p">({</span><span class="nx">count</span><span class="o">:</span><span class="nx">state</span><span class="p">}),</span>

    <span class="c1">//mapDispatchToProps的一般写法：传函数
</span><span class="c1"></span>    <span class="c1">// dispatch =&gt; ({
</span><span class="c1"></span>    <span class="c1">//     jia:data =&gt; dispatch(incrementAction(data)),
</span><span class="c1"></span>    <span class="c1">//     jian:data =&gt; dispatch(decrementAction(data)),
</span><span class="c1"></span>    <span class="c1">//     asyncAdd:(data,time) =&gt; dispatch(incrementAsyncAction(data,time))
</span><span class="c1"></span>    <span class="c1">// })
</span><span class="c1"></span>
    <span class="c1">//mapDispatchToProps的简写版：传对象
</span><span class="c1"></span>    <span class="c1">//跟jia:(data) =&gt; ({type:INCREMENT,data:data})作用一样，所以在UI组件中调用jia函数时传递参数传给了incrementAction函数，所以返回结果为一个action对象，当返回为action对象时，redux会自动帮你调用dispatch分发
</span><span class="c1"></span>    <span class="p">{</span>
        <span class="nx">jia</span><span class="o">:</span><span class="nx">incrementAction</span><span class="p">,</span>
        <span class="nx">jian</span><span class="o">:</span><span class="nx">decrementAction</span><span class="p">,</span>
        <span class="nx">asyncAdd</span><span class="o">:</span><span class="nx">incrementAsyncAction</span>
    <span class="p">}</span>
<span class="p">)(</span><span class="nx">Count</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="7优化react-redux总结">7.优化react-redux总结</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110135.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110135.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110135.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110135.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110135.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110135.png" /></p>
<h3 id="175-数据共享">17.5 数据共享</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110149.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110149.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110149.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110149.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110149.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110149.png" /></p>
<p>redux要存多个组件存放在redux中的状态，那么redux存放的总状态应该为一个对象，每个组件对应一个key，组件中需要共享的状态即为value</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110203.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110203.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110203.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110203.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110203.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110203.png" /></p>
<p>如果redux总存储状态为一个对象，那么容器组件中的connect第一个参数中的返回的state即为一个对象，所以不能将这个总状态对象渲染到UI组件中，需要取对象中你需要的状态显示在UI组件上</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110215.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110215.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110215.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110215.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110215.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110215.png" /></p>
<p>store.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="cm">/**
</span><span class="cm"> * 该模块专门用于暴露一个store对象，整个应用只有一个store对象
</span><span class="cm"> */</span>

<span class="c1">// 1.引入创建store对象的方法
</span><span class="c1">// 2.引入第三方组件，允许store调用异步action函数
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">createStore</span><span class="p">,</span> <span class="nx">applyMiddleware</span><span class="p">,</span> <span class="nx">combineReducers</span><span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;redux&#34;</span><span class="p">;</span>
<span class="c1">// 引入redux-thunk允许store调用异步action函数
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">thunk</span> <span class="nx">from</span> <span class="s1">&#39;redux-thunk&#39;</span>
<span class="c1">// 引入为Count组件服务的reducer对象
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">countReducer</span> <span class="nx">from</span> <span class="s1">&#39;./reducers/count&#39;</span>
<span class="c1">// 引入为Person组件服务的reducer对象
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">personReducer</span> <span class="nx">from</span> <span class="s1">&#39;./reducers/person&#39;</span>

<span class="c1">// redux中存放的总状态为一个对象，combineReducers就是将对象参数转化为redux中的总状态
</span><span class="c1">// he:countReducer表示：he代表Count组件在redux中存放的状态，rens代表Person组件在redux中存放的状态
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">allReducers</span> <span class="o">=</span> <span class="nx">combineReducers</span><span class="p">({</span>
    <span class="nx">he</span><span class="o">:</span><span class="nx">countReducer</span><span class="p">,</span>
    <span class="nx">rens</span><span class="o">:</span><span class="nx">personReducer</span>
<span class="p">})</span>

<span class="c1">// 创建store的同时，指定为store做事的reducer
</span><span class="c1">// 并默认暴露
</span><span class="c1">// 需要将applyMiddleware函数作为创建store的第二个参数传递，一定要是第二个参数，并且将thunk作为参数传给applyMiddleware函数
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="nx">createStore</span><span class="p">(</span><span class="nx">allReducers</span><span class="p">,</span><span class="nx">applyMiddleware</span><span class="p">(</span><span class="nx">thunk</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><p>reducers/count.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="cm">/**
</span><span class="cm"> * 该模块是创建一个为Count组件服务的reducer
</span><span class="cm"> */</span>

 <span class="kr">import</span> <span class="p">{</span><span class="nx">INCREMENT</span><span class="p">,</span> <span class="nx">DECREMENT</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;../constant&#39;</span>
<span class="c1">// 初始化方法一：
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">initState</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="c1">// 
</span><span class="c1">// 如果type为初始化，那么就初始化state为initState，下一次由组件触发函数发生时，获取到的参数preState就为初始化state值，所以可以直接给preState赋initState值
</span><span class="c1">// 参数中赋值表示如果preState为undefined，那么就会被赋值为initState，如果preState有值，那么就不会执行preState=initState
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nx">countReducer</span><span class="p">(</span><span class="nx">preState</span><span class="o">=</span><span class="nx">initState</span><span class="p">,</span><span class="nx">action</span><span class="p">){</span>
    <span class="kr">const</span> <span class="p">{</span><span class="nx">type</span><span class="p">,</span><span class="nx">data</span><span class="p">}</span><span class="o">=</span><span class="nx">action</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">preState</span><span class="p">);</span>
    <span class="c1">// 使用switch直接按条件返回结果，由于当初始化时给preState设置了初始化state值，所以初始化时直接返回preState
</span><span class="c1"></span>    <span class="k">switch</span> <span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="nx">INCREMENT</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">preState</span><span class="o">+</span><span class="nx">data</span><span class="p">;</span>
        <span class="k">case</span> <span class="nx">DECREMENT</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">preState</span><span class="o">-</span><span class="nx">data</span><span class="p">;</span>
        <span class="k">default</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">preState</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// // 初始化方法二：
</span><span class="c1">// // 如果type为初始化，那么就初始化state为initState，下一次由组件触发函数发生时，获取到的参数preState就为初始化state值，所以可以直接给preState赋initState值
</span><span class="c1">// // 参数中赋值表示如果preState为undefined，那么就会被赋值为initState，如果preState有值，那么就不会执行preState=initState
</span><span class="c1">// export default function countReducer(preState,action){
</span><span class="c1">//     if(preState===undefined)
</span><span class="c1">//     // 设置你想初始化的值
</span><span class="c1">//     preState=0;
</span><span class="c1">//     const {type,data}=action;
</span><span class="c1">//     // 使用switch直接按条件返回结果，由于当初始化时给preState设置了初始化state值，所以初始化时直接返回preState
</span><span class="c1">//     switch (type) {
</span><span class="c1">//         case &#39;increment&#39;:
</span><span class="c1">//             return preState+data;
</span><span class="c1">//         case &#39;decrement&#39;:
</span><span class="c1">//             return preState+data;
</span><span class="c1">//         default:
</span><span class="c1">//             return preState;
</span><span class="c1">//     }
</span><span class="c1">// }
</span><span class="c1"></span>
<span class="c1">// // 初始化方法三：
</span><span class="c1">// // 
</span><span class="c1">// // 如果type为初始化，那么就初始化state为initState，下一次由组件触发函数发生时，获取到的参数preState就为初始化state值，所以可以直接给preState赋initState值
</span><span class="c1">// // 参数中赋值表示如果preState为undefined，那么就会被赋值为initState，如果preState有值，那么就不会执行preState=initState
</span><span class="c1">// export default function countReducer(preState,action){
</span><span class="c1">//     const {type,data}=action;
</span><span class="c1">//     // 使用switch直接按条件返回结果，由于当初始化时给preState设置了初始化state值，所以初始化时直接返回preState
</span><span class="c1">//     switch (type) {
</span><span class="c1">//         case &#39;increment&#39;:
</span><span class="c1">//             return preState+data;
</span><span class="c1">//         case &#39;decrement&#39;:
</span><span class="c1">//             return preState+data;
</span><span class="c1">//         default:
</span><span class="c1">//             return 0;
</span><span class="c1">//     }
</span><span class="c1">//     // 不是increment也不是decrement，那就是初始化，所以直接返回要初始化的值，这里写的是0
</span><span class="c1">// }
</span></code></pre></td></tr></table>
</div>
</div><p>reducers/person.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 引入type变量
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">ADD_PERSON</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;../constant&#39;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">nanoid</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;nanoid&#39;</span>

<span class="kr">const</span> <span class="nx">initPerson</span> <span class="o">=</span> <span class="p">[{</span><span class="nx">id</span><span class="o">:</span><span class="nx">nanoid</span><span class="p">(),</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;张三&#39;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">19</span><span class="p">}];</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nx">personReducer</span><span class="p">(</span><span class="nx">preState</span><span class="o">=</span><span class="nx">initPerson</span><span class="p">,</span><span class="nx">action</span><span class="p">){</span>
    <span class="kr">const</span> <span class="p">{</span><span class="nx">type</span><span class="p">,</span><span class="nx">data</span><span class="p">}</span> <span class="o">=</span> <span class="nx">action</span><span class="p">;</span>
    <span class="k">switch</span> <span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="nx">ADD_PERSON</span><span class="o">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="nx">data</span><span class="p">,...</span><span class="nx">preState</span><span class="p">]</span>
        <span class="k">default</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">preState</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>constant.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="cm">/**
</span><span class="cm"> * 该模块是用于定义action对象中type类型的常量值，目的只有一个：便于管理的同时防止程序员单词写错
</span><span class="cm"> */</span>
<span class="c1">// Count组件进行加法运算的type
</span><span class="c1"></span><span class="kr">export</span> <span class="kr">const</span> <span class="nx">INCREMENT</span> <span class="o">=</span> <span class="s1">&#39;increment&#39;</span><span class="p">;</span>
<span class="c1">// Count组件进行减法运算的type
</span><span class="c1"></span><span class="kr">export</span> <span class="kr">const</span> <span class="nx">DECREMENT</span> <span class="o">=</span> <span class="s1">&#39;decrement&#39;</span><span class="p">;</span>

<span class="c1">// Person组件中添加人的type
</span><span class="c1"></span><span class="kr">export</span> <span class="kr">const</span> <span class="nx">ADD_PERSON</span> <span class="o">=</span> <span class="s1">&#39;add_person&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p>actions/count.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="cm">/**
</span><span class="cm"> * 
</span><span class="cm"> * 该模块专门为Count组件创建action对象
</span><span class="cm"> * 
</span><span class="cm"> */</span>

 <span class="kr">import</span> <span class="p">{</span><span class="nx">INCREMENT</span><span class="p">,</span> <span class="nx">DECREMENT</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;../constant&#39;</span>

<span class="c1">// 箭头函数体中，如果只有一行代码，并且是返回之，那么可以省略{}和return，但是如果返回的是一个对象那么()=&gt;{xxx:xxx}会报错，因为会把这个大括号解析为是一个代码块，而不是对象外面的大括号。
</span><span class="c1">// 方法一：加上{}和return
</span><span class="c1">// const incrementAction = (data) =&gt; {return {type:&#39;increment&#39;,data:data}};
</span><span class="c1">// 方法二：对象外面加一个小括号
</span><span class="c1"></span>
<span class="c1">// 分别暴露
</span><span class="c1">// 该函数返回一个同步action：对象
</span><span class="c1"></span><span class="kr">export</span> <span class="kr">const</span> <span class="nx">incrementAction</span> <span class="o">=</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">({</span><span class="nx">type</span><span class="o">:</span><span class="nx">INCREMENT</span><span class="p">,</span><span class="nx">data</span><span class="o">:</span><span class="nx">data</span><span class="p">});</span>
<span class="kr">export</span> <span class="kr">const</span> <span class="nx">decrementAction</span> <span class="o">=</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">({</span><span class="nx">type</span><span class="o">:</span><span class="nx">DECREMENT</span><span class="p">,</span><span class="nx">data</span><span class="o">:</span><span class="nx">data</span><span class="p">});</span>

<span class="c1">// 该函数返回一个异步action：函数
</span><span class="c1"></span><span class="kr">export</span> <span class="kr">const</span> <span class="nx">incrementAsyncAction</span> <span class="o">=</span> <span class="p">(</span><span class="nx">data</span><span class="p">,</span><span class="nx">time</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="c1">// 由于只要配置好了redux-thunk，store就会帮你调用这个函数，并且一般在异步action函数中都会分发同步action给store，所以异步action函数可以接受到一个dispatch参数，所以异步action函数中的分发同步action对象时不需要使用store.来调用dispatch函数
</span><span class="c1"></span>    <span class="k">return</span> <span class="p">(</span><span class="nx">dispatch</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
            <span class="nx">dispatch</span><span class="p">(</span><span class="nx">incrementAction</span><span class="p">(</span><span class="nx">data</span><span class="p">));</span>
        <span class="p">},</span><span class="nx">time</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>actions/person.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 引入type
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">ADD_PERSON</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;../constant&#39;</span>

<span class="c1">// 新增人
</span><span class="c1"></span><span class="kr">export</span> <span class="kr">const</span> <span class="nx">createPersonAction</span> <span class="o">=</span> <span class="nx">per</span> <span class="p">=&gt;</span> <span class="p">({</span><span class="nx">type</span><span class="o">:</span><span class="nx">ADD_PERSON</span><span class="p">,</span><span class="nx">data</span><span class="o">:</span><span class="nx">per</span><span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>contains/Count/index.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 引入连接UI组件和容器组件、以及连接容器组件与redux的方法:connect
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">connect</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-redux&#39;</span>
<span class="c1">// 引入action
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">incrementAction</span><span class="p">,</span> <span class="nx">decrementAction</span><span class="p">,</span> <span class="nx">incrementAsyncAction</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;../../redux/actions/count&#39;</span>

<span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>

<span class="c1">// UI组件不需要暴露了，因为只在容器组件中使用
</span><span class="c1"></span><span class="kr">class</span> <span class="nx">Count</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>

    <span class="nx">increment</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">jia</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">decrement</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">jian</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">incrementIfOdd</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">count</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">){</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">jia</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">incrementAsync</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">asyncAdd</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">,</span><span class="mi">3000</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">此部分为Count组件</span><span class="err">，</span><span class="nx">下面Person组件的人数为</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">personCount</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                <span class="o">&lt;</span><span class="nx">h4</span><span class="o">&gt;</span><span class="nx">当前求和为</span><span class="err">：</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">count</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h4&gt;</span>
                <span class="p">{</span><span class="cm">/* 获取选中的结点 */</span><span class="p">}</span>
                <span class="o">&lt;</span><span class="nx">select</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">c</span><span class="p">=&gt;{</span><span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="o">=</span><span class="nx">c</span><span class="p">}}</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">option</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;1&#34;</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
                    <span class="o">&lt;</span><span class="nx">option</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;2&#34;</span><span class="o">&gt;</span><span class="mi">2</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
                    <span class="o">&lt;</span><span class="nx">option</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;3&#34;</span><span class="o">&gt;</span><span class="mi">3</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
                <span class="o">&lt;</span><span class="err">/select&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">increment</span><span class="p">}</span><span class="o">&gt;+&lt;</span><span class="err">/button&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">decrement</span><span class="p">}</span><span class="o">&gt;-&lt;</span><span class="err">/button&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">incrementIfOdd</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">当前求和为奇数时再加</span><span class="o">&lt;</span><span class="err">/button&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">incrementAsync</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">异步加</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 创建一个容器组件并连接相应的UI组件
</span><span class="c1">// 1.可以直接将函数体写在参数中
</span><span class="c1">// 2.mapDispatchToProps可以传一个函数，也可以传一个对象，当只传一个对象时，即action对象，redux会自动帮你调用dispatch，不需要自己去调用
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="nx">connect</span><span class="p">(</span>
    <span class="nx">state</span> <span class="p">=&gt;</span> <span class="p">({</span><span class="nx">count</span><span class="o">:</span><span class="nx">state</span><span class="p">.</span><span class="nx">he</span><span class="p">,</span> <span class="nx">personCount</span><span class="o">:</span><span class="nx">state</span><span class="p">.</span><span class="nx">rens</span><span class="p">.</span><span class="nx">length</span><span class="p">}),</span>
    <span class="p">{</span>
        <span class="nx">jia</span><span class="o">:</span><span class="nx">incrementAction</span><span class="p">,</span>
        <span class="nx">jian</span><span class="o">:</span><span class="nx">decrementAction</span><span class="p">,</span>
        <span class="nx">asyncAdd</span><span class="o">:</span><span class="nx">incrementAsyncAction</span>
    <span class="p">}</span>
<span class="p">)(</span><span class="nx">Count</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>contains/Person/index.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">connect</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-redux&#39;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">createPersonAction</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;../../redux/actions/persoin&#39;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">nanoid</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;nanoid&#39;</span>
<span class="kr">class</span> <span class="nx">Person</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>

    <span class="nx">addPerson</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nameNode</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">trim</span><span class="p">()</span><span class="o">!==</span><span class="s1">&#39;&#39;</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">ageNode</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">trim</span><span class="p">()</span><span class="o">!==</span><span class="s1">&#39;&#39;</span><span class="p">){</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">addPerson</span><span class="p">({</span><span class="nx">id</span><span class="o">:</span><span class="nx">nanoid</span><span class="p">(),</span> <span class="nx">name</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">nameNode</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">ageNode</span><span class="p">.</span><span class="nx">value</span><span class="p">})</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">nameNode</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">ageNode</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">此部分为Person组件</span><span class="err">，</span><span class="nx">上面Count组件的求和为</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">he</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">c</span><span class="p">=&gt;{</span><span class="k">this</span><span class="p">.</span><span class="nx">nameNode</span><span class="o">=</span><span class="nx">c</span><span class="p">}}</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">&#34;请输入姓名&#34;</span><span class="o">/&gt;</span>
                <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">c</span><span class="p">=&gt;{</span><span class="k">this</span><span class="p">.</span><span class="nx">ageNode</span><span class="o">=</span><span class="nx">c</span><span class="p">}}</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">&#34;请输入年龄&#34;</span><span class="o">/&gt;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">addPerson</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">添加</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
                    <span class="p">{</span>
                        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">persons</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">item</span><span class="p">=&gt;{</span>
                            <span class="k">return</span> <span class="o">&lt;</span><span class="nx">li</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span> <span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">age</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                        <span class="p">})</span>
                    <span class="p">}</span>
                <span class="o">&lt;</span><span class="err">/ul&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">connect</span><span class="p">(</span>
    <span class="nx">state</span> <span class="p">=&gt;</span> <span class="p">({</span><span class="nx">persons</span><span class="o">:</span><span class="nx">state</span><span class="p">.</span><span class="nx">rens</span><span class="p">,</span> <span class="nx">he</span><span class="o">:</span><span class="nx">state</span><span class="p">.</span><span class="nx">he</span><span class="p">}),</span>
    <span class="p">{</span>
        <span class="nx">addPerson</span><span class="o">:</span><span class="nx">createPersonAction</span>
    <span class="p">}</span>
<span class="p">)(</span><span class="nx">Person</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>App.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="nx">Count</span> <span class="nx">from</span> <span class="s1">&#39;./containers/Count&#39;</span>
<span class="kr">import</span> <span class="nx">Person</span> <span class="nx">from</span> <span class="s1">&#39;./containers/Person&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">Count</span><span class="o">/&gt;</span>
                <span class="o">&lt;</span><span class="nx">hr</span><span class="o">/&gt;</span>
                <span class="o">&lt;</span><span class="nx">Person</span><span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>index.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">ReactDOM</span> <span class="nx">from</span> <span class="s1">&#39;react-dom&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">App</span> <span class="nx">from</span> <span class="s1">&#39;./App&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">store</span> <span class="nx">from</span> <span class="s1">&#39;./redux/store&#39;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">Provider</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-redux&#39;</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>
    <span class="c1">// Provider保证App组件中的所有用到store的地方（App中的所有容器组件），都会给它传store
</span><span class="c1"></span>    <span class="o">&lt;</span><span class="nx">Provider</span> <span class="nx">store</span><span class="o">=</span><span class="p">{</span><span class="nx">store</span><span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">App</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="err">/Provider&gt;,</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;root&#39;</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="176-纯函数">17.6 纯函数</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110247.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110247.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110247.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110247.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110247.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110247.png" /></p>
<p>contains/Person/index.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 引入type变量
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">ADD_PERSON</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;../constant&#39;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">nanoid</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;nanoid&#39;</span>

<span class="kr">const</span> <span class="nx">initPerson</span> <span class="o">=</span> <span class="p">[{</span><span class="nx">id</span><span class="o">:</span><span class="nx">nanoid</span><span class="p">(),</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;张三&#39;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">19</span><span class="p">}];</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nx">personReducer</span><span class="p">(</span><span class="nx">preState</span><span class="o">=</span><span class="nx">initPerson</span><span class="p">,</span><span class="nx">action</span><span class="p">){</span>
    <span class="kr">const</span> <span class="p">{</span><span class="nx">type</span><span class="p">,</span><span class="nx">data</span><span class="p">}</span> <span class="o">=</span> <span class="nx">action</span><span class="p">;</span>
    <span class="c1">// 1.这里往数组头部添加一个值，不适用数组自带的方法：unshift()是因为：
</span><span class="c1"></span>    <span class="c1">// preState.unshift(data) 往数组头部添加一个数，但是preState这个数组的地址并没有改变，redux在检测状态更新时，在底层进行了一个浅比较，发现数组的地址没变，就认为这个状态并没有被更新，所以不会驱动页面重新渲染
</span><span class="c1"></span>    <span class="c1">// 所以一般react 和 redux很少使用数组自带的那些方法
</span><span class="c1"></span>
    <span class="c1">//2. redux的reducer函数必须是一个纯函数，纯函数不能对参数进行修改，unshift是会修改原数组的值，所以preState.unshift(xxx)是会修改preState的值的
</span><span class="c1"></span>    <span class="k">switch</span> <span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="nx">ADD_PERSON</span><span class="o">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="nx">data</span><span class="p">,...</span><span class="nx">preState</span><span class="p">]</span>
        <span class="k">default</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">preState</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="177-redux开发者工具">17.7 redux开发者工具</h3>
<ol>
<li>
<p>导入redux开发者工具</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110302.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110302.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110302.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110302.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110302.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110302.png" /></p>
</li>
<li>
<p>安装 npm install redux-devtools-extension</p>
</li>
<li>
<p>在store中引用</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="cm">/**
</span><span class="cm"> * 该模块专门用于暴露一个store对象，整个应用只有一个store对象
</span><span class="cm"> */</span>
   
<span class="c1">// 1.引入创建store对象的方法
</span><span class="c1">// 2.引入第三方组件，允许store调用异步action函数
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">createStore</span><span class="p">,</span> <span class="nx">applyMiddleware</span><span class="p">,</span> <span class="nx">combineReducers</span><span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;redux&#34;</span><span class="p">;</span>
<span class="c1">// 引入redux-thunk允许store调用异步action函数
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">thunk</span> <span class="nx">from</span> <span class="s1">&#39;redux-thunk&#39;</span>
<span class="c1">// 引入为Count组件服务的reducer对象
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">countReducer</span> <span class="nx">from</span> <span class="s1">&#39;./reducers/count&#39;</span>
<span class="c1">// 引入为Person组件服务的reducer对象
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">personReducer</span> <span class="nx">from</span> <span class="s1">&#39;./reducers/person&#39;</span>
<span class="c1">// 使用redux开发者工具
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">composeWithDevTools</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;redux-devtools-extension&#39;</span>
   
<span class="kr">const</span> <span class="nx">allReducers</span> <span class="o">=</span> <span class="nx">combineReducers</span><span class="p">({</span>
    <span class="nx">he</span><span class="o">:</span><span class="nx">countReducer</span><span class="p">,</span>
    <span class="nx">rens</span><span class="o">:</span><span class="nx">personReducer</span>
<span class="p">})</span>
   
<span class="c1">// 如果createStore没有第二个参数，那么直接将composeWithDevTools()作为第二个参数
</span><span class="c1">// 如果createStore有第二个参数，那么将composeWithDevTools()作为第二个参数，并将原来的第二个参数作为composeWithDevTools的参数
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="nx">createStore</span><span class="p">(</span><span class="nx">allReducers</span><span class="p">,</span><span class="nx">composeWithDevTools</span><span class="p">(</span><span class="nx">applyMiddleware</span><span class="p">(</span><span class="nx">thunk</span><span class="p">)))</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<p>做完上述三步就可以使用redux开发者工具了</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110315.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110315.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110315.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110315.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110315.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110315.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110326.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110326.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110326.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110326.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110326.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110326.png" /></p>
<h3 id="178-最终版">17.8 最终版</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110338.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110338.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110338.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110338.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110338.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110338.png" /></p>
<ul>
<li>可以汇总reducer的事情放在单独的一个文件夹中，因为如果有很多个容器组件，那么就需要在store中import很多次，并且在combineReducers中定义很多个key、value。一般是将汇总reducer放在reducers文件夹中的index.js文件中</li>
<li>对象简写方法：{count:count,person:person}可以简写为只要属性值{count,person}，这表示count为对象的属性值，属性名也为count所以.count==count的</li>
</ul>
<p>index.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">ReactDOM</span> <span class="nx">from</span> <span class="s1">&#39;react-dom&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">App</span> <span class="nx">from</span> <span class="s1">&#39;./App&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">store</span> <span class="nx">from</span> <span class="s1">&#39;./redux/store&#39;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">Provider</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-redux&#39;</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>
    <span class="c1">// Provider保证App组件中的所有用到store的地方（App中的所有容器组件），都会给它传store
</span><span class="c1"></span>    <span class="o">&lt;</span><span class="nx">Provider</span> <span class="nx">store</span><span class="o">=</span><span class="p">{</span><span class="nx">store</span><span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">App</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="err">/Provider&gt;,</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;root&#39;</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>App.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="nx">Count</span> <span class="nx">from</span> <span class="s1">&#39;./containers/Count&#39;</span> <span class="c1">//引入Count容器组件
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">Person</span> <span class="nx">from</span> <span class="s1">&#39;./containers/Person&#39;</span> <span class="c1">//引入Person容器组件
</span><span class="c1"></span>
<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">Count</span><span class="o">/&gt;</span>
                <span class="o">&lt;</span><span class="nx">hr</span><span class="o">/&gt;</span>
                <span class="o">&lt;</span><span class="nx">Person</span><span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>store.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="cm">/**
</span><span class="cm"> * 该模块专门用于暴露一个store对象，整个应用只有一个store对象
</span><span class="cm"> */</span>

<span class="c1">// 1.引入创建store对象的方法
</span><span class="c1">// 2.引入第三方组件，允许store调用异步action函数
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">createStore</span><span class="p">,</span> <span class="nx">applyMiddleware</span><span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;redux&#34;</span><span class="p">;</span>
<span class="c1">// 引入redux-thunk允许store调用异步action函数
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">thunk</span> <span class="nx">from</span> <span class="s1">&#39;redux-thunk&#39;</span>
<span class="c1">// 使用redux开发者工具
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">composeWithDevTools</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;redux-devtools-extension&#39;</span>
<span class="c1">// 引入汇总后的reducer
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">reducer</span> <span class="nx">from</span> <span class="s1">&#39;./reducers&#39;</span>


<span class="c1">// 如果createStore没有第二个参数，那么直接将composeWithDevTools()作为第二个参数
</span><span class="c1">// 如果createStore有第二个参数，那么将composeWithDevTools()作为第二个参数，并将原来的第二个参数作为composeWithDevTools的参数
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="nx">createStore</span><span class="p">(</span><span class="nx">reducer</span><span class="p">,</span><span class="nx">composeWithDevTools</span><span class="p">(</span><span class="nx">applyMiddleware</span><span class="p">(</span><span class="nx">thunk</span><span class="p">)))</span>
</code></pre></td></tr></table>
</div>
</div><p>constant.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="cm">/**
</span><span class="cm"> * 该模块是用于定义action对象中type类型的常量值，目的只有一个：便于管理的同时防止程序员单词写错
</span><span class="cm"> */</span>
<span class="c1">// Count组件进行加法运算的type
</span><span class="c1"></span><span class="kr">export</span> <span class="kr">const</span> <span class="nx">INCREMENT</span> <span class="o">=</span> <span class="s1">&#39;increment&#39;</span><span class="p">;</span>
<span class="c1">// Count组件进行减法运算的type
</span><span class="c1"></span><span class="kr">export</span> <span class="kr">const</span> <span class="nx">DECREMENT</span> <span class="o">=</span> <span class="s1">&#39;decrement&#39;</span><span class="p">;</span>

<span class="c1">// Person组件中添加人的type
</span><span class="c1"></span><span class="kr">export</span> <span class="kr">const</span> <span class="nx">ADD_PERSON</span> <span class="o">=</span> <span class="s1">&#39;add_person&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p>reducers/count.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="cm">/**
</span><span class="cm"> * 该模块是创建一个为Count组件服务的reducer
</span><span class="cm"> */</span>

 <span class="kr">import</span> <span class="p">{</span><span class="nx">INCREMENT</span><span class="p">,</span> <span class="nx">DECREMENT</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;../constant&#39;</span>
<span class="c1">// 初始化方法一：
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">initState</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="c1">// 
</span><span class="c1">// 如果type为初始化，那么就初始化state为initState，下一次由组件触发函数发生时，获取到的参数preState就为初始化state值，所以可以直接给preState赋initState值
</span><span class="c1">// 参数中赋值表示如果preState为undefined，那么就会被赋值为initState，如果preState有值，那么就不会执行preState=initState
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nx">countReducer</span><span class="p">(</span><span class="nx">preState</span><span class="o">=</span><span class="nx">initState</span><span class="p">,</span><span class="nx">action</span><span class="p">){</span>
    <span class="kr">const</span> <span class="p">{</span><span class="nx">type</span><span class="p">,</span><span class="nx">data</span><span class="p">}</span><span class="o">=</span><span class="nx">action</span><span class="p">;</span>
    <span class="c1">// 使用switch直接按条件返回结果，由于当初始化时给preState设置了初始化state值，所以初始化时直接返回preState
</span><span class="c1"></span>    <span class="k">switch</span> <span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="nx">INCREMENT</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">preState</span><span class="o">+</span><span class="nx">data</span><span class="p">;</span>
        <span class="k">case</span> <span class="nx">DECREMENT</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">preState</span><span class="o">-</span><span class="nx">data</span><span class="p">;</span>
        <span class="k">default</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">preState</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// // 初始化方法二：
</span><span class="c1">// // 如果type为初始化，那么就初始化state为initState，下一次由组件触发函数发生时，获取到的参数preState就为初始化state值，所以可以直接给preState赋initState值
</span><span class="c1">// // 参数中赋值表示如果preState为undefined，那么就会被赋值为initState，如果preState有值，那么就不会执行preState=initState
</span><span class="c1">// export default function countReducer(preState,action){
</span><span class="c1">//     if(preState===undefined)
</span><span class="c1">//     // 设置你想初始化的值
</span><span class="c1">//     preState=0;
</span><span class="c1">//     const {type,data}=action;
</span><span class="c1">//     // 使用switch直接按条件返回结果，由于当初始化时给preState设置了初始化state值，所以初始化时直接返回preState
</span><span class="c1">//     switch (type) {
</span><span class="c1">//         case &#39;increment&#39;:
</span><span class="c1">//             return preState+data;
</span><span class="c1">//         case &#39;decrement&#39;:
</span><span class="c1">//             return preState+data;
</span><span class="c1">//         default:
</span><span class="c1">//             return preState;
</span><span class="c1">//     }
</span><span class="c1">// }
</span><span class="c1"></span>
<span class="c1">// // 初始化方法三：
</span><span class="c1">// // 
</span><span class="c1">// // 如果type为初始化，那么就初始化state为initState，下一次由组件触发函数发生时，获取到的参数preState就为初始化state值，所以可以直接给preState赋initState值
</span><span class="c1">// // 参数中赋值表示如果preState为undefined，那么就会被赋值为initState，如果preState有值，那么就不会执行preState=initState
</span><span class="c1">// export default function countReducer(preState,action){
</span><span class="c1">//     const {type,data}=action;
</span><span class="c1">//     // 使用switch直接按条件返回结果，由于当初始化时给preState设置了初始化state值，所以初始化时直接返回preState
</span><span class="c1">//     switch (type) {
</span><span class="c1">//         case &#39;increment&#39;:
</span><span class="c1">//             return preState+data;
</span><span class="c1">//         case &#39;decrement&#39;:
</span><span class="c1">//             return preState+data;
</span><span class="c1">//         default:
</span><span class="c1">//             return 0;
</span><span class="c1">//     }
</span><span class="c1">//     // 不是increment也不是decrement，那就是初始化，所以直接返回要初始化的值，这里写的是0
</span><span class="c1">// }
</span></code></pre></td></tr></table>
</div>
</div><p>reducers/person.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 引入type变量
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">ADD_PERSON</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;../constant&#39;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">nanoid</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;nanoid&#39;</span>

<span class="kr">const</span> <span class="nx">initPerson</span> <span class="o">=</span> <span class="p">[{</span><span class="nx">id</span><span class="o">:</span><span class="nx">nanoid</span><span class="p">(),</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;张三&#39;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">19</span><span class="p">}];</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nx">personReducer</span><span class="p">(</span><span class="nx">preState</span><span class="o">=</span><span class="nx">initPerson</span><span class="p">,</span><span class="nx">action</span><span class="p">){</span>
    <span class="kr">const</span> <span class="p">{</span><span class="nx">type</span><span class="p">,</span><span class="nx">data</span><span class="p">}</span> <span class="o">=</span> <span class="nx">action</span><span class="p">;</span>
    <span class="k">switch</span> <span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="nx">ADD_PERSON</span><span class="o">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="nx">data</span><span class="p">,...</span><span class="nx">preState</span><span class="p">]</span>
        <span class="k">default</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">preState</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>reducers/index.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="p">{</span><span class="nx">combineReducers</span><span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;redux&#34;</span><span class="p">;</span>
<span class="c1">// 引入为Count组件服务的reducer对象
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">count</span> <span class="nx">from</span> <span class="s1">&#39;../reducers/count&#39;</span>
<span class="c1">// 引入为Person组件服务的reducer对象
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">persons</span> <span class="nx">from</span> <span class="s1">&#39;../reducers/person&#39;</span>

<span class="c1">// 汇总所有的reducer变成一个总reducer
</span><span class="c1">// {count:count,person:person}可以简写为只要属性值{count,person}，这表示count为对象的属性值，属性名也为count所以.count==count的
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="nx">combineReducers</span><span class="p">({</span>
    <span class="nx">count</span><span class="p">,</span> <span class="nx">persons</span>
<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>actions/count.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="cm">/**
</span><span class="cm"> * 
</span><span class="cm"> * 该模块专门为Count组件创建action对象
</span><span class="cm"> * 
</span><span class="cm"> */</span>

 <span class="kr">import</span> <span class="p">{</span><span class="nx">INCREMENT</span><span class="p">,</span> <span class="nx">DECREMENT</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;../constant&#39;</span>

<span class="c1">// 箭头函数体中，如果只有一行代码，并且是返回之，那么可以省略{}和return，但是如果返回的是一个对象那么()=&gt;{xxx:xxx}会报错，因为会把这个大括号解析为是一个代码块，而不是对象外面的大括号。
</span><span class="c1">// 方法一：加上{}和return
</span><span class="c1">// const incrementAction = (data) =&gt; {return {type:&#39;increment&#39;,data:data}};
</span><span class="c1">// 方法二：对象外面加一个小括号
</span><span class="c1"></span>
<span class="c1">// 分别暴露
</span><span class="c1">// 该函数返回一个同步action：对象
</span><span class="c1"></span><span class="kr">export</span> <span class="kr">const</span> <span class="nx">increment</span> <span class="o">=</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">({</span><span class="nx">type</span><span class="o">:</span><span class="nx">INCREMENT</span><span class="p">,</span><span class="nx">data</span><span class="p">});</span>
<span class="kr">export</span> <span class="kr">const</span> <span class="nx">decrement</span> <span class="o">=</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">({</span><span class="nx">type</span><span class="o">:</span><span class="nx">DECREMENT</span><span class="p">,</span><span class="nx">data</span><span class="p">});</span>

<span class="c1">// 该函数返回一个异步action：函数
</span><span class="c1"></span><span class="kr">export</span> <span class="kr">const</span> <span class="nx">incrementAsync</span> <span class="o">=</span> <span class="p">(</span><span class="nx">data</span><span class="p">,</span><span class="nx">time</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="c1">// 由于只要配置好了redux-thunk，store就会帮你调用这个函数，并且一般在异步action函数中都会分发同步action给store，所以异步action函数可以接受到一个dispatch参数，所以异步action函数中的分发同步action对象时不需要使用store.来调用dispatch函数
</span><span class="c1"></span>    <span class="k">return</span> <span class="p">(</span><span class="nx">dispatch</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
            <span class="nx">dispatch</span><span class="p">(</span><span class="nx">increment</span><span class="p">(</span><span class="nx">data</span><span class="p">));</span>
        <span class="p">},</span><span class="nx">time</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>actions/person.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 引入type
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">ADD_PERSON</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;../constant&#39;</span>

<span class="c1">// 新增人
</span><span class="c1"></span><span class="kr">export</span> <span class="kr">const</span> <span class="nx">addPerson</span> <span class="o">=</span> <span class="nx">per</span> <span class="p">=&gt;</span> <span class="p">({</span><span class="nx">type</span><span class="o">:</span><span class="nx">ADD_PERSON</span><span class="p">,</span><span class="nx">data</span><span class="o">:</span><span class="nx">per</span><span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>containers/Count/index.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 引入连接UI组件和容器组件、以及连接容器组件与redux的方法:connect
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">connect</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-redux&#39;</span>
<span class="c1">// 引入action
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">increment</span><span class="p">,</span> <span class="nx">decrement</span><span class="p">,</span> <span class="nx">incrementAsync</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;../../redux/actions/count&#39;</span>

<span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>

<span class="c1">// UI组件不需要暴露了，因为只在容器组件中使用
</span><span class="c1"></span><span class="kr">class</span> <span class="nx">Count</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>

    <span class="nx">increment</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">increment</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">decrement</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">decrement</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">incrementIfOdd</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">count</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">){</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">increment</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">incrementAsync</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="kr">const</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">incrementAsync</span><span class="p">(</span><span class="nx">value</span><span class="o">-</span><span class="mi">0</span><span class="p">,</span><span class="mi">3000</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">此部分为Count组件</span><span class="err">，</span><span class="nx">下面Person组件的人数为</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">persons</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                <span class="o">&lt;</span><span class="nx">h4</span><span class="o">&gt;</span><span class="nx">当前求和为</span><span class="err">：</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">count</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h4&gt;</span>
                <span class="p">{</span><span class="cm">/* 获取选中的结点 */</span><span class="p">}</span>
                <span class="o">&lt;</span><span class="nx">select</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">c</span><span class="p">=&gt;{</span><span class="k">this</span><span class="p">.</span><span class="nx">selectNumNode</span><span class="o">=</span><span class="nx">c</span><span class="p">}}</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">option</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;1&#34;</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
                    <span class="o">&lt;</span><span class="nx">option</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;2&#34;</span><span class="o">&gt;</span><span class="mi">2</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
                    <span class="o">&lt;</span><span class="nx">option</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&#34;3&#34;</span><span class="o">&gt;</span><span class="mi">3</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
                <span class="o">&lt;</span><span class="err">/select&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">increment</span><span class="p">}</span><span class="o">&gt;+&lt;</span><span class="err">/button&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">decrement</span><span class="p">}</span><span class="o">&gt;-&lt;</span><span class="err">/button&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">incrementIfOdd</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">当前求和为奇数时再加</span><span class="o">&lt;</span><span class="err">/button&gt;&amp;nbsp;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">incrementAsync</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">异步加</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 创建一个容器组件并连接相应的UI组件
</span><span class="c1">// 1.可以直接将函数体写在参数中
</span><span class="c1">// 2.mapDispatchToProps可以传一个函数，也可以传一个对象，当只传一个对象时，即action对象，redux会自动帮你调用dispatch，不需要自己去调用
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="nx">connect</span><span class="p">(</span>
    <span class="nx">state</span> <span class="p">=&gt;</span> <span class="p">({</span><span class="nx">count</span><span class="o">:</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span><span class="p">,</span> <span class="nx">persons</span><span class="o">:</span><span class="nx">state</span><span class="p">.</span><span class="nx">persons</span><span class="p">.</span><span class="nx">length</span><span class="p">}),</span>
    <span class="p">{</span>
        <span class="nx">increment</span><span class="p">,</span>
        <span class="nx">decrement</span><span class="p">,</span>
        <span class="nx">incrementAsync</span>
    <span class="p">}</span>
<span class="p">)(</span><span class="nx">Count</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>containers/Person/index.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">connect</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-redux&#39;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">addPerson</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;../../redux/actions/persoin&#39;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">nanoid</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;nanoid&#39;</span>
<span class="kr">class</span> <span class="nx">Person</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>

    <span class="nx">addPerson</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;{</span>
        <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nameNode</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">trim</span><span class="p">()</span><span class="o">!==</span><span class="s1">&#39;&#39;</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">ageNode</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">trim</span><span class="p">()</span><span class="o">!==</span><span class="s1">&#39;&#39;</span><span class="p">){</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">addPerson</span><span class="p">({</span><span class="nx">id</span><span class="o">:</span><span class="nx">nanoid</span><span class="p">(),</span> <span class="nx">name</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">nameNode</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">ageNode</span><span class="p">.</span><span class="nx">value</span><span class="p">})</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">nameNode</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">ageNode</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">此部分为Person组件</span><span class="err">，</span><span class="nx">上面Count组件的求和为</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">count</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
                <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">c</span><span class="p">=&gt;{</span><span class="k">this</span><span class="p">.</span><span class="nx">nameNode</span><span class="o">=</span><span class="nx">c</span><span class="p">}}</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">&#34;请输入姓名&#34;</span><span class="o">/&gt;</span>
                <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">c</span><span class="p">=&gt;{</span><span class="k">this</span><span class="p">.</span><span class="nx">ageNode</span><span class="o">=</span><span class="nx">c</span><span class="p">}}</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">&#34;请输入年龄&#34;</span><span class="o">/&gt;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">addPerson</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">添加</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
                    <span class="p">{</span>
                        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">persons</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">item</span><span class="p">=&gt;{</span>
                            <span class="k">return</span> <span class="o">&lt;</span><span class="nx">li</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span> <span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">age</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
                        <span class="p">})</span>
                    <span class="p">}</span>
                <span class="o">&lt;</span><span class="err">/ul&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">connect</span><span class="p">(</span>
    <span class="nx">state</span> <span class="p">=&gt;</span> <span class="p">({</span><span class="nx">persons</span><span class="o">:</span><span class="nx">state</span><span class="p">.</span><span class="nx">persons</span><span class="p">,</span> <span class="nx">count</span><span class="o">:</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span><span class="p">}),</span>
    <span class="p">{</span>
        <span class="nx">addPerson</span>
    <span class="p">}</span>
<span class="p">)(</span><span class="nx">Person</span><span class="p">)</span>

</code></pre></td></tr></table>
</div>
</div><h3 id="179-项目打包运行">17.9 项目打包运行</h3>
<ol>
<li>项目一般是打包成静态资源给后端服务器去部署的，但是由于现在没有服务器，可以借助一个包serve，指定某个文件夹，然后开启一个小型服务器</li>
<li>全局安装serve包,npm install serve -g</li>
<li>将项目打包：npm run build</li>
<li>将build作为服务器根目录，开启一个服务器：serve build</li>
</ol>
<p>如果serve build报错，原因是：无法加载文件 D:\nvm\v12.16.0\node_global\serve.ps1，因为在此系统上禁止运行脚本。</p>
<p>解决方法：</p>
<ul>
<li>使用管理员权限打开工具软件（如VScode）</li>
<li>命令行执行：get-ExecutionPolicy，得到结果为Restricted，表示禁止状态</li>
<li>命令行执行：set-ExecutionPolicy RemoteSigned</li>
<li>再次执行命令：get-ExecutionPolicy，结果显示为RemoteSigned</li>
<li>执行serve build,运行成功。</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110524.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110524.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110524.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110524.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110524.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211002110524.png" /></p>
<p>成功后直接访问5000</p>
<p>运行serve build 报错；<strong>serve : 无法将“serve”项识别为 cmdlet、函数、脚本文件或可运行程序的名称。请检查名称的拼写，如果包括路径，请确保路径正确，然后再试一次</strong></p>
<p>解决方法：</p>
<ul>
<li>使用<code>yarn</code>语法进行服务器安装<code>yarn add serve</code>，安装完毕后执行<code>yarn serve build</code>即可成功</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211010210840.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211010210840.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211010210840.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211010210840.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211010210840.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20211010210840.png" /></p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2021-10-02</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="https://cloverfelix.github.io/react/" data-title="React" data-hashtags="React"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="https://cloverfelix.github.io/react/" data-hashtag="React"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Hacker News" data-sharer="hackernews" data-url="https://cloverfelix.github.io/react/" data-title="React"><i class="fab fa-hacker-news fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Line" data-sharer="line" data-url="https://cloverfelix.github.io/react/" data-title="React"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@2.14.0/icons/line.svg"></i></a><a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="https://cloverfelix.github.io/react/" data-title="React"><i class="fab fa-weibo fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/react/">React</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/dockerdeploy/" class="prev" rel="prev" title="DockerDeploy"><i class="fas fa-angle-left fa-fw"></i>DockerDeploy</a>
            <a href="/reactexpand/" class="next" rel="next" title="ReactExpand">ReactExpand<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2021 - 2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Clover</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/css/lightgallery.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/algoliasearch@4.2.0/dist/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/js/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.2.0/dist/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":10},"comment":{},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"search":{"algoliaAppID":"QEH6MSAUGD","algoliaIndex":"blog","algoliaSearchKey":"83e0e9a01bb86efaff215298300450e1","highlightTag":"em","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"algolia"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
