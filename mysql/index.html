<!DOCTYPE html>
<html lang="zh-cn">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Mysql - clover</title><meta name="Description" content="mysql"><meta property="og:title" content="Mysql" />
<meta property="og:description" content="mysql" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cloverfelix.github.io/mysql/" /><meta property="og:image" content="https://cloverfelix.github.io/RW.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-04T16:33:35&#43;08:00" />
<meta property="article:modified_time" content="2021-07-04T16:33:35&#43;08:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://cloverfelix.github.io/RW.png"/>

<meta name="twitter:title" content="Mysql"/>
<meta name="twitter:description" content="mysql"/>
<meta name="application-name" content="Clover">
<meta name="apple-mobile-web-app-title" content="Clover"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://cloverfelix.github.io/mysql/" /><link rel="prev" href="https://cloverfelix.github.io/mybatis/" /><link rel="next" href="https://cloverfelix.github.io/sql%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Mysql",
        "inLanguage": "zh-cn",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/cloverfelix.github.io\/mysql\/"
        },"image": ["https:\/\/cloverfelix.github.io\/images\/Apple-Devices-Preview.png"],"genre": "posts","keywords": "Mysql","wordcount":  27497 ,
        "url": "https:\/\/cloverfelix.github.io\/mysql\/","datePublished": "2021-07-04T16:33:35+08:00","dateModified": "2021-07-04T16:33:35+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "clover","logo": "https:\/\/cloverfelix.github.io\/images\/RW.png"},"author": {
                "@type": "Person",
                "name": "Clover"
            },"description": "mysql"
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="clover"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span>Clover</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 所有文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><a class="menu-item" href="/about/"> 关于 </a><a class="menu-item" href="https://github.com/cloverfelix" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="clover"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span>Clover</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">所有文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a class="menu-item" href="/about/" title="">关于</a><a class="menu-item" href="https://github.com/cloverfelix" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Mysql</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Clover</a></span>&nbsp;<span class="post-category">收录于 <a href="/categories/mysql/"><i class="far fa-folder fa-fw"></i>Mysql</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2021-07-04">2021-07-04</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 27497 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 55 分钟&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#1初始mysql">1、初始Mysql</a>
      <ul>
        <li><a href="#11为什么学习数据库">1.1、为什么学习数据库</a></li>
        <li><a href="#12什么是数据库">1.2、什么是数据库</a></li>
        <li><a href="#13什么是dbms">1.3、什么是DBMS</a></li>
        <li><a href="#14mysql简介">1.4、MySQL简介</a></li>
        <li><a href="#15安装mysql">1.5、安装MySQL</a></li>
        <li><a href="#16sqlyog">1.6、SQLyog</a></li>
        <li><a href="#17连接数据库">1.7、连接数据库</a></li>
      </ul>
    </li>
    <li><a href="#2操作数据库">2、操作数据库</a>
      <ul>
        <li><a href="#21结构化查询语句分类">2.1、结构化查询语句分类</a></li>
        <li><a href="#22数据库操作">2.2、数据库操作</a></li>
        <li><a href="#23创建数据表">2.3、创建数据表</a></li>
        <li><a href="#24数据值和列类型">2.4、数据值和列类型</a></li>
        <li><a href="#25数据字段属性">2.5、数据字段属性</a></li>
        <li><a href="#26数据表的类型">2.6、数据表的类型</a></li>
        <li><a href="#27修改数据库">2.7、修改数据库</a></li>
      </ul>
    </li>
    <li><a href="#3mysql数据管理">3、MySQL数据管理</a>
      <ul>
        <li><a href="#31外键">3.1、外键</a></li>
        <li><a href="#32dml语言">3.2、DML语言</a></li>
        <li><a href="#33添加数据">3.3、添加数据</a></li>
        <li><a href="#34修改数据">3.4、修改数据</a></li>
        <li><a href="#35删除数据">3.5、删除数据</a></li>
      </ul>
    </li>
    <li><a href="#4使用dql查询数据">4、使用DQL查询数据</a>
      <ul>
        <li><a href="#41dql语言">4.1、DQL语言</a></li>
        <li><a href="#42指定查询字段">4.2、指定查询字段</a></li>
        <li><a href="#43where条件语句">4.3、where条件语句</a></li>
        <li><a href="#44连接查询">4.4、连接查询</a></li>
        <li><a href="#45排序和分页">4.5、排序和分页</a></li>
        <li><a href="#46子查询">4.6、子查询</a></li>
      </ul>
    </li>
    <li><a href="#5mysql函数">5、MySQL函数</a>
      <ul>
        <li><a href="#51常用函数">5.1、常用函数</a></li>
        <li><a href="#52聚合函数">5.2、聚合函数</a></li>
        <li><a href="#53小结">5.3、小结</a></li>
      </ul>
    </li>
    <li><a href="#6事务">6、事务</a>
      <ul>
        <li><a href="#61概述">6.1、概述</a></li>
        <li><a href="#62事务实现">6.2、事务实现</a></li>
        <li><a href="#63测试题目">6.3、测试题目</a></li>
      </ul>
    </li>
    <li><a href="#7索引">7、索引</a>
      <ul>
        <li><a href="#71索引分类">7.1、索引分类</a></li>
        <li><a href="#72扩展测试索引">7.2、扩展：测试索引</a></li>
        <li><a href="#73索引原则">7.3、索引原则</a></li>
        <li><a href="#74索引的数据结构">7.4、索引的数据结构</a></li>
      </ul>
    </li>
    <li><a href="#8权限管理和备份">8、权限管理和备份</a>
      <ul>
        <li><a href="#81用户管理">8.1、用户管理</a></li>
        <li><a href="#82数据库备份">8.2、数据库备份</a></li>
      </ul>
    </li>
    <li><a href="#9规范化数据库">9、规范化数据库</a>
      <ul>
        <li><a href="#91为什么需要数据库设计">9.1、为什么需要数据库设计</a></li>
        <li><a href="#92三大范式">9.2、三大范式</a></li>
      </ul>
    </li>
    <li><a href="#10jdbc">10、JDBC</a>
      <ul>
        <li><a href="#101数据库驱动">10.1、数据库驱动</a></li>
        <li><a href="#102jdbc介绍">10.2、JDBC介绍</a></li>
        <li><a href="#103编写jdbc程序">10.3、编写JDBC程序</a></li>
        <li><a href="#104对象说明">10.4、对象说明</a></li>
        <li><a href="#105statement对象">10.5、statement对象</a></li>
        <li><a href="#106preparedstatement对象">10.6、PreparedStatement对象</a></li>
        <li><a href="#107事务">10.7、事务</a></li>
        <li><a href="#108数据库连接池">10.8、数据库连接池</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="1初始mysql">1、初始Mysql</h2>
<h3 id="11为什么学习数据库">1.1、为什么学习数据库</h3>
<p>1、岗位技能需求</p>
<p>2、现在的世界,得数据者得天下</p>
<p>3、存储数据的方法</p>
<p>4、程序,网站中,大量数据如何长久保存?</p>
<p><strong>5、数据库是几乎软件体系中最核心的一个存在。</strong></p>
<h3 id="12什么是数据库">1.2、什么是数据库</h3>
<p>数据库 ( <strong>DataBase</strong> , 简称<strong>DB</strong> )</p>
<p>概念 : 长期存放在计算机内,有组织,可共享的大量数据的集合,是一个数据 &ldquo;仓库&rdquo;</p>
<p>作用 : 保存,并能安全管理数据(如:增删改查等),减少冗余&hellip;</p>
<p>数据库总览 :</p>
<ul>
<li>关系型数据库 ( SQL )
<ul>
<li>MySQL , Oracle , SQL Server , SQLite , DB2 , &hellip;</li>
<li>关系型数据库通过外键关联来建立表与表之间的关系</li>
</ul>
</li>
<li>非关系型数据库 ( NOSQL )
<ul>
<li>Redis , MongoDB , &hellip;</li>
<li>非关系型数据库通常指数据以对象的形式存储在数据库中，而对象之间的关系通过每个对象自 身的属性来决定</li>
</ul>
</li>
</ul>
<h3 id="13什么是dbms">1.3、什么是DBMS</h3>
<p>数据库管理系统(<strong>D</strong>ata<strong>B</strong>ase <strong>M</strong>anagement <strong>S</strong>ystem)</p>
<p>数据库管理软件，科学组织和存储数据，高效的获取和维护数据</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822200246.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822200246.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822200246.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822200246.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822200246.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822200246.png" /></p>
<p>为社么要说这个呢？</p>
<p>因为我们要学习的Mysql应该算是一个数据库管理系统</p>
<h3 id="14mysql简介">1.4、MySQL简介</h3>
<p><strong>概念</strong>：是现在<strong>流行的</strong>，<strong>开源的</strong>，<strong>免费的</strong>，<strong>关系型</strong>数据库</p>
<p><strong>历史</strong>：由瑞典MySQL AB公司开发，目前属于Oracle旗下产品。</p>
<p><strong>特点</strong>：</p>
<ul>
<li>免费，开源数据库</li>
<li>小巧，功能齐全</li>
<li>使用便捷</li>
<li>可运行与Windows或Linux操作系统</li>
<li>可适用于中小型甚至大型网站应用</li>
</ul>
<p><a href="https://www.mysql.com/" target="_blank" rel="noopener noreffer">官网</a></p>
<h3 id="15安装mysql">1.5、安装MySQL</h3>
<p><strong>这里建议大家使用压缩版,安装快,方便.不复杂.</strong></p>
<blockquote>
<p>1、软件下载</p>
</blockquote>
<p><a href="https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.19-winx64.zip" target="_blank" rel="noopener noreffer">MySQL5.7 64位下载地址</a></p>
<blockquote>
<p>2、步骤</p>
</blockquote>
<p>1、下载后得到zip压缩包</p>
<p>2、解压到自己想要安装到的目录，本人解压到的是D:\Environment\mysql-5.7.19</p>
<p>3、添加环境变量：我的电脑-&gt;属性-&gt;高级-&gt;环境变</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">选择PATH,在其后面添加: 你的mysql 安装文件下面的bin文件夹
</code></pre></td></tr></table>
</div>
</div><p>4、编辑 my.ini 文件 ,注意替换路径位置</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">[mysqld] 
basedir=D:\Program Files\mysql-5.7\
datadir=D:\Program Files\mysql-5.7\data\ 
port=3306 
skip-grant-tables
</code></pre></td></tr></table>
</div>
</div><p>5、启动管理员模式下的CMD，并将路径切换至mysql下的bin目录，然后输入<code>mysqld –install</code> (安装 mysql)</p>
<p>6、再输入<code>mysqld --initialize-insecure --user=mysql</code>初始化数据文件</p>
<p>7、然后再次启动mysql 然后用命令 <code>mysql –u root –p</code> 进入mysql管理界面（密码可为空）</p>
<p>8、进入界面后更改root密码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">update mysql.user set authentication_string=password(&#39;xn123456&#39;) where user=&#39;root&#39; and Host = &#39;localhost&#39;;
</code></pre></td></tr></table>
</div>
</div><p>9、刷新权限</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">flush privileges;
</code></pre></td></tr></table>
</div>
</div><p>10、修改 my.ini文件删除最后一句skip-grant-tables</p>
<p>11、重启mysql即可正常使用</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">net stop mysql 
net start mysql
</code></pre></td></tr></table>
</div>
</div><p>12、连接上测试出现以下结果就安装好了</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822201243.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822201243.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822201243.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822201243.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822201243.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822201243.png" /></p>
<p>一步步去做 , 理论上是没有任何问题的 .</p>
<p>如果以前装过,现在需要重装,一定要将环境清理干净 .</p>
<p>好了,到这里大家都装好了,因为刚接触,所以我们先不学习命令.</p>
<p>这里给大家推荐一个工具 : <strong>SQLyog</strong> .</p>
<p>即便有了可视化工具,可是基本的DOS命名大家还是要记住!</p>
<h3 id="16sqlyog">1.6、SQLyog</h3>
<p>可手动操作,管理MySQL数据库的软件工具
<strong>特点 : 简洁 , 易用 , 图形化</strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822201846.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822201846.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822201846.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822201846.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822201846.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822201846.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822201905.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822201905.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822201905.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822201905.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822201905.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822201905.png" /></p>
<p>使用SQLyog管理工具自己完成以下操作 :</p>
<ul>
<li>连接本地MySQL数据库</li>
<li>新建MySchool数据库
<ul>
<li>数据库名称MySchool</li>
<li>新建数据库表(grade)
<ul>
<li>字段
<ul>
<li>GradeID : int(11) , Primary Key (pk)</li>
<li>GradeName : varchar(50)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>在历史记录中可以看到相对应的数据库操作的语句 .</p>
<h3 id="17连接数据库">1.7、连接数据库</h3>
<p>打开MySQL命令窗口</p>
<ul>
<li>在DOS命令行窗口进入 <strong>安装目录\mysql\bin</strong></li>
<li>可设置环境遍历，设置了环境变量，可以在任意目录打开！</li>
</ul>
<p>连接数据库语句：<code>mysql -h 服务器主机地址 -u 用户名 -p 用户密码</code></p>
<pre><code>注意 : -p后面不能加空格,否则会被当做密码的内容,导致登录失败 !
</code></pre>
<p><strong>几个基本的数据库操作命令</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">update</span> <span class="k">user</span> <span class="k">set</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">(</span><span class="s1">&#39;123456&#39;</span><span class="p">)</span><span class="k">where</span> <span class="k">user</span><span class="o">=</span><span class="s1">&#39;root&#39;</span><span class="p">;</span> <span class="err">修改密码</span>
<span class="n">flush</span> <span class="k">privileges</span><span class="p">;</span> <span class="err">刷新数据库</span>
<span class="k">show</span> <span class="n">databases</span><span class="p">;</span> <span class="err">显示所有数据库</span>
<span class="n">use</span> <span class="n">dbname</span><span class="err">；</span> <span class="err">打开某个数据库</span>
<span class="k">show</span> <span class="n">tables</span><span class="p">;</span> <span class="err">显示数据库</span><span class="n">mysql中所有的表</span>
<span class="k">describe</span> <span class="k">user</span><span class="p">;</span> <span class="err">显示表</span><span class="n">mysql数据库中user表的列信息</span>
<span class="k">create</span> <span class="k">database</span> <span class="n">name</span><span class="p">;</span> <span class="err">创建数据库</span>
<span class="n">use</span> <span class="n">databasename</span><span class="p">;</span> <span class="err">选择数据库</span>
<span class="n">exit</span><span class="p">;</span> <span class="err">退出</span><span class="n">Mysql</span>
<span class="o">?</span> <span class="err">命令关键词</span> <span class="p">:</span> <span class="err">寻求帮助</span>
<span class="c1">-- 表示注释
</span></code></pre></td></tr></table>
</div>
</div><h2 id="2操作数据库">2、操作数据库</h2>
<h3 id="21结构化查询语句分类">2.1、结构化查询语句分类</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822202503.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822202503.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822202503.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822202503.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822202503.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822202503.png" /></p>
<h3 id="22数据库操作">2.2、数据库操作</h3>
<blockquote>
<p>命令行操作数据库</p>
</blockquote>
<p>创建数据库 :<code>create database [if not exists] 数据库名;</code></p>
<p>删除数据库 : <code>drop database [if exists] 数据库名; </code></p>
<p>查看数据库 : <code>show databases;</code></p>
<p>使用数据库 : <code>use 数据库名;</code></p>
<blockquote>
<p>对比工具操作数据库</p>
</blockquote>
<p><strong>学习方法：</strong></p>
<ul>
<li>对照SQLyog工具自动生成的语句学习</li>
<li>固定语法中的单词需要记忆</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822202734.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822202734.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822202734.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822202734.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822202734.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822202734.png" /></p>
<h3 id="23创建数据表">2.3、创建数据表</h3>
<p>属于DDL的一种语法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">create</span> <span class="k">table</span> <span class="p">[</span><span class="k">if</span> <span class="k">not</span> <span class="k">exists</span><span class="p">]</span> <span class="o">`</span><span class="err">表名</span><span class="o">`</span><span class="p">(</span>
<span class="s1">&#39;字段名1&#39;</span> <span class="err">列类型</span> <span class="p">[</span><span class="err">属性</span><span class="p">][</span><span class="err">索引</span><span class="p">][</span><span class="err">注释</span><span class="p">],</span>
<span class="s1">&#39;字段名2&#39;</span> <span class="err">列类型</span> <span class="p">[</span><span class="err">属性</span><span class="p">][</span><span class="err">索引</span><span class="p">][</span><span class="err">注释</span><span class="p">],</span>
<span class="o">#</span><span class="p">...</span>
<span class="s1">&#39;字段名n&#39;</span> <span class="err">列类型</span> <span class="p">[</span><span class="err">属性</span><span class="p">][</span><span class="err">索引</span><span class="p">][</span><span class="err">注释</span><span class="p">]</span>
<span class="p">)[</span><span class="err">表类型</span><span class="p">][</span><span class="err">表字符集</span><span class="p">][</span><span class="err">注释</span><span class="p">];</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>说明</strong> : 反引号用于区别MySQL保留字与普通字符而引入的 (键盘esc下面的键)</p>
<h3 id="24数据值和列类型">2.4、数据值和列类型</h3>
<p>列类型：规定数据库中该列存放的数据类型</p>
<blockquote>
<p>数值类型</p>
</blockquote>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822203751.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822203751.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822203751.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822203751.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822203751.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822203751.png" /></p>
<blockquote>
<p>字符串类型</p>
</blockquote>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822203815.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822203815.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822203815.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822203815.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822203815.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822203815.png" /></p>
<blockquote>
<p>日期和时间型数值类型</p>
</blockquote>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822203848.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822203848.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822203848.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822203848.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822203848.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822203848.png" /></p>
<blockquote>
<p>NULL值</p>
</blockquote>
<ul>
<li>理解为&quot;没有值&quot;或&quot;未知值&quot;</li>
<li>不要用NULL进行算术运算，结果仍为NULL</li>
</ul>
<h3 id="25数据字段属性">2.5、数据字段属性</h3>
<p><strong>UnSigned</strong></p>
<ul>
<li>无符号的</li>
<li>声明该数据列不允许负数 .</li>
</ul>
<p><strong>ZEROFILL</strong></p>
<ul>
<li>0填充的</li>
<li>不足位数的用0来填充 , 如int(3),5则为005</li>
</ul>
<p><strong>Auto_InCrement</strong></p>
<ul>
<li>自动增长的 , 每添加一条数据 , 自动在上一个记录数上加 1(默认)</li>
<li>通常用于设置主键 , 且为整数类型</li>
<li>可定义起始值和步长
<ul>
<li>当前表设置步长(AUTO_INCREMENT=100) : 只影响当前表</li>
<li>SET @@auto_increment_increment=5 ; 影响所有使用自增的表(全局)</li>
</ul>
</li>
</ul>
<p><strong>NULL 和 NOT NULL</strong></p>
<ul>
<li>默认为NULL , 即没有插入该列的数值</li>
<li>如果设置为NOT NULL , 则该列必须有值</li>
</ul>
<p><strong>DEFAULT</strong></p>
<ul>
<li>默认的</li>
<li>用于设置默认值</li>
<li>例如,性别字段,默认为&quot;男&quot; , 否则为 &ldquo;女&rdquo; ; 若无指定该列的值 , 则默认值为&quot;男&quot;的值</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- 目标 : 创建一个school数据库
</span><span class="c1">-- 创建学生表(列,字段)
</span><span class="c1">-- 学号int 登录密码varchar(20) 姓名,性别varchar(2),出生日期(datatime),家庭住址,email
</span><span class="c1">-- 创建表之前 , 一定要先选择数据库
</span><span class="c1"></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="k">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="o">`</span><span class="n">student</span><span class="o">`</span> <span class="p">(</span>
<span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="nb">int</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span> <span class="k">COMMENT</span> <span class="s1">&#39;学号&#39;</span><span class="p">,</span>
<span class="o">`</span><span class="n">name</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">DEFAULT</span> <span class="s1">&#39;匿名&#39;</span> <span class="k">COMMENT</span> <span class="s1">&#39;姓名&#39;</span><span class="p">,</span>
<span class="o">`</span><span class="n">pwd</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">DEFAULT</span> <span class="s1">&#39;123456&#39;</span> <span class="k">COMMENT</span> <span class="s1">&#39;密码&#39;</span><span class="p">,</span>
<span class="o">`</span><span class="n">sex</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">DEFAULT</span> <span class="s1">&#39;男&#39;</span> <span class="k">COMMENT</span> <span class="s1">&#39;性别&#39;</span><span class="p">,</span>
<span class="o">`</span><span class="n">birthday</span><span class="o">`</span> <span class="n">datetime</span> <span class="k">DEFAULT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">&#39;生日&#39;</span><span class="p">,</span>
<span class="o">`</span><span class="n">address</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">&#39;地址&#39;</span><span class="p">,</span>
<span class="o">`</span><span class="n">email</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">&#39;邮箱&#39;</span><span class="p">,</span>
<span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">)</span>
<span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="k">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8</span>
<span class="c1">-- 查看数据库的定义
</span><span class="c1"></span><span class="k">SHOW</span> <span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">school</span><span class="p">;</span>
<span class="c1">-- 查看数据表的定义
</span><span class="c1"></span><span class="k">SHOW</span> <span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">student</span><span class="p">;</span>
<span class="c1">-- 显示表结构
</span><span class="c1"></span><span class="k">DESC</span> <span class="n">student</span><span class="p">;</span> <span class="c1">-- 设置严格检查模式(不能容错了)
</span><span class="c1"></span><span class="k">SET</span> <span class="n">sql_mode</span><span class="o">=</span><span class="s1">&#39;STRICT_TRANS_TABLES&#39;</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="26数据表的类型">2.6、数据表的类型</h3>
<blockquote>
<p>设置数据表的类型</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="err">表名</span><span class="p">(</span>
<span class="c1">-- 省略一些代码
</span><span class="c1">-- Mysql注释
</span><span class="c1">-- 1. # 单行注释
</span><span class="c1">-- 2. /*...*/ 多行注释
</span><span class="c1"></span><span class="p">)</span><span class="n">ENGINE</span> <span class="o">=</span> <span class="n">MyISAM</span> <span class="p">(</span><span class="k">or</span> <span class="n">InnoDB</span><span class="p">)</span>

<span class="c1">-- 查看mysql所支持的引擎类型 (表类型)
</span><span class="c1"></span><span class="k">SHOW</span> <span class="n">ENGINES</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>MySQL的数据表的类型 : <strong>MyISAM</strong> , <strong>InnoDB</strong> , HEAP , BOB , CSV等&hellip;</p>
<p>常见的 MyISAM 与 InnoDB 类型：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822204628.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822204628.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822204628.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822204628.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822204628.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822204628.png" /></p>
<p>经验(使用场合)：</p>
<ul>
<li>使用M有ISAM：节约空间及相应速度</li>
<li>使用InnoDB：安全性，事务性及多用户操作数据表</li>
</ul>
<blockquote>
<p>数据表的存储位置</p>
</blockquote>
<ul>
<li>MySQL数据表以文件方式存放在磁盘中
<ul>
<li>包括表文件，数据文件，以及数据库的选项文件</li>
<li>位置：Mysql安装目录\data\下存放数据表 . 目录名对应数据库名 , 该目录下文件名对应数据表</li>
</ul>
</li>
<li>注意：
<ul>
<li>InnoDB类型数据表只有一个*.frm文件，以及上一级目录的ibdata1文件</li>
<li>MyISAM类型数据表对应三个文件：
<ul>
<li>*.frm &ndash;表结构定义文件</li>
<li>*.MYD &ndash;数据文件(data)</li>
<li>*.MYI &ndash;索引文件(index)</li>
<li><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822205055.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822205055.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822205055.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822205055.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822205055.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210822205055.png" /></li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>设置数据表字符集</p>
</blockquote>
<p>我们可谓护具看，数据表，数据列设置不同的字符集，设定方法；</p>
<ul>
<li>创建时通过命令来设置，如：<code>CREATE TABLE 表名()CHARSET = utf8;</code></li>
<li>如果没有设置，则根据MySQL数据库配置文件<code>my.ini</code>中的参数设定</li>
</ul>
<h3 id="27修改数据库">2.7、修改数据库</h3>
<blockquote>
<p>修改表（ALTER ＴABLE）</p>
</blockquote>
<p>修改表名：<code>ALTER TABLE 旧表名 RENAME AS 新表名</code></p>
<p>添加字段 :  <code>ALTER TABLE 表名 ADD字段名 列属性[属性]</code></p>
<p>修改字段 :</p>
<ul>
<li><code>ALTER TABLE 表名 MODIFY 字段名 列类型[属性]</code></li>
<li><code>ALTER TABLE 表名 CHANGE 旧字段名 新字段名 列属性[属性]</code></li>
</ul>
<p>删除字段 : <code>ALTER TABLE 表名 DROP 字段名</code></p>
<blockquote>
<p>删除数据表</p>
</blockquote>
<p>语法： <code>DROP TABLE [IF EXISTS] 表名</code></p>
<ul>
<li><code>IF EXISTS</code>为可选 , 判断是否存在该数据表</li>
<li>如删除不存在的数据表会抛出错误</li>
</ul>
<blockquote>
<p>其它</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="mi">1</span><span class="p">.</span> <span class="err">可用反引号（</span><span class="o">`</span><span class="err">）为标识符（库名、表名、字段名、索引、别名）包裹，以避免与关键字重名！中文也可以作为标识符！</span>

<span class="mi">2</span><span class="p">.</span> <span class="err">每个库目录存在一个保存当前数据库的选项文件</span><span class="n">db</span><span class="p">.</span><span class="n">opt</span><span class="err">。</span>

<span class="mi">3</span><span class="p">.</span> <span class="err">注释：</span>
		<span class="err">单行注释</span> <span class="o">#</span> <span class="err">注释内容</span>
		<span class="err">多行注释</span> <span class="cm">/* 注释内容 */</span>
		<span class="err">单行注释</span> <span class="c1">-- 注释内容 (标准SQL注释风格，要求双破折号后加一空格符（空格、TAB、换行等）)
</span><span class="c1"></span>		
<span class="mi">4</span><span class="p">.</span> <span class="err">模式通配符：</span>
		<span class="n">_</span> <span class="err">任意单个字符</span>
		<span class="o">%</span> <span class="err">任意多个字符，甚至包括零字符</span>
		<span class="err">单引号需要进行转义</span> <span class="err">\</span><span class="s1">&#39;
</span><span class="s1">		
</span><span class="s1">5. CMD命令行内的语句结束符可以为 &#34;;&#34;, &#34;\G&#34;, &#34;\g&#34;，仅影响显示结果。其他地方还是用分号结束。delimiter 可修改当前对话的语句结束符。
</span><span class="s1">
</span><span class="s1">6. SQL对大小写不敏感 （关键字）
</span><span class="s1">
</span><span class="s1">7. 清除已有语句：\c
</span></code></pre></td></tr></table>
</div>
</div><h2 id="3mysql数据管理">3、MySQL数据管理</h2>
<h3 id="31外键">3.1、外键</h3>
<blockquote>
<p>外键概念</p>
</blockquote>
<p>如果公共关键字在一个关系中是主关键字，那么这个公共关键字被称为另一个关系的外键。由此可见， 外键表示了两个关系之间的相关联系。以另一个关系的外键作主关键字的表被称为<strong>主表</strong>，具有此外键的 表被称为主表的<strong>从表</strong>。</p>
<p>在实际操作中，将一个表的值放入第二个表来表示关联，所使用的值是第一个表的主键值(在必要时可包括复合主键值)。此时，第二个表中保存这些值的属性称为外键(<strong>foreign key</strong>)。</p>
<p><strong>外键作用</strong></p>
<p>保持数据<strong>一致性</strong>，<strong>完整性</strong>，主要目的是控制存储在外键表中的数据,<strong>约束</strong>。 使两张表形成关联，外键只能 引用外表中的列的值或使用空值。</p>
<blockquote>
<p>创建外键</p>
</blockquote>
<p>建表时指定外键约束</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- 创建外键的方式一 : 创建子表同时创建外键
</span><span class="c1"></span>
<span class="c1">-- 年级表 (id\年级名称)
</span><span class="c1"></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">grade</span><span class="o">`</span> <span class="p">(</span>
	<span class="o">`</span><span class="n">gradeid</span><span class="o">`</span> <span class="nb">INT</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span> <span class="k">COMMENT</span> <span class="s1">&#39;年级ID&#39;</span><span class="p">,</span>
	<span class="o">`</span><span class="n">gradename</span><span class="o">`</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">&#39;年级名称&#39;</span><span class="p">,</span>
	<span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="o">`</span><span class="n">gradeid</span><span class="o">`</span><span class="p">)</span>
<span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">INNODB</span> <span class="k">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8</span>

<span class="c1">-- 学生信息表 (学号,姓名,性别,年级,手机,地址,出生日期,邮箱,身份证号)
</span><span class="c1"></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">student</span><span class="o">`</span> <span class="p">(</span>
	<span class="o">`</span><span class="n">studentno</span><span class="o">`</span> <span class="nb">INT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">&#39;学号&#39;</span><span class="p">,</span>
	<span class="o">`</span><span class="n">studentname</span><span class="o">`</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">DEFAULT</span> <span class="s1">&#39;匿名&#39;</span> <span class="k">COMMENT</span> <span class="s1">&#39;姓名&#39;</span><span class="p">,</span>
	<span class="o">`</span><span class="n">sex</span><span class="o">`</span> <span class="n">TINYINT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="s1">&#39;1&#39;</span> <span class="k">COMMENT</span> <span class="s1">&#39;性别&#39;</span><span class="p">,</span>
	<span class="o">`</span><span class="n">gradeid</span><span class="o">`</span> <span class="nb">INT</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">&#39;年级&#39;</span><span class="p">,</span>
	<span class="o">`</span><span class="n">phoneNum</span><span class="o">`</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">&#39;手机&#39;</span><span class="p">,</span>
	<span class="o">`</span><span class="n">address</span><span class="o">`</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">&#39;地址&#39;</span><span class="p">,</span>
	<span class="o">`</span><span class="n">borndate</span><span class="o">`</span> <span class="n">DATETIME</span> <span class="k">DEFAULT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">&#39;生日&#39;</span><span class="p">,</span>
	<span class="o">`</span><span class="n">email</span><span class="o">`</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">&#39;邮箱&#39;</span><span class="p">,</span>
	<span class="o">`</span><span class="n">idCard</span><span class="o">`</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">&#39;身份证号&#39;</span><span class="p">,</span>
	<span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="o">`</span><span class="n">studentno</span><span class="o">`</span><span class="p">),</span>
	<span class="k">KEY</span> <span class="o">`</span><span class="n">FK_gradeid</span><span class="o">`</span> <span class="p">(</span><span class="o">`</span><span class="n">gradeid</span><span class="o">`</span><span class="p">),</span>
	<span class="k">CONSTRAINT</span> <span class="o">`</span><span class="n">FK_gradeid</span><span class="o">`</span> <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="p">(</span><span class="o">`</span><span class="n">gradeid</span><span class="o">`</span><span class="p">)</span> <span class="k">REFERENCES</span> <span class="o">`</span><span class="n">grade</span><span class="o">`</span><span class="p">(</span><span class="o">`</span><span class="n">gradeid</span><span class="o">`</span><span class="p">)</span>
<span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">INNODB</span> <span class="k">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8</span>

<span class="c1">-- 创建外键方式二 : 创建子表完毕后,修改子表添加外键 
</span><span class="c1"></span><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">student</span><span class="o">`</span> <span class="k">ADD</span> <span class="k">CONSTRAINT</span> <span class="o">`</span><span class="n">FK_gradeid</span><span class="o">`</span> <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="p">(</span><span class="o">`</span><span class="n">gradeid</span><span class="o">`</span><span class="p">)</span> <span class="k">REFERENCES</span> <span class="o">`</span><span class="n">grade</span><span class="o">`</span><span class="p">(</span><span class="o">`</span><span class="n">gradeid</span><span class="o">`</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>删除外键</p>
</blockquote>
<p>操作：删除grade表，发现报错</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823105534.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823105534.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823105534.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823105534.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823105534.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823105534.png" /></p>
<p><strong>注意</strong>：删除具有主外键关系的表时，要先删子表，后删主表</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- 删除外键
</span><span class="c1"></span><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">student</span> <span class="k">DROP</span> <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="n">FK_gradeid</span><span class="p">;</span>
<span class="c1">-- 发现执行完上面的,索引还在,所以还要删除索引
</span><span class="c1">-- 注:这个索引是建立外键的时候默认生成的
</span><span class="c1"></span><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">student</span> <span class="k">DROP</span> <span class="k">INDEX</span> <span class="n">FK_gradeid</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="32dml语言">3.2、DML语言</h3>
<p><strong>数据库意义</strong>：数据存储、数据管理</p>
<p><strong>管理数据库数据方法</strong>：</p>
<ul>
<li>通过SQLyog等管理工具管理数据库数据</li>
<li>通过<strong>DML语句</strong>管理数据库数据</li>
</ul>
<p><strong>DML语言</strong>：数据操作语言</p>
<ul>
<li>用于操作数据库对象中所包含的数据</li>
<li>包括
<ul>
<li>INSERT(添加数据语句)</li>
<li>UPDATE(更新数据语句)</li>
<li>DELETE(删除数据语句)</li>
</ul>
</li>
</ul>
<h3 id="33添加数据">3.3、添加数据</h3>
<blockquote>
<p>INSERT 命令</p>
</blockquote>
<p><strong>语法</strong>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">INSERT</span> <span class="k">INTO</span> <span class="err">表名</span><span class="p">[(</span><span class="err">字段</span><span class="mi">1</span><span class="p">,</span><span class="err">字段</span><span class="mi">2</span><span class="p">,</span><span class="err">字段</span><span class="mi">3</span><span class="p">,...)]</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">&#39;值1&#39;</span><span class="p">,</span><span class="s1">&#39;值2&#39;</span><span class="p">,</span><span class="s1">&#39;值3&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>注意：</p>
<ul>
<li>字段或值之间使用英文逗号隔开。</li>
<li>&lsquo;字段1,字段2,字段3&rsquo;该部分可省略，但添加的值无比与表结构，数据列，顺序相对应，且数量一致</li>
<li>可同时插入多条数据，values后用英文逗号隔开</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- 使用语句如何增加语句?
</span><span class="c1">-- 语法 : INSERT INTO 表名[(字段1,字段2,字段3,...)] VALUES(&#39;值1&#39;,&#39;值2&#39;,&#39;值3&#39;)
</span><span class="c1"></span><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">grade</span><span class="p">(</span><span class="n">gradename</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">&#39;大一&#39;</span><span class="p">);</span>

<span class="c1">-- 主键自增,那能否省略呢?
</span><span class="c1"></span><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">grade</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">&#39;大二&#39;</span><span class="p">);</span>

<span class="c1">-- 查询:INSERT INTO grade VALUE (&#39;大二&#39;)错误代码： 1136
</span><span class="c1"></span><span class="k">Column</span> <span class="k">count</span> <span class="n">doesn</span><span class="o">`</span><span class="n">t</span> <span class="k">match</span> <span class="n">value</span> <span class="k">count</span> <span class="k">at</span> <span class="k">row</span> <span class="mi">1</span>

<span class="c1">-- 结论:&#39;字段1,字段2...&#39;该部分可省略 , 但添加的值务必与表结构,数据列,顺序相对应,且数量一致.
</span><span class="c1"></span>
<span class="c1">-- 一次插入多条数据
</span><span class="c1"></span><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">grade</span><span class="p">(</span><span class="n">gradename</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">&#39;大三&#39;</span><span class="p">),(</span><span class="s1">&#39;大四&#39;</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="34修改数据">3.4、修改数据</h3>
<blockquote>
<p>update命令</p>
</blockquote>
<p>语法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">UPDATE</span> <span class="err">表名</span> <span class="k">SET</span> <span class="k">column_name</span><span class="o">=</span><span class="n">value</span> <span class="p">[,</span><span class="n">column_name2</span><span class="o">=</span><span class="n">value2</span><span class="p">,...]</span> <span class="p">[</span><span class="k">WHERE</span> <span class="n">condition</span><span class="p">];</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>注意</strong>：</p>
<ul>
<li>column_name韋要更改的数据列</li>
<li>value为修改后的数据，可以为变量，具体指表达式或者嵌套的SELECT结果</li>
<li>condition为筛选条件，如不指定则修改该表的所有列数据</li>
</ul>
<blockquote>
<p>where条件子句</p>
</blockquote>
<p>可以简单的理解为：有条件的从表中筛选数据</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823110852.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823110852.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823110852.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823110852.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823110852.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823110852.png" /></p>
<p>测试：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- 修改年级信息
</span><span class="c1"></span><span class="k">UPDATE</span> <span class="n">grade</span> <span class="k">SET</span> <span class="n">gradename</span> <span class="o">=</span> <span class="s1">&#39;高中&#39;</span> <span class="k">WHERE</span> <span class="n">gradeid</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="35删除数据">3.5、删除数据</h3>
<blockquote>
<p>DELETE命令</p>
</blockquote>
<p>语法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">DELETE</span> <span class="k">FROM</span> <span class="err">表名</span> <span class="p">[</span><span class="k">WHERE</span> <span class="n">condition</span><span class="p">];</span>
</code></pre></td></tr></table>
</div>
</div><p>注意：condition为筛选条件，如不指定则删除该表的所有列数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- 删除最后一个数据 
</span><span class="c1"></span><span class="k">DELETE</span> <span class="k">FROM</span> <span class="n">grade</span> <span class="k">WHERE</span> <span class="n">gradeid</span> <span class="o">=</span> <span class="mi">5</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>TRUNCATE命令</p>
</blockquote>
<p>作用：用于完全清空表数据，但表结构，索引，约束等不变；</p>
<p>语法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">TRUNCATE</span> <span class="p">[</span><span class="k">TABLE</span><span class="p">]</span> <span class="k">table_name</span><span class="p">;</span> 

<span class="c1">-- 清空年级表 
</span><span class="c1"></span><span class="k">TRUNCATE</span> <span class="n">grade</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>注意：区别于DELETE命令</strong></p>
<ul>
<li>相同：都能删除数据，不删除表结构，但TRUNCATE速度更快</li>
<li>不同：
<ul>
<li>使用TRUNCATE TABLE 重新设置 AUTO_INCREMENT计数器</li>
<li>使用TRUNCATE TABLE 不会对事务有影响</li>
</ul>
</li>
</ul>
<p>测试：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- 创建一个测试表
</span><span class="c1"></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">test</span><span class="o">`</span> <span class="p">(</span>
	<span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="nb">INT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span><span class="p">,</span>
	<span class="o">`</span><span class="n">coll</span><span class="o">`</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
	<span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">)</span>
<span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">INNODB</span> <span class="k">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8</span>

<span class="c1">-- 插入几个测试数据
</span><span class="c1"></span><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">test</span><span class="p">(</span><span class="n">coll</span><span class="p">)</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">&#39;row1&#39;</span><span class="p">),(</span><span class="s1">&#39;row2&#39;</span><span class="p">),(</span><span class="s1">&#39;row3&#39;</span><span class="p">);</span>

<span class="c1">-- 删除表数据(不带where条件的delete)
</span><span class="c1"></span><span class="k">DELETE</span> <span class="k">FROM</span> <span class="n">test</span><span class="p">;</span>
<span class="c1">-- 结论:如不指定Where则删除该表的所有列数据,自增当前值依然从原来基础上进行,会记录日志.
</span><span class="c1"></span>
<span class="c1">-- 删除表数据(truncate)
</span><span class="c1"></span><span class="k">TRUNCATE</span> <span class="k">TABLE</span> <span class="n">test</span><span class="p">;</span>
<span class="c1">-- 结论:truncate删除数据,自增当前值会恢复到初始值重新开始;不会记录日志.
</span><span class="c1"></span>
<span class="c1">-- 同样使用DELETE清空不同引擎的数据库表数据.重启数据库服务后
</span><span class="c1">-- InnoDB : 自增列从初始值重新开始 (因为是存储在内存中,断电即失)
</span><span class="c1">-- MyISAM : 自增列依然从上一个自增数据基础上开始 (存在文件中,不会丢失)
</span></code></pre></td></tr></table>
</div>
</div><h2 id="4使用dql查询数据">4、使用DQL查询数据</h2>
<h3 id="41dql语言">4.1、DQL语言</h3>
<p>**DQL( Data Query Language 数据查询语言 ) **</p>
<ul>
<li>查询数据库数据 , 如<strong>SELECT</strong>语句</li>
<li>简单的单表查询或多表的复杂查询和嵌套查询</li>
<li>是数据库语言中最核心,最重要的语句</li>
<li>使用频率最高的语句</li>
</ul>
<blockquote>
<p>SELECT语法</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="p">[</span><span class="k">ALL</span> <span class="o">|</span> <span class="k">DISTINCT</span><span class="p">]</span>
<span class="err">{</span><span class="o">*</span> <span class="o">|</span> <span class="k">table</span><span class="p">.</span><span class="o">*</span> <span class="o">|</span> <span class="p">[</span><span class="k">table</span><span class="p">.</span><span class="n">field1</span><span class="p">[</span><span class="k">as</span> <span class="n">alias1</span><span class="p">][,</span><span class="k">table</span><span class="p">.</span><span class="n">field2</span><span class="p">[</span><span class="k">as</span> <span class="n">alias2</span><span class="p">]][,...]]</span><span class="err">}</span>
<span class="k">FROM</span> <span class="k">table_name</span> <span class="p">[</span><span class="k">as</span> <span class="n">table_alias</span><span class="p">]</span>
		<span class="p">[</span><span class="k">left</span> <span class="o">|</span> <span class="k">right</span> <span class="o">|</span> <span class="k">inner</span> <span class="k">join</span> <span class="n">table_name2</span><span class="p">]</span> <span class="c1">-- 联合查询
</span><span class="c1"></span>		<span class="p">[</span><span class="k">WHERE</span> <span class="p">...]</span> <span class="c1">-- 指定结果需满足的条件
</span><span class="c1"></span>		<span class="p">[</span><span class="k">GROUP</span> <span class="k">BY</span> <span class="p">...]</span> <span class="c1">-- 指定结果按照哪几个字段来分组
</span><span class="c1"></span>		<span class="p">[</span><span class="k">HAVING</span><span class="p">]</span> <span class="c1">-- 过滤分组的记录必须满足的次要条件
</span><span class="c1"></span>		<span class="p">[</span><span class="k">ORDER</span> <span class="k">BY</span> <span class="p">...]</span> <span class="c1">-- 指定查询记录按一个或多个条件排序
</span><span class="c1"></span>		<span class="p">[</span><span class="k">LIMIT</span> <span class="err">{</span><span class="p">[</span><span class="k">offset</span><span class="p">,]</span><span class="k">row_count</span> <span class="o">|</span> <span class="n">row_countOFFSET</span> <span class="k">offset</span><span class="err">}</span><span class="p">];</span>
		<span class="c1">-- 指定查询的记录从哪条至哪条
</span></code></pre></td></tr></table>
</div>
</div><p><strong>注意 : [ ] 括号代表可选的 , { }括号代表必选得</strong></p>
<h3 id="42指定查询字段">4.2、指定查询字段</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- 查询表中所有的数据列结果 , 采用 **&#34; \* &#34;** 符号; 但是效率低，不推荐 .
</span><span class="c1"></span>
<span class="c1">-- 查询所有学生信息
</span><span class="c1"></span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">student</span><span class="p">;</span>

<span class="c1">-- 查询指定列(学号 , 姓名)
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">studentno</span><span class="p">,</span><span class="n">studentname</span> <span class="k">FROM</span> <span class="n">student</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>AS子句作为别名</p>
</blockquote>
<p>作用：</p>
<ul>
<li>可以给数据列取一个新别名</li>
<li>可给表去一个新别名</li>
<li>可把经计算或总结的结果用另一个新名称来代替</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- 这里是为列取别名(当然as关键词可以省略)
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">studentno</span> <span class="k">AS</span> <span class="err">学号</span><span class="p">,</span><span class="n">studentname</span> <span class="k">AS</span> <span class="err">姓名</span> <span class="k">FROM</span> <span class="n">student</span><span class="p">;</span>

<span class="c1">-- 使用as也可以为表取别名
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">studentno</span> <span class="k">AS</span> <span class="err">学号</span><span class="p">,</span><span class="n">studentname</span> <span class="k">AS</span> <span class="err">姓名</span> <span class="k">FROM</span> <span class="n">student</span> <span class="k">AS</span> <span class="n">s</span><span class="p">;</span>

<span class="c1">-- 使用as,为查询结果取一个新名字
</span><span class="c1">-- CONCAT()函数拼接字符串
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">CONCAT</span><span class="p">(</span><span class="s1">&#39;姓名:&#39;</span><span class="p">,</span><span class="n">studentname</span><span class="p">)</span> <span class="k">AS</span> <span class="err">新姓名</span> <span class="k">FROM</span> <span class="n">student</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>DISTINCT关键字的使用</p>
</blockquote>
<p>作用 : 去掉SELECT查询返回的记录结果中重复的记录 ( 返回所有列的值都相同 ) , 只返回一条</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- 查看哪些同学参加了考试(学号) 去除重复项 
</span><span class="c1"></span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">result</span><span class="p">;</span> <span class="c1">-- 查看考试成绩 
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">studentno</span> <span class="k">FROM</span> <span class="k">result</span><span class="p">;</span> <span class="c1">-- 查看哪些同学参加了考试 
</span><span class="c1"></span><span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">studentno</span> <span class="k">FROM</span> <span class="k">result</span><span class="p">;</span> <span class="c1">-- 了解:DISTINCT 去除重复项 , (默认是ALL)
</span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>使用表达式的列</p>
</blockquote>
<p><strong>数据库中的表达式：一般由文本值，列值，NULL，函数和操作符等组成</strong></p>
<p>应用场景：</p>
<ul>
<li>SELECT语句返回结果列中使用</li>
<li>SELECT语句中的ORDER　BY，HAVING等子句中使用</li>
<li>DML语句中的where条件语句中使用表达式</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- selcet查询中可以使用表达式
</span><span class="c1"></span><span class="k">SELECT</span> <span class="o">@@</span><span class="n">auto_increment_increment</span><span class="p">;</span> <span class="c1">-- 查询自增步长
</span><span class="c1"></span><span class="k">SELECT</span> <span class="k">VERSION</span><span class="p">();</span> <span class="c1">-- 查询版本号
</span><span class="c1"></span><span class="k">SELECT</span> <span class="mi">100</span><span class="o">*</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span> <span class="k">AS</span> <span class="err">计算结果</span><span class="p">;</span> <span class="c1">-- 表达式
</span><span class="c1"></span>
<span class="c1">-- 学员考试成绩集体提分一分查看
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">studentno</span><span class="p">,</span><span class="n">StudentResult</span><span class="o">+</span><span class="mi">1</span> <span class="k">AS</span> <span class="s1">&#39;提分后&#39;</span> <span class="k">FROM</span> <span class="k">result</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>避免SQL返回结果中包含 ' . ' , ' * ' 和括号等干扰开发语言程序.</li>
</ul>
<h3 id="43where条件语句">4.3、where条件语句</h3>
<p>作用：用于检索数据表中符合条件的记录</p>
<p>搜索条件可由一个或多个逻辑表达式组成，结果一般为真或假</p>
<blockquote>
<p>逻辑操作符</p>
</blockquote>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161005.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161005.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161005.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161005.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161005.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161005.png" /></p>
<p>测试：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- 满足条件的查询(where)
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">Studentno</span><span class="p">,</span><span class="n">StudentResult</span> <span class="k">FROM</span> <span class="k">result</span><span class="p">;</span>

<span class="c1">-- 查询考试成绩在95-100之间的
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">Studentno</span><span class="p">,</span><span class="n">StudentResult</span>
<span class="k">FROM</span> <span class="k">result</span>
<span class="k">WHERE</span> <span class="n">StudentResult</span><span class="o">&gt;=</span><span class="mi">95</span> <span class="k">AND</span> <span class="n">StudentResult</span><span class="o">&lt;=</span><span class="mi">100</span><span class="p">;</span>

<span class="c1">-- AND也可以写成 &amp;&amp;
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">Studentno</span><span class="p">,</span><span class="n">StudentResult</span>
<span class="k">FROM</span> <span class="k">result</span>
<span class="k">WHERE</span> <span class="n">StudentResult</span><span class="o">&gt;=</span><span class="mi">95</span> <span class="o">&amp;&amp;</span> <span class="n">StudentResult</span><span class="o">&lt;=</span><span class="mi">100</span><span class="p">;</span>

<span class="c1">-- 模糊查询(对应的词:精确查询)
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">Studentno</span><span class="p">,</span><span class="n">StudentResult</span>
<span class="k">FROM</span> <span class="k">result</span>
<span class="k">WHERE</span> <span class="n">StudentResult</span> <span class="k">BETWEEN</span> <span class="mi">95</span> <span class="k">AND</span> <span class="mi">100</span><span class="p">;</span>

<span class="c1">-- 除了1000号同学,要其他同学的成绩
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">studentno</span><span class="p">,</span><span class="n">studentresult</span>
<span class="k">FROM</span> <span class="k">result</span>
<span class="k">WHERE</span> <span class="n">studentno</span><span class="o">!=</span><span class="mi">1000</span><span class="p">;</span>

<span class="c1">-- 使用NOT
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">studentno</span><span class="p">,</span><span class="n">studentresult</span>
<span class="k">FROM</span> <span class="k">result</span>
<span class="k">WHERE</span> <span class="k">NOT</span> <span class="n">studentno</span><span class="o">=</span><span class="mi">1000</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>模糊查询：比较操作符</p>
</blockquote>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161120.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161120.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161120.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161120.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161120.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161120.png" /></p>
<p>注意：</p>
<ul>
<li>数值数据类型的记录之间才能进行算术运算；</li>
<li>相同数据类型的数据之间才能进行比较；</li>
</ul>
<p>测试：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- 模糊查询 between and \ like \ in \ null
</span><span class="c1"></span>
<span class="c1">-- =============================================
</span><span class="c1">-- LIKE
</span><span class="c1">-- =============================================
</span><span class="c1">-- 查询姓刘的同学的学号及姓名
</span><span class="c1">-- like结合使用的通配符 : % (代表0到任意个字符) _ (一个字符)
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">studentno</span><span class="p">,</span><span class="n">studentname</span> <span class="k">FROM</span> <span class="n">student</span>
<span class="k">WHERE</span> <span class="n">studentname</span> <span class="k">LIKE</span> <span class="s1">&#39;刘%&#39;</span><span class="p">;</span>

<span class="c1">-- 查询姓刘的同学,后面只有一个字的
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">studentno</span><span class="p">,</span><span class="n">studentname</span> <span class="k">FROM</span> <span class="n">student</span>
<span class="k">WHERE</span> <span class="n">studentname</span> <span class="k">LIKE</span> <span class="s1">&#39;刘_&#39;</span><span class="p">;</span>

<span class="c1">-- 查询姓刘的同学,后面只有两个字的
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">studentno</span><span class="p">,</span><span class="n">studentname</span> <span class="k">FROM</span> <span class="n">student</span>
<span class="k">WHERE</span> <span class="n">studentname</span> <span class="k">LIKE</span> <span class="s1">&#39;刘__&#39;</span><span class="p">;</span>

<span class="c1">-- 查询姓名中含有 嘉 字的
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">studentno</span><span class="p">,</span><span class="n">studentname</span> <span class="k">FROM</span> <span class="n">student</span>
<span class="k">WHERE</span> <span class="n">studentname</span> <span class="k">LIKE</span> <span class="s1">&#39;%嘉%&#39;</span><span class="p">;</span>

<span class="c1">-- 查询姓名中含有特殊字符的需要使用转义符号 &#39;\&#39;
</span><span class="c1">-- 自定义转义符关键字: ESCAPE &#39;:&#39;
</span><span class="c1"></span>
<span class="c1">-- =============================================
</span><span class="c1">-- IN
</span><span class="c1">-- =============================================
</span><span class="c1">-- 查询学号为1000,1001,1002的学生姓名
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">studentno</span><span class="p">,</span><span class="n">studentname</span> <span class="k">FROM</span> <span class="n">student</span>
<span class="k">WHERE</span> <span class="n">studentno</span> <span class="k">IN</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1001</span><span class="p">,</span><span class="mi">1002</span><span class="p">);</span>

<span class="c1">-- 查询地址在北京,南京,河南洛阳的学生
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">studentno</span><span class="p">,</span><span class="n">studentname</span><span class="p">,</span><span class="n">address</span> <span class="k">FROM</span> <span class="n">student</span>
<span class="k">WHERE</span> <span class="n">address</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">&#39;北京&#39;</span><span class="p">,</span><span class="s1">&#39;南京&#39;</span><span class="p">,</span><span class="s1">&#39;河南洛阳&#39;</span><span class="p">);</span>

<span class="c1">-- =============================================
</span><span class="c1">-- NULL 空
</span><span class="c1">-- =============================================
</span><span class="c1">-- 查询出生日期没有填写的同学
</span><span class="c1">-- 不能直接写=NULL , 这是代表错误的 , 用 is null
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">studentname</span> <span class="k">FROM</span> <span class="n">student</span>
<span class="k">WHERE</span> <span class="n">BornDate</span> <span class="k">IS</span> <span class="k">NULL</span><span class="p">;</span>

<span class="c1">-- 查询出生日期填写的同学
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">studentname</span> <span class="k">FROM</span> <span class="n">student</span>
<span class="k">WHERE</span> <span class="n">BornDate</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">;</span>

<span class="c1">-- 查询没有写家庭住址的同学(空字符串不等于null)
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">studentname</span> <span class="k">FROM</span> <span class="n">student</span>
<span class="k">WHERE</span> <span class="n">Address</span><span class="o">=</span><span class="s1">&#39;&#39;</span> <span class="k">OR</span> <span class="n">Address</span> <span class="k">IS</span> <span class="k">NULL</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="44连接查询">4.4、连接查询</h3>
<blockquote>
<p>JOIN对比</p>
</blockquote>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161412.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161412.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161412.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161412.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161412.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161412.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161513.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161513.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161513.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161513.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161513.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161513.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161537.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161537.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161537.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161537.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161537.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823161537.png" /></p>
<p>测试：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-SQL" data-lang="SQL"><span class="cm">/*
</span><span class="cm">连接查询
</span><span class="cm">		如需要多张数据表的数据进行查询,则可通过连接运算符实现多个查询
</span><span class="cm">内连接 inner join
</span><span class="cm">		查询两个表中的结果集中的交集
</span><span class="cm">外连接 outer join
</span><span class="cm">		左外连接 left join
</span><span class="cm">		(以左表作为基准,右边表来一一匹配,匹配不上的,返回左表的记录,右表以NULL填充)
</span><span class="cm">		右外连接 right join
</span><span class="cm">		(以右表作为基准,左边表来一一匹配,匹配不上的,返回右表的记录,左表以NULL填充)
</span><span class="cm">等值连接和非等值连接
</span><span class="cm">
</span><span class="cm">自连接
</span><span class="cm">*/</span>
<span class="c1">-- 查询参加了考试的同学信息(学号,学生姓名,科目编号,分数)
</span><span class="c1"></span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">student</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">result</span><span class="p">;</span>

<span class="cm">/*思路:
</span><span class="cm">(1):分析需求,确定查询的列来源于两个类,student result,连接查询
</span><span class="cm">(2):确定使用哪种连接查询?(内连接)
</span><span class="cm">*/</span>
<span class="k">SELECT</span> <span class="n">s</span><span class="p">.</span><span class="n">studentno</span><span class="p">,</span><span class="n">studentname</span><span class="p">,</span><span class="n">subjectno</span><span class="p">,</span><span class="n">StudentResult</span>
<span class="k">FROM</span> <span class="n">student</span> <span class="n">s</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="k">result</span> <span class="n">r</span>
<span class="k">ON</span> <span class="n">r</span><span class="p">.</span><span class="n">studentno</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">studentno</span>

<span class="c1">-- 右连接(也可实现)
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">s</span><span class="p">.</span><span class="n">studentno</span><span class="p">,</span><span class="n">studentname</span><span class="p">,</span><span class="n">subjectno</span><span class="p">,</span><span class="n">StudentResult</span>
<span class="k">FROM</span> <span class="n">student</span> <span class="n">s</span>
<span class="k">RIGHT</span> <span class="k">JOIN</span> <span class="k">result</span> <span class="n">r</span>
<span class="k">ON</span> <span class="n">r</span><span class="p">.</span><span class="n">studentno</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">studentno</span>

<span class="c1">-- 等值连接
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">s</span><span class="p">.</span><span class="n">studentno</span><span class="p">,</span><span class="n">studentname</span><span class="p">,</span><span class="n">subjectno</span><span class="p">,</span><span class="n">StudentResult</span>
<span class="k">FROM</span> <span class="n">student</span> <span class="n">s</span> <span class="p">,</span> <span class="k">result</span> <span class="n">r</span>
<span class="k">WHERE</span> <span class="n">r</span><span class="p">.</span><span class="n">studentno</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">studentno</span>

<span class="c1">-- 左连接 (查询了所有同学,不考试的也会查出来)
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">s</span><span class="p">.</span><span class="n">studentno</span><span class="p">,</span><span class="n">studentname</span><span class="p">,</span><span class="n">subjectno</span><span class="p">,</span><span class="n">StudentResult</span>
<span class="k">FROM</span> <span class="n">student</span> <span class="n">s</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="k">result</span> <span class="n">r</span>
<span class="k">ON</span> <span class="n">r</span><span class="p">.</span><span class="n">studentno</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">studentno</span>

<span class="c1">-- 查一下缺考的同学(左连接应用场景)
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">s</span><span class="p">.</span><span class="n">studentno</span><span class="p">,</span><span class="n">studentname</span><span class="p">,</span><span class="n">subjectno</span><span class="p">,</span><span class="n">StudentResult</span>
<span class="k">FROM</span> <span class="n">student</span> <span class="n">s</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="k">result</span> <span class="n">r</span>
<span class="k">ON</span> <span class="n">r</span><span class="p">.</span><span class="n">studentno</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">studentno</span>
<span class="k">WHERE</span> <span class="n">StudentResult</span> <span class="k">IS</span> <span class="k">NULL</span>

<span class="c1">-- 思考题:查询参加了考试的同学信息(学号,学生姓名,科目名,分数)
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">s</span><span class="p">.</span><span class="n">studentno</span><span class="p">,</span><span class="n">studentname</span><span class="p">,</span><span class="n">subjectname</span><span class="p">,</span><span class="n">StudentResult</span>
<span class="k">FROM</span> <span class="n">student</span> <span class="n">s</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="k">result</span> <span class="n">r</span>
<span class="k">ON</span> <span class="n">r</span><span class="p">.</span><span class="n">studentno</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">studentno</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="o">`</span><span class="n">subject</span><span class="o">`</span> <span class="n">sub</span>
<span class="k">ON</span> <span class="n">sub</span><span class="p">.</span><span class="n">subjectno</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">subjectno</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>自连接</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="cm">/*
</span><span class="cm">自连接
</span><span class="cm">		数据表与自身进行连接
</span><span class="cm">需求:从一个包含栏目ID , 栏目名称和父栏目ID的表中
</span><span class="cm">		查询父栏目名称和其他子栏目名称
</span><span class="cm">*/</span>

<span class="c1">-- 创建一个表
</span><span class="c1"></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">category</span><span class="o">`</span> <span class="p">(</span>
<span class="o">`</span><span class="n">categoryid</span><span class="o">`</span> <span class="nb">INT</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="n">UNSIGNED</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span> <span class="k">COMMENT</span> <span class="s1">&#39;主题id&#39;</span><span class="p">,</span>
<span class="o">`</span><span class="n">pid</span><span class="o">`</span> <span class="nb">INT</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">&#39;父id&#39;</span><span class="p">,</span>
<span class="o">`</span><span class="n">categoryName</span><span class="o">`</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">&#39;主题名字&#39;</span><span class="p">,</span>
<span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="o">`</span><span class="n">categoryid</span><span class="o">`</span><span class="p">)</span>
<span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">INNODB</span> <span class="n">AUTO_INCREMENT</span><span class="o">=</span><span class="mi">9</span> <span class="k">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8</span>

<span class="c1">-- 插入数据
</span><span class="c1"></span><span class="k">INSERT</span> <span class="k">INTO</span> <span class="o">`</span><span class="n">category</span><span class="o">`</span> <span class="p">(</span><span class="o">`</span><span class="n">categoryid</span><span class="o">`</span><span class="p">,</span> <span class="o">`</span><span class="n">pid</span><span class="o">`</span><span class="p">,</span> <span class="o">`</span><span class="n">categoryName</span><span class="o">`</span><span class="p">)</span>
<span class="k">VALUES</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;信息技术&#39;</span><span class="p">),(</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;软件开发&#39;</span><span class="p">),(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;数据库&#39;</span><span class="p">),(</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;美术设计&#39;</span><span class="p">),(</span><span class="s1">&#39;6&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;web开发&#39;</span><span class="p">),(</span><span class="s1">&#39;7&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;ps技术&#39;</span><span class="p">),(</span><span class="s1">&#39;8&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;办公信息&#39;</span><span class="p">);</span>

<span class="c1">-- 编写SQL语句,将栏目的父子关系呈现出来 (父栏目名称,子栏目名称)
</span><span class="c1">-- 核心思想:把一张表看成两张一模一样的表,然后将这两张表连接查询(自连接)
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">a</span><span class="p">.</span><span class="n">categoryName</span> <span class="k">AS</span> <span class="s1">&#39;父栏目&#39;</span><span class="p">,</span><span class="n">b</span><span class="p">.</span><span class="n">categoryName</span> <span class="k">AS</span> <span class="s1">&#39;子栏目&#39;</span>
<span class="k">FROM</span> <span class="n">category</span> <span class="k">AS</span> <span class="n">a</span><span class="p">,</span><span class="n">category</span> <span class="k">AS</span> <span class="n">b</span>
<span class="k">WHERE</span> <span class="n">a</span><span class="p">.</span><span class="o">`</span><span class="n">categoryid</span><span class="o">`=</span><span class="n">b</span><span class="p">.</span><span class="o">`</span><span class="n">pid</span><span class="o">`</span>

<span class="c1">-- 思考题:查询参加了考试的同学信息(学号,学生姓名,科目名,分数)
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">s</span><span class="p">.</span><span class="n">studentno</span><span class="p">,</span><span class="n">studentname</span><span class="p">,</span><span class="n">subjectname</span><span class="p">,</span><span class="n">StudentResult</span>
<span class="k">FROM</span> <span class="n">student</span> <span class="n">s</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="k">result</span> <span class="n">r</span>
<span class="k">ON</span> <span class="n">r</span><span class="p">.</span><span class="n">studentno</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">studentno</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="o">`</span><span class="n">subject</span><span class="o">`</span> <span class="n">sub</span>
<span class="k">ON</span> <span class="n">sub</span><span class="p">.</span><span class="n">subjectno</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">subjectno</span>

<span class="c1">-- 查询学员及所属的年级(学号,学生姓名,年级名)
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">studentno</span> <span class="k">AS</span> <span class="err">学号</span><span class="p">,</span><span class="n">studentname</span> <span class="k">AS</span> <span class="err">学生姓名</span><span class="p">,</span><span class="n">gradename</span> <span class="k">AS</span> <span class="err">年级名称</span>
<span class="k">FROM</span> <span class="n">student</span> <span class="n">s</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">grade</span> <span class="k">g</span>
<span class="k">ON</span> <span class="n">s</span><span class="p">.</span><span class="o">`</span><span class="n">GradeId</span><span class="o">`</span> <span class="o">=</span> <span class="k">g</span><span class="p">.</span><span class="o">`</span><span class="n">GradeID</span><span class="o">`</span>

<span class="c1">-- 查询科目及所属的年级(科目名称,年级名称)
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">subjectname</span> <span class="k">AS</span> <span class="err">科目名称</span><span class="p">,</span><span class="n">gradename</span> <span class="k">AS</span> <span class="err">年级名称</span>
<span class="k">FROM</span> <span class="n">SUBJECT</span> <span class="n">sub</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">grade</span> <span class="k">g</span>
<span class="k">ON</span> <span class="n">sub</span><span class="p">.</span><span class="n">gradeid</span> <span class="o">=</span> <span class="k">g</span><span class="p">.</span><span class="n">gradeid</span>

<span class="c1">-- 查询 数据库结构-1 的所有考试结果(学号 学生姓名 科目名称 成绩)
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">s</span><span class="p">.</span><span class="n">studentno</span><span class="p">,</span><span class="n">studentname</span><span class="p">,</span><span class="n">subjectname</span><span class="p">,</span><span class="n">StudentResult</span>
<span class="k">FROM</span> <span class="n">student</span> <span class="n">s</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="k">result</span> <span class="n">r</span>
<span class="k">ON</span> <span class="n">r</span><span class="p">.</span><span class="n">studentno</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">studentno</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="o">`</span><span class="n">subject</span><span class="o">`</span> <span class="n">sub</span>
<span class="k">ON</span> <span class="n">r</span><span class="p">.</span><span class="n">subjectno</span> <span class="o">=</span> <span class="n">sub</span><span class="p">.</span><span class="n">subjectno</span>
<span class="k">WHERE</span> <span class="n">subjectname</span><span class="o">=</span><span class="s1">&#39;数据库结构-1&#39;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="45排序和分页">4.5、排序和分页</h3>
<p>测试：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="cm">/*============== 排序 ================
</span><span class="cm">语法 : ORDER BY
</span><span class="cm">		ORDER BY 语句用于根据指定的列对结果集进行排序。
</span><span class="cm">		ORDER BY 语句默认按照ASC升序对记录进行排序。
</span><span class="cm">		如果您希望按照降序对记录进行排序，可以使用 DESC 关键字。
</span><span class="cm">*/</span>

<span class="c1">-- 查询 数据库结构-1 的所有考试结果(学号 学生姓名 科目名称 成绩)
</span><span class="c1">-- 按成绩降序排序
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">s</span><span class="p">.</span><span class="n">studentno</span><span class="p">,</span><span class="n">studentname</span><span class="p">,</span><span class="n">subjectname</span><span class="p">,</span><span class="n">StudentResult</span>
<span class="k">FROM</span> <span class="n">student</span> <span class="n">s</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="k">result</span> <span class="n">r</span>
<span class="k">ON</span> <span class="n">r</span><span class="p">.</span><span class="n">studentno</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">studentno</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="o">`</span><span class="n">subject</span><span class="o">`</span> <span class="n">sub</span>
<span class="k">ON</span> <span class="n">r</span><span class="p">.</span><span class="n">subjectno</span> <span class="o">=</span> <span class="n">sub</span><span class="p">.</span><span class="n">subjectno</span>
<span class="k">WHERE</span> <span class="n">subjectname</span><span class="o">=</span><span class="s1">&#39;数据库结构-1&#39;</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">StudentResult</span> <span class="k">DESC</span>

<span class="cm">/*============== 分页 ================
</span><span class="cm">语法 : SELECT * FROM table LIMIT [offset,] rows | rows OFFSET offset
</span><span class="cm">好处 : (用户体验,网络传输,查询压力)
</span><span class="cm">推导:
</span><span class="cm">第一页 : limit 0,5
</span><span class="cm">第二页 : limit 5,5
</span><span class="cm">第三页 : limit 10,5
</span><span class="cm">......
</span><span class="cm">第N页 : limit (pageNo-1)*pageSzie,pageSzie
</span><span class="cm">[pageNo:页码,pageSize:单页面显示条数]
</span><span class="cm">*/</span>

<span class="c1">-- 每页显示5条数据
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">s</span><span class="p">.</span><span class="n">studentno</span><span class="p">,</span><span class="n">studentname</span><span class="p">,</span><span class="n">subjectname</span><span class="p">,</span><span class="n">StudentResult</span>
<span class="k">FROM</span> <span class="n">student</span> <span class="n">s</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="k">result</span> <span class="n">r</span>
<span class="k">ON</span> <span class="n">r</span><span class="p">.</span><span class="n">studentno</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">studentno</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="o">`</span><span class="n">subject</span><span class="o">`</span> <span class="n">sub</span>
<span class="k">ON</span> <span class="n">r</span><span class="p">.</span><span class="n">subjectno</span> <span class="o">=</span> <span class="n">sub</span><span class="p">.</span><span class="n">subjectno</span>
<span class="k">WHERE</span> <span class="n">subjectname</span><span class="o">=</span><span class="s1">&#39;数据库结构-1&#39;</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">StudentResult</span> <span class="k">DESC</span> <span class="p">,</span> <span class="n">studentno</span>
<span class="k">LIMIT</span> <span class="mi">0</span><span class="p">,</span><span class="mi">5</span>

<span class="c1">-- 查询 JAVA第一学年 课程成绩前10名并且分数大于80的学生信息(学号,姓名,课程名,分数)
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">s</span><span class="p">.</span><span class="n">studentno</span><span class="p">,</span><span class="n">studentname</span><span class="p">,</span><span class="n">subjectname</span><span class="p">,</span><span class="n">StudentResult</span>
<span class="k">FROM</span> <span class="n">student</span> <span class="n">s</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="k">result</span> <span class="n">r</span>
<span class="k">ON</span> <span class="n">r</span><span class="p">.</span><span class="n">studentno</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">studentno</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="o">`</span><span class="n">subject</span><span class="o">`</span> <span class="n">sub</span>
<span class="k">ON</span> <span class="n">r</span><span class="p">.</span><span class="n">subjectno</span> <span class="o">=</span> <span class="n">sub</span><span class="p">.</span><span class="n">subjectno</span>
<span class="k">WHERE</span> <span class="n">subjectname</span><span class="o">=</span><span class="s1">&#39;JAVA第一学年&#39;</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">StudentResult</span> <span class="k">DESC</span>
<span class="k">LIMIT</span> <span class="mi">0</span><span class="p">,</span><span class="mi">10</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="46子查询">4.6、子查询</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-SQL" data-lang="SQL"><span class="cm">/*============== 子查询 ================
</span><span class="cm">什么是子查询?
</span><span class="cm">		在查询语句中的WHERE条件子句中,又嵌套了另一个查询语句
</span><span class="cm">		嵌套查询可由多个子查询组成,求解的方式是由里及外;
</span><span class="cm">		子查询返回的结果一般都是集合,故而建议使用IN关键字;
</span><span class="cm">*/</span>
<span class="c1">-- 查询 数据库结构-1 的所有考试结果(学号,科目编号,成绩),并且成绩降序排列
</span><span class="c1">-- 方法一:使用连接查询
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">studentno</span><span class="p">,</span><span class="n">r</span><span class="p">.</span><span class="n">subjectno</span><span class="p">,</span><span class="n">StudentResult</span>
<span class="k">FROM</span> <span class="k">result</span> <span class="n">r</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="o">`</span><span class="n">subject</span><span class="o">`</span> <span class="n">sub</span>
<span class="k">ON</span> <span class="n">r</span><span class="p">.</span><span class="o">`</span><span class="n">SubjectNo</span><span class="o">`=</span><span class="n">sub</span><span class="p">.</span><span class="o">`</span><span class="n">SubjectNo</span><span class="o">`</span>
<span class="k">WHERE</span> <span class="n">subjectname</span> <span class="o">=</span> <span class="s1">&#39;数据库结构-1&#39;</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">studentresult</span> <span class="k">DESC</span><span class="p">;</span>

<span class="c1">-- 方法二:使用子查询(执行顺序:由里及外)
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">studentno</span><span class="p">,</span><span class="n">subjectno</span><span class="p">,</span><span class="n">StudentResult</span>
<span class="k">FROM</span> <span class="k">result</span>
<span class="k">WHERE</span> <span class="n">subjectno</span><span class="o">=</span><span class="p">(</span>
<span class="k">SELECT</span> <span class="n">subjectno</span> <span class="k">FROM</span> <span class="o">`</span><span class="n">subject</span><span class="o">`</span>
<span class="k">WHERE</span> <span class="n">subjectname</span> <span class="o">=</span> <span class="s1">&#39;数据库结构-1&#39;</span><span class="p">)</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">studentresult</span> <span class="k">DESC</span><span class="p">;</span>

<span class="c1">-- 查询课程为 高等数学-2 且分数不小于80分的学生的学号和姓名
</span><span class="c1">-- 方法一:使用连接查询
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">s</span><span class="p">.</span><span class="n">studentno</span><span class="p">,</span><span class="n">studentname</span>
<span class="k">FROM</span> <span class="n">student</span> <span class="n">s</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="k">result</span> <span class="n">r</span>
<span class="k">ON</span> <span class="n">s</span><span class="p">.</span><span class="o">`</span><span class="n">StudentNo</span><span class="o">`</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="o">`</span><span class="n">StudentNo</span><span class="o">`</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="o">`</span><span class="n">subject</span><span class="o">`</span> <span class="n">sub</span>
<span class="k">ON</span> <span class="n">sub</span><span class="p">.</span><span class="o">`</span><span class="n">SubjectNo</span><span class="o">`</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="o">`</span><span class="n">SubjectNo</span><span class="o">`</span>
<span class="k">WHERE</span> <span class="n">subjectname</span> <span class="o">=</span> <span class="s1">&#39;高等数学-2&#39;</span> <span class="k">AND</span> <span class="n">StudentResult</span><span class="o">&gt;=</span><span class="mi">80</span>

<span class="c1">-- 方法二:使用连接查询+子查询
</span><span class="c1">-- 分数不小于80分的学生的学号和姓名
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">r</span><span class="p">.</span><span class="n">studentno</span><span class="p">,</span><span class="n">studentname</span> <span class="k">FROM</span> <span class="n">student</span> <span class="n">s</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="k">result</span> <span class="n">r</span> <span class="k">ON</span> <span class="n">s</span><span class="p">.</span><span class="o">`</span><span class="n">StudentNo</span><span class="o">`=</span><span class="n">r</span><span class="p">.</span><span class="o">`</span><span class="n">StudentNo</span><span class="o">`</span>
<span class="k">WHERE</span> <span class="n">StudentResult</span><span class="o">&gt;=</span><span class="mi">80</span>

<span class="c1">-- 在上面SQL基础上,添加需求:课程为 高等数学-2
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">r</span><span class="p">.</span><span class="n">studentno</span><span class="p">,</span><span class="n">studentname</span> <span class="k">FROM</span> <span class="n">student</span> <span class="n">s</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="k">result</span> <span class="n">r</span> <span class="k">ON</span> <span class="n">s</span><span class="p">.</span><span class="o">`</span><span class="n">StudentNo</span><span class="o">`=</span><span class="n">r</span><span class="p">.</span><span class="o">`</span><span class="n">StudentNo</span><span class="o">`</span>
<span class="k">WHERE</span> <span class="n">StudentResult</span><span class="o">&gt;=</span><span class="mi">80</span> <span class="k">AND</span> <span class="n">subjectno</span><span class="o">=</span><span class="p">(</span>
<span class="k">SELECT</span> <span class="n">subjectno</span> <span class="k">FROM</span> <span class="o">`</span><span class="n">subject</span><span class="o">`</span>
<span class="k">WHERE</span> <span class="n">subjectname</span> <span class="o">=</span> <span class="s1">&#39;高等数学-2&#39;</span><span class="p">)</span>

<span class="c1">-- 方法三:使用子查询
</span><span class="c1">-- 分步写简单sql语句,然后将其嵌套起来
</span><span class="c1"></span><span class="k">SELECT</span> <span class="n">studentno</span><span class="p">,</span><span class="n">studentname</span> <span class="k">FROM</span> <span class="n">student</span> <span class="k">WHERE</span> <span class="n">studentno</span> <span class="k">IN</span><span class="p">(</span>
	<span class="k">SELECT</span> <span class="n">studentno</span> <span class="k">FROM</span> <span class="k">result</span> <span class="k">WHERE</span> <span class="n">StudentResult</span><span class="o">&gt;=</span><span class="mi">80</span> <span class="k">AND</span> <span class="n">subjectno</span><span class="o">=</span><span class="p">(</span>
		<span class="k">SELECT</span> <span class="n">subjectno</span> <span class="k">FROM</span> <span class="o">`</span><span class="n">subject</span><span class="o">`</span> <span class="k">WHERE</span> <span class="n">subjectname</span> <span class="o">=</span> <span class="s1">&#39;高等数学-2&#39;</span>
	<span class="p">)</span>
<span class="p">)</span>
<span class="cm">/*
</span><span class="cm">练习题目:
</span><span class="cm">查 C语言-1 的前5名学生的成绩信息(学号,姓名,分数)
</span><span class="cm">使用子查询,查询郭靖同学所在的年级名称
</span><span class="cm">*/</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="5mysql函数">5、MySQL函数</h2>
<h3 id="51常用函数">5.1、常用函数</h3>
<p><strong>数据函数</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="k">ABS</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">);</span> <span class="cm">/*绝对值*/</span>
<span class="k">SELECT</span> <span class="n">CEILING</span><span class="p">(</span><span class="mi">9</span><span class="p">.</span><span class="mi">4</span><span class="p">);</span> <span class="cm">/*向上取整*/</span>
<span class="k">SELECT</span> <span class="n">FLOOR</span><span class="p">(</span><span class="mi">9</span><span class="p">.</span><span class="mi">4</span><span class="p">);</span> <span class="cm">/*向下取整*/</span>
<span class="k">SELECT</span> <span class="n">RAND</span><span class="p">();</span> <span class="cm">/*随机数,返回一个0-1之间的随机数*/</span>
<span class="k">SELECT</span> <span class="n">SIGN</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="cm">/*符号函数: 负数返回-1,正数返回1,0返回0*/</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>字符串函数</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="k">CHAR_LENGTH</span><span class="p">(</span><span class="s1">&#39;狂神说坚持就能成功&#39;</span><span class="p">);</span> <span class="cm">/*返回字符串包含的字符数*/</span>
<span class="k">SELECT</span> <span class="n">CONCAT</span><span class="p">(</span><span class="s1">&#39;我&#39;</span><span class="p">,</span><span class="s1">&#39;爱&#39;</span><span class="p">,</span><span class="s1">&#39;程序&#39;</span><span class="p">);</span> <span class="cm">/*合并字符串,参数可以有多个*/</span>
<span class="k">SELECT</span> <span class="k">INSERT</span><span class="p">(</span><span class="s1">&#39;我爱编程helloworld&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;超级热爱&#39;</span><span class="p">);</span> <span class="cm">/*替换字符串,从某个位置开始替换某个长度*/</span>
<span class="k">SELECT</span> <span class="k">LOWER</span><span class="p">(</span><span class="s1">&#39;KuangShen&#39;</span><span class="p">);</span> <span class="cm">/*小写*/</span>
<span class="k">SELECT</span> <span class="k">UPPER</span><span class="p">(</span><span class="s1">&#39;KuangShen&#39;</span><span class="p">);</span> <span class="cm">/*大写*/</span>
<span class="k">SELECT</span> <span class="k">LEFT</span><span class="p">(</span><span class="s1">&#39;hello,world&#39;</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span> <span class="cm">/*从左边截取*/</span>
<span class="k">SELECT</span> <span class="k">RIGHT</span><span class="p">(</span><span class="s1">&#39;hello,world&#39;</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span> <span class="cm">/*从右边截取*/</span>
<span class="k">SELECT</span> <span class="k">REPLACE</span><span class="p">(</span><span class="s1">&#39;狂神说坚持就能成功&#39;</span><span class="p">,</span><span class="s1">&#39;坚持&#39;</span><span class="p">,</span><span class="s1">&#39;努力&#39;</span><span class="p">);</span> <span class="cm">/*替换字符串*/</span>
<span class="k">SELECT</span> <span class="n">SUBSTR</span><span class="p">(</span><span class="s1">&#39;狂神说坚持就能成功&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">);</span> <span class="cm">/*截取字符串,开始和长度*/</span>
<span class="k">SELECT</span> <span class="n">REVERSE</span><span class="p">(</span><span class="s1">&#39;狂神说坚持就能成功&#39;</span><span class="p">);</span> <span class="cm">/*反转
</span><span class="cm">
</span><span class="cm">-- 查询姓周的同学,改成邹
</span><span class="cm">SELECT REPLACE(studentname,&#39;周&#39;,&#39;邹&#39;) AS 新名字
</span><span class="cm">FROM student WHERE studentname LIKE &#39;周%&#39;;
</span></code></pre></td></tr></table>
</div>
</div><p><strong>日期和时间函数</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="k">CURRENT_DATE</span><span class="p">();</span> <span class="cm">/*获取当前日期*/</span>
<span class="k">SELECT</span> <span class="n">CURDATE</span><span class="p">();</span> <span class="cm">/*获取当前日期*/</span>
<span class="k">SELECT</span> <span class="n">NOW</span><span class="p">();</span> <span class="cm">/*获取当前日期和时间*/</span>
<span class="k">SELECT</span> <span class="k">LOCALTIME</span><span class="p">();</span> <span class="cm">/*获取当前日期和时间*/</span>
<span class="k">SELECT</span> <span class="n">SYSDATE</span><span class="p">();</span> <span class="cm">/*获取当前日期和时间*/</span>

<span class="c1">-- 获取年月日,时分秒
</span><span class="c1"></span><span class="k">SELECT</span> <span class="k">YEAR</span><span class="p">(</span><span class="n">NOW</span><span class="p">());</span>
<span class="k">SELECT</span> <span class="k">MONTH</span><span class="p">(</span><span class="n">NOW</span><span class="p">());</span>
<span class="k">SELECT</span> <span class="k">DAY</span><span class="p">(</span><span class="n">NOW</span><span class="p">());</span>
<span class="k">SELECT</span> <span class="n">HOUR</span><span class="p">(</span><span class="n">NOW</span><span class="p">());</span>
<span class="k">SELECT</span> <span class="k">MINUTE</span><span class="p">(</span><span class="n">NOW</span><span class="p">());</span>
<span class="k">SELECT</span> <span class="k">SECOND</span><span class="p">(</span><span class="n">NOW</span><span class="p">());</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>系统信息函数</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="k">VERSION</span><span class="p">();</span> <span class="cm">/*版本*/</span>
<span class="k">SELECT</span> <span class="k">USER</span><span class="p">();</span> <span class="cm">/*用户*/</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="52聚合函数">5.2、聚合函数</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823162435.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823162435.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823162435.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823162435.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823162435.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823162435.png" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- 聚合函数
</span><span class="c1"></span><span class="cm">/*COUNT:非空的*/</span>
<span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="n">studentname</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">student</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">student</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">student</span><span class="p">;</span> <span class="cm">/*推荐*/</span>

<span class="c1">-- 从含义上讲，count(1) 与 count(*) 都表示对全部数据行的查询。
</span><span class="c1">-- count(字段) 会统计该字段在表中出现的次数，忽略字段为null 的情况。即不统计字段为null
</span><span class="c1"></span><span class="err">的记录。</span>
<span class="c1">-- count(*) 包括了所有的列，相当于行数，在统计结果的时候，包含字段为null 的记录；
</span><span class="c1">-- count(1) 用1代表代码行，在统计结果的时候，包含字段为null 的记录 。
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm">很多人认为count(1)执行的效率会比count(*)高，原因是count(*)会存在全表扫描，而count(1)
</span><span class="cm">可以针对一个字段进行查询。其实不然，count(1)和count(*)都会对全表进行扫描，统计所有记录的
</span><span class="cm">条数，包括那些为null的记录，因此，它们的效率可以说是相差无几。而count(字段)则与前两者不
</span><span class="cm">同，它会统计该字段不为null的记录条数。
</span><span class="cm">
</span><span class="cm">下面它们之间的一些对比：
</span><span class="cm">1）在表没有主键时，count(1)比count(*)快
</span><span class="cm">2）有主键时，主键作为计算条件，count(主键)效率最高；
</span><span class="cm">3）若表格只有一个字段，则count(*)效率较高。
</span><span class="cm">*/</span>

<span class="k">SELECT</span> <span class="k">SUM</span><span class="p">(</span><span class="n">StudentResult</span><span class="p">)</span> <span class="k">AS</span> <span class="err">总和</span> <span class="k">FROM</span> <span class="k">result</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="k">AVG</span><span class="p">(</span><span class="n">StudentResult</span><span class="p">)</span> <span class="k">AS</span> <span class="err">平均分</span> <span class="k">FROM</span> <span class="k">result</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="k">MAX</span><span class="p">(</span><span class="n">StudentResult</span><span class="p">)</span> <span class="k">AS</span> <span class="err">最高分</span> <span class="k">FROM</span> <span class="k">result</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="k">MIN</span><span class="p">(</span><span class="n">StudentResult</span><span class="p">)</span> <span class="k">AS</span> <span class="err">最低分</span> <span class="k">FROM</span> <span class="k">result</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>题目</strong>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- 查询不同课程的平均分,最高分,最低分
</span><span class="c1">-- 前提:根据不同的课程进行分组
</span><span class="c1"></span>
<span class="k">SELECT</span> <span class="n">subjectname</span><span class="p">,</span><span class="k">AVG</span><span class="p">(</span><span class="n">studentresult</span><span class="p">)</span> <span class="k">AS</span> <span class="err">平均分</span><span class="p">,</span><span class="k">MAX</span><span class="p">(</span><span class="n">StudentResult</span><span class="p">)</span> <span class="k">AS</span> <span class="err">最高分</span><span class="p">,</span><span class="k">MIN</span><span class="p">(</span><span class="n">StudentResult</span><span class="p">)</span> <span class="k">AS</span> <span class="err">最低分</span>
<span class="k">FROM</span> <span class="k">result</span> <span class="k">AS</span> <span class="n">r</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="o">`</span><span class="n">subject</span><span class="o">`</span> <span class="k">AS</span> <span class="n">s</span>
<span class="k">ON</span> <span class="n">r</span><span class="p">.</span><span class="n">subjectno</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">subjectno</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">r</span><span class="p">.</span><span class="n">subjectno</span>
<span class="k">HAVING</span> <span class="err">平均分</span><span class="o">&gt;</span><span class="mi">80</span><span class="p">;</span>

<span class="cm">/*
</span><span class="cm">where写在group by前面.
</span><span class="cm">要是放在分组后面的筛选
</span><span class="cm">要使用HAVING..
</span><span class="cm">因为having是从前面筛选的字段再筛选，而where是从数据表中的&gt;字段直接进行的筛选的
</span><span class="cm">*/</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>MD5加密</p>
</blockquote>
<p><strong>一、MD5简介</strong></p>
<p>MD5即Message-Digest Algorithm 5（信息-摘要算法5），用于确保信息传输完整一致。是计算机广泛使用的杂凑算法之一（又译摘要算法、哈希算法），主流编程语言普遍已有MD5实现。将数据（如汉字）运算为另一固定长度值，是杂凑算法的基础原理，MD5的前身有MD2、MD3和MD4。</p>
<p><strong>二、实现数据加密</strong></p>
<p>新建一个表testmd5</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">testmd5</span><span class="o">`</span> <span class="p">(</span>
		<span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="nb">INT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
		<span class="o">`</span><span class="n">name</span><span class="o">`</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
		<span class="o">`</span><span class="n">pwd</span><span class="o">`</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
		<span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">)</span>
<span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">INNODB</span> <span class="k">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8</span>
</code></pre></td></tr></table>
</div>
</div><p>插入一些数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">testmd5</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;kuangshen&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;qinjiang&#39;</span><span class="p">,</span><span class="s1">&#39;456789&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>如果我们要对pwd着一列数据进行加密，语法是：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">update</span> <span class="n">testmd5</span> <span class="k">set</span> <span class="n">pwd</span> <span class="o">=</span> <span class="n">md5</span><span class="p">(</span><span class="n">pwd</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>如果单独对某个用户(如kuangshen)的密码加密：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">testmd5</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;kuangshen2&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">)</span>
<span class="k">update</span> <span class="n">testmd5</span> <span class="k">set</span> <span class="n">pwd</span> <span class="o">=</span> <span class="n">md5</span><span class="p">(</span><span class="n">pwd</span><span class="p">)</span> <span class="k">where</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;kuangshen2&#39;</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>插入新的数据自动加密</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">testmd5</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;kuangshen3&#39;</span><span class="p">,</span><span class="n">md5</span><span class="p">(</span><span class="s1">&#39;123456&#39;</span><span class="p">));</span>
</code></pre></td></tr></table>
</div>
</div><p>查询登录用户信息（md5对比使用，查看用户输入加密后的密码进行比对）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">testmd5</span> <span class="k">WHERE</span> <span class="o">`</span><span class="n">name</span><span class="o">`=</span><span class="s1">&#39;kuangshen&#39;</span> <span class="k">AND</span> <span class="n">pwd</span><span class="o">=</span><span class="n">MD5</span><span class="p">(</span><span class="s1">&#39;123456&#39;</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="53小结">5.3、小结</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- ================ 内置函数 ================
</span><span class="c1"></span>
<span class="c1">-- 数值函数
</span><span class="c1"></span><span class="k">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1">-- 绝对值 abs(-10.9) = 10
</span><span class="c1"></span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="c1">-- 格式化千分位数值 format(1234567.456, 2) = 1,234,567.46
</span><span class="c1"></span><span class="n">ceil</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1">-- 向上取整 ceil(10.1) = 11
</span><span class="c1"></span><span class="n">floor</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1">-- 向下取整 floor (10.1) = 10
</span><span class="c1"></span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1">-- 四舍五入去整
</span><span class="c1"></span><span class="k">mod</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="c1">-- m%n m mod n 求余 10%3=1
</span><span class="c1"></span><span class="n">pi</span><span class="p">()</span> <span class="c1">-- 获得圆周率
</span><span class="c1"></span><span class="n">pow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="c1">-- m^n
</span><span class="c1"></span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1">-- 算术平方根
</span><span class="c1"></span><span class="n">rand</span><span class="p">()</span> <span class="c1">-- 随机数
</span><span class="c1"></span><span class="k">truncate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="c1">-- 截取d位小数
</span><span class="c1"></span>
<span class="c1">-- 时间日期函数
</span><span class="c1"></span><span class="n">now</span><span class="p">(),</span> <span class="k">current_timestamp</span><span class="p">();</span> <span class="c1">-- 当前日期时间
</span><span class="c1"></span><span class="k">current_date</span><span class="p">();</span> <span class="c1">-- 当前日期
</span><span class="c1"></span><span class="k">current_time</span><span class="p">();</span> <span class="c1">-- 当前时间
</span><span class="c1"></span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;yyyy-mm-dd hh:ii:ss&#39;</span><span class="p">);</span> <span class="c1">-- 获取日期部分
</span><span class="c1"></span><span class="n">time</span><span class="p">(</span><span class="s1">&#39;yyyy-mm-dd hh:ii:ss&#39;</span><span class="p">);</span> <span class="c1">-- 获取时间部分
</span><span class="c1"></span><span class="n">date_format</span><span class="p">(</span><span class="s1">&#39;yyyy-mm-dd hh:ii:ss&#39;</span><span class="p">,</span> <span class="s1">&#39;%d %y %a %d %m %b %j&#39;</span><span class="p">);</span> <span class="c1">-- 格式化时间
</span><span class="c1"></span><span class="n">unix_timestamp</span><span class="p">();</span> <span class="c1">-- 获得unix时间戳
</span><span class="c1"></span><span class="n">from_unixtime</span><span class="p">();</span> <span class="c1">-- 从时间戳获得时间
</span><span class="c1"></span>
<span class="c1">-- 字符串函数
</span><span class="c1"></span><span class="k">length</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="c1">-- string长度，字节
</span><span class="c1"></span><span class="k">char_length</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="c1">-- string的字符个数
</span><span class="c1"></span><span class="k">substring</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="k">position</span> <span class="p">[,</span><span class="k">length</span><span class="p">])</span> <span class="c1">-- 从str的position开始,取length个字符
</span><span class="c1"></span><span class="k">replace</span><span class="p">(</span><span class="n">str</span> <span class="p">,</span><span class="n">search_str</span> <span class="p">,</span><span class="n">replace_str</span><span class="p">)</span> <span class="c1">-- 在str中用replace_str替换search_str
</span><span class="c1"></span><span class="n">instr</span><span class="p">(</span><span class="n">string</span> <span class="p">,</span><span class="k">substring</span><span class="p">)</span> <span class="c1">-- 返回substring首次在string中出现的位置
</span><span class="c1"></span><span class="n">concat</span><span class="p">(</span><span class="n">string</span> <span class="p">[,...])</span> <span class="c1">-- 连接字串
</span><span class="c1"></span><span class="n">charset</span><span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="c1">-- 返回字串字符集
</span><span class="c1"></span><span class="n">lcase</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="c1">-- 转换成小写
</span><span class="c1"></span><span class="k">left</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="k">length</span><span class="p">)</span> <span class="c1">-- 从string2中的左边起取length个字符
</span><span class="c1"></span><span class="n">load_file</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span> <span class="c1">-- 从文件读取内容
</span><span class="c1"></span><span class="n">locate</span><span class="p">(</span><span class="k">substring</span><span class="p">,</span> <span class="n">string</span> <span class="p">[,</span><span class="n">start_position</span><span class="p">])</span> <span class="c1">-- 同instr,但可指定开始位置
</span><span class="c1"></span><span class="n">lpad</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="k">length</span><span class="p">,</span> <span class="k">pad</span><span class="p">)</span> <span class="c1">-- 重复用pad加在string开头,直到字串长度为length
</span><span class="c1"></span><span class="n">ltrim</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="c1">-- 去除前端空格
</span><span class="c1"></span><span class="n">repeat</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="k">count</span><span class="p">)</span> <span class="c1">-- 重复count次
</span><span class="c1"></span><span class="n">rpad</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="k">length</span><span class="p">,</span> <span class="k">pad</span><span class="p">)</span> <span class="c1">--在str后用pad补充,直到长度为length
</span><span class="c1"></span><span class="n">rtrim</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="c1">-- 去除后端空格
</span><span class="c1"></span><span class="n">strcmp</span><span class="p">(</span><span class="n">string1</span> <span class="p">,</span><span class="n">string2</span><span class="p">)</span> <span class="c1">-- 逐字符比较两字串大小
</span><span class="c1"></span>
<span class="c1">-- 聚合函数
</span><span class="c1"></span><span class="k">count</span><span class="p">()</span>
<span class="k">sum</span><span class="p">();</span>
<span class="k">max</span><span class="p">();</span>
<span class="k">min</span><span class="p">();</span>
<span class="k">avg</span><span class="p">();</span>
<span class="n">group_concat</span><span class="p">()</span>

<span class="c1">-- 其他常用函数
</span><span class="c1"></span><span class="n">md5</span><span class="p">();</span>
<span class="k">default</span><span class="p">();</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="6事务">6、事务</h2>
<h3 id="61概述">6.1、概述</h3>
<blockquote>
<p>什么是事务</p>
</blockquote>
<ul>
<li>事务就是将一组SQL语句放在同一批次内去执行</li>
<li>如果一个SQL语句出错,则该批次内的所有SQL都将被取消执行</li>
<li>MySQL事务处理只支持InnoDB和BDB数据表类型</li>
</ul>
<blockquote>
<p>事务的ACID原则  百度ACID</p>
</blockquote>
<p><strong>原子性(Atomic)</strong></p>
<ul>
<li>整个事务中的所有操作，要么全部完成，要么全部不完成，不可能停滞在中间某个环节。事务在执
行过程中发生错误，会被回滚（ROLLBACK）到事务开始前的状态，就像这个事务从来没有执行过
一样。</li>
</ul>
<p><strong>一致性(Consist)</strong></p>
<ul>
<li>一个事务可以封装状态改变（除非它是一个只读的）。事务必须始终保持系统处于一致的状态，不管在任何给定的时间并发事务有多少。也就是说：如果事务是并发多个，系统也必须如同串行事务
一样操作。其主要特征是<code>保护性和不变性</code>(Preserving an Invariant)，以转账案例为例，假设有五
个账户，每个账户余额是100元，那么五个账户总额是500元，如果在这个5个账户之间同时发生多
个转账，无论并发多少个，比如在A与B账户之间转账5元，在C与D账户之间转账10元，在B与E之
间转账15元，五个账户总额也应该还是500元，这就是保护性和不变性。</li>
</ul>
<p><strong>隔离性(Isolated)</strong></p>
<ul>
<li>隔离状态执行事务，使它们好像是系统在给定时间内执行的唯一操作。如果有两个事务，运行在相同的时间内，执行相同的功能，事务的隔离性将确保每一事务在系统中认为只有该事务在使用系
统。这种属性有时称为串行化，为了防止事务操作间的混淆，必须串行化或序列化请求，使得在同
一时间仅有一个请求用于同一数据。</li>
</ul>
<p><strong>持久性(Durable)</strong></p>
<ul>
<li>在事务完成以后，该事务对数据库所作的更改便持久的保存在数据库之中，并不会被回滚。</li>
</ul>
<h3 id="62事务实现">6.2、事务实现</h3>
<p><strong>基本语法</strong>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- 使用set语句来改变自动提交模式
</span><span class="c1"></span><span class="k">SET</span> <span class="n">autocommit</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="cm">/*关闭*/</span>
<span class="k">SET</span> <span class="n">autocommit</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/*开启*/</span>

<span class="c1">-- 注意:
</span><span class="c1">--- 1.MySQL中默认是自动提交
</span><span class="c1">--- 2.使用事务时应先关闭自动提交
</span><span class="c1"></span>
<span class="c1">-- 开始一个事务,标记事务的起始点
</span><span class="c1"></span><span class="k">START</span> <span class="k">TRANSACTION</span>

<span class="c1">-- 提交一个事务给数据库
</span><span class="c1"></span><span class="k">COMMIT</span>

<span class="c1">-- 将事务回滚,数据回到本次事务的初始状态
</span><span class="c1"></span><span class="k">ROLLBACK</span>

<span class="c1">-- 还原MySQL数据库的自动提交
</span><span class="c1"></span><span class="k">SET</span> <span class="n">autocommit</span> <span class="o">=</span><span class="mi">1</span><span class="p">;</span>

<span class="c1">-- 保存点
</span><span class="c1"></span><span class="n">SAVEPOINT</span> <span class="err">保存点名称</span> <span class="c1">-- 设置一个事务保存点
</span><span class="c1"></span><span class="k">ROLLBACK</span> <span class="k">TO</span> <span class="n">SAVEPOINT</span> <span class="err">保存点名称</span> <span class="c1">-- 回滚到保存点
</span><span class="c1"></span><span class="n">RELEASE</span> <span class="n">SAVEPOINT</span> <span class="err">保存点名称</span> <span class="c1">-- 删除保存点
</span></code></pre></td></tr></table>
</div>
</div><p>事务处理步骤：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823165551.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823165551.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823165551.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823165551.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823165551.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823165551.png" /></p>
<h3 id="63测试题目">6.3、测试题目</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="cm">/*
</span><span class="cm">课堂测试题目
</span><span class="cm">
</span><span class="cm">A在线买一款价格为500元商品,网上银行转账.
</span><span class="cm">A的银行卡余额为2000,然后给商家B支付500.
</span><span class="cm">商家B一开始的银行卡余额为10000
</span><span class="cm">
</span><span class="cm">创建数据库shop和创建表account并插入2条数据
</span><span class="cm">*/</span>
<span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="o">`</span><span class="n">shop</span><span class="o">`</span><span class="nb">CHARACTER</span> <span class="k">SET</span> <span class="n">utf8</span> <span class="k">COLLATE</span> <span class="n">utf8_general_ci</span><span class="p">;</span>

<span class="n">USE</span> <span class="o">`</span><span class="n">shop</span><span class="o">`</span><span class="p">;</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">account</span><span class="o">`</span> <span class="p">(</span>
		<span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="nb">INT</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span><span class="p">,</span>
		<span class="o">`</span><span class="n">name</span><span class="o">`</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
		<span class="o">`</span><span class="n">cash</span><span class="o">`</span> <span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
		<span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">)</span>
<span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">INNODB</span> <span class="k">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">account</span> <span class="p">(</span><span class="o">`</span><span class="n">name</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">cash</span><span class="o">`</span><span class="p">)</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mi">2000</span><span class="p">.</span><span class="mi">00</span><span class="p">),(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="mi">10000</span><span class="p">.</span><span class="mi">00</span><span class="p">)</span>
<span class="c1">-- 转账实现
</span><span class="c1"></span><span class="k">SET</span> <span class="n">autocommit</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">-- 关闭自动提交
</span><span class="c1"></span><span class="k">START</span> <span class="k">TRANSACTION</span><span class="p">;</span> <span class="c1">-- 开始一个事务,标记事务的起始点
</span><span class="c1"></span><span class="k">UPDATE</span> <span class="n">account</span> <span class="k">SET</span> <span class="n">cash</span><span class="o">=</span><span class="n">cash</span><span class="o">-</span><span class="mi">500</span> <span class="k">WHERE</span> <span class="o">`</span><span class="n">name</span><span class="o">`=</span><span class="s1">&#39;A&#39;</span><span class="p">;</span>
<span class="k">UPDATE</span> <span class="n">account</span> <span class="k">SET</span> <span class="n">cash</span><span class="o">=</span><span class="n">cash</span><span class="o">+</span><span class="mi">500</span> <span class="k">WHERE</span> <span class="o">`</span><span class="n">name</span><span class="o">`=</span><span class="s1">&#39;B&#39;</span><span class="p">;</span>
<span class="k">COMMIT</span><span class="p">;</span> <span class="c1">-- 提交事务
</span><span class="c1"></span><span class="o">#</span> <span class="k">rollback</span><span class="p">;</span>
<span class="k">SET</span> <span class="n">autocommit</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">-- 恢复自动提交
</span></code></pre></td></tr></table>
</div>
</div><h2 id="7索引">7、索引</h2>
<h3 id="71索引分类">7.1、索引分类</h3>
<blockquote>
<p>索引的作用</p>
</blockquote>
<ul>
<li>提高查询速度</li>
<li>确保数据唯一性</li>
<li>可以加速表和表之间的连接，实现表与表之间的参照完整性</li>
<li>使用分组和排序子句进行数据检索时，可以显著减少分组和排序的时间</li>
<li>全文检索字段进行搜索优化</li>
</ul>
<blockquote>
<p>在一个表中，主键索引只能有一个，唯一索引可以有多个</p>
</blockquote>
<ul>
<li>主键索引
<ul>
<li>唯一的标识，主键不可重复，只能有一个列作为主键</li>
</ul>
</li>
<li>唯一索引
<ul>
<li>避免重复的列出现，唯一索引可以重复，多个列都可以标识为唯一索引</li>
</ul>
</li>
<li>常规索引
<ul>
<li>默认的，可以使用index，key关键字来设置</li>
</ul>
</li>
<li>全文索引
<ul>
<li>在特定的数据库引擎下才有，MyISAM</li>
<li>快速定位数据</li>
<li>只能用于CHAR，VARCHAR，TEXT数据列类型</li>
</ul>
</li>
</ul>
<p>基础语法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- 索引的使用
</span><span class="c1">-- 1、在创建表的时候给字段增加索引
</span><span class="c1">-- 2、创建完毕后，增加索引
</span><span class="c1"></span>
<span class="c1">-- 显示所有的索引信息
</span><span class="c1"></span><span class="k">SHOW</span> <span class="k">INDEX</span> <span class="k">FROM</span> <span class="n">student</span>

<span class="c1">-- 增加一个全文索引(索引名)   列名
</span><span class="c1"></span><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">school</span><span class="p">.</span><span class="n">student</span> <span class="k">ADD</span> <span class="n">FULLTEXT</span> <span class="k">INDEX</span> <span class="n">studentName</span><span class="p">(</span><span class="n">studentName</span><span class="p">);</span>

<span class="c1">-- EXPLAIN 分析sql执行的状况
</span><span class="c1"></span><span class="k">EXPLAIN</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">student</span><span class="p">;</span> <span class="c1">--- 非全文索引
</span><span class="c1"></span>
<span class="k">EXPLAIN</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">student</span> <span class="k">WHERE</span> <span class="k">MATCH</span><span class="p">(</span><span class="n">studentName</span><span class="p">)</span>  <span class="n">AGAINST</span><span class="p">(</span><span class="s1">&#39;刘&#39;</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p><a href="https://blog.csdn.net/jiadajing267/article/details/81269067" target="_blank" rel="noopener noreffer">关于EXPLAIN</a></p>
<h3 id="72扩展测试索引">7.2、扩展：测试索引</h3>
<p><strong>建表app_user：</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">app_user</span><span class="o">`</span> <span class="p">(</span>
		<span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="nb">bigint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="n">unsigned</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span><span class="p">,</span>
		<span class="o">`</span><span class="n">name</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="s1">&#39;&#39;</span> <span class="k">COMMENT</span> <span class="s1">&#39;用户昵称&#39;</span><span class="p">,</span>
		<span class="o">`</span><span class="n">email</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">&#39;用户邮箱&#39;</span><span class="p">,</span>
		<span class="o">`</span><span class="n">phone</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="s1">&#39;&#39;</span> <span class="k">COMMENT</span> <span class="s1">&#39;手机号&#39;</span><span class="p">,</span>
		<span class="o">`</span><span class="n">gender</span><span class="o">`</span> <span class="n">tinyint</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">unsigned</span> <span class="k">DEFAULT</span> <span class="s1">&#39;0&#39;</span> <span class="k">COMMENT</span> <span class="s1">&#39;性别（0:男；1：女）&#39;</span><span class="p">,</span>
		<span class="o">`</span><span class="n">password</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">&#39;密码&#39;</span><span class="p">,</span>
		<span class="o">`</span><span class="n">age</span><span class="o">`</span> <span class="n">tinyint</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="s1">&#39;0&#39;</span> <span class="k">COMMENT</span> <span class="s1">&#39;年龄&#39;</span><span class="p">,</span>
		<span class="o">`</span><span class="n">create_time</span><span class="o">`</span> <span class="n">datetime</span> <span class="k">DEFAULT</span> <span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>
		<span class="o">`</span><span class="n">update_time</span><span class="o">`</span> <span class="k">timestamp</span> <span class="k">NULL</span> <span class="k">DEFAULT</span> <span class="k">CURRENT_TIMESTAMP</span> <span class="k">ON</span> <span class="k">UPDATE</span>
		<span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>
		<span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">)</span>
<span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="k">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8mb4</span> <span class="k">COMMENT</span><span class="o">=</span><span class="s1">&#39;app用户表&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>批量插入数据：100w</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">DROP</span> <span class="k">FUNCTION</span> <span class="k">IF</span> <span class="k">EXISTS</span> <span class="n">mock_data</span><span class="p">;</span>
<span class="k">DELIMITER</span> <span class="err">$$</span>
<span class="k">CREATE</span> <span class="k">FUNCTION</span> <span class="n">mock_data</span><span class="p">()</span>
<span class="k">RETURNS</span> <span class="nb">INT</span>
<span class="k">BEGIN</span>
	<span class="k">DECLARE</span> <span class="n">num</span> <span class="nb">INT</span> <span class="k">DEFAULT</span> <span class="mi">1000000</span><span class="p">;</span>
	<span class="k">DECLARE</span> <span class="n">i</span> <span class="nb">INT</span> <span class="k">DEFAULT</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">WHILE</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num</span> <span class="k">DO</span>
		<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">app_user</span><span class="p">(</span><span class="o">`</span><span class="n">name</span><span class="o">`</span><span class="p">,</span> <span class="o">`</span><span class="n">email</span><span class="o">`</span><span class="p">,</span> <span class="o">`</span><span class="n">phone</span><span class="o">`</span><span class="p">,</span> <span class="o">`</span><span class="n">gender</span><span class="o">`</span><span class="p">,</span> <span class="o">`</span><span class="n">password</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">age</span><span class="o">`</span><span class="p">)</span>
		<span class="k">VALUES</span><span class="p">(</span><span class="n">CONCAT</span><span class="p">(</span><span class="s1">&#39;用户&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s1">&#39;24736743@qq.com&#39;</span><span class="p">,</span> <span class="n">CONCAT</span><span class="p">(</span><span class="s1">&#39;18&#39;</span><span class="p">,</span> <span class="n">FLOOR</span><span class="p">(</span><span class="n">RAND</span><span class="p">()</span><span class="o">*</span>
		<span class="p">(</span><span class="mi">999999999</span><span class="o">-</span><span class="mi">100000000</span><span class="p">)</span><span class="o">+</span><span class="mi">100000000</span><span class="p">)),</span><span class="n">FLOOR</span><span class="p">(</span><span class="n">RAND</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span><span class="n">UUID</span><span class="p">(),</span>
		<span class="n">FLOOR</span><span class="p">(</span><span class="n">RAND</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">));</span>
		<span class="k">SET</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">END</span> <span class="n">WHILE</span><span class="p">;</span>
	<span class="k">RETURN</span> <span class="n">i</span><span class="p">;</span>
<span class="k">END</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="n">mock_data</span><span class="p">();</span>

<span class="o">#</span> <span class="err">创建一个索引</span>
<span class="c1">-- 格式：id_表名_字段名
</span><span class="c1"></span><span class="k">CREATE</span> <span class="k">INDEX</span> <span class="err">索引名</span> <span class="k">on</span> <span class="err">表</span><span class="p">(</span><span class="err">字段</span><span class="p">)</span>
<span class="k">CREATE</span> <span class="k">INDEX</span> <span class="n">id_user_app_name</span> <span class="k">ON</span> <span class="n">user_app</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>索引效率测试</strong></p>
<ul>
<li>无索引</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">app_user</span> <span class="k">WHERE</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;用户9999&#39;</span><span class="p">;</span> <span class="c1">-- 查看耗时
</span><span class="c1"></span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">app_user</span> <span class="k">WHERE</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;用户9999&#39;</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">app_user</span> <span class="k">WHERE</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;用户9999&#39;</span><span class="p">;</span>


<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">EXPLAIN</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">app_user</span> <span class="k">WHERE</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;用户9999&#39;</span><span class="err">\</span><span class="k">G</span>
<span class="o">***************************</span> <span class="mi">1</span><span class="p">.</span> <span class="k">row</span> <span class="o">***************************</span>
							<span class="n">id</span><span class="p">:</span> <span class="mi">1</span>
							<span class="n">select_type</span><span class="p">:</span> <span class="k">SIMPLE</span>
							<span class="k">table</span><span class="p">:</span> <span class="n">app_user</span>
							<span class="n">partitions</span><span class="p">:</span> <span class="k">NULL</span>
							<span class="k">type</span><span class="p">:</span> <span class="k">ALL</span>
							<span class="n">possible_keys</span><span class="p">:</span> <span class="k">NULL</span>
							<span class="k">key</span><span class="p">:</span> <span class="k">NULL</span>
							<span class="n">key_len</span><span class="p">:</span> <span class="k">NULL</span>
							<span class="k">ref</span><span class="p">:</span> <span class="k">NULL</span>
							<span class="k">rows</span><span class="p">:</span> <span class="mi">992759</span>
							<span class="n">filtered</span><span class="p">:</span> <span class="mi">10</span><span class="p">.</span><span class="mi">00</span>
							<span class="n">Extra</span><span class="p">:</span> <span class="k">Using</span> <span class="k">where</span>
<span class="mi">1</span> <span class="k">row</span> <span class="k">in</span> <span class="k">set</span><span class="p">,</span> <span class="mi">1</span> <span class="n">warning</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823195926.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823195926.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823195926.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823195926.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823195926.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823195926.png" /></p>
<p><strong>创建索引</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">CREATE</span> <span class="k">INDEX</span> <span class="n">idx_app_user_name</span> <span class="k">ON</span> <span class="n">app_user</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>测试普通索引</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">EXPLAIN</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">app_user</span> <span class="k">WHERE</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;用户9999&#39;</span><span class="err">\</span><span class="k">G</span>
<span class="o">***************************</span> <span class="mi">1</span><span class="p">.</span> <span class="k">row</span> <span class="o">***************************</span>
						<span class="n">id</span><span class="p">:</span> <span class="mi">1</span>
						<span class="n">select_type</span><span class="p">:</span> <span class="k">SIMPLE</span>
						<span class="k">table</span><span class="p">:</span> <span class="n">app_user</span>
						<span class="n">partitions</span><span class="p">:</span> <span class="k">NULL</span>
						<span class="k">type</span><span class="p">:</span> <span class="k">ref</span>
						<span class="n">possible_keys</span><span class="p">:</span> <span class="n">idx_app_user_name</span>
						<span class="k">key</span><span class="p">:</span> <span class="n">idx_app_user_name</span>
						<span class="n">key_len</span><span class="p">:</span> <span class="mi">203</span>
						<span class="k">ref</span><span class="p">:</span> <span class="n">const</span>
						<span class="k">rows</span><span class="p">:</span> <span class="mi">1</span>
						<span class="n">filtered</span><span class="p">:</span> <span class="mi">100</span><span class="p">.</span><span class="mi">00</span>
						<span class="n">Extra</span><span class="p">:</span> <span class="k">NULL</span>
<span class="mi">1</span> <span class="k">row</span> <span class="k">in</span> <span class="k">set</span><span class="p">,</span> <span class="mi">1</span> <span class="n">warning</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>

<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">app_user</span> <span class="k">WHERE</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;用户9999&#39;</span><span class="p">;</span>
<span class="mi">1</span> <span class="k">row</span> <span class="k">in</span> <span class="k">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>

<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">app_user</span> <span class="k">WHERE</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;用户9999&#39;</span><span class="p">;</span>
<span class="mi">1</span> <span class="k">row</span> <span class="k">in</span> <span class="k">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>

<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">app_user</span> <span class="k">WHERE</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;用户9999&#39;</span><span class="p">;</span>
<span class="mi">1</span> <span class="k">row</span> <span class="k">in</span> <span class="k">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823195943.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823195943.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823195943.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823195943.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823195943.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823195943.png" /></p>
<pre><code>索引在小数据量的时候，用户不大，但是在大数据的时候，区别十分明显
</code></pre>
<h3 id="73索引原则">7.3、索引原则</h3>
<ul>
<li>索引不是越多越好</li>
<li>不要对经常变动的数据加索引(因为又得重新查询)</li>
<li>小数据量的表不需要加索引</li>
<li>索引一般加载常用来查询的字段上！</li>
</ul>
<h3 id="74索引的数据结构">7.4、索引的数据结构</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- 我们可以在创建上述索引的时候，为其指定索引类型，分两类
</span><span class="c1"></span><span class="n">hash类型的索引</span><span class="err">：查询单条快，范围查询慢</span>
<span class="n">btree类型的索引</span><span class="err">：</span><span class="n">b</span><span class="o">+</span><span class="err">树，层数越多，数据量指数级增长（我们就用它，因为</span><span class="n">innodb默认支持它</span><span class="err">）</span>

<span class="c1">-- 不同的存储引擎支持的索引类型也不一样
</span><span class="c1"></span><span class="n">InnoDB</span> <span class="err">支持事务，支持行级别锁定，支持</span> <span class="n">B</span><span class="o">-</span><span class="n">tree</span><span class="err">、</span><span class="k">Full</span><span class="o">-</span><span class="nb">text</span> <span class="err">等索引，不支持</span> <span class="n">Hash</span> <span class="err">索引；</span>
<span class="n">MyISAM</span> <span class="err">不支持事务，支持表级别锁定，支持</span> <span class="n">B</span><span class="o">-</span><span class="n">tree</span><span class="err">、</span><span class="k">Full</span><span class="o">-</span><span class="nb">text</span> <span class="err">等索引，不支持</span> <span class="n">Hash</span> <span class="err">索引；</span>
<span class="n">Memory</span> <span class="err">不支持事务，支持表级别锁定，支持</span> <span class="n">B</span><span class="o">-</span><span class="n">tree</span><span class="err">、</span><span class="n">Hash</span> <span class="err">等索引，不支持</span> <span class="k">Full</span><span class="o">-</span><span class="nb">text</span> <span class="err">索引；</span>
<span class="n">NDB</span> <span class="err">支持事务，支持行级别锁定，支持</span> <span class="n">Hash</span> <span class="err">索引，不支持</span> <span class="n">B</span><span class="o">-</span><span class="n">tree</span><span class="err">、</span><span class="k">Full</span><span class="o">-</span><span class="nb">text</span> <span class="err">等索引；</span>
<span class="n">Archive</span> <span class="err">不支持事务，支持表级别锁定，不支持</span> <span class="n">B</span><span class="o">-</span><span class="n">tree</span><span class="err">、</span><span class="n">Hash</span><span class="err">、</span><span class="k">Full</span><span class="o">-</span><span class="nb">text</span> <span class="err">等索引；</span>
</code></pre></td></tr></table>
</div>
</div><p><a href="http://blog.codinglabs.org/articles/theory-of-mysql-index.html" target="_blank" rel="noopener noreffer">关于索引的本质</a></p>
<h2 id="8权限管理和备份">8、权限管理和备份</h2>
<h3 id="81用户管理">8.1、用户管理</h3>
<blockquote>
<p>SQLyog可视化界面</p>
</blockquote>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823202306.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823202306.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823202306.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823202306.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823202306.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823202306.png" /></p>
<blockquote>
<p>SQL命令操作</p>
</blockquote>
<p>用户表：<code>mysql.user</code></p>
<p>本质：对这张表进行增删改查</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- 创建用户 CREATE USER 用户名 IDENTIFIED BY &#39;密码&#39;
</span><span class="c1"></span><span class="k">CREATE</span> <span class="k">USER</span> <span class="n">clover</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">&#39;1234566&#39;</span><span class="p">;</span>

<span class="c1">-- 修改密码(修改当前用户的密码)
</span><span class="c1"></span><span class="k">SET</span> <span class="n">PASSWORD</span> <span class="o">=</span> <span class="n">PASSWORD</span><span class="p">(</span><span class="s1">&#39;123456&#39;</span><span class="p">)</span>

<span class="c1">-- 修改密码(修改指定用户的密码)
</span><span class="c1"></span><span class="k">SET</span> <span class="n">PASSWORD</span> <span class="k">FOR</span> <span class="n">clover</span><span class="o">=</span> <span class="n">PASSWORD</span><span class="p">(</span><span class="s1">&#39;123456&#39;</span><span class="p">)</span>

<span class="c1">-- 重命名 RENAME USER 原来名字 TO 新名字
</span><span class="c1"></span><span class="k">RENAME</span> <span class="k">USER</span> <span class="n">clover</span> <span class="k">TO</span> <span class="n">cloverfelix</span>

<span class="c1">-- 用户授权 ALL PRIVILEGES 全部的权限，库.表
</span><span class="c1">-- ALL PRIVILEGES 除了给别人授权，其它都可以干
</span><span class="c1"></span><span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">PRIVILEGES</span> <span class="k">ON</span> <span class="o">*</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="n">cloverfelix</span>

<span class="c1">-- 查询权限
</span><span class="c1"></span><span class="k">SHOW</span> <span class="n">GRANTS</span> <span class="k">FOR</span> <span class="n">cloverfelix</span>       <span class="c1">-- 查看指定用户的权限
</span><span class="c1"></span><span class="k">SHOW</span> <span class="n">GRANTS</span> <span class="k">FOR</span> <span class="n">root</span><span class="o">@</span><span class="n">localhost</span>

<span class="c1">-- ROOT用户权限：GRANT ALL PRIVILEGES ON *.* TO &#39;root&#39;@&#39;localhost&#39; WITH GRANT　OPTION
</span><span class="c1"></span>
<span class="c1">-- 撤销权限 REVOKE 哪些权限   在哪个库撤销，给谁撤销
</span><span class="c1"></span><span class="k">REVOKE</span> <span class="k">ALL</span> <span class="k">PRIVILEGES</span> <span class="k">ON</span> <span class="o">*</span><span class="p">.</span><span class="o">*</span> <span class="k">FROM</span> <span class="n">cloverfelix</span>

<span class="c1">-- 删除用户
</span><span class="c1"></span><span class="k">DROP</span> <span class="k">USER</span> <span class="n">cloverfelix</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>基本命令</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="cm">/* 用户和权限管理 */</span> <span class="c1">------------------
</span><span class="c1"></span><span class="err">用户信息表：</span><span class="n">mysql</span><span class="p">.</span><span class="k">user</span>

<span class="c1">-- 刷新权限
</span><span class="c1"></span><span class="n">FLUSH</span> <span class="k">PRIVILEGES</span>

<span class="c1">-- 增加用户 CREATE USER kuangshen IDENTIFIED BY &#39;123456&#39;
</span><span class="c1"></span><span class="k">CREATE</span> <span class="k">USER</span> <span class="err">用户名</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="p">[</span><span class="n">PASSWORD</span><span class="p">]</span> <span class="err">密码</span><span class="p">(</span><span class="err">字符串</span><span class="p">)</span>
		<span class="o">-</span> <span class="err">必须拥有</span><span class="n">mysql数据库的全局CREATE</span> <span class="n">USER权限</span><span class="err">，或拥有</span><span class="n">INSERT权限</span><span class="err">。</span>
		<span class="o">-</span> <span class="err">只能创建用户，不能赋予权限。</span>
		<span class="o">-</span> <span class="err">用户名，注意引号：如</span> <span class="s1">&#39;user_name&#39;</span><span class="o">@</span><span class="s1">&#39;192.168.1.1&#39;</span>
		<span class="o">-</span> <span class="err">密码也需引号，纯数字密码也要加引号</span>
		<span class="o">-</span> <span class="err">要在纯文本中指定密码，需忽略</span><span class="n">PASSWORD关键词</span><span class="err">。要把密码指定为由</span><span class="n">PASSWORD</span><span class="p">()</span><span class="err">函数返回的混编值，需包含关键字</span><span class="n">PASSWORD</span>
		
<span class="c1">-- 重命名用户 RENAME USER kuangshen TO kuangshen2
</span><span class="c1"></span><span class="k">RENAME</span> <span class="k">USER</span> <span class="n">old_user</span> <span class="k">TO</span> <span class="n">new_user</span>

<span class="c1">-- 设置密码
</span><span class="c1"></span><span class="k">SET</span> <span class="n">PASSWORD</span> <span class="o">=</span> <span class="n">PASSWORD</span><span class="p">(</span><span class="s1">&#39;密码&#39;</span><span class="p">)</span> <span class="c1">-- 为当前用户设置密码
</span><span class="c1"></span><span class="k">SET</span> <span class="n">PASSWORD</span> <span class="k">FOR</span> <span class="err">用户名</span> <span class="o">=</span> <span class="n">PASSWORD</span><span class="p">(</span><span class="s1">&#39;密码&#39;</span><span class="p">)</span> <span class="c1">-- 为指定用户设置密码
</span><span class="c1"></span>
<span class="c1">-- 删除用户 DROP USER kuangshen2
</span><span class="c1"></span><span class="k">DROP</span> <span class="k">USER</span> <span class="err">用户名</span>

<span class="c1">-- 分配权限/添加用户
</span><span class="c1"></span><span class="k">GRANT</span> <span class="err">权限列表</span> <span class="k">ON</span> <span class="err">表名</span> <span class="k">TO</span> <span class="err">用户名</span> <span class="p">[</span><span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="p">[</span><span class="n">PASSWORD</span><span class="p">]</span> <span class="s1">&#39;password&#39;</span><span class="p">]</span>
		<span class="o">-</span> <span class="k">all</span> <span class="k">privileges</span> <span class="err">表示所有权限</span>
		<span class="o">-</span> <span class="o">*</span><span class="p">.</span><span class="o">*</span> <span class="err">表示所有库的所有表</span>
		<span class="o">-</span> <span class="err">库名</span><span class="p">.</span><span class="err">表名</span> <span class="err">表示某库下面的某表</span>
		
<span class="c1">-- 查看权限 SHOW GRANTS FOR root@localhost;
</span><span class="c1"></span><span class="k">SHOW</span> <span class="n">GRANTS</span> <span class="k">FOR</span> <span class="err">用户名</span>

<span class="c1">-- 查看当前用户权限
</span><span class="c1"></span><span class="k">SHOW</span> <span class="n">GRANTS</span><span class="p">;</span> <span class="err">或</span> <span class="k">SHOW</span> <span class="n">GRANTS</span> <span class="k">FOR</span> <span class="k">CURRENT_USER</span><span class="p">;</span> <span class="err">或</span> <span class="k">SHOW</span> <span class="n">GRANTS</span> <span class="k">FOR</span>
<span class="k">CURRENT_USER</span><span class="p">();</span>

<span class="c1">-- 撤消权限
</span><span class="c1"></span><span class="k">REVOKE</span> <span class="err">权限列表</span> <span class="k">ON</span> <span class="err">表名</span> <span class="k">FROM</span> <span class="err">用户名</span>
<span class="k">REVOKE</span> <span class="k">ALL</span> <span class="k">PRIVILEGES</span><span class="p">,</span> <span class="k">GRANT</span> <span class="k">OPTION</span> <span class="k">FROM</span> <span class="err">用户名</span> <span class="c1">-- 撤销所有权限
</span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>权限解释</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- 权限列表
</span><span class="c1"></span><span class="k">ALL</span> <span class="p">[</span><span class="k">PRIVILEGES</span><span class="p">]</span> <span class="c1">-- 设置除GRANT OPTION之外的所有简单权限
</span><span class="c1"></span><span class="k">ALTER</span> <span class="c1">-- 允许使用ALTER TABLE
</span><span class="c1"></span><span class="k">ALTER</span> <span class="k">ROUTINE</span> <span class="c1">-- 更改或取消已存储的子程序
</span><span class="c1"></span><span class="k">CREATE</span> <span class="c1">-- 允许使用CREATE TABLE
</span><span class="c1"></span><span class="k">CREATE</span> <span class="k">ROUTINE</span> <span class="c1">-- 创建已存储的子程序
</span><span class="c1"></span><span class="k">CREATE</span> <span class="k">TEMPORARY</span> <span class="n">TABLES</span> <span class="c1">-- 允许使用CREATE TEMPORARY TABLE
</span><span class="c1"></span><span class="k">CREATE</span> <span class="k">USER</span> <span class="c1">-- 允许使用CREATE USER, DROP USER, RENAME USER和REVOKE ALL
</span><span class="c1"></span><span class="k">PRIVILEGES</span><span class="err">。</span>
<span class="k">CREATE</span> <span class="k">VIEW</span> <span class="c1">-- 允许使用CREATE VIEW
</span><span class="c1"></span><span class="k">DELETE</span> <span class="c1">-- 允许使用DELETE
</span><span class="c1"></span><span class="k">DROP</span> <span class="c1">-- 允许使用DROP TABLE
</span><span class="c1"></span><span class="k">EXECUTE</span> <span class="c1">-- 允许用户运行已存储的子程序
</span><span class="c1"></span><span class="n">FILE</span> <span class="c1">-- 允许使用SELECT...INTO OUTFILE和LOAD DATA INFILE
</span><span class="c1"></span><span class="k">INDEX</span> <span class="c1">-- 允许使用CREATE INDEX和DROP INDEX
</span><span class="c1"></span><span class="k">INSERT</span> <span class="c1">-- 允许使用INSERT
</span><span class="c1"></span><span class="k">LOCK</span> <span class="n">TABLES</span> <span class="c1">-- 允许对您拥有SELECT权限的表使用LOCK TABLES
</span><span class="c1"></span><span class="n">PROCESS</span> <span class="c1">-- 允许使用SHOW FULL PROCESSLIST
</span><span class="c1"></span><span class="k">REFERENCES</span> <span class="c1">-- 未被实施
</span><span class="c1"></span><span class="n">RELOAD</span> <span class="c1">-- 允许使用FLUSH
</span><span class="c1"></span><span class="n">REPLICATION</span> <span class="n">CLIENT</span> <span class="c1">-- 允许用户询问从属服务器或主服务器的地址
</span><span class="c1"></span><span class="n">REPLICATION</span> <span class="n">SLAVE</span> <span class="c1">-- 用于复制型从属服务器（从主服务器中读取二进制日志事件）
</span><span class="c1"></span><span class="k">SELECT</span> <span class="c1">-- 允许使用SELECT
</span><span class="c1"></span><span class="k">SHOW</span> <span class="n">DATABASES</span> <span class="c1">-- 显示所有数据库
</span><span class="c1"></span><span class="k">SHOW</span> <span class="k">VIEW</span> <span class="c1">-- 允许使用SHOW CREATE VIEW
</span><span class="c1"></span><span class="n">SHUTDOWN</span> <span class="c1">-- 允许使用mysqladmin shutdown
</span><span class="c1"></span><span class="n">SUPER</span> <span class="c1">-- 允许使用CHANGE MASTER, KILL, PURGE MASTER LOGS和SET GLOBAL语句，
</span><span class="c1"></span><span class="n">mysqladmin</span> <span class="n">debug命令</span><span class="err">；允许您连接（一次），即使已达到</span><span class="n">max_connections</span><span class="err">。</span>
<span class="k">UPDATE</span> <span class="c1">-- 允许使用UPDATE
</span><span class="c1"></span><span class="k">USAGE</span> <span class="c1">-- “无权限”的同义词
</span><span class="c1"></span><span class="k">GRANT</span> <span class="k">OPTION</span> <span class="c1">-- 允许授予权限
</span><span class="c1"></span>
<span class="cm">/* 表维护 */</span>
<span class="c1">-- 分析和存储表的关键字分布
</span><span class="c1"></span><span class="k">ANALYZE</span> <span class="p">[</span><span class="k">LOCAL</span> <span class="o">|</span> <span class="n">NO_WRITE_TO_BINLOG</span><span class="p">]</span> <span class="k">TABLE</span> <span class="err">表名</span> <span class="p">...</span>
<span class="c1">-- 检查一个或多个表是否有错误
</span><span class="c1"></span><span class="k">CHECK</span> <span class="k">TABLE</span> <span class="n">tbl_name</span> <span class="p">[,</span> <span class="n">tbl_name</span><span class="p">]</span> <span class="p">...</span> <span class="p">[</span><span class="k">option</span><span class="p">]</span> <span class="p">...</span>
<span class="k">option</span> <span class="o">=</span> <span class="err">{</span><span class="n">QUICK</span> <span class="o">|</span> <span class="n">FAST</span> <span class="o">|</span> <span class="n">MEDIUM</span> <span class="o">|</span> <span class="n">EXTENDED</span> <span class="o">|</span> <span class="n">CHANGED</span><span class="err">}</span>
<span class="c1">-- 整理数据文件的碎片
</span><span class="c1"></span><span class="n">OPTIMIZE</span> <span class="p">[</span><span class="k">LOCAL</span> <span class="o">|</span> <span class="n">NO_WRITE_TO_BINLOG</span><span class="p">]</span> <span class="k">TABLE</span> <span class="n">tbl_name</span> <span class="p">[,</span> <span class="n">tbl_name</span><span class="p">]</span> <span class="p">...</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="82数据库备份">8.2、数据库备份</h3>
<p>使用命令行导出 <code>mysqldump</code> 命令行使用</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="o">#</span> <span class="n">mysqldump</span> <span class="o">-</span><span class="n">h</span> <span class="err">主机</span> <span class="o">-</span><span class="n">u</span> <span class="err">用户名</span> <span class="o">-</span><span class="n">p</span>  <span class="err">密码</span> <span class="err">数据库</span> <span class="err">表</span> <span class="o">&gt;</span><span class="err">物理磁盘位置</span><span class="o">/</span><span class="err">文件名</span>
<span class="n">mysqldump</span> <span class="o">-</span><span class="n">hlocalhost</span> <span class="o">-</span><span class="n">uroot</span> <span class="o">-</span><span class="n">pxn123456</span> <span class="n">mybatis</span> <span class="k">user</span> <span class="o">&gt;</span><span class="n">H</span><span class="p">:</span><span class="o">/</span><span class="n">a</span><span class="p">.</span><span class="k">sql</span>

<span class="o">#</span> <span class="n">mysqldump</span> <span class="o">-</span><span class="n">h</span> <span class="err">主机</span> <span class="o">-</span><span class="n">u</span> <span class="err">用户名</span> <span class="o">-</span><span class="n">p</span>  <span class="err">密码</span> <span class="err">数据库</span> <span class="err">表</span><span class="mi">1</span> <span class="err">表</span><span class="mi">2</span> <span class="err">表</span><span class="mi">3</span> <span class="o">&gt;</span><span class="err">物理磁盘位置</span><span class="o">/</span><span class="err">文件名</span>
<span class="n">mysqldump</span> <span class="o">-</span><span class="n">hlocalhost</span> <span class="o">-</span><span class="n">uroot</span> <span class="o">-</span><span class="n">pxn123456</span> <span class="n">mybatis</span> <span class="n">user1</span> <span class="n">user2</span> <span class="n">user3</span> <span class="o">&gt;</span><span class="n">H</span><span class="p">:</span><span class="o">/</span><span class="n">a</span><span class="p">.</span><span class="k">sql</span>

<span class="o">#</span> <span class="n">mysqldump</span> <span class="o">-</span><span class="n">h</span> <span class="err">主机</span> <span class="o">-</span><span class="n">u</span> <span class="err">用户名</span> <span class="o">-</span><span class="n">p</span>  <span class="err">密码</span> <span class="err">数据库</span> <span class="o">&gt;</span><span class="err">物理磁盘位置</span><span class="o">/</span><span class="err">文件名</span>
<span class="n">mysqldump</span> <span class="o">-</span><span class="n">hlocalhost</span> <span class="o">-</span><span class="n">uroot</span> <span class="o">-</span><span class="n">pxn123456</span> <span class="n">mybatisr</span> <span class="o">&gt;</span><span class="n">H</span><span class="p">:</span><span class="o">/</span><span class="n">a</span><span class="p">.</span><span class="k">sql</span>

<span class="o">#</span> <span class="err">导入</span>
<span class="o">#</span> <span class="err">在登录的情况下，切换到指定的数据库</span>
<span class="o">#</span> <span class="k">source</span>  <span class="err">备份文件</span>
<span class="k">source</span> <span class="n">H</span><span class="p">:</span><span class="o">/</span><span class="n">a</span><span class="p">.</span><span class="k">sql</span>

<span class="o">#</span> <span class="err">一步完成</span> 
<span class="n">mysql</span> <span class="o">-</span><span class="n">u用户名</span> <span class="o">-</span><span class="n">p密码</span> <span class="err">库名</span><span class="o">&lt;</span> <span class="err">备份文件</span>
</code></pre></td></tr></table>
</div>
</div><p>如下图所示即可成功，需要进入mysql安装目录下的bin目录在使用cmd命令</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823210720.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823210720.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823210720.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823210720.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823210720.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823210720.png" /></p>
<p>如果在管理员模式下运行不成功说明你环境配置有问题，取环境变量中的path选项中加入MySQL安装目录下的bin所在位置即可</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823211210.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823211210.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823211210.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823211210.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823211210.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210823211210.png" /></p>
<h2 id="9规范化数据库">9、规范化数据库</h2>
<h3 id="91为什么需要数据库设计">9.1、为什么需要数据库设计</h3>
<p><strong>糟糕的数据库设计</strong></p>
<ul>
<li>数据冗余，存储空间浪费</li>
<li>数据更新和插入的异常</li>
<li>程序性能差</li>
</ul>
<p><strong>良好的数据库设计</strong></p>
<ul>
<li>节省数据的存储空间</li>
<li>能够保证数据的完整性</li>
<li>方便进行数据库应用系统的开发</li>
</ul>
<p><strong>软件项目开发周期中数据库设计</strong></p>
<ul>
<li>需求分析阶段：分析客户的业务和数据处理需求</li>
<li>概要设计阶段：设计数据库的E-R模型图，确认需求信息的正确和完整</li>
</ul>
<p><strong>设计数据库步骤</strong></p>
<ul>
<li>收集信息
<ul>
<li>与该系统有关人员进行交流、座谈，充分了解用户需求，理解数据库需要完成的任务</li>
</ul>
</li>
<li>标识实体[Entity]
<ul>
<li>标识数据库要管理的关键对象或实体，实体一般是名词</li>
</ul>
</li>
<li>标识每个实体需要存储的详细信息[Attribute]</li>
<li>标识实体之间的关系[Relationship]</li>
</ul>
<h3 id="92三大范式">9.2、三大范式</h3>
<p><strong>问题：为什么需要数据规范化</strong></p>
<p>不合规范的表设计会导致的问题</p>
<ul>
<li>信息重复</li>
<li>更新异常</li>
<li>插入异常
<ul>
<li>无法正确表示信息</li>
</ul>
</li>
<li>删除异常
<ul>
<li>丢失有效信息</li>
</ul>
</li>
</ul>
<blockquote>
<p>百度搜索：三大范式</p>
</blockquote>
<p><strong>第一范式(1st NF)</strong></p>
<p>第一范式的目标是确保每列的原子性，如果每列都是<code>不可再分的最小数据单元</code>，则满足第一范式</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824104423.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824104423.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824104423.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824104423.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824104423.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824104423.png" /></p>
<p><strong>第二范式(2st NF)</strong></p>
<p>第二范式是在第一范式的基础上建立起来的，即满足第二范式必须先满足第一范式</p>
<p>第二范式要求每个表只描述一件事情</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824104442.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824104442.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824104442.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824104442.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824104442.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824104442.png" /></p>
<p><strong>第三范式(3st NF)</strong></p>
<p>如果一个关系满足第二范式，并且非主键列都不传递依赖于主键列，则满足第三范式</p>
<p>第三范式需要确保数据表中的每一列数据都和主键直接相关，而不能间接相关</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824104508.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824104508.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824104508.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824104508.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824104508.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824104508.png" /></p>
<p><strong>规范化和性能的关系</strong></p>
<ul>
<li>为满足某种商业目标，数据库性能比规范化数据库更重要</li>
<li>在数据规范化的同时，要综合考虑数据库的性能</li>
<li>通过在给定的表中添加额外的字段，一减少需要从中搜索信息所需要的时间</li>
<li>通过在给的的表中插入计算列，以方便查询</li>
</ul>
<h2 id="10jdbc">10、JDBC</h2>
<h3 id="101数据库驱动">10.1、数据库驱动</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824210410.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824210410.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824210410.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824210410.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824210410.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824210410.png" /></p>
<p>我们的程序会通过数据库驱动和数据库打交道！！</p>
<h3 id="102jdbc介绍">10.2、JDBC介绍</h3>
<p>SUN公司为了简化开发人员的(对数据库的统一)操作，提供了一个(Java操作数据库的)规范，俗称JDBC</p>
<p>这些规范的实现由具体的厂商取做</p>
<p>对于开发人员来说，我们只需要掌握JDBC接口的操作即可</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824210632.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824210632.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824210632.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824210632.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824210632.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824210632.png" /></p>
<h3 id="103编写jdbc程序">10.3、编写JDBC程序</h3>
<blockquote>
<p>搭建实验环境</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">jdbcStudy</span> <span class="nb">CHARACTER</span> <span class="k">SET</span> <span class="n">utf8</span> <span class="k">COLLATE</span> <span class="n">utf8_general_ci</span><span class="p">;</span>

<span class="n">USE</span> <span class="n">jdbcStudy</span><span class="p">;</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">users</span><span class="p">(</span>
		<span class="n">id</span> <span class="nb">INT</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
		<span class="n">NAME</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span>
		<span class="n">PASSWORD</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span>
		<span class="n">email</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">60</span><span class="p">),</span>
		<span class="n">birthday</span> <span class="nb">DATE</span>
<span class="p">);</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">users</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">NAME</span><span class="p">,</span><span class="n">PASSWORD</span><span class="p">,</span><span class="n">email</span><span class="p">,</span><span class="n">birthday</span><span class="p">)</span>
<span class="k">VALUES</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;zhansan&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">,</span><span class="s1">&#39;zs@sina.com&#39;</span><span class="p">,</span><span class="s1">&#39;1980-12-04&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;lisi&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">,</span><span class="s1">&#39;lisi@sina.com&#39;</span><span class="p">,</span><span class="s1">&#39;1981-12-04&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;wangwu&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">,</span><span class="s1">&#39;wangwu@sina.com&#39;</span><span class="p">,</span><span class="s1">&#39;1979-12-04&#39;</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>新建一个Java工程，并导入数据驱动</p>
</blockquote>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824120332.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824120332.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824120332.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824120332.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824120332.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824120332.png" /></p>
<blockquote>
<p>编写程序从user表中读取数据，并打印在命令行窗口中</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.kuang.lesson01</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.DriverManager</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Statement</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JdbcFirstDemo</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
			<span class="c1">//要连接的数据库URL
</span><span class="c1"></span>			<span class="n">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">&#34;jdbc:mysql://localhost:3306/jdbcStudy?
</span><span class="s">			useUnicode=true&amp;characterEncoding=utf8&amp;useSSL=true&#34;</span><span class="o">;</span>
			
			<span class="c1">//连接的数据库时使用的用户名
</span><span class="c1"></span>			<span class="n">String</span> <span class="n">username</span> <span class="o">=</span> <span class="s">&#34;root&#34;</span><span class="o">;</span>
			
			<span class="c1">//连接的数据库时使用的密码
</span><span class="c1"></span>			<span class="n">String</span> <span class="n">password</span> <span class="o">=</span> <span class="s">&#34;123456&#34;</span><span class="o">;</span>
			
			<span class="c1">//1.加载驱动
</span><span class="c1"></span>			<span class="c1">//DriverManager.registerDriver(new com.mysql.jdbc.Driver());不推荐使用这种方式来加载驱动
</span><span class="c1"></span>			<span class="n">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">&#34;com.mysql.jdbc.Driver&#34;</span><span class="o">);</span><span class="c1">//推荐使用这种方式来加载驱动
</span><span class="c1"></span>			
			<span class="c1">//2.获取与数据库的链接  conn 代表数据库
</span><span class="c1"></span>			<span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="n">username</span><span class="o">,</span><span class="n">password</span><span class="o">);</span>
			
			<span class="c1">//3.获取用于向数据库发送sql语句的statement
</span><span class="c1"></span>			<span class="n">Statement</span> <span class="n">st</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">createStatement</span><span class="o">();</span>
			<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;select id,name,password,email,birthday from users&#34;</span><span class="o">;</span>
			
			<span class="c1">//4.向数据库发sql,并获取代表结果集的resultset
</span><span class="c1"></span>			<span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
			
			<span class="c1">//5.取出结果集的数据
</span><span class="c1"></span>			<span class="k">while</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">()){</span>
				<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;id=&#34;</span> <span class="o">+</span> <span class="n">rs</span><span class="o">.</span><span class="na">getObject</span><span class="o">(</span><span class="s">&#34;id&#34;</span><span class="o">));</span>
				<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;name=&#34;</span> <span class="o">+</span> <span class="n">rs</span><span class="o">.</span><span class="na">getObject</span><span class="o">(</span><span class="s">&#34;name&#34;</span><span class="o">));</span>
				<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;password=&#34;</span> <span class="o">+</span> <span class="n">rs</span><span class="o">.</span><span class="na">getObject</span><span class="o">(</span><span class="s">&#34;password&#34;</span><span class="o">));</span>
				<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;email=&#34;</span> <span class="o">+</span> <span class="n">rs</span><span class="o">.</span><span class="na">getObject</span><span class="o">(</span><span class="s">&#34;email&#34;</span><span class="o">));</span>
				<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;birthday=&#34;</span> <span class="o">+</span> <span class="n">rs</span><span class="o">.</span><span class="na">getObject</span><span class="o">(</span><span class="s">&#34;birthday&#34;</span><span class="o">));</span>
			<span class="o">}</span>
			
			<span class="c1">//6.关闭链接，释放资源
</span><span class="c1"></span>			<span class="n">rs</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
			<span class="n">st</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
			<span class="n">conn</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>步骤总结：</p>
<p>1、加载驱动</p>
<p>2、连接数据库DriverManager</p>
<p>3、获得执行sql的对象Statement</p>
<p>4、获得返回的结果集</p>
<p>5、释放连接</p>
<h3 id="104对象说明">10.4、对象说明</h3>
<blockquote>
<p>DriverManager类讲解</p>
</blockquote>
<p>Jdbc程序中的DriverManager用于加载驱动，并创建与数据库的连接，这个API常用方法</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="n">DriverManager</span><span class="o">.</span><span class="na">registerDriver</span><span class="o">(</span><span class="k">new</span> <span class="n">Driver</span><span class="o">());</span>
<span class="n">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="n">user</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
</code></pre></td></tr></table>
</div>
</div><p>注意：<strong>在实际开发中并不推荐采用registerDriver方法注册驱动</strong>。原因有二：</p>
<ol>
<li>查看Driver的源代码可以看到，如果采用此种方式，会导致驱动程序注册两次，也就是在内存中会有两个Driver对象</li>
<li>程序依赖MySQL的api，脱离MySQL的jar包，程序将无法编译，将来程序切换底层数据库将会非常麻烦</li>
</ol>
<p>推荐方式：<strong>Class.forName(&ldquo;com.mysql.jdbc.Driver&rdquo;);</strong></p>
<p>采用此种方式不会导致驱动对象在内存中重复出现，并且采用此种方式，程序仅仅只需要一个字符串，不需要依赖具体的驱动，使程序的灵活性更高</p>
<blockquote>
<p>数据库URL</p>
</blockquote>
<p>URL用于标识数据库的位置，通过URL地址告诉JDBC程序连接哪个数据库，URL的写法为：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824201059.png"
        data-srcset="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824201059.png, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824201059.png 1.5x, https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824201059.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824201059.png"
        title="https://cdn.jsdelivr.net/gh/cloverfelix/image/image/20210824201059.png" /></p>
<p>常用数据库URL地址的写法：</p>
<ul>
<li>Oracle写法：jdbc:oracle:thin:@localhost:1521:sid</li>
<li>SqlServer写法:jdbc:microsoft:sqlserver://localhost:1433;DatabaseName=sid</li>
<li>Mysqlxi写法：jdbc:mysql://localhost:3306/sid</li>
</ul>
<p>如果连接的使本地的MySQL数据库，并且连接使用的端口使3306，那么url地址可以简写为<code>jdbc:mysql:///数据库</code></p>
<blockquote>
<p>Connection类</p>
</blockquote>
<p>Jdbc程序中的Connection，它用于代表数据库的链接，Collection是数据库编程中最重要的一个对象，客户端与数据库所有交互都是通过connection对象完成的，这个对象的常用方法：</p>
<ul>
<li>createStatement()：创建向数据库发送sql的statement对象。</li>
<li><strong>prepareStatement(sql) ：创建向数据库发送预编译sql的PrepareSatement对象。</strong></li>
<li>setAutoCommit(boolean autoCommit)：设置事务是否自动提交。</li>
<li>commit() ：在链接上提交事务。</li>
<li>rollback() ：在此链接上回滚事务。</li>
</ul>
<blockquote>
<p>Statement类</p>
</blockquote>
<p>Jdbc程序中的Statement对象用于向数据库发送SQL语句， Statement对象常用方法：</p>
<ul>
<li>executeQuery(String sql) ：用于向数据发送查询语句。</li>
<li>executeUpdate(String sql)：用于向数据库发送insert、update或delete语句</li>
<li>execute(String sql)：用于向数据库发送任意sql语句</li>
<li>addBatch(String sql) ：把多条sql语句放到一个批处理中。</li>
<li>executeBatch()：向数据库发送一批sql语句执行。</li>
</ul>
<blockquote>
<p>ResultSet类</p>
</blockquote>
<p>Jdbc程序中的ResultSet用于代表Sql语句的执行结果。Resultset封装执行结果时，采用的类似于表格的 方式。ResultSet 对象维护了一个指向表格数据行的游标，初始的时候，<strong>游标在第一行之前</strong>，调用ResultSet.next() 方法，可以使游标指向具体的数据行，进行调用方法获取该行的数据。</p>
<p>ResultSet既然用于封装执行结果的，所以该对象提供的都是用于获取数据的get方法：</p>
<ul>
<li>获取任意类型的数据
<ul>
<li>getObject(int index)</li>
<li>getObject(string columnName)</li>
</ul>
</li>
<li>获取指定类型的数据，例如：
<ul>
<li>getString(int index)</li>
<li>getString(String columnName)</li>
</ul>
</li>
</ul>
<p>ResultSet还提供了对结果集进行滚动的方法：</p>
<ul>
<li>next()：移动到下一行</li>
<li>Previous()：移动到前一行</li>
<li>absolute(int row)：移动到指定行</li>
<li>beforeFirst()：移动resultSet的最前面。</li>
<li>afterLast() ：移动到resultSet的最后面。</li>
</ul>
<blockquote>
<p>释放资源</p>
</blockquote>
<p>Jdbc程序运行完后，切记要释放程序在运行过程中，创建的那些与数据库进行交互的对象，这些对象通常是<code>ResultSet, Statement和Connection对象</code>，<code>特别是Connection对象</code>，它是非常稀有的资源，用完后必须马上释放，如果Connection不能及时、正确的关闭，极易导致系统宕机。Connection的使用原则是尽量晚创建，尽量早的释放。</p>
<pre><code>为确保资源释放代码能运行，资源释放代码也一定要放在finally语句中。
</code></pre>
<h3 id="105statement对象">10.5、statement对象</h3>
<p>Jdbc中的statement对象用于向数据库发送SQL语句，想完成对数据库的增删改查，只需要通过这个对象向数据库发送增删改查语句即可。</p>
<p>Statement对象的executeUpdate方法，用于向数据库发送增、删、改的sql语句，executeUpdate执行完后，将会返回一个整数（即增删改语句导致了数据库几行数据发生了变化）。</p>
<p>Statement.executeQuery方法用于向数据库发送查询语句，executeQuery方法返回代表查询结果的
ResultSet对象。</p>
<blockquote>
<p>CRUD操作-create</p>
</blockquote>
<p>使用executeUpdate(String sql)方法完成数据添加操作，示例操作：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="n">Statement</span> <span class="n">st</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">createStatement</span><span class="o">();</span>
<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;insert into user(….) values(…..) &#34;</span><span class="o">;</span>
<span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
<span class="k">if</span><span class="o">(</span><span class="n">num</span><span class="o">&gt;</span><span class="n">0</span><span class="o">){</span>
	<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;插入成功！！！&#34;</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>CRUD操作-update</p>
</blockquote>
<p>使用executeUpdate(String sql)方法完成数据修改操作，示例操作：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="n">Statement</span> <span class="n">st</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">createStatement</span><span class="o">();</span>
<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;update user set name=&#39;&#39; where name=&#39;&#39;&#34;</span><span class="o">;</span>
<span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
<span class="k">if</span><span class="o">(</span><span class="n">num</span><span class="o">&gt;</span><span class="n">0</span><span class="o">){</span>
	<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="err">“</span><span class="n">修改成功</span><span class="err">！！！&#34;</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>CRUD操作-read</p>
</blockquote>
<p>使用executeQuery(String sql)方法完成数据查询操作，示例操作：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="n">Statement</span> <span class="n">st</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">createStatement</span><span class="o">();</span>
<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;select * from user where id=1&#34;</span><span class="o">;</span>
<span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
<span class="k">while</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">()){</span>
		<span class="c1">//根据获取列的数据类型，分别调用rs的相应方法映射到java对象中
</span><span class="c1"></span><span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>使用jdbc对数据库增删改查</strong></p>
<ol>
<li>新建一个lesson02的包</li>
<li>在src目录下创建一个个db.properties文件，如下图所示：</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml">driver=com.mysql.jdbc.Driver
url=jdbc:mysql://localhost:3306/jdbcStudy?useUnicode=true<span class="err">&amp;</span>characterEncoding=utf8<span class="err">&amp;</span>useSSL=true
username=root
password=xn123456
</code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>在lesson02 下新建一个 utils 包，新建一个类 <code>JdbcUtils</code></li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.kuang.lesson02.utils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.DriverManager</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Statement</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Properties</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JdbcUtils</span> <span class="o">{</span>
		<span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">driver</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">url</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">username</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">password</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		
		<span class="kd">static</span><span class="o">{</span>
			<span class="k">try</span><span class="o">{</span>
				<span class="c1">//读取db.properties文件中的数据库连接信息
</span><span class="c1"></span>				<span class="n">InputStream</span> <span class="n">in</span> <span class="o">=</span><span class="n">JdbcUtils</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getClassLoader</span><span class="o">().</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="s">&#34;db.properties&#34;</span><span class="o">);</span>
				<span class="n">Properties</span> <span class="n">prop</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Properties</span><span class="o">();</span>
				<span class="n">prop</span><span class="o">.</span><span class="na">load</span><span class="o">(</span><span class="n">in</span><span class="o">);</span>
				
				<span class="c1">//获取数据库连接驱动
</span><span class="c1"></span>				<span class="n">driver</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">&#34;driver&#34;</span><span class="o">);</span>
				<span class="c1">//获取数据库连接URL地址
</span><span class="c1"></span>				<span class="n">url</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">&#34;url&#34;</span><span class="o">);</span>
				<span class="c1">//获取数据库连接用户名
</span><span class="c1"></span>				<span class="n">username</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">&#34;username&#34;</span><span class="o">);</span>
				<span class="c1">//获取数据库连接密码
</span><span class="c1"></span>				<span class="n">password</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">&#34;password&#34;</span><span class="o">);</span>
				
				<span class="c1">//加载数据库驱动
</span><span class="c1"></span>				<span class="n">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="n">driver</span><span class="o">);</span>
			<span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
				<span class="k">throw</span> <span class="k">new</span> <span class="n">ExceptionInInitializerError</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
			<span class="o">}</span>
		<span class="o">}</span>
		<span class="c1">// 获取数据库连接对象
</span><span class="c1"></span>		<span class="kd">public</span> <span class="kd">static</span> <span class="n">Connection</span> <span class="nf">getConnection</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">SQLException</span><span class="o">{</span>
		<span class="k">return</span> <span class="n">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="n">username</span><span class="o">,</span><span class="n">password</span><span class="o">);</span>
		<span class="o">}</span>
		<span class="c1">// 释放资源，要释放的资源包括Connection数据库连接对象，负责执行SQL命令的Statement对象，存储查询结果的ResultSet对象
</span><span class="c1"></span>		<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">release</span><span class="o">(</span><span class="n">Connection</span> <span class="n">conn</span><span class="o">,</span><span class="n">Statement</span> <span class="n">st</span><span class="o">,</span><span class="n">ResultSet</span> <span class="n">rs</span><span class="o">){</span>
			<span class="k">if</span><span class="o">(</span><span class="n">rs</span><span class="o">!=</span><span class="kc">null</span><span class="o">){</span>
				<span class="k">try</span><span class="o">{</span>
						<span class="c1">//关闭存储查询结果的ResultSet对象
</span><span class="c1"></span>						<span class="n">rs</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
					<span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
						<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
					<span class="o">}</span>
					<span class="n">rs</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
				<span class="o">}</span>
				<span class="k">if</span><span class="o">(</span><span class="n">st</span><span class="o">!=</span><span class="kc">null</span><span class="o">){</span>
					<span class="k">try</span><span class="o">{</span>
						<span class="c1">//关闭负责执行SQL命令的Statement对象
</span><span class="c1"></span>						<span class="n">st</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
					<span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
						<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
					<span class="o">}</span>
				<span class="o">}</span>
				<span class="k">if</span><span class="o">(</span><span class="n">conn</span><span class="o">!=</span><span class="kc">null</span><span class="o">){</span>
					<span class="k">try</span><span class="o">{</span>
						<span class="c1">//关闭Connection数据库连接对象
</span><span class="c1"></span>						<span class="n">conn</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
					<span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
						<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
					<span class="o">}</span>
			<span class="o">}</span>
		<span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>使用statement对象完成对数据库的CRUD操作</p>
</blockquote>
<p>1、插入一条数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.kuang.lesson02</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.kuang.lesson02.utils.JdbcUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Statement</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestInsert</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">Statement</span> <span class="n">st</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="k">try</span><span class="o">{</span>
				<span class="c1">//获取一个数据库连接
</span><span class="c1"></span>				<span class="n">conn</span> <span class="o">=</span> <span class="n">JdbcUtils</span><span class="o">.</span><span class="na">getConnection</span><span class="o">();</span>
				<span class="c1">//通过conn对象获取负责执行SQL命令的Statement对象
</span><span class="c1"></span>				<span class="n">st</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">createStatement</span><span class="o">();</span>
				<span class="c1">//要执行的SQL命令
</span><span class="c1"></span>				<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;insert into users(id,name,password,email,birthday)&#34;</span> <span class="o">+</span>
				<span class="s">&#34;values(4,&#39;kuangshen&#39;,&#39;123&#39;,&#39;24736743@qq.com&#39;,&#39;2020-01-01&#39;)&#34;</span><span class="o">;</span>
				<span class="c1">//执行插入操作，executeUpdate方法返回成功的条数
</span><span class="c1"></span>				<span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
				<span class="k">if</span><span class="o">(</span><span class="n">num</span><span class="o">&gt;</span><span class="n">0</span><span class="o">){</span>
					<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;插入成功！！&#34;</span><span class="o">);</span>
				<span class="o">}</span>
			<span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
			<span class="o">}</span><span class="k">finally</span><span class="o">{</span>
				<span class="c1">//SQL执行完成之后释放相关资源
</span><span class="c1"></span>				<span class="n">JdbcUtils</span><span class="o">.</span><span class="na">release</span><span class="o">(</span><span class="n">conn</span><span class="o">,</span> <span class="n">st</span><span class="o">,</span> <span class="n">rs</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>2、删除一条数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.kuang.lesson02</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.kuang.lesson02.utils.JdbcUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Statement</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestDelete</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">Statement</span> <span class="n">st</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="k">try</span><span class="o">{</span>
				<span class="n">conn</span> <span class="o">=</span> <span class="n">JdbcUtils</span><span class="o">.</span><span class="na">getConnection</span><span class="o">();</span>
				<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;delete from users where id=4&#34;</span><span class="o">;</span>
				<span class="n">st</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">createStatement</span><span class="o">();</span>
				<span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
				<span class="k">if</span><span class="o">(</span><span class="n">num</span><span class="o">&gt;</span><span class="n">0</span><span class="o">){</span>
					<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;删除成功！！&#34;</span><span class="o">);</span>
				<span class="o">}</span>
		<span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span><span class="k">finally</span><span class="o">{</span>
				<span class="n">JdbcUtils</span><span class="o">.</span><span class="na">release</span><span class="o">(</span><span class="n">conn</span><span class="o">,</span> <span class="n">st</span><span class="o">,</span> <span class="n">rs</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>3、更新一条数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.kuang.lesson02</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.kuang.lesson02.utils.JdbcUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Statement</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestUpdate</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">Statement</span> <span class="n">st</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		
		<span class="k">try</span><span class="o">{</span>
				<span class="n">conn</span> <span class="o">=</span> <span class="n">JdbcUtils</span><span class="o">.</span><span class="na">getConnection</span><span class="o">();</span>
				<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;update users set
</span><span class="s">				name=&#39;kuangshen&#39;,email=&#39;24736743@qq.com&#39; where id=3&#34;</span><span class="o">;</span>
				<span class="n">st</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">createStatement</span><span class="o">();</span>
				<span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
				<span class="k">if</span><span class="o">(</span><span class="n">num</span><span class="o">&gt;</span><span class="n">0</span><span class="o">){</span>
					<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;更新成功！！&#34;</span><span class="o">);</span>
				<span class="o">}</span>
		<span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span><span class="k">finally</span><span class="o">{</span>
				<span class="n">JdbcUtils</span><span class="o">.</span><span class="na">release</span><span class="o">(</span><span class="n">conn</span><span class="o">,</span> <span class="n">st</span><span class="o">,</span> <span class="n">rs</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>4、查询数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.kuang.lesson02</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.kuang.lesson02.utils.JdbcUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Statement</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestSelect</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">Statement</span> <span class="n">st</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		
		<span class="k">try</span><span class="o">{</span>
				<span class="n">conn</span> <span class="o">=</span> <span class="n">JdbcUtils</span><span class="o">.</span><span class="na">getConnection</span><span class="o">();</span>
				<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;select * from users where id=3&#34;</span><span class="o">;</span>
				<span class="n">st</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">createStatement</span><span class="o">();</span>
				<span class="n">rs</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
				<span class="k">if</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">()){</span>
					<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&#34;name&#34;</span><span class="o">));</span>
				<span class="o">}</span>
		<span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span><span class="k">finally</span><span class="o">{</span>
				<span class="n">JdbcUtils</span><span class="o">.</span><span class="na">release</span><span class="o">(</span><span class="n">conn</span><span class="o">,</span> <span class="n">st</span><span class="o">,</span> <span class="n">rs</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>SQL注入问题</p>
</blockquote>
<p><strong>通过巧妙的技巧来拼接字符串，造成SQL短路，从而获取数据库数据</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.kuang.lesson02</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.kuang.lesson02.utils.JdbcUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Statement</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SQL注入</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
			<span class="c1">// login(&#34;zhangsan&#34;,&#34;123456&#34;); // 正常登陆
</span><span class="c1"></span>			<span class="n">login</span><span class="o">(</span><span class="s">&#34;&#39;or &#39;1=1&#34;</span><span class="o">,</span><span class="s">&#34;123456&#34;</span><span class="o">);</span> <span class="c1">// SQL 注入
</span><span class="c1"></span>		<span class="o">}</span>
		<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">login</span><span class="o">(</span><span class="n">String</span> <span class="n">username</span><span class="o">,</span><span class="n">String</span> <span class="n">password</span><span class="o">){</span>
			<span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
			<span class="n">Statement</span> <span class="n">st</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
			<span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
			<span class="k">try</span><span class="o">{</span>
					<span class="n">conn</span> <span class="o">=</span> <span class="n">JdbcUtils</span><span class="o">.</span><span class="na">getConnection</span><span class="o">();</span>
					<span class="c1">// select * from users where name=&#39;&#39; or &#39;1=1&#39; and password =&#39;123456&#39;
</span><span class="c1"></span>					<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;select * from users where name=&#39;&#34;</span><span class="o">+</span><span class="n">username</span><span class="o">+</span><span class="s">&#34;&#39; and password=&#39;&#34;</span><span class="o">+</span><span class="n">password</span><span class="o">+</span><span class="s">&#34;&#39;;
</span><span class="s">					st = conn.createStatement();
</span><span class="s">					rs = st.executeQuery(sql);
</span><span class="s">					while(rs.next()){
</span><span class="s">							System.out.println(rs.getString(&#34;</span><span class="n">name</span><span class="s">&#34;));
</span><span class="s">							System.out.println(rs.getString(&#34;</span><span class="n">password</span><span class="s">&#34;));
</span><span class="s">							System.out.println(&#34;</span><span class="o">==============</span><span class="err">&#34;</span><span class="o">);</span>
					<span class="o">}</span>
			<span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
					<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
			<span class="o">}</span><span class="k">finally</span><span class="o">{</span>
					<span class="n">JdbcUtils</span><span class="o">.</span><span class="na">release</span><span class="o">(</span><span class="n">conn</span><span class="o">,</span> <span class="n">st</span><span class="o">,</span> <span class="n">rs</span><span class="o">);</span>
			<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="106preparedstatement对象">10.6、PreparedStatement对象</h3>
<p><code>PreperedStatement</code>是<code>Statement</code>的子类，它的实例对象可以通过调用Connection.preparedStatement()方法获得，相对于Statement对象而言：PreperedStatement可以避
免SQL注入的问题。</p>
<p>Statement会使数据库频繁编译SQL，可能造成数据库缓冲区溢出。</p>
<p>PreparedStatement可对SQL进行<code>预编译</code>，从而提高数据库的执行效率。并且PreperedStatement对于sql中的参数，允许使用占位符的形式进行替换，简化sql语句的编写。</p>
<blockquote>
<p>使用PreparedStatement对象完成对数据库的CRUD操作</p>
</blockquote>
<p>1、插入数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.kuang.lesson03</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.kuang.lesson02.utils.JdbcUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.PreparedStatement</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestInsert</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">PreparedStatement</span> <span class="n">st</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		
		<span class="k">try</span><span class="o">{</span>
				<span class="c1">//获取一个数据库连接
</span><span class="c1"></span>				<span class="n">conn</span> <span class="o">=</span> <span class="n">JdbcUtils</span><span class="o">.</span><span class="na">getConnection</span><span class="o">();</span>
				<span class="c1">//要执行的SQL命令，SQL中的参数使用?作为占位符
</span><span class="c1"></span>				<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;insert into users(id,name,password,email,birthday) values(?,?,?,?,?)&#34;</span><span class="o">;</span>
				<span class="c1">//通过conn对象获取负责执行SQL命令的prepareStatement对象
</span><span class="c1"></span>				<span class="n">st</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
				
				<span class="c1">//为SQL语句中的参数赋值，注意，索引是从1开始的
</span><span class="c1"></span>				<span class="n">st</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="n">1</span><span class="o">,</span> <span class="n">4</span><span class="o">);</span><span class="c1">//id是int类型的
</span><span class="c1"></span>				<span class="n">st</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="n">2</span><span class="o">,</span> <span class="s">&#34;kuangshen&#34;</span><span class="o">);</span><span class="c1">//name是varchar(字符串类型)
</span><span class="c1"></span>				<span class="n">st</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="n">3</span><span class="o">,</span> <span class="s">&#34;123&#34;</span><span class="o">);</span><span class="c1">//password是varchar(字符串类型)
</span><span class="c1"></span>				<span class="n">st</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="n">4</span><span class="o">,</span> <span class="s">&#34;24736743@qq.com&#34;</span><span class="o">);</span><span class="c1">//email是varchar(字符串类型)
</span><span class="c1"></span>				<span class="n">st</span><span class="o">.</span><span class="na">setDate</span><span class="o">(</span><span class="n">5</span><span class="o">,</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="na">sql</span><span class="o">.</span><span class="na">Date</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">().</span><span class="na">getTime</span><span class="o">()));</span><span class="c1">//birthday是date类型
</span><span class="c1"></span>				
				<span class="c1">//执行插入操作，executeUpdate方法返回成功的条数
</span><span class="c1"></span>				<span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
				<span class="k">if</span><span class="o">(</span><span class="n">num</span><span class="o">&gt;</span><span class="n">0</span><span class="o">){</span>
					<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;插入成功！！&#34;</span><span class="o">);</span>
				<span class="o">}</span>
		<span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span><span class="k">finally</span><span class="o">{</span>
				<span class="c1">//SQL执行完成之后释放相关资源
</span><span class="c1"></span>				<span class="n">JdbcUtils</span><span class="o">.</span><span class="na">release</span><span class="o">(</span><span class="n">conn</span><span class="o">,</span> <span class="n">st</span><span class="o">,</span> <span class="n">rs</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>2、删除一条数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.kuang.lesson03</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.kuang.lesson02.utils.JdbcUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.PreparedStatement</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestDelete</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">PreparedStatement</span> <span class="n">st</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="k">try</span><span class="o">{</span>
				<span class="n">conn</span> <span class="o">=</span> <span class="n">JdbcUtils</span><span class="o">.</span><span class="na">getConnection</span><span class="o">();</span>
				<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;delete from users where id=?&#34;</span><span class="o">;</span>
				<span class="n">st</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
				<span class="n">st</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="n">1</span><span class="o">,</span> <span class="n">4</span><span class="o">);</span>
				<span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
				<span class="k">if</span><span class="o">(</span><span class="n">num</span><span class="o">&gt;</span><span class="n">0</span><span class="o">){</span>
					<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;删除成功！！&#34;</span><span class="o">);</span>
				<span class="o">}</span>
		<span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span><span class="k">finally</span><span class="o">{</span>
				<span class="n">JdbcUtils</span><span class="o">.</span><span class="na">release</span><span class="o">(</span><span class="n">conn</span><span class="o">,</span> <span class="n">st</span><span class="o">,</span> <span class="n">rs</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>3、更新一条数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.kuang.lesson03</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.kuang.lesson02.utils.JdbcUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.PreparedStatement</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestUpdate</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">PreparedStatement</span> <span class="n">st</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="k">try</span><span class="o">{</span>
				<span class="n">conn</span> <span class="o">=</span> <span class="n">JdbcUtils</span><span class="o">.</span><span class="na">getConnection</span><span class="o">();</span>
				<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;update users set name=?,email=? where id=?&#34;</span><span class="o">;</span>
				<span class="n">st</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
				<span class="n">st</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="n">1</span><span class="o">,</span> <span class="s">&#34;kuangshen&#34;</span><span class="o">);</span>
				<span class="n">st</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="n">2</span><span class="o">,</span> <span class="s">&#34;24736743@qq.com&#34;</span><span class="o">);</span>
				<span class="n">st</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="n">3</span><span class="o">,</span> <span class="n">2</span><span class="o">);</span>
				<span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
				<span class="k">if</span><span class="o">(</span><span class="n">num</span><span class="o">&gt;</span><span class="n">0</span><span class="o">){</span>
					<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;更新成功！！&#34;</span><span class="o">);</span>
				<span class="o">}</span>
		<span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span><span class="k">finally</span><span class="o">{</span>
				<span class="n">JdbcUtils</span><span class="o">.</span><span class="na">release</span><span class="o">(</span><span class="n">conn</span><span class="o">,</span> <span class="n">st</span><span class="o">,</span> <span class="n">rs</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>4、查询一条数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.kuang.lesson03</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.kuang.lesson02.utils.JdbcUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.PreparedStatement</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestSelect</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">PreparedStatement</span> <span class="n">st</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="k">try</span><span class="o">{</span>
				<span class="n">conn</span> <span class="o">=</span> <span class="n">JdbcUtils</span><span class="o">.</span><span class="na">getConnection</span><span class="o">();</span>
				<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;select * from users where id=?&#34;</span><span class="o">;</span>
				<span class="n">st</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
				<span class="n">st</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="n">1</span><span class="o">,</span> <span class="n">1</span><span class="o">);</span>
				<span class="n">rs</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">();</span>
				<span class="k">if</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">()){</span>
					<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&#34;name&#34;</span><span class="o">));</span>
				<span class="o">}</span>
		<span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
		<span class="o">}</span><span class="k">finally</span><span class="o">{</span>
				<span class="n">JdbcUtils</span><span class="o">.</span><span class="na">release</span><span class="o">(</span><span class="n">conn</span><span class="o">,</span> <span class="n">st</span><span class="o">,</span> <span class="n">rs</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>避免SQL注入</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.kuang.lesson03</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.kuang.lesson02.utils.JdbcUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.PreparedStatement</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Statement</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SQL注入</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="c1">// login(&#34;zhangsan&#34;,&#34;123456&#34;); // 正常登陆
</span><span class="c1"></span>		<span class="n">login</span><span class="o">(</span><span class="s">&#34;&#39;or &#39;1=1&#34;</span><span class="o">,</span><span class="s">&#34;123456&#34;</span><span class="o">);</span> <span class="c1">// SQL 注入
</span><span class="c1"></span>	<span class="o">}</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">login</span><span class="o">(</span><span class="n">String</span> <span class="n">username</span><span class="o">,</span><span class="n">String</span> <span class="n">password</span><span class="o">){</span>
		<span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">PreparedStatement</span> <span class="n">st</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="k">try</span><span class="o">{</span>
			<span class="n">conn</span> <span class="o">=</span> <span class="n">JdbcUtils</span><span class="o">.</span><span class="na">getConnection</span><span class="o">();</span>
			
			<span class="c1">// 假设其中存在转义字符，就直接忽略，比如说  &#39;  会被直接转义
</span><span class="c1"></span>			<span class="c1">// select * from users where name=&#39;&#39; or &#39;1=1&#39; and password =&#39;123456&#39;
</span><span class="c1"></span>			<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;select * from users where name=? and password=?&#34;</span><span class="o">;</span>
			<span class="n">st</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
			<span class="n">st</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="n">1</span><span class="o">,</span><span class="n">username</span><span class="o">);</span>
			<span class="n">st</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="n">2</span><span class="o">,</span><span class="n">password</span><span class="o">);</span>
			<span class="n">rs</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">();</span>
			<span class="k">while</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">()){</span>
				<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&#34;name&#34;</span><span class="o">));</span>
				<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&#34;password&#34;</span><span class="o">));</span>
				<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;==============&#34;</span><span class="o">);</span>
			<span class="o">}</span>
		<span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span><span class="k">finally</span><span class="o">{</span>
			<span class="n">JdbcUtils</span><span class="o">.</span><span class="na">release</span><span class="o">(</span><span class="n">conn</span><span class="o">,</span> <span class="n">st</span><span class="o">,</span> <span class="n">rs</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><pre><code>原理：执行的时候参数会用引号包起来，并把参数中的引号作为转义字符，从而避免了参数也作为条件的一部分
</code></pre>
<h3 id="107事务">10.7、事务</h3>
<blockquote>
<p>概念</p>
</blockquote>
<p><strong>事务指逻辑上的一组操作，组成这组操作的各个单元，要不全部成功，要不全部不成功</strong></p>
<blockquote>
<p>ACID原则</p>
</blockquote>
<p><strong>原子性</strong></p>
<ul>
<li>整个事务中的所有操作，要么全部完成，要么全部不完成，不可能停滞在中间某个环节。事务在执 行过程中发生错误，会被回滚（ROLLBACK）到事务开始前的状态，就像这个事务从来没有执行过一样</li>
</ul>
<p><strong>一致性</strong></p>
<ul>
<li>一个事务可以封装状态改变（除非它是一个只读的）。事务必须始终保持系统处于一致的状态，不 管在任何给定的时间并发事务有多少。也就是说：如果事务是并发多个，系统也必须如同串行事务 一样操作。其主要特征是保护性和不变性(Preserving an Invariant)，以转账案例为例，假设有五 个账户，每个账户余额是100元，那么五个账户总额是500元，如果在这个5个账户之间同时发生多 个转账，无论并发多少个，比如在A与B账户之间转账5元，在C与D账户之间转账10元，在B与E之 间转账15元，五个账户总额也应该还是500元，这就是保护性和不变性。</li>
</ul>
<p><strong>隔离性</strong></p>
<ul>
<li>隔离状态执行事务，使它们好像是系统在给定时间内执行的唯一操作。如果有两个事务，运行在相 同的时间内，执行相同的功能，事务的隔离性将确保每一事务在系统中认为只有该事务在使用系 统。这种属性有时称为串行化，为了防止事务操作间的混淆，必须串行化或序列化请求，使得在同 一时间仅有一个请求用于同一数据。</li>
</ul>
<p><strong>持久性</strong></p>
<ul>
<li>在事务完成以后，该事务对数据库所作的更改便持久的保存在数据库之中，并不会被回滚。</li>
</ul>
<blockquote>
<p>隔离性问题</p>
</blockquote>
<ol>
<li>脏读：脏读指一个事务读取了另外一个事务未提交的数据</li>
<li>不可重复读：不可重复读指在一个事务内读取表中的某一行数据，多次读取结构不同</li>
<li>虚读(幻读)：虚读(幻读)是指在一个事务内读到了别的事务插入的数据，导致前后读取不一致</li>
</ol>
<blockquote>
<p>代码测试</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="cm">/*创建账户表*/</span>
<span class="n">CREATE</span> <span class="n">TABLE</span> <span class="nf">account</span><span class="o">(</span>
		<span class="n">id</span> <span class="n">INT</span> <span class="n">PRIMARY</span> <span class="n">KEY</span> <span class="n">AUTO_INCREMENT</span><span class="o">,</span>
		<span class="n">NAME</span> <span class="nf">VARCHAR</span><span class="o">(</span><span class="n">40</span><span class="o">),</span>
		<span class="n">money</span> <span class="n">FLOAT</span>
<span class="o">);</span>

<span class="cm">/*插入测试数据*/</span>
<span class="n">insert</span> <span class="n">into</span> <span class="nf">account</span><span class="o">(</span><span class="n">name</span><span class="o">,</span><span class="n">money</span><span class="o">)</span> <span class="n">values</span><span class="o">(</span><span class="sc">&#39;A&#39;</span><span class="o">,</span><span class="n">1000</span><span class="o">);</span>
<span class="n">insert</span> <span class="n">into</span> <span class="nf">account</span><span class="o">(</span><span class="n">name</span><span class="o">,</span><span class="n">money</span><span class="o">)</span> <span class="n">values</span><span class="o">(</span><span class="sc">&#39;B&#39;</span><span class="o">,</span><span class="n">1000</span><span class="o">);</span>
<span class="n">insert</span> <span class="n">into</span> <span class="nf">account</span><span class="o">(</span><span class="n">name</span><span class="o">,</span><span class="n">money</span><span class="o">)</span> <span class="n">values</span><span class="o">(</span><span class="sc">&#39;C&#39;</span><span class="o">,</span><span class="n">1000</span><span class="o">);</span>
</code></pre></td></tr></table>
</div>
</div><p>当Jdbc程序向数据库获得一个Connection对象时，默认情况下这个Connection对象会自动向数据库提交在它上面发送的SQL语句。若想关闭这种默认提交方式，让多条SQL在一个事务中执行，可使用下列的JDBC控制事务语句</p>
<ul>
<li>Connection.setAutoCommit(false);//开启事务(start transaction)</li>
<li>Connection.rollback();//回滚事务(rollback)</li>
<li>Connection.commit();//提交事务(commit)</li>
</ul>
<blockquote>
<p>程序编写</p>
</blockquote>
<p>1、模拟转账成功时的业务场景</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.kuang.lesson04</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.kuang.lesson02.utils.JdbcUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.PreparedStatement</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="o">;</span>
<span class="c1">//模拟转账成功时的业务场景
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestTransaction1</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">PreparedStatement</span> <span class="n">st</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="k">try</span><span class="o">{</span>
				<span class="n">conn</span> <span class="o">=</span> <span class="n">JdbcUtils</span><span class="o">.</span><span class="na">getConnection</span><span class="o">();</span>
				<span class="n">conn</span><span class="o">.</span><span class="na">setAutoCommit</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span><span class="c1">//通知数据库开启事务(start transaction)
</span><span class="c1"></span>				<span class="n">String</span> <span class="n">sql1</span> <span class="o">=</span> <span class="s">&#34;update account set money=money-100 where name=&#39;A&#39;&#34;</span><span class="o">;</span>
				<span class="n">st</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">sql1</span><span class="o">);</span>
				<span class="n">st</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
				
				<span class="n">String</span> <span class="n">sql2</span> <span class="o">=</span> <span class="s">&#34;update account set money=money+100 where name=&#39;B&#39;&#34;</span><span class="o">;</span>
				<span class="n">st</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">sql2</span><span class="o">);</span>
				<span class="n">st</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
				<span class="n">conn</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span><span class="c1">//上面的两条SQL执行Update语句成功之后就通知数据库提交事务(commit)
</span><span class="c1"></span>				<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;成功！！！&#34;</span><span class="o">);</span> <span class="c1">//log4j
</span><span class="c1"></span>		<span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span><span class="k">finally</span><span class="o">{</span>
				<span class="n">JdbcUtils</span><span class="o">.</span><span class="na">release</span><span class="o">(</span><span class="n">conn</span><span class="o">,</span> <span class="n">st</span><span class="o">,</span> <span class="n">rs</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>2、模拟转账过程中出现异常导致有一部分SQL执行失败后让数据库自动回滚事务</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.kuang.lesson04</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.kuang.lesson02.utils.JdbcUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.PreparedStatement</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="o">;</span>
<span class="c1">// 模拟转账过程中出现异常导致有一部分SQL执行失败后让数据库自动回滚事务
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestTransaction2</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">PreparedStatement</span> <span class="n">st</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="k">try</span><span class="o">{</span>
				<span class="n">conn</span> <span class="o">=</span> <span class="n">JdbcUtils</span><span class="o">.</span><span class="na">getConnection</span><span class="o">();</span>
				<span class="n">conn</span><span class="o">.</span><span class="na">setAutoCommit</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span><span class="c1">//通知数据库开启事务(start transaction)
</span><span class="c1"></span>				<span class="n">String</span> <span class="n">sql1</span> <span class="o">=</span> <span class="s">&#34;update account set money=money-100 where name=&#39;A&#39;&#34;</span><span class="o">;</span>
				<span class="n">st</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">sql1</span><span class="o">);</span>
				<span class="n">st</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
				
				<span class="c1">//用这句代码模拟执行完SQL1之后程序出现了异常而导致后面的SQL无法正常执行，事务也无法正常提交，此时数据库会自动执行回滚操作
</span><span class="c1"></span>				<span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">1</span><span class="o">/</span><span class="n">0</span><span class="o">;</span>
				
				<span class="n">String</span> <span class="n">sql2</span> <span class="o">=</span> <span class="s">&#34;update account set money=money+100 where name=&#39;B&#39;&#34;</span><span class="o">;</span>
				<span class="n">st</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">sql2</span><span class="o">);</span>
				<span class="n">st</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
				<span class="n">conn</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span><span class="c1">//上面的两条SQL执行Update语句成功之后就通知数据库提交事务(commit)
</span><span class="c1"></span>				<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;成功！！！&#34;</span><span class="o">);</span>
		<span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span><span class="k">finally</span><span class="o">{</span>
				<span class="n">JdbcUtils</span><span class="o">.</span><span class="na">release</span><span class="o">(</span><span class="n">conn</span><span class="o">,</span> <span class="n">st</span><span class="o">,</span> <span class="n">rs</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>3、模拟转账过程中出现异常导致有一部分SQL执行失败时手动通知数据库回滚事务</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.kuang.lesson04</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.kuang.lesson02.utils.JdbcUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.PreparedStatement</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="o">;</span>
<span class="c1">//模拟转账过程中出现异常导致有一部分SQL执行失败时手动通知数据库回滚事务
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestTransaction3</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">PreparedStatement</span> <span class="n">st</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="k">try</span><span class="o">{</span>
				<span class="n">conn</span> <span class="o">=</span> <span class="n">JdbcUtils</span><span class="o">.</span><span class="na">getConnection</span><span class="o">();</span>
				<span class="n">conn</span><span class="o">.</span><span class="na">setAutoCommit</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span><span class="c1">//通知数据库开启事务(start transaction)
</span><span class="c1"></span>				<span class="n">String</span> <span class="n">sql1</span> <span class="o">=</span> <span class="s">&#34;update account set money=money-100 where name=&#39;A&#39;&#34;</span><span class="o">;</span>
				<span class="n">st</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">sql1</span><span class="o">);</span>
				<span class="n">st</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
				
				<span class="c1">//用这句代码模拟执行完SQL1之后程序出现了异常而导致后面的SQL无法正常执行，事务也无法正常提交
</span><span class="c1"></span>				<span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">1</span><span class="o">/</span><span class="n">0</span><span class="o">;</span>
				<span class="n">String</span> <span class="n">sql2</span> <span class="o">=</span> <span class="s">&#34;update account set money=money+100 where name=&#39;B&#39;&#34;</span><span class="o">;</span>
				<span class="n">st</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">sql2</span><span class="o">);</span>
				<span class="n">st</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
				<span class="n">conn</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span><span class="c1">//上面的两条SQL执行Update语句成功之后就通知数据库提交事务(commit)
</span><span class="c1"></span>				<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;成功！！！&#34;</span><span class="o">);</span>
		<span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
				<span class="k">try</span> <span class="o">{</span>
						<span class="c1">//捕获到异常之后手动通知数据库执行回滚事务的操作
</span><span class="c1"></span>						<span class="n">conn</span><span class="o">.</span><span class="na">rollback</span><span class="o">();</span>
				<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">SQLException</span> <span class="n">e1</span><span class="o">)</span> <span class="o">{</span>
						<span class="n">e1</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
				<span class="o">}</span>
				<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span><span class="k">finally</span><span class="o">{</span>
				<span class="n">JdbcUtils</span><span class="o">.</span><span class="na">release</span><span class="o">(</span><span class="n">conn</span><span class="o">,</span> <span class="n">st</span><span class="o">,</span> <span class="n">rs</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="108数据库连接池">10.8、数据库连接池</h3>
<p>用户每次请求都需要向数据库获得链接，而数据库创建连接通常需要消耗相对较大的资源，创建时间也 较长。假设网站一天10万访问量，数据库服务器就需要创建10万次连接，极大的浪费数据库的资源，并 且极易造成数据库服务器内存溢出、拓机。</p>
<blockquote>
<p>数据库连接池的基本概念</p>
</blockquote>
<p><strong>数据库连接池负责分配,管理和释放数据库连接,它允许应用程序重复使用一个现有的
数据库连接,而不是重新建立一个。</strong></p>
<p>数据库连接池在初始化时将创建一定数量的数据库连接放到连接池中, 这些数据库连接的数量是由<code>最小数据库</code>连接数来设定的.无论这些数据库连接是否被使用,连接池都将一直保证至少拥有这么多的连接数量. 连接池的最大数据库连接数量限定了这个连接池能占有的最大连接数,当应用程序向连接池请求的连接数<code>超过最大连接数量时,这些请求将被加入到等待队列中</code></p>
<p>数据库连接池的最小连接数和最大连接数的设置要考虑到以下几个因素:</p>
<ol>
<li>最小连接数:是连接池一直保持的数据库连接,所以如果应用程序对数据库连接的使用量不大,将会有
大量的数据库连接资源被浪费.</li>
<li>最大连接数:是连接池能申请的最大连接数,如果数据库连接请求超过次数,后面的数据库连接请求将
被加入到等待队列中,这会影响以后的数据库操作</li>
<li>如果最小连接数与最大连接数相差很大:那么最先连接请求将会获利,之后超过最小连接数量的连接
请求等价于建立一个新的数据库连接.不过,这些大于最小连接数的数据库连接在使用完不会马上被
释放,他将被放到连接池中等待重复使用或是空间超时后被释放.</li>
</ol>
<p><strong>编写连接池需实现java.sql.DataSource接口。</strong></p>
<blockquote>
<p>开源数据库连接池</p>
</blockquote>
<p>现在很多WEB服务器(Weblogic, WebSphere, Tomcat)都提供了DataSoruce的实现，即连接池的实现。 <strong>通常我们把DataSource的实现，按其英文含义称之为数据源，数据源中都包含了数据库连接池的实 现。</strong></p>
<p>也有一些开源组织提供了数据源的独立实现：</p>
<ul>
<li>DBCP数据库连接池</li>
<li>C3P0数据库连接池</li>
</ul>
<p>在使用了数据库连接池之后，在项目的实际开发中就<code>不需要编写连接数据库的代码了</code>，直接从数据源获得数据库的连接</p>
<blockquote>
<p>DBCP数据源</p>
</blockquote>
<p>DBCP 是 Apache 软件基金组织下的开源连接池实现，要使用DBCP数据源，需要应用程序应在系统中增加如下两个 jar 文件：</p>
<ul>
<li>Commons-dbcp.jar：连接池的实现</li>
<li>Commons-pool.jar：连接池实现的依赖库</li>
</ul>
<p>Tomcat 的连接池正是采用该连接池来实现的。该数据库连接池既可以与应用服务器整合使用，也可由
应用程序独立使用。</p>
<p>测试：</p>
<ol>
<li>导入相关jar包</li>
<li>在类目录下加入dbcp的配置文件：dbcpconfig.properties</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="o">#</span><span class="err">连接设置</span>
<span class="n">driverClassName</span><span class="o">=</span><span class="n">com</span><span class="p">.</span><span class="n">mysql</span><span class="p">.</span><span class="n">jdbc</span><span class="p">.</span><span class="n">Driver</span>
<span class="n">url</span><span class="o">=</span><span class="n">jdbc</span><span class="p">:</span><span class="n">mysql</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">3306</span><span class="o">/</span><span class="n">jdbcStudy</span><span class="o">?</span>
<span class="n">useUnicode</span><span class="o">=</span><span class="k">true</span><span class="o">&amp;</span><span class="n">characterEncoding</span><span class="o">=</span><span class="n">utf8</span><span class="o">&amp;</span><span class="n">useSSL</span><span class="o">=</span><span class="k">true</span>
<span class="n">username</span><span class="o">=</span><span class="n">root</span>
<span class="n">password</span><span class="o">=</span><span class="mi">123456</span>

<span class="o">#&lt;!</span><span class="c1">-- 初始化连接 --&gt;
</span><span class="c1"></span><span class="n">initialSize</span><span class="o">=</span><span class="mi">10</span>
<span class="o">#</span><span class="err">最大连接数量</span>
<span class="n">maxActive</span><span class="o">=</span><span class="mi">50</span>
<span class="o">#&lt;!</span><span class="c1">-- 最大空闲连接 --&gt;
</span><span class="c1"></span><span class="n">maxIdle</span><span class="o">=</span><span class="mi">20</span>
<span class="o">#&lt;!</span><span class="c1">-- 最小空闲连接 --&gt;
</span><span class="c1"></span><span class="n">minIdle</span><span class="o">=</span><span class="mi">5</span>
<span class="o">#&lt;!</span><span class="c1">-- 超时等待时间以毫秒为单位 6000毫秒/1000等于60秒 --&gt;
</span><span class="c1"></span><span class="n">maxWait</span><span class="o">=</span><span class="mi">60000</span>

<span class="o">#</span><span class="n">JDBC驱动建立连接时附带的连接属性属性的格式必须为这样</span><span class="err">：</span><span class="p">[</span><span class="err">属性名</span><span class="o">=</span><span class="n">property</span><span class="p">;]</span>
<span class="o">#</span><span class="err">注意：</span><span class="s2">&#34;user&#34;</span> <span class="err">与</span> <span class="s2">&#34;password&#34;</span> <span class="err">两个属性会被明确地传递，因此这里不需要包含他们。</span>
<span class="n">connectionProperties</span><span class="o">=</span><span class="n">useUnicode</span><span class="o">=</span><span class="k">true</span><span class="p">;</span><span class="n">characterEncoding</span><span class="o">=</span><span class="n">UTF8</span>

<span class="o">#</span><span class="err">指定由连接池所创建的连接的自动提交（</span><span class="n">auto</span><span class="o">-</span><span class="k">commit</span><span class="err">）状态。</span>
<span class="n">defaultAutoCommit</span><span class="o">=</span><span class="k">true</span>
<span class="o">#</span><span class="n">driver</span> <span class="k">default</span> <span class="err">指定由连接池所创建的连接的只读（</span><span class="k">read</span><span class="o">-</span><span class="k">only</span><span class="err">）状态。</span>
<span class="o">#</span><span class="err">如果没有设置该值，则“</span><span class="n">setReadOnly</span><span class="err">”方法将不被调用。（某些驱动并不支持只读模式，如：</span><span class="n">Informix</span><span class="err">）</span>
<span class="n">defaultReadOnly</span><span class="o">=</span>

<span class="o">#</span><span class="n">driver</span> <span class="k">default</span> <span class="err">指定由连接池所创建的连接的事务级别（</span><span class="n">TransactionIsolation</span><span class="err">）。</span>
<span class="o">#</span><span class="err">可用值为下列之一：（详情可见</span><span class="n">javadoc</span><span class="err">。）</span><span class="k">NONE</span><span class="p">,</span><span class="n">READ_UNCOMMITTED</span><span class="p">,</span> <span class="n">READ_COMMITTED</span><span class="p">,</span><span class="n">REPEATABLE_READ</span><span class="p">,</span> <span class="k">SERIALIZABLE</span>
<span class="n">defaultTransactionIsolation</span><span class="o">=</span><span class="n">READ_UNCOMMITTED</span>
</code></pre></td></tr></table>
</div>
</div><p>3、编写工具类 JdbcUtils_DBCP</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.kuang.datasource.utils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Statement</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Properties</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.sql.DataSource</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.commons.dbcp.BasicDataSourceFactory</span><span class="o">;</span>
<span class="c1">//数据库连接工具类
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JdbcUtils_DBCP</span> <span class="o">{</span>
		<span class="cm">/**
</span><span class="cm">		* 在java中，编写数据库连接池需实现java.sql.DataSource接口，每一种数据库连接池都
</span><span class="cm">		是DataSource接口的实现
</span><span class="cm">		* DBCP连接池就是java.sql.DataSource接口的一个具体实现
</span><span class="cm">		*/</span>
		<span class="kd">private</span> <span class="kd">static</span> <span class="n">DataSource</span> <span class="n">ds</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="c1">//在静态代码块中创建数据库连接池
</span><span class="c1"></span>		<span class="kd">static</span><span class="o">{</span>
			<span class="k">try</span><span class="o">{</span>
					<span class="c1">//加载dbcpconfig.properties配置文件
</span><span class="c1"></span>					<span class="n">InputStream</span> <span class="n">in</span> <span class="o">=</span><span class="n">JdbcUtils_DBCP</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getClassLoader</span><span class="o">().</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="s">&#34;dbcpconfig.properties&#34;</span><span class="o">);</span>
					<span class="n">Properties</span> <span class="n">prop</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Properties</span><span class="o">();</span>
					<span class="n">prop</span><span class="o">.</span><span class="na">load</span><span class="o">(</span><span class="n">in</span><span class="o">);</span>
					<span class="c1">//创建数据源
</span><span class="c1"></span>					<span class="n">ds</span> <span class="o">=</span> <span class="n">BasicDataSourceFactory</span><span class="o">.</span><span class="na">createDataSource</span><span class="o">(</span><span class="n">prop</span><span class="o">);</span>
				<span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
					<span class="k">throw</span> <span class="k">new</span> <span class="n">ExceptionInInitializerError</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
				<span class="o">}</span>
		<span class="o">}</span>
		<span class="c1">//从数据源中获取数据库连接
</span><span class="c1"></span>		<span class="kd">public</span> <span class="kd">static</span> <span class="n">Connection</span> <span class="nf">getConnection</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">SQLException</span><span class="o">{</span>
			<span class="c1">//从数据源中获取数据库连接
</span><span class="c1"></span>			<span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="na">getConnection</span><span class="o">();</span>
		<span class="o">}</span>
		<span class="c1">// 释放资源
</span><span class="c1"></span>		<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">release</span><span class="o">(</span><span class="n">Connection</span> <span class="n">conn</span><span class="o">,</span><span class="n">Statement</span> <span class="n">st</span><span class="o">,</span><span class="n">ResultSet</span> <span class="n">rs</span><span class="o">){</span>
			<span class="k">if</span><span class="o">(</span><span class="n">rs</span><span class="o">!=</span><span class="kc">null</span><span class="o">){</span>
				<span class="k">try</span><span class="o">{</span>
						<span class="c1">//关闭存储查询结果的ResultSet对象
</span><span class="c1"></span>						<span class="n">rs</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
				<span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
						<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
				<span class="o">}</span>
				<span class="n">rs</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
			<span class="o">}</span>
			<span class="k">if</span><span class="o">(</span><span class="n">st</span><span class="o">!=</span><span class="kc">null</span><span class="o">){</span>
				<span class="k">try</span><span class="o">{</span>
					<span class="c1">//关闭负责执行SQL命令的Statement对象
</span><span class="c1"></span>					<span class="n">st</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
				<span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
					<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
				<span class="o">}</span>
			<span class="o">}</span>
			<span class="k">if</span><span class="o">(</span><span class="n">conn</span><span class="o">!=</span><span class="kc">null</span><span class="o">){</span>
				<span class="k">try</span><span class="o">{</span>
					<span class="c1">//将Connection连接对象还给数据库连接池
</span><span class="c1"></span>					<span class="n">conn</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
				<span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
					<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
				<span class="o">}</span>
			<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>测试类</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Java" data-lang="Java"><span class="kn">package</span> <span class="nn">com.kuang.datasource</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.kuang.datasource.utils.JdbcUtils_DBCP</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.PreparedStatement</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DBCPTest</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">PreparedStatement</span> <span class="n">st</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="k">try</span><span class="o">{</span>
				<span class="c1">//获取数据库连接
</span><span class="c1"></span>				<span class="n">conn</span> <span class="o">=</span> <span class="n">JdbcUtils_DBCP</span><span class="o">.</span><span class="na">getConnection</span><span class="o">();</span>
				<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;insert into users(id,name,password,email,birthday) values(?,?,?,?,?)&#34;</span><span class="o">;</span>
				<span class="n">st</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
				
				<span class="n">st</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="n">1</span><span class="o">,</span> <span class="n">5</span><span class="o">);</span><span class="c1">//id是int类型的
</span><span class="c1"></span>				<span class="n">st</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="n">2</span><span class="o">,</span> <span class="s">&#34;kuangshen&#34;</span><span class="o">);</span><span class="c1">//name是varchar(字符串类型)
</span><span class="c1"></span>				<span class="n">st</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="n">3</span><span class="o">,</span> <span class="s">&#34;123&#34;</span><span class="o">);</span><span class="c1">//password是varchar(字符串类型)
</span><span class="c1"></span>				<span class="n">st</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="n">4</span><span class="o">,</span> <span class="s">&#34;24736743@qq.com&#34;</span><span class="o">);</span><span class="c1">//email是varchar(字符串类型)
</span><span class="c1"></span>				<span class="n">st</span><span class="o">.</span><span class="na">setDate</span><span class="o">(</span><span class="n">5</span><span class="o">,</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="na">sql</span><span class="o">.</span><span class="na">Date</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">().</span><span class="na">getTime</span><span class="o">()));</span><span class="c1">//birthday是date类型
</span><span class="c1"></span>				<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
				<span class="k">if</span> <span class="o">(</span><span class="n">i</span><span class="o">&gt;</span><span class="n">0</span><span class="o">){</span>
						<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;插入成功&#34;</span><span class="o">);</span>
				<span class="o">}</span>
		<span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span><span class="k">finally</span><span class="o">{</span>
				<span class="c1">//释放资源
</span><span class="c1"></span>				<span class="n">JdbcUtils_DBCP</span><span class="o">.</span><span class="na">release</span><span class="o">(</span><span class="n">conn</span><span class="o">,</span> <span class="n">st</span><span class="o">,</span> <span class="n">rs</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2021-07-04</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="https://cloverfelix.github.io/mysql/" data-title="Mysql" data-hashtags="Mysql"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="https://cloverfelix.github.io/mysql/" data-hashtag="Mysql"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Hacker News" data-sharer="hackernews" data-url="https://cloverfelix.github.io/mysql/" data-title="Mysql"><i class="fab fa-hacker-news fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Line" data-sharer="line" data-url="https://cloverfelix.github.io/mysql/" data-title="Mysql"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@2.14.0/icons/line.svg"></i></a><a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="https://cloverfelix.github.io/mysql/" data-title="Mysql"><i class="fab fa-weibo fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/mysql/">Mysql</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/mybatis/" class="prev" rel="prev" title="Mybatis"><i class="fas fa-angle-left fa-fw"></i>Mybatis</a>
            <a href="/sql%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/" class="next" rel="next" title="SQL常见问题">SQL常见问题<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2021 - 2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Clover</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/css/lightgallery.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/algoliasearch@4.2.0/dist/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/js/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.2.0/dist/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":10},"comment":{},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"search":{"algoliaAppID":"QEH6MSAUGD","algoliaIndex":"blog","algoliaSearchKey":"83e0e9a01bb86efaff215298300450e1","highlightTag":"em","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"algolia"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
